<?xml version="1.0" encoding="utf-8" ?>
<Sqls>

	<Sql>
		<key>GetMaxId</key>
		<query>
			 select nvl(max(cagdcmcodi), 0) + 1 from cai_generdeman
		</query>
	</Sql>

	<Sql>
		<key>Save</key>
		<query>
			insert into cai_generdeman(
			cagdcmcodi,
			caiajcodi,
			cagdcmfuentedat,
			ptomedicodi,
			emprcodi,
			equicodicen,
			equicodiuni,
			cagdcmcalidadinfo,
			cagdcmdia,
			cagdcmtotaldia,
			h1,
			h2,
			h3,
			h4,
			h5,
			h6,
			h7,
			h8,
			h9,
			h10,
			h11,
			h12,
			h13,
			h14,
			h15,
			h16,
			h17,
			h18,
			h19,
			h20,
			h21,
			h22,
			h23,
			h24,
			h25,
			h26,
			h27,
			h28,
			h29,
			h30,
			h31,
			h32,
			h33,
			h34,
			h35,
			h36,
			h37,
			h38,
			h39,
			h40,
			h41,
			h42,
			h43,
			h44,
			h45,
			h46,
			h47,
			h48,
			h49,
			h50,
			h51,
			h52,
			h53,
			h54,
			h55,
			h56,
			h57,
			h58,
			h59,
			h60,
			h61,
			h62,
			h63,
			h64,
			h65,
			h66,
			h67,
			h68,
			h69,
			h70,
			h71,
			h72,
			h73,
			h74,
			h75,
			h76,
			h77,
			h78,
			h79,
			h80,
			h81,
			h82,
			h83,
			h84,
			h85,
			h86,
			h87,
			h88,
			h89,
			h90,
			h91,
			h92,
			h93,
			h94,
			h95,
			h96,
			t1,
			t2,
			t3,
			t4,
			t5,
			t6,
			t7,
			t8,
			t9,
			t10,
			t11,
			t12,
			t13,
			t14,
			t15,
			t16,
			t17,
			t18,
			t19,
			t20,
			t21,
			t22,
			t23,
			t24,
			t25,
			t26,
			t27,
			t28,
			t29,
			t30,
			t31,
			t32,
			t33,
			t34,
			t35,
			t36,
			t37,
			t38,
			t39,
			t40,
			t41,
			t42,
			t43,
			t44,
			t45,
			t46,
			t47,
			t48,
			t49,
			t50,
			t51,
			t52,
			t53,
			t54,
			t55,
			t56,
			t57,
			t58,
			t59,
			t60,
			t61,
			t62,
			t63,
			t64,
			t65,
			t66,
			t67,
			t68,
			t69,
			t70,
			t71,
			t72,
			t73,
			t74,
			t75,
			t76,
			t77,
			t78,
			t79,
			t80,
			t81,
			t82,
			t83,
			t84,
			t85,
			t86,
			t87,
			t88,
			t89,
			t90,
			t91,
			t92,
			t93,
			t94,
			t95,
			t96,
			cagdcmusucreacion,
			cagdcmfeccreacion
			)
			values(
			:cagdcmcodi,
			:caiajcodi,
			:cagdcmfuentedat,
			:ptomedicodi,
			:emprcodi,
			:equicodicen,
			:equicodiuni,
			:cagdcmcalidadinfo,
			:cagdcmdia,
			:cagdcmtotaldia,
			:h1,
			:h2,
			:h3,
			:h4,
			:h5,
			:h6,
			:h7,
			:h8,
			:h9,
			:h10,
			:h11,
			:h12,
			:h13,
			:h14,
			:h15,
			:h16,
			:h17,
			:h18,
			:h19,
			:h20,
			:h21,
			:h22,
			:h23,
			:h24,
			:h25,
			:h26,
			:h27,
			:h28,
			:h29,
			:h30,
			:h31,
			:h32,
			:h33,
			:h34,
			:h35,
			:h36,
			:h37,
			:h38,
			:h39,
			:h40,
			:h41,
			:h42,
			:h43,
			:h44,
			:h45,
			:h46,
			:h47,
			:h48,
			:h49,
			:h50,
			:h51,
			:h52,
			:h53,
			:h54,
			:h55,
			:h56,
			:h57,
			:h58,
			:h59,
			:h60,
			:h61,
			:h62,
			:h63,
			:h64,
			:h65,
			:h66,
			:h67,
			:h68,
			:h69,
			:h70,
			:h71,
			:h72,
			:h73,
			:h74,
			:h75,
			:h76,
			:h77,
			:h78,
			:h79,
			:h80,
			:h81,
			:h82,
			:h83,
			:h84,
			:h85,
			:h86,
			:h87,
			:h88,
			:h89,
			:h90,
			:h91,
			:h92,
			:h93,
			:h94,
			:h95,
			:h96,
			:t1,
			:t2,
			:t3,
			:t4,
			:t5,
			:t6,
			:t7,
			:t8,
			:t9,
			:t10,
			:t11,
			:t12,
			:t13,
			:t14,
			:t15,
			:t16,
			:t17,
			:t18,
			:t19,
			:t20,
			:t21,
			:t22,
			:t23,
			:t24,
			:t25,
			:t26,
			:t27,
			:t28,
			:t29,
			:t30,
			:t31,
			:t32,
			:t33,
			:t34,
			:t35,
			:t36,
			:t37,
			:t38,
			:t39,
			:t40,
			:t41,
			:t42,
			:t43,
			:t44,
			:t45,
			:t46,
			:t47,
			:t48,
			:t49,
			:t50,
			:t51,
			:t52,
			:t53,
			:t54,
			:t55,
			:t56,
			:t57,
			:t58,
			:t59,
			:t60,
			:t61,
			:t62,
			:t63,
			:t64,
			:t65,
			:t66,
			:t67,
			:t68,
			:t69,
			:t70,
			:t71,
			:t72,
			:t73,
			:t74,
			:t75,
			:t76,
			:t77,
			:t78,
			:t79,
			:t80,
			:t81,
			:t82,
			:t83,
			:t84,
			:t85,
			:t86,
			:t87,
			:t88,
			:t89,
			:t90,
			:t91,
			:t92,
			:t93,
			:t94,
			:t95,
			:t96,
			:cagdcmusucreacion,
			:cagdcmfeccreacion
			)
		</query>
	</Sql>

	<Sql>
		<key>SaveAsSelectUsuariosLibres</key>
		<query>INSERT INTO cai_generdeman (cagdcmcodi, caiajcodi, cagdcmfuentedat, ptomedicodi, 
emprcodi, equicodicen, equicodiuni, cagdcmcalidadinfo, cagdcmdia, cagdcmtotaldia,
h1, h2, h3, h4, h5, h6, h7, h8, h9, h10, h11, h12, h13, h14, h15, h16, h17, h18, h19, h20, h21, h22, h23, h24, h25, h26, h27, h28, h29, h30, h31, h32, h33, h34, h35, h36, h37, h38, h39, h40, h41, h42, h43, h44, h45, h46, h47, h48,
h49, h50, h51, h52, h53, h54, h55, h56, h57, h58, h59, h60, h61, h62, h63, h64, h65, h66, h67, h68, h69, h70, h71, h72, h73, h74, h75, h76, h77, h78, h79, h80, h81, h82, h83, h84, h85, h86, h87, h88, h89, h90, h91, h92, h93, h94, h95, h96,
t1, t2, t3, t4, t5, t6, t7, t8, t9, t10, t11, t12, t13, t14, t15, t16, t17, t18, t19, t20, t21, t22, t23, t24, t25, t26, t27, t28, t29, t30, t31, t32, t33, t34, t35, t36, t37, t38, t39, t40, t41, t42, t43, t44, t45, t46, t47, t48, 
t49, t50, t51, t52, t53, t54, t55, t56, t57, t58, t59, t60, t61, t62, t63, t64, t65, t66, t67, t68, t69, t70, t71, t72, t73, t74, t75, t76, t77, t78, t79, t80, t81, t82, t83, t84, t85, t86, t87, t88, t89, t90, t91, t92, t93, t94, t95, t96,
cagdcmusucreacion, cagdcmfeccreacion)
SELECT rownum + {0}, {1}, '{2}', PTOMEDICODI, 
EMPRCODI, EQUICODICEN, EQUICODIUNI, '{3}', CAGDCMDIA, NVL(MEDITOTAL,0),
NVL(h1,0), NVL(h2,0), NVL(h3,0), NVL(h4,0), NVL(h5,0), NVL(h6,0), NVL(h7,0), NVL(h8,0), NVL(h9,0), NVL(h10,0), NVL(h11,0), NVL(h12,0), NVL(h13,0), NVL(h14,0), NVL(h15,0), NVL(h16,0), NVL(h17,0), NVL(h18,0), NVL(h19,0), NVL(h20,0), NVL(h21,0), NVL(h22,0), NVL(h23,0), NVL(h24,0), NVL(h25,0), NVL(h26,0), NVL(h27,0), NVL(h28,0), NVL(h29,0), NVL(h30,0), NVL(h31,0), NVL(h32,0), NVL(h33,0), NVL(h34,0), NVL(h35,0), NVL(h36,0), NVL(h37,0), NVL(h38,0), NVL(h39,0), NVL(h40,0), NVL(h41,0), NVL(h42,0), NVL(h43,0), NVL(h44,0), NVL(h45,0), NVL(h46,0), NVL(h47,0), NVL(h48,0),
NVL(h49,0), NVL(h50,0), NVL(h51,0), NVL(h52,0), NVL(h53,0), NVL(h54,0), NVL(h55,0), NVL(h56,0), NVL(h57,0), NVL(h58,0), NVL(h59,0), NVL(h60,0), NVL(h61,0), NVL(h62,0), NVL(h63,0), NVL(h64,0), NVL(h65,0), NVL(h66,0), NVL(h67,0), NVL(h68,0), NVL(h69,0), NVL(h70,0), NVL(h71,0), NVL(h72,0), NVL(h73,0), NVL(h74,0), NVL(h75,0), NVL(h76,0), NVL(h77,0), NVL(h78,0), NVL(h79,0), NVL(h80,0), NVL(h81,0), NVL(h82,0), NVL(h83,0), NVL(h84,0), NVL(h85,0), NVL(h86,0), NVL(h87,0), NVL(h88,0), NVL(h89,0), NVL(h90,0), NVL(h91,0), NVL(h92,0), NVL(h93,0), NVL(h94,0), NVL(h95,0), NVL(h96,0),
'{4}', '{4}', '{4}', '{4}', '{4}', '{4}', '{4}', '{4}', '{4}', '{4}', '{4}', '{4}', '{4}', '{4}', '{4}', '{4}', '{4}', '{4}', '{4}', '{4}', '{4}', '{4}', '{4}', '{4}', '{4}', '{4}', '{4}', '{4}', '{4}', '{4}', '{4}', '{4}', '{4}', '{4}', '{4}', '{4}', '{4}', '{4}', '{4}', '{4}', '{4}', '{4}', '{4}', '{4}', '{4}', '{4}', '{4}', '{4}',
'{4}', '{4}', '{4}', '{4}', '{4}', '{4}', '{4}', '{4}', '{4}', '{4}', '{4}', '{4}', '{4}', '{4}', '{4}', '{4}', '{4}', '{4}', '{4}', '{4}', '{4}', '{4}', '{4}', '{4}', '{4}', '{4}', '{4}', '{4}', '{4}', '{4}', '{4}', '{4}', '{4}', '{4}', '{4}', '{4}', '{4}', '{4}', '{4}', '{4}', '{4}', '{4}', '{4}', '{4}', '{4}', '{4}', '{4}', '{4}',
'{5}', sysdate
FROM (SELECT pees.FECHA_FILA as CAGDCMDIA,
		empr.EMPRCODI, empr.EMPRRUC AS RUC_EMPRESA, NVL(empr.EMPRRAZSOCIAL, ' - SIN RAZON SOCIAL - ') AS NOMBRE_EMPRESA,
		eqp.equipadre as EQUICODICEN, eqp.EQUICODI as EQUICODIUNI, ptme.PTOMEDICODI,
		CASE WHEN medi.MEDIFECHA IS NULL THEN median.MEDITOTAL ELSE medi.MEDITOTAL END AS MEDITOTAL
		, CASE WHEN medi.MEDIFECHA IS NULL THEN median.H1 ELSE medi.H1 END AS H1
		, CASE WHEN medi.MEDIFECHA IS NULL THEN median.H2 ELSE medi.H2 END AS H2
		, CASE WHEN medi.MEDIFECHA IS NULL THEN median.H3 ELSE medi.H3 END AS H3
		, CASE WHEN medi.MEDIFECHA IS NULL THEN median.H4 ELSE medi.H4 END AS H4
		, CASE WHEN medi.MEDIFECHA IS NULL THEN median.H5 ELSE medi.H5 END AS H5
		, CASE WHEN medi.MEDIFECHA IS NULL THEN median.H6 ELSE medi.H6 END AS H6
		, CASE WHEN medi.MEDIFECHA IS NULL THEN median.H7 ELSE medi.H7 END AS H7
		, CASE WHEN medi.MEDIFECHA IS NULL THEN median.H8 ELSE medi.H8 END AS H8
		, CASE WHEN medi.MEDIFECHA IS NULL THEN median.H9 ELSE medi.H9 END AS H9
		, CASE WHEN medi.MEDIFECHA IS NULL THEN median.H10 ELSE medi.H10 END AS H10
		, CASE WHEN medi.MEDIFECHA IS NULL THEN median.H11 ELSE medi.H11 END AS H11
		, CASE WHEN medi.MEDIFECHA IS NULL THEN median.H12 ELSE medi.H12 END AS H12
		, CASE WHEN medi.MEDIFECHA IS NULL THEN median.H13 ELSE medi.H13 END AS H13
		, CASE WHEN medi.MEDIFECHA IS NULL THEN median.H14 ELSE medi.H14 END AS H14
		, CASE WHEN medi.MEDIFECHA IS NULL THEN median.H15 ELSE medi.H15 END AS H15
		, CASE WHEN medi.MEDIFECHA IS NULL THEN median.H16 ELSE medi.H16 END AS H16
		, CASE WHEN medi.MEDIFECHA IS NULL THEN median.H17 ELSE medi.H17 END AS H17
		, CASE WHEN medi.MEDIFECHA IS NULL THEN median.H18 ELSE medi.H18 END AS H18
		, CASE WHEN medi.MEDIFECHA IS NULL THEN median.H19 ELSE medi.H19 END AS H19
		, CASE WHEN medi.MEDIFECHA IS NULL THEN median.H20 ELSE medi.H20 END AS H20
		, CASE WHEN medi.MEDIFECHA IS NULL THEN median.H21 ELSE medi.H21 END AS H21
		, CASE WHEN medi.MEDIFECHA IS NULL THEN median.H22 ELSE medi.H22 END AS H22   
		, CASE WHEN medi.MEDIFECHA IS NULL THEN median.H23 ELSE medi.H23 END AS H23
		, CASE WHEN medi.MEDIFECHA IS NULL THEN median.H24 ELSE medi.H24 END AS H24
		, CASE WHEN medi.MEDIFECHA IS NULL THEN median.H25 ELSE medi.H25 END AS H25
		, CASE WHEN medi.MEDIFECHA IS NULL THEN median.H26 ELSE medi.H26 END AS H26
		, CASE WHEN medi.MEDIFECHA IS NULL THEN median.H27 ELSE medi.H27 END AS H27
		, CASE WHEN medi.MEDIFECHA IS NULL THEN median.H28 ELSE medi.H28 END AS H28
		, CASE WHEN medi.MEDIFECHA IS NULL THEN median.H29 ELSE medi.H29 END AS H29
		, CASE WHEN medi.MEDIFECHA IS NULL THEN median.H30 ELSE medi.H30 END AS H30
		, CASE WHEN medi.MEDIFECHA IS NULL THEN median.H31 ELSE medi.H31 END AS H31
		, CASE WHEN medi.MEDIFECHA IS NULL THEN median.H32 ELSE medi.H32 END AS H32
		, CASE WHEN medi.MEDIFECHA IS NULL THEN median.H33 ELSE medi.H33 END AS H33
		, CASE WHEN medi.MEDIFECHA IS NULL THEN median.H34 ELSE medi.H34 END AS H34
		, CASE WHEN medi.MEDIFECHA IS NULL THEN median.H35 ELSE medi.H35 END AS H35
		, CASE WHEN medi.MEDIFECHA IS NULL THEN median.H36 ELSE medi.H36 END AS H36
		, CASE WHEN medi.MEDIFECHA IS NULL THEN median.H37 ELSE medi.H37 END AS H37
		, CASE WHEN medi.MEDIFECHA IS NULL THEN median.H38 ELSE medi.H38 END AS H38
		, CASE WHEN medi.MEDIFECHA IS NULL THEN median.H39 ELSE medi.H39 END AS H39
		, CASE WHEN medi.MEDIFECHA IS NULL THEN median.H40 ELSE medi.H40 END AS H40
		, CASE WHEN medi.MEDIFECHA IS NULL THEN median.H41 ELSE medi.H41 END AS H41
		, CASE WHEN medi.MEDIFECHA IS NULL THEN median.H42 ELSE medi.H42 END AS H42
		, CASE WHEN medi.MEDIFECHA IS NULL THEN median.H43 ELSE medi.H43 END AS H43
		, CASE WHEN medi.MEDIFECHA IS NULL THEN median.H44 ELSE medi.H44 END AS H44
		, CASE WHEN medi.MEDIFECHA IS NULL THEN median.H45 ELSE medi.H45 END AS H45
		, CASE WHEN medi.MEDIFECHA IS NULL THEN median.H46 ELSE medi.H46 END AS H46
		, CASE WHEN medi.MEDIFECHA IS NULL THEN median.H47 ELSE medi.H47 END AS H47
		, CASE WHEN medi.MEDIFECHA IS NULL THEN median.H48 ELSE medi.H48 END AS H48
		, CASE WHEN medi.MEDIFECHA IS NULL THEN median.H49 ELSE medi.H49 END AS H49
		, CASE WHEN medi.MEDIFECHA IS NULL THEN median.H50 ELSE medi.H50 END AS H50
		, CASE WHEN medi.MEDIFECHA IS NULL THEN median.H51 ELSE medi.H51 END AS H51
		, CASE WHEN medi.MEDIFECHA IS NULL THEN median.H52 ELSE medi.H52 END AS H52
		, CASE WHEN medi.MEDIFECHA IS NULL THEN median.H53 ELSE medi.H53 END AS H53
		, CASE WHEN medi.MEDIFECHA IS NULL THEN median.H54 ELSE medi.H54 END AS H54
		, CASE WHEN medi.MEDIFECHA IS NULL THEN median.H55 ELSE medi.H55 END AS H55
		, CASE WHEN medi.MEDIFECHA IS NULL THEN median.H56 ELSE medi.H56 END AS H56
		, CASE WHEN medi.MEDIFECHA IS NULL THEN median.H57 ELSE medi.H57 END AS H57
		, CASE WHEN medi.MEDIFECHA IS NULL THEN median.H58 ELSE medi.H58 END AS H58
		, CASE WHEN medi.MEDIFECHA IS NULL THEN median.H59 ELSE medi.H59 END AS H59
		, CASE WHEN medi.MEDIFECHA IS NULL THEN median.H60 ELSE medi.H60 END AS H60
		, CASE WHEN medi.MEDIFECHA IS NULL THEN median.H61 ELSE medi.H61 END AS H61
		, CASE WHEN medi.MEDIFECHA IS NULL THEN median.H62 ELSE medi.H62 END AS H62
		, CASE WHEN medi.MEDIFECHA IS NULL THEN median.H63 ELSE medi.H63 END AS H63
		, CASE WHEN medi.MEDIFECHA IS NULL THEN median.H64 ELSE medi.H64 END AS H64
		, CASE WHEN medi.MEDIFECHA IS NULL THEN median.H65 ELSE medi.H65 END AS H65
		, CASE WHEN medi.MEDIFECHA IS NULL THEN median.H66 ELSE medi.H66 END AS H66
		, CASE WHEN medi.MEDIFECHA IS NULL THEN median.H67 ELSE medi.H67 END AS H67
		, CASE WHEN medi.MEDIFECHA IS NULL THEN median.H68 ELSE medi.H68 END AS H68
		, CASE WHEN medi.MEDIFECHA IS NULL THEN median.H69 ELSE medi.H69 END AS H69
		, CASE WHEN medi.MEDIFECHA IS NULL THEN median.H70 ELSE medi.H70 END AS H70
		, CASE WHEN medi.MEDIFECHA IS NULL THEN median.H71 ELSE medi.H71 END AS H71
		, CASE WHEN medi.MEDIFECHA IS NULL THEN median.H72 ELSE medi.H72 END AS H72
		, CASE WHEN medi.MEDIFECHA IS NULL THEN median.H73 ELSE medi.H73 END AS H73
		, CASE WHEN medi.MEDIFECHA IS NULL THEN median.H74 ELSE medi.H74 END AS H74
		, CASE WHEN medi.MEDIFECHA IS NULL THEN median.H75 ELSE medi.H75 END AS H75
		, CASE WHEN medi.MEDIFECHA IS NULL THEN median.H76 ELSE medi.H76 END AS H76
		, CASE WHEN medi.MEDIFECHA IS NULL THEN median.H77 ELSE medi.H77 END AS H77
		, CASE WHEN medi.MEDIFECHA IS NULL THEN median.H78 ELSE medi.H78 END AS H78
		, CASE WHEN medi.MEDIFECHA IS NULL THEN median.H79 ELSE medi.H79 END AS H79
		, CASE WHEN medi.MEDIFECHA IS NULL THEN median.H80 ELSE medi.H80 END AS H80
		, CASE WHEN medi.MEDIFECHA IS NULL THEN median.H81 ELSE medi.H81 END AS H81
		, CASE WHEN medi.MEDIFECHA IS NULL THEN median.H82 ELSE medi.H82 END AS H82
		, CASE WHEN medi.MEDIFECHA IS NULL THEN median.H83 ELSE medi.H83 END AS H83
		, CASE WHEN medi.MEDIFECHA IS NULL THEN median.H84 ELSE medi.H84 END AS H84
		, CASE WHEN medi.MEDIFECHA IS NULL THEN median.H85 ELSE medi.H85 END AS H85
		, CASE WHEN medi.MEDIFECHA IS NULL THEN median.H86 ELSE medi.H86 END AS H86
		, CASE WHEN medi.MEDIFECHA IS NULL THEN median.H87 ELSE medi.H87 END AS H87
		, CASE WHEN medi.MEDIFECHA IS NULL THEN median.H88 ELSE medi.H88 END AS H88
		, CASE WHEN medi.MEDIFECHA IS NULL THEN median.H89 ELSE medi.H89 END AS H89
		, CASE WHEN medi.MEDIFECHA IS NULL THEN median.H90 ELSE medi.H90 END AS H90
		, CASE WHEN medi.MEDIFECHA IS NULL THEN median.H91 ELSE medi.H91 END AS H91
		, CASE WHEN medi.MEDIFECHA IS NULL THEN median.H92 ELSE medi.H92 END AS H92
		, CASE WHEN medi.MEDIFECHA IS NULL THEN median.H93 ELSE medi.H93 END AS H93
		, CASE WHEN medi.MEDIFECHA IS NULL THEN median.H94 ELSE medi.H94 END AS H94
		, CASE WHEN medi.MEDIFECHA IS NULL THEN median.H95 ELSE medi.H95 END AS H95
		, CASE WHEN medi.MEDIFECHA IS NULL THEN median.H96 ELSE medi.H96 END AS H96
		FROM (
		SELECT TO_CHAR(TO_DATE(td.FECHA_FINAL + 1 - ROWNUM), 'MM YYYY') AS PERIODO
		, TRUNC(TO_DATE(td.FECHA_FINAL + 1 - ROWNUM), 'MM') AS INI_PERIODO
		, ADD_MONTHS(TRUNC(TO_DATE(td.FECHA_FINAL + 1 - ROWNUM), 'MM'), 1) AS INI_REMISION
		, ADD_MONTHS(
		TO_DATE(
		(SELECT fori.FORMATDIAPLAZO
		FROM ME_FORMATO fori
		WHERE fori.FORMATCODI = {6}
		)
		|| '/' || TO_CHAR(TO_DATE(td.FECHA_FINAL + 1 - ROWNUM), 'mm/yyyy'), 'dd/mm/yyyy')
		, 1) AS FIN_REMISION
		, TO_DATE(td.FECHA_FINAL + 1 - ROWNUM) AS FECHA_FILA
		FROM ALL_OBJECTS
		, (SELECT TO_DATE('{7}', 'dd/mm/yyyy') AS FECHA_INICIAL
		, LAST_DAY(TO_DATE('{8}', 'dd/mm/yyyy')) AS FECHA_FINAL
		FROM DUAL) td
		WHERE TRUNC(td.FECHA_FINAL + 1 - ROWNUM, 'MM') >= TRUNC(td.FECHA_INICIAL,'MM')
		ORDER BY 5
		) pees
		INNER JOIN ME_FORMATO form ON (form.FORMATCODI = {6} )
		INNER JOIN ME_PTOMEDICION ptme ON (ptme.ORIGLECTCODI = 19)
		INNER JOIN SI_EMPRESA empr ON (ptme.EMPRCODI = empr.EMPRCODI AND empr.TIPOEMPRCODI IN (2, 4) )
		INNER JOIN SI_TIPOEMPRESA tiem ON (empr.TIPOEMPRCODI = tiem.TIPOEMPRCODI)
		INNER JOIN (SELECT sumi.PTOMEDICODI, MAX(sumi.EMPRCODI) AS EMPRCODI FROM ME_PTOSUMINISTRADOR sumi GROUP BY sumi.PTOMEDICODI) mrsu 
					 ON (ptme.PTOMEDICODI = mrsu.PTOMEDICODI)
		LEFT JOIN SI_EMPRESA mrem ON (mrsu.EMPRCODI = mrem.EMPRCODI)
		LEFT JOIN (
		SELECT enul.FORMATCODI
		, enul.EMPRCODI
		, enul.ENVIOCODI_MAX
		, enul.ENVIOCODI_CONT
		, TRUNC(enpri.ENVIOFECHA) AS ENVIOFECHA_MIN
		, TRUNC(enuld.ENVIOFECHA) AS ENVIOFECHA_MAX
		, enuld.ENVIOFECHAPERIODO
		, enuld.ENVIOFECHAINI
		, enuld.ENVIOFECHAFIN
		FROM (SELECT envi.FORMATCODI
		, envi.EMPRCODI
		, envi.ENVIOFECHAPERIODO
		, MIN(envi.ENVIOCODI) AS ENVIOCODI_MIN
		, MAX(envi.ENVIOCODI) AS ENVIOCODI_MAX
		, COUNT(envi.ENVIOCODI) AS ENVIOCODI_CONT
		FROM ME_ENVIO envi
		WHERE envi.FORMATCODI = {6}
		GROUP BY envi.FORMATCODI
		, envi.EMPRCODI
		, envi.ENVIOFECHAPERIODO) enul
		INNER JOIN ME_ENVIO enpri ON (enul.ENVIOCODI_MIN = enpri.ENVIOCODI)
		INNER JOIN ME_ENVIO enuld ON (enul.ENVIOCODI_MAX = enuld.ENVIOCODI)
		) ulenv ON (form.FORMATCODI = ulenv.FORMATCODI AND empr.EMPRCODI = ulenv.EMPRCODI AND pees.INI_PERIODO = TRUNC(ulenv.ENVIOFECHAPERIODO, 'MM'))
		LEFT JOIN ME_MEDICION96 medi ON (medi.LECTCODI = {10} AND TRUNC(pees.FECHA_FILA) = TRUNC(medi.MEDIFECHA) AND ptme.PTOMEDICODI = medi.PTOMEDICODI)
		LEFT JOIN ME_MEDICION96 median ON (median.LECTCODI = CASE
								WHEN tiem.TIPOEMPRCODI = 2 THEN {10}
								WHEN tiem.TIPOEMPRCODI = 4 THEN {11}
								ELSE
								NULL
								END
								AND TRUNC(median.MEDIFECHA) = FN_ME_FECHAMEDMASRECIENTE(ptme.PTOMEDICODI, tiem.TIPOEMPRCODI, pees.FECHA_FILA, medi.MEDIFECHA, {10}, {11})
								AND ptme.PTOMEDICODI = median.PTOMEDICODI
		)
		LEFT JOIN EQ_EQUIPO eqp ON (ptme.EQUICODI = eqp.EQUICODI)
		LEFT JOIN EQ_AREA ara ON (eqp.AREACODI = ara.AREACODI)
		WHERE empr.TIPOEMPRCODI = {9} 
		AND TRUNC(pees.INI_PERIODO) BETWEEN TO_DATE('{7}', 'dd/mm/yyyy') AND TO_DATE('{8}', 'dd/mm/yyyy')
		ORDER BY empr.EMPRNOMB, ptme.PTOMEDICODI, pees.FECHA_FILA
		) t
		</query>
	</Sql>

  <Sql>
    <key>SaveAsSelectMeMedicion96</key>
    <query>
      INSERT INTO cai_generdeman (cagdcmcodi, caiajcodi, cagdcmfuentedat, ptomedicodi,
      emprcodi, equicodicen, equicodiuni, cagdcmcalidadinfo, cagdcmdia, cagdcmtotaldia,
      h1, h2, h3, h4, h5, h6, h7, h8, h9, h10, h11, h12, h13, h14, h15, h16, h17, h18, h19, h20, h21, h22, h23, h24, h25, h26, h27, h28, h29, h30, h31, h32, h33, h34, h35, h36, h37, h38, h39, h40, h41, h42, h43, h44, h45, h46, h47, h48,
      h49, h50, h51, h52, h53, h54, h55, h56, h57, h58, h59, h60, h61, h62, h63, h64, h65, h66, h67, h68, h69, h70, h71, h72, h73, h74, h75, h76, h77, h78, h79, h80, h81, h82, h83, h84, h85, h86, h87, h88, h89, h90, h91, h92, h93, h94, h95, h96,
      t1, t2, t3, t4, t5, t6, t7, t8, t9, t10, t11, t12, t13, t14, t15, t16, t17, t18, t19, t20, t21, t22, t23, t24, t25, t26, t27, t28, t29, t30, t31, t32, t33, t34, t35, t36, t37, t38, t39, t40, t41, t42, t43, t44, t45, t46, t47, t48,
      t49, t50, t51, t52, t53, t54, t55, t56, t57, t58, t59, t60, t61, t62, t63, t64, t65, t66, t67, t68, t69, t70, t71, t72, t73, t74, t75, t76, t77, t78, t79, t80, t81, t82, t83, t84, t85, t86, t87, t88, t89, t90, t91, t92, t93, t94, t95, t96,
      cagdcmusucreacion, cagdcmfeccreacion)
      select rownum + {0} as cagdcmcodi, {1} as caiajcodi, '{2}' as cagdcmfuentedat, me.ptomedicodi,
      pto.emprcodi, eq.equipadre as equicodicen, eq.equicodi as equicodiuni, '{3}' as cagdcmcalidadinfo, me.medifecha as cagdcmdia, NVL(meditotal,0) as cagdcmtotaldia,
      NVL(h1,0), NVL(h2,0), NVL(h3,0), NVL(h4,0), NVL(h5,0), NVL(h6,0), NVL(h7,0), NVL(h8,0), NVL(h9,0), NVL(h10,0), NVL(h11,0), NVL(h12,0), NVL(h13,0), NVL(h14,0), NVL(h15,0), NVL(h16,0), NVL(h17,0), NVL(h18,0), NVL(h19,0), NVL(h20,0), NVL(h21,0), NVL(h22,0), NVL(h23,0), NVL(h24,0), NVL(h25,0), NVL(h26,0), NVL(h27,0), NVL(h28,0), NVL(h29,0), NVL(h30,0), NVL(h31,0), NVL(h32,0), NVL(h33,0), NVL(h34,0), NVL(h35,0), NVL(h36,0), NVL(h37,0), NVL(h38,0), NVL(h39,0), NVL(h40,0), NVL(h41,0), NVL(h42,0), NVL(h43,0), NVL(h44,0), NVL(h45,0), NVL(h46,0), NVL(h47,0), NVL(h48,0),
      NVL(h49,0), NVL(h50,0), NVL(h51,0), NVL(h52,0), NVL(h53,0), NVL(h54,0), NVL(h55,0), NVL(h56,0), NVL(h57,0), NVL(h58,0), NVL(h59,0), NVL(h60,0), NVL(h61,0), NVL(h62,0), NVL(h63,0), NVL(h64,0), NVL(h65,0), NVL(h66,0), NVL(h67,0), NVL(h68,0), NVL(h69,0), NVL(h70,0), NVL(h71,0), NVL(h72,0), NVL(h73,0), NVL(h74,0), NVL(h75,0), NVL(h76,0), NVL(h77,0), NVL(h78,0), NVL(h79,0), NVL(h80,0), NVL(h81,0), NVL(h82,0), NVL(h83,0), NVL(h84,0), NVL(h85,0), NVL(h86,0), NVL(h87,0), NVL(h88,0), NVL(h89,0), NVL(h90,0), NVL(h91,0), NVL(h92,0), NVL(h93,0), NVL(h94,0), NVL(h95,0), NVL(h96,0),
      '{4}', '{4}', '{4}', '{4}', '{4}', '{4}', '{4}', '{4}', '{4}', '{4}', '{4}', '{4}', '{4}', '{4}', '{4}', '{4}', '{4}', '{4}', '{4}', '{4}', '{4}', '{4}', '{4}', '{4}', '{4}', '{4}', '{4}', '{4}', '{4}', '{4}', '{4}', '{4}', '{4}', '{4}', '{4}', '{4}', '{4}', '{4}', '{4}', '{4}', '{4}', '{4}', '{4}', '{4}', '{4}', '{4}', '{4}', '{4}',
      '{4}', '{4}', '{4}', '{4}', '{4}', '{4}', '{4}', '{4}', '{4}', '{4}', '{4}', '{4}', '{4}', '{4}', '{4}', '{4}', '{4}', '{4}', '{4}', '{4}', '{4}', '{4}', '{4}', '{4}', '{4}', '{4}', '{4}', '{4}', '{4}', '{4}', '{4}', '{4}', '{4}', '{4}', '{4}', '{4}', '{4}', '{4}', '{4}', '{4}', '{4}', '{4}', '{4}', '{4}', '{4}', '{4}', '{4}', '{4}',
      '{5}' as cagdcmusucreacion, sysdate as cagdcmfeccreacion
      from me_medicion96 me
      inner join me_hojaptomed hp on hp.ptomedicodi = me.ptomedicodi and hp.tipoinfocodi = me.tipoinfocodi and hp.TPTOMEDICODI = me.TPTOMEDICODI
      inner join me_formato fh on fh.formatcodi = hp.formatcodi and fh.lectcodi = me.lectcodi
      inner join me_ptomedicion pto on pto.ptomedicodi = hp.ptomedicodi
      inner join eq_equipo eq on pto.equicodi = eq.equicodi
      where hp.formatcodi = {6} and me.lectcodi = {7} and
      medifecha BETWEEN TO_DATE('{8}', 'YYYY-MM-DD') AND TO_DATE('{9}', 'YYYY-MM-DD')
      order by me.ptomedicodi asc, me.medifecha desc
    </query>
  </Sql>
		
	<Sql>
		<key>Update</key>
		<query>
			update cai_generdeman
			set
			caiajcodi = :caiajcodi,
			cagdcmfuentedat = :cagdcmfuentedat,
			ptomedicodi = :ptomedicodi,
			emprcodi = :emprcodi,
			equicodicen = :equicodicen,
			equicodiuni = :equicodiuni,
			cagdcmcalidadinfo = :cagdcmcalidadinfo,
			cagdcmdia = :cagdcmdia,
			cagdcmtotaldia = :cagdcmtotaldia,
			h1 = :h1,
			h2 = :h2,
			h3 = :h3,
			h4 = :h4,
			h5 = :h5,
			h6 = :h6,
			h7 = :h7,
			h8 = :h8,
			h9 = :h9,
			h10 = :h10,
			h11 = :h11,
			h12 = :h12,
			h13 = :h13,
			h14 = :h14,
			h15 = :h15,
			h16 = :h16,
			h17 = :h17,
			h18 = :h18,
			h19 = :h19,
			h20 = :h20,
			h21 = :h21,
			h22 = :h22,
			h23 = :h23,
			h24 = :h24,
			h25 = :h25,
			h26 = :h26,
			h27 = :h27,
			h28 = :h28,
			h29 = :h29,
			h30 = :h30,
			h31 = :h31,
			h32 = :h32,
			h33 = :h33,
			h34 = :h34,
			h35 = :h35,
			h36 = :h36,
			h37 = :h37,
			h38 = :h38,
			h39 = :h39,
			h40 = :h40,
			h41 = :h41,
			h42 = :h42,
			h43 = :h43,
			h44 = :h44,
			h45 = :h45,
			h46 = :h46,
			h47 = :h47,
			h48 = :h48,
			h49 = :h49,
			h50 = :h50,
			h51 = :h51,
			h52 = :h52,
			h53 = :h53,
			h54 = :h54,
			h55 = :h55,
			h56 = :h56,
			h57 = :h57,
			h58 = :h58,
			h59 = :h59,
			h60 = :h60,
			h61 = :h61,
			h62 = :h62,
			h63 = :h63,
			h64 = :h64,
			h65 = :h65,
			h66 = :h66,
			h67 = :h67,
			h68 = :h68,
			h69 = :h69,
			h70 = :h70,
			h71 = :h71,
			h72 = :h72,
			h73 = :h73,
			h74 = :h74,
			h75 = :h75,
			h76 = :h76,
			h77 = :h77,
			h78 = :h78,
			h79 = :h79,
			h80 = :h80,
			h81 = :h81,
			h82 = :h82,
			h83 = :h83,
			h84 = :h84,
			h85 = :h85,
			h86 = :h86,
			h87 = :h87,
			h88 = :h88,
			h89 = :h89,
			h90 = :h90,
			h91 = :h91,
			h92 = :h92,
			h93 = :h93,
			h94 = :h94,
			h95 = :h95,
			h96 = :h96,
			t1 = :t1,
			t2 = :t2,
			t3 = :t3,
			t4 = :t4,
			t5 = :t5,
			t6 = :t6,
			t7 = :t7,
			t8 = :t8,
			t9 = :t9,
			t10 = :t10,
			t11 = :t11,
			t12 = :t12,
			t13 = :t13,
			t14 = :t14,
			t15 = :t15,
			t16 = :t16,
			t17 = :t17,
			t18 = :t18,
			t19 = :t19,
			t20 = :t20,
			t21 = :t21,
			t22 = :t22,
			t23 = :t23,
			t24 = :t24,
			t25 = :t25,
			t26 = :t26,
			t27 = :t27,
			t28 = :t28,
			t29 = :t29,
			t30 = :t30,
			t31 = :t31,
			t32 = :t32,
			t33 = :t33,
			t34 = :t34,
			t35 = :t35,
			t36 = :t36,
			t37 = :t37,
			t38 = :t38,
			t39 = :t39,
			t40 = :t40,
			t41 = :t41,
			t42 = :t42,
			t43 = :t43,
			t44 = :t44,
			t45 = :t45,
			t46 = :t46,
			t47 = :t47,
			t48 = :t48,
			t49 = :t49,
			t50 = :t50,
			t51 = :t51,
			t52 = :t52,
			t53 = :t53,
			t54 = :t54,
			t55 = :t55,
			t56 = :t56,
			t57 = :t57,
			t58 = :t58,
			t59 = :t59,
			t60 = :t60,
			t61 = :t61,
			t62 = :t62,
			t63 = :t63,
			t64 = :t64,
			t65 = :t65,
			t66 = :t66,
			t67 = :t67,
			t68 = :t68,
			t69 = :t69,
			t70 = :t70,
			t71 = :t71,
			t72 = :t72,
			t73 = :t73,
			t74 = :t74,
			t75 = :t75,
			t76 = :t76,
			t77 = :t77,
			t78 = :t78,
			t79 = :t79,
			t80 = :t80,
			t81 = :t81,
			t82 = :t82,
			t83 = :t83,
			t84 = :t84,
			t85 = :t85,
			t86 = :t86,
			t87 = :t87,
			t88 = :t88,
			t89 = :t89,
			t90 = :t90,
			t91 = :t91,
			t92 = :t92,
			t93 = :t93,
			t94 = :t94,
			t95 = :t95,
			t96 = :t96,
			cagdcmusucreacion = :cagdcmusucreacion,
			cagdcmfeccreacion = :cagdcmfeccreacion
			where
			cagdcmcodi = :cagdcmcodi
		</query>
	</Sql>

	<Sql>
		<key>Delete</key>
		<query>
			delete from cai_generdeman where caiajcodi = :caiajcodi and cagdcmfuentedat = :cagdcmfuentedat
		</query>
	</Sql>

	<Sql>
		<key>GetById</key>
		<query>
			 select * from cai_generdeman
			 where cagdcmcodi = :cagdcmcodi
		</query>
	</Sql>

	<Sql>
		<key>List</key>
		<query>
			select * from cai_generdeman
		</query>
	</Sql>

	<Sql>
		<key>GetByCriteria</key>
		<query>
			select * from cai_generdeman
		</query>
	</Sql>

	<Sql>
		<key>GetByUsuarioLibresSGOCOES</key>
		<query>SELECT pees.FECHA_FILA as CAGDCMDIA,
			empr.EMPRCODI, empr.EMPRRUC AS RUC_EMPRESA, NVL(empr.EMPRRAZSOCIAL, ' - SIN RAZON SOCIAL - ') AS NOMBRE_EMPRESA,
			eqp.equipadre as EQUICODICEN, eqp.EQUICODI as EQUICODIUNI, ptme.PTOMEDICODI,
			CASE WHEN medi.MEDIFECHA IS NULL THEN median.H1 ELSE medi.H1 END AS H1
			, CASE WHEN medi.MEDIFECHA IS NULL THEN median.H2 ELSE medi.H2 END AS H2
			, CASE WHEN medi.MEDIFECHA IS NULL THEN median.H3 ELSE medi.H3 END AS H3
			, CASE WHEN medi.MEDIFECHA IS NULL THEN median.H4 ELSE medi.H4 END AS H4
			, CASE WHEN medi.MEDIFECHA IS NULL THEN median.H5 ELSE medi.H5 END AS H5
			, CASE WHEN medi.MEDIFECHA IS NULL THEN median.H6 ELSE medi.H6 END AS H6
			, CASE WHEN medi.MEDIFECHA IS NULL THEN median.H7 ELSE medi.H7 END AS H7
			, CASE WHEN medi.MEDIFECHA IS NULL THEN median.H8 ELSE medi.H8 END AS H8
			, CASE WHEN medi.MEDIFECHA IS NULL THEN median.H9 ELSE medi.H9 END AS H9
			, CASE WHEN medi.MEDIFECHA IS NULL THEN median.H10 ELSE medi.H10 END AS H10
			, CASE WHEN medi.MEDIFECHA IS NULL THEN median.H11 ELSE medi.H11 END AS H11
			, CASE WHEN medi.MEDIFECHA IS NULL THEN median.H12 ELSE medi.H12 END AS H12
			, CASE WHEN medi.MEDIFECHA IS NULL THEN median.H13 ELSE medi.H13 END AS H13
			, CASE WHEN medi.MEDIFECHA IS NULL THEN median.H14 ELSE medi.H14 END AS H14
			, CASE WHEN medi.MEDIFECHA IS NULL THEN median.H15 ELSE medi.H15 END AS H15
			, CASE WHEN medi.MEDIFECHA IS NULL THEN median.H16 ELSE medi.H16 END AS H16
			, CASE WHEN medi.MEDIFECHA IS NULL THEN median.H17 ELSE medi.H17 END AS H17
			, CASE WHEN medi.MEDIFECHA IS NULL THEN median.H18 ELSE medi.H18 END AS H18
			, CASE WHEN medi.MEDIFECHA IS NULL THEN median.H19 ELSE medi.H19 END AS H19
			, CASE WHEN medi.MEDIFECHA IS NULL THEN median.H20 ELSE medi.H20 END AS H20
			, CASE WHEN medi.MEDIFECHA IS NULL THEN median.H21 ELSE medi.H21 END AS H21
			, CASE WHEN medi.MEDIFECHA IS NULL THEN median.H22 ELSE medi.H22 END AS H22   
			, CASE WHEN medi.MEDIFECHA IS NULL THEN median.H23 ELSE medi.H23 END AS H23
			, CASE WHEN medi.MEDIFECHA IS NULL THEN median.H24 ELSE medi.H24 END AS H24
			, CASE WHEN medi.MEDIFECHA IS NULL THEN median.H25 ELSE medi.H25 END AS H25
			, CASE WHEN medi.MEDIFECHA IS NULL THEN median.H26 ELSE medi.H26 END AS H26
			, CASE WHEN medi.MEDIFECHA IS NULL THEN median.H27 ELSE medi.H27 END AS H27
			, CASE WHEN medi.MEDIFECHA IS NULL THEN median.H28 ELSE medi.H28 END AS H28
			, CASE WHEN medi.MEDIFECHA IS NULL THEN median.H29 ELSE medi.H29 END AS H29
			, CASE WHEN medi.MEDIFECHA IS NULL THEN median.H30 ELSE medi.H30 END AS H30
			, CASE WHEN medi.MEDIFECHA IS NULL THEN median.H31 ELSE medi.H31 END AS H31
			, CASE WHEN medi.MEDIFECHA IS NULL THEN median.H32 ELSE medi.H32 END AS H32
			, CASE WHEN medi.MEDIFECHA IS NULL THEN median.H33 ELSE medi.H33 END AS H33
			, CASE WHEN medi.MEDIFECHA IS NULL THEN median.H34 ELSE medi.H34 END AS H34
			, CASE WHEN medi.MEDIFECHA IS NULL THEN median.H35 ELSE medi.H35 END AS H35
			, CASE WHEN medi.MEDIFECHA IS NULL THEN median.H36 ELSE medi.H36 END AS H36
			, CASE WHEN medi.MEDIFECHA IS NULL THEN median.H37 ELSE medi.H37 END AS H37
			, CASE WHEN medi.MEDIFECHA IS NULL THEN median.H38 ELSE medi.H38 END AS H38
			, CASE WHEN medi.MEDIFECHA IS NULL THEN median.H39 ELSE medi.H39 END AS H39
			, CASE WHEN medi.MEDIFECHA IS NULL THEN median.H40 ELSE medi.H40 END AS H40
			, CASE WHEN medi.MEDIFECHA IS NULL THEN median.H41 ELSE medi.H41 END AS H41
			, CASE WHEN medi.MEDIFECHA IS NULL THEN median.H42 ELSE medi.H42 END AS H42
			, CASE WHEN medi.MEDIFECHA IS NULL THEN median.H43 ELSE medi.H43 END AS H43
			, CASE WHEN medi.MEDIFECHA IS NULL THEN median.H44 ELSE medi.H44 END AS H44
			, CASE WHEN medi.MEDIFECHA IS NULL THEN median.H45 ELSE medi.H45 END AS H45
			, CASE WHEN medi.MEDIFECHA IS NULL THEN median.H46 ELSE medi.H46 END AS H46
			, CASE WHEN medi.MEDIFECHA IS NULL THEN median.H47 ELSE medi.H47 END AS H47
			, CASE WHEN medi.MEDIFECHA IS NULL THEN median.H48 ELSE medi.H48 END AS H48
			, CASE WHEN medi.MEDIFECHA IS NULL THEN median.H49 ELSE medi.H49 END AS H49
			, CASE WHEN medi.MEDIFECHA IS NULL THEN median.H50 ELSE medi.H50 END AS H50
			, CASE WHEN medi.MEDIFECHA IS NULL THEN median.H51 ELSE medi.H51 END AS H51
			, CASE WHEN medi.MEDIFECHA IS NULL THEN median.H52 ELSE medi.H52 END AS H52
			, CASE WHEN medi.MEDIFECHA IS NULL THEN median.H53 ELSE medi.H53 END AS H53
			, CASE WHEN medi.MEDIFECHA IS NULL THEN median.H54 ELSE medi.H54 END AS H54
			, CASE WHEN medi.MEDIFECHA IS NULL THEN median.H55 ELSE medi.H55 END AS H55
			, CASE WHEN medi.MEDIFECHA IS NULL THEN median.H56 ELSE medi.H56 END AS H56
			, CASE WHEN medi.MEDIFECHA IS NULL THEN median.H57 ELSE medi.H57 END AS H57
			, CASE WHEN medi.MEDIFECHA IS NULL THEN median.H58 ELSE medi.H58 END AS H58
			, CASE WHEN medi.MEDIFECHA IS NULL THEN median.H59 ELSE medi.H59 END AS H59
			, CASE WHEN medi.MEDIFECHA IS NULL THEN median.H60 ELSE medi.H60 END AS H60
			, CASE WHEN medi.MEDIFECHA IS NULL THEN median.H61 ELSE medi.H61 END AS H61
			, CASE WHEN medi.MEDIFECHA IS NULL THEN median.H62 ELSE medi.H62 END AS H62
			, CASE WHEN medi.MEDIFECHA IS NULL THEN median.H63 ELSE medi.H63 END AS H63
			, CASE WHEN medi.MEDIFECHA IS NULL THEN median.H64 ELSE medi.H64 END AS H64
			, CASE WHEN medi.MEDIFECHA IS NULL THEN median.H65 ELSE medi.H65 END AS H65
			, CASE WHEN medi.MEDIFECHA IS NULL THEN median.H66 ELSE medi.H66 END AS H66
			, CASE WHEN medi.MEDIFECHA IS NULL THEN median.H67 ELSE medi.H67 END AS H67
			, CASE WHEN medi.MEDIFECHA IS NULL THEN median.H68 ELSE medi.H68 END AS H68
			, CASE WHEN medi.MEDIFECHA IS NULL THEN median.H69 ELSE medi.H69 END AS H69
			, CASE WHEN medi.MEDIFECHA IS NULL THEN median.H70 ELSE medi.H70 END AS H70
			, CASE WHEN medi.MEDIFECHA IS NULL THEN median.H71 ELSE medi.H71 END AS H71
			, CASE WHEN medi.MEDIFECHA IS NULL THEN median.H72 ELSE medi.H72 END AS H72
			, CASE WHEN medi.MEDIFECHA IS NULL THEN median.H73 ELSE medi.H73 END AS H73
			, CASE WHEN medi.MEDIFECHA IS NULL THEN median.H74 ELSE medi.H74 END AS H74
			, CASE WHEN medi.MEDIFECHA IS NULL THEN median.H75 ELSE medi.H75 END AS H75
			, CASE WHEN medi.MEDIFECHA IS NULL THEN median.H76 ELSE medi.H76 END AS H76
			, CASE WHEN medi.MEDIFECHA IS NULL THEN median.H77 ELSE medi.H77 END AS H77
			, CASE WHEN medi.MEDIFECHA IS NULL THEN median.H78 ELSE medi.H78 END AS H78
			, CASE WHEN medi.MEDIFECHA IS NULL THEN median.H79 ELSE medi.H79 END AS H79
			, CASE WHEN medi.MEDIFECHA IS NULL THEN median.H80 ELSE medi.H80 END AS H80
			, CASE WHEN medi.MEDIFECHA IS NULL THEN median.H81 ELSE medi.H81 END AS H81
			, CASE WHEN medi.MEDIFECHA IS NULL THEN median.H82 ELSE medi.H82 END AS H82
			, CASE WHEN medi.MEDIFECHA IS NULL THEN median.H83 ELSE medi.H83 END AS H83
			, CASE WHEN medi.MEDIFECHA IS NULL THEN median.H84 ELSE medi.H84 END AS H84
			, CASE WHEN medi.MEDIFECHA IS NULL THEN median.H85 ELSE medi.H85 END AS H85
			, CASE WHEN medi.MEDIFECHA IS NULL THEN median.H86 ELSE medi.H86 END AS H86
			, CASE WHEN medi.MEDIFECHA IS NULL THEN median.H87 ELSE medi.H87 END AS H87
			, CASE WHEN medi.MEDIFECHA IS NULL THEN median.H88 ELSE medi.H88 END AS H88
			, CASE WHEN medi.MEDIFECHA IS NULL THEN median.H89 ELSE medi.H89 END AS H89
			, CASE WHEN medi.MEDIFECHA IS NULL THEN median.H90 ELSE medi.H90 END AS H90
			, CASE WHEN medi.MEDIFECHA IS NULL THEN median.H91 ELSE medi.H91 END AS H91
			, CASE WHEN medi.MEDIFECHA IS NULL THEN median.H92 ELSE medi.H92 END AS H92
			, CASE WHEN medi.MEDIFECHA IS NULL THEN median.H93 ELSE medi.H93 END AS H93
			, CASE WHEN medi.MEDIFECHA IS NULL THEN median.H94 ELSE medi.H94 END AS H94
			, CASE WHEN medi.MEDIFECHA IS NULL THEN median.H95 ELSE medi.H95 END AS H95
			, CASE WHEN medi.MEDIFECHA IS NULL THEN median.H96 ELSE medi.H96 END AS H96
			FROM (
		SELECT TO_CHAR(TO_DATE(td.FECHA_FINAL + 1 - ROWNUM), 'MM YYYY') AS PERIODO
			, TRUNC(TO_DATE(td.FECHA_FINAL + 1 - ROWNUM), 'MM') AS INI_PERIODO
			, ADD_MONTHS(TRUNC(TO_DATE(td.FECHA_FINAL + 1 - ROWNUM), 'MM'), 1) AS INI_REMISION
			, ADD_MONTHS(
			TO_DATE(
			(SELECT fori.FORMATDIAPLAZO
			FROM ME_FORMATO fori
			WHERE fori.FORMATCODI = {0}
			)
			|| '/' || TO_CHAR(TO_DATE(td.FECHA_FINAL + 1 - ROWNUM), 'mm/yyyy'), 'dd/mm/yyyy')
			, 1) AS FIN_REMISION
			, TO_DATE(td.FECHA_FINAL + 1 - ROWNUM) AS FECHA_FILA
			FROM ALL_OBJECTS
			, (SELECT TO_DATE('{1}', 'dd/mm/yyyy') AS FECHA_INICIAL
			, LAST_DAY(TO_DATE('{2}', 'dd/mm/yyyy')) AS FECHA_FINAL
			FROM DUAL) td
			WHERE TRUNC(td.FECHA_FINAL + 1 - ROWNUM, 'MM') >= TRUNC(td.FECHA_INICIAL,'MM')
			ORDER BY 5
		) pees
			INNER JOIN ME_FORMATO form ON (form.FORMATCODI = {0} )
			INNER JOIN ME_PTOMEDICION ptme ON (ptme.ORIGLECTCODI = 19)
			INNER JOIN SI_EMPRESA empr ON (ptme.EMPRCODI = empr.EMPRCODI AND empr.TIPOEMPRCODI IN (2, 4) )
			INNER JOIN SI_TIPOEMPRESA tiem ON (empr.TIPOEMPRCODI = tiem.TIPOEMPRCODI)
			INNER JOIN (SELECT sumi.PTOMEDICODI, MAX(sumi.EMPRCODI) AS EMPRCODI FROM ME_PTOSUMINISTRADOR sumi GROUP BY sumi.PTOMEDICODI) mrsu 
							 ON (ptme.PTOMEDICODI = mrsu.PTOMEDICODI)
			LEFT JOIN SI_EMPRESA mrem ON (mrsu.EMPRCODI = mrem.EMPRCODI)
			LEFT JOIN (
		SELECT enul.FORMATCODI
			, enul.EMPRCODI
			, enul.ENVIOCODI_MAX
			, enul.ENVIOCODI_CONT
			, TRUNC(enpri.ENVIOFECHA) AS ENVIOFECHA_MIN
			, TRUNC(enuld.ENVIOFECHA) AS ENVIOFECHA_MAX
			, enuld.ENVIOFECHAPERIODO
			, enuld.ENVIOFECHAINI
			, enuld.ENVIOFECHAFIN
			FROM (SELECT envi.FORMATCODI
			, envi.EMPRCODI
			, envi.ENVIOFECHAPERIODO
			, MIN(envi.ENVIOCODI) AS ENVIOCODI_MIN
			, MAX(envi.ENVIOCODI) AS ENVIOCODI_MAX
			, COUNT(envi.ENVIOCODI) AS ENVIOCODI_CONT
			FROM ME_ENVIO envi
			WHERE envi.FORMATCODI = {0}
			GROUP BY envi.FORMATCODI
			, envi.EMPRCODI
			, envi.ENVIOFECHAPERIODO) enul
			INNER JOIN ME_ENVIO enpri ON (enul.ENVIOCODI_MIN = enpri.ENVIOCODI)
			INNER JOIN ME_ENVIO enuld ON (enul.ENVIOCODI_MAX = enuld.ENVIOCODI)
			) ulenv ON (form.FORMATCODI = ulenv.FORMATCODI AND empr.EMPRCODI = ulenv.EMPRCODI AND pees.INI_PERIODO = TRUNC(ulenv.ENVIOFECHAPERIODO, 'MM'))
			LEFT JOIN ME_MEDICION96 medi ON (medi.LECTCODI = {4} AND TRUNC(pees.FECHA_FILA) = TRUNC(medi.MEDIFECHA) AND ptme.PTOMEDICODI = medi.PTOMEDICODI)
			LEFT JOIN ME_MEDICION96 median ON (median.LECTCODI = CASE
											WHEN tiem.TIPOEMPRCODI = 2 THEN {4}
											WHEN tiem.TIPOEMPRCODI = 4 THEN {5}
											ELSE
											NULL
											END
											AND TRUNC(median.MEDIFECHA) = FN_ME_FECHAMEDMASRECIENTE(ptme.PTOMEDICODI, tiem.TIPOEMPRCODI, pees.FECHA_FILA, medi.MEDIFECHA, {4}, {5})
											AND ptme.PTOMEDICODI = median.PTOMEDICODI
			)
			LEFT JOIN EQ_EQUIPO eqp ON (ptme.EQUICODI = eqp.EQUICODI)
			LEFT JOIN EQ_AREA ara ON (eqp.AREACODI = ara.AREACODI)
			WHERE empr.TIPOEMPRCODI = {3} 
			AND TRUNC(pees.INI_PERIODO) BETWEEN TO_DATE('{1}', 'dd/mm/yyyy') AND TO_DATE('{2}', 'dd/mm/yyyy')
			ORDER BY empr.EMPRNOMB, ptme.PTOMEDICODI, pees.FECHA_FILA
		</query>
	</Sql>

	<Sql>
		<key>ListGenDemBarrMes</key>
		<query>
			select eg.cagdcmdia, eg.cagdcmfuentedat, eg.cagdcmtotaldia,
			eg.h1, cm.cosmar1 as cm1, eg.h2, cm.cosmar2 as cm2, eg.h3, cm.cosmar3 as cm3, eg.h4, cm.cosmar4 as cm4, eg.h5, cm.cosmar5 as cm5, eg.h6, cm.cosmar6 as cm6, eg.h7, cm.cosmar7 as cm7, eg.h8, cm.cosmar8 as cm8, eg.h9, cm.cosmar9 as cm9, eg.h10, cm.cosmar10 as cm10,
			eg.h11, cm.cosmar11 as cm11, eg.h12, cm.cosmar12 as cm12, eg.h13, cm.cosmar13 as cm13, eg.h14, cm.cosmar14 as cm14, eg.h15, cm.cosmar15 as cm15, eg.h16, cm.cosmar16 as cm16, eg.h17, cm.cosmar17 as cm17, eg.h8, cm.cosmar18 as cm8, eg.h19, cm.cosmar19 as cm19, eg.h20, cm.cosmar20 as cm20,
			eg.h21, cm.cosmar21 as cm21, eg.h22, cm.cosmar22 as cm22, eg.h23, cm.cosmar23 as cm23, eg.h24, cm.cosmar24 as cm24, eg.h25, cm.cosmar25 as cm25, eg.h26, cm.cosmar26 as cm26, eg.h27, cm.cosmar27 as cm27, eg.h8, cm.cosmar28 as cm8, eg.h29, cm.cosmar29 as cm29, eg.h30, cm.cosmar30 as cm30,
			eg.h31, cm.cosmar31 as cm31, eg.h32, cm.cosmar32 as cm32, eg.h33, cm.cosmar33 as cm33, eg.h34, cm.cosmar34 as cm34, eg.h35, cm.cosmar35 as cm35, eg.h36, cm.cosmar36 as cm36, eg.h37, cm.cosmar37 as cm37, eg.h8, cm.cosmar38 as cm8, eg.h39, cm.cosmar39 as cm39, eg.h40, cm.cosmar40 as cm40,
			eg.h41, cm.cosmar41 as cm41, eg.h42, cm.cosmar42 as cm42, eg.h43, cm.cosmar43 as cm43, eg.h44, cm.cosmar44 as cm44, eg.h45, cm.cosmar45 as cm45, eg.h46, cm.cosmar46 as cm46, eg.h47, cm.cosmar47 as cm47, eg.h8, cm.cosmar48 as cm8, eg.h49, cm.cosmar49 as cm49, eg.h50, cm.cosmar50 as cm50,
			eg.h51, cm.cosmar51 as cm51, eg.h52, cm.cosmar52 as cm52, eg.h53, cm.cosmar53 as cm53, eg.h54, cm.cosmar54 as cm54, eg.h55, cm.cosmar55 as cm55, eg.h56, cm.cosmar56 as cm56, eg.h57, cm.cosmar57 as cm57, eg.h8, cm.cosmar58 as cm8, eg.h59, cm.cosmar59 as cm59, eg.h60, cm.cosmar60 as cm60,
			eg.h61, cm.cosmar61 as cm61, eg.h62, cm.cosmar62 as cm62, eg.h63, cm.cosmar63 as cm63, eg.h64, cm.cosmar64 as cm64, eg.h65, cm.cosmar65 as cm65, eg.h66, cm.cosmar66 as cm66, eg.h67, cm.cosmar67 as cm67, eg.h8, cm.cosmar68 as cm8, eg.h69, cm.cosmar69 as cm69, eg.h70, cm.cosmar70 as cm70,
			eg.h71, cm.cosmar71 as cm71, eg.h72, cm.cosmar72 as cm72, eg.h73, cm.cosmar73 as cm73, eg.h74, cm.cosmar74 as cm74, eg.h75, cm.cosmar75 as cm75, eg.h76, cm.cosmar76 as cm76, eg.h77, cm.cosmar77 as cm77, eg.h8, cm.cosmar78 as cm8, eg.h79, cm.cosmar79 as cm79, eg.h80, cm.cosmar80 as cm80,
			eg.h81, cm.cosmar81 as cm81, eg.h82, cm.cosmar82 as cm82, eg.h83, cm.cosmar83 as cm83, eg.h84, cm.cosmar84 as cm84, eg.h85, cm.cosmar85 as cm85, eg.h86, cm.cosmar86 as cm86, eg.h87, cm.cosmar87 as cm87, eg.h8, cm.cosmar88 as cm8, eg.h89, cm.cosmar89 as cm89, eg.h90, cm.cosmar90 as cm90,
			eg.h91, cm.cosmar91 as cm91, eg.h92, cm.cosmar92 as cm92, eg.h93, cm.cosmar93 as cm93, eg.h94, cm.cosmar94 as cm94, eg.h95, cm.cosmar95 as cm95, eg.h96, cm.cosmar96 as cm96
			from cai_generdeman eg, cai_equiunidbarr eb, trn_costo_marginal cm
			where eg.caiajcodi = :caiajcodi and eg.emprcodi = :emprcodi and eg.ptomedicodi = :ptomedicodi and to_char(eg.cagdcmdia, 'YYYYMM') = :cagdcmcodi
			and eb.ptomedicodi = eg.ptomedicodi and eb.emprcodi = eg.emprcodi
			and eb.barrcodi = cm.barrcodi and to_number(to_char(eg.cagdcmdia, 'dd')) = cm.cosmardia
			and cm.pericodi = :equicodicen and cm.cosmarversion = :equicodiuni
			order by eg.cagdcmdia
		</query>
	</Sql>

	<Sql>
		<key>ListGenDemProyMes</key>
		<query>
			select eg.cagdcmdia, eg.cagdcmfuentedat, eg.cagdcmtotaldia,
			eg.h1, cm.h1 as cm1, eg.h2, cm.h2 as cm2, eg.h3, cm.h3 as cm3, eg.h4, cm.h4 as cm4, eg.h5, cm.h5 as cm5, eg.h6, cm.h6 as cm6, eg.h7, cm.h7 as cm7, eg.h8, cm.h8 as cm8, eg.h9, cm.h9 as cm9, eg.h10, cm.h10 as cm10,
			eg.h11, cm.h11 as cm11, eg.h12, cm.h12 as cm12, eg.h13, cm.h13 as cm13, eg.h14, cm.h14 as cm14, eg.h15, cm.h15 as cm15, eg.h16, cm.h16 as cm16, eg.h17, cm.h17 as cm17, eg.h8, cm.h18 as cm8, eg.h19, cm.h19 as cm19, eg.h20, cm.h20 as cm20,
			eg.h21, cm.h21 as cm21, eg.h22, cm.h22 as cm22, eg.h23, cm.h23 as cm23, eg.h24, cm.h24 as cm24, eg.h25, cm.h25 as cm25, eg.h26, cm.h26 as cm26, eg.h27, cm.h27 as cm27, eg.h8, cm.h28 as cm8, eg.h29, cm.h29 as cm29, eg.h30, cm.h30 as cm30,
			eg.h31, cm.h31 as cm31, eg.h32, cm.h32 as cm32, eg.h33, cm.h33 as cm33, eg.h34, cm.h34 as cm34, eg.h35, cm.h35 as cm35, eg.h36, cm.h36 as cm36, eg.h37, cm.h37 as cm37, eg.h8, cm.h38 as cm8, eg.h39, cm.h39 as cm39, eg.h40, cm.h40 as cm40,
			eg.h41, cm.h41 as cm41, eg.h42, cm.h42 as cm42, eg.h43, cm.h43 as cm43, eg.h44, cm.h44 as cm44, eg.h45, cm.h45 as cm45, eg.h46, cm.h46 as cm46, eg.h47, cm.h47 as cm47, eg.h8, cm.h48 as cm8, eg.h49, cm.h49 as cm49, eg.h50, cm.h50 as cm50,
			eg.h51, cm.h51 as cm51, eg.h52, cm.h52 as cm52, eg.h53, cm.h53 as cm53, eg.h54, cm.h54 as cm54, eg.h55, cm.h55 as cm55, eg.h56, cm.h56 as cm56, eg.h57, cm.h57 as cm57, eg.h8, cm.h58 as cm8, eg.h59, cm.h59 as cm59, eg.h60, cm.h60 as cm60,
			eg.h61, cm.h61 as cm61, eg.h62, cm.h62 as cm62, eg.h63, cm.h63 as cm63, eg.h64, cm.h64 as cm64, eg.h65, cm.h65 as cm65, eg.h66, cm.h66 as cm66, eg.h67, cm.h67 as cm67, eg.h8, cm.h68 as cm8, eg.h69, cm.h69 as cm69, eg.h70, cm.h70 as cm70,
			eg.h71, cm.h71 as cm71, eg.h72, cm.h72 as cm72, eg.h73, cm.h73 as cm73, eg.h74, cm.h74 as cm74, eg.h75, cm.h75 as cm75, eg.h76, cm.h76 as cm76, eg.h77, cm.h77 as cm77, eg.h8, cm.h78 as cm8, eg.h79, cm.h79 as cm79, eg.h80, cm.h80 as cm80,
			eg.h81, cm.h81 as cm81, eg.h82, cm.h82 as cm82, eg.h83, cm.h83 as cm83, eg.h84, cm.h84 as cm84, eg.h85, cm.h85 as cm85, eg.h86, cm.h86 as cm86, eg.h87, cm.h87 as cm87, eg.h8, cm.h88 as cm8, eg.h89, cm.h89 as cm89, eg.h90, cm.h90 as cm90,
			eg.h91, cm.h91 as cm91, eg.h92, cm.h92 as cm92, eg.h93, cm.h93 as cm93, eg.h94, cm.h94 as cm94, eg.h95, cm.h95 as cm95, eg.h96, cm.h96 as cm96
			from cai_generdeman eg, cai_equiunidbarr eb, cai_generdeman cm
			where eg.caiajcodi = :caiajcodi and eg.emprcodi = :emprcodi and eg.ptomedicodi = :ptomedicodi and to_char(eg.cagdcmdia, 'YYYYMM') = :cagdcmcodi
			and eb.ptomedicodi = eg.ptomedicodi and eb.emprcodi = eg.emprcodi
			and eg.caiajcodi = cm.caiajcodi and eb.emprcodi = cm.emprcodi and eb.ptomedicodi = cm.ptomedicodi and eg.cagdcmdia = cm.cagdcmdia and cm.cagdcmfuentedat = 'CM'
			order by eg.cagdcmdia
		</query>
	</Sql>
</Sqls>
