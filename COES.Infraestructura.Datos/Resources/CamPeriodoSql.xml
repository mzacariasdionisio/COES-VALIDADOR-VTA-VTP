<?xml version="1.0" encoding="utf-8" ?>
<Sqls>
	<Sql>
		<key>GetListaCombobox</key>
		<query>
			SELECT * FROM CAM_PERIODO
		</query>
	</Sql>
	<Sql>
		<key>GetListaPeriodos</key>
		<query>
			SELECT * FROM CAM_PERIODO WHERE IND_DEL= :IND_DEL ORDER BY PERICODI DESC
		</query>
	</Sql>


	<Sql>
		<key>GetListaPeriodosByAnioAndEstado</key>
		<query>
			SELECT * FROM CAM_PERIODO WHERE EXTRACT(YEAR FROM PERIFECHAINICIO) = :ANIOINI AND EXTRACT(YEAR FROM PERIFECHAFIN) = :ANIO AND PERIESTADO = :ESTADO AND IND_DEL= :IND_DEL ORDER BY PERICODI DESC
		</query>
	</Sql>

	<Sql>
		<key>GetListaPeriodosByAnio</key>
		<query>
			SELECT * FROM CAM_PERIODO WHERE EXTRACT(YEAR FROM PERIFECHAINICIO) = :ANIOINI AND EXTRACT(YEAR FROM PERIFECHAFIN) = :ANIO AND IND_DEL= :IND_DEL ORDER BY PERICODI DESC
		</query>
	</Sql>

	<Sql>
		<key>Save</key>
		<query>
			INSERT INTO CAM_PERIODO(
			PERICODI,
			PERINOMBRE,
			PERIFECHAINICIO,
			PERIFECHAFIN,
			PERIHORAFIN,
			PERIESTADO,
			PERIHORIZONTEATRAS,
			PERIHORIZONTEADELANTE,
			PERICOMENTARIO,
			USU_CREACION,
			FEC_CREACION,
			IND_DEL
			)
			VALUES(
			:PERICODI,
			:PERINOMBRE,
			:PERIFECHAINICIO,
			:PERIFECHAFIN,
			:PERIHORAFIN,
			:PERIESTADO,
			:PERIHORIZONTEATRAS,
			:PERIHORIZONTEADELANTE,
			:PERICOMENTARIO,
			:USU_CREACION,
			:FEC_CREACION,
			:IND_DEL)
		</query>
	</Sql>
	
	<Sql>
		<key>UpdatePeriodo</key>
		<query>
			UPDATE CAM_PERIODO
			SET
			PERINOMBRE=:PERINOMBRE,
			PERIFECHAINICIO=:PERIFECHAINICIO,
			PERIFECHAFIN=:PPERIFECHAFIN,
			PERIHORAFIN=:PERIHORAFIN,
			PERIESTADO=:PERIESTADO,
			PERIHORIZONTEATRAS=:PERIHORIZONTEATRAS,
			PERIHORIZONTEADELANTE=:PERIHORIZONTEADELANTE,
			PERICOMENTARIO=:PERICOMENTARIO,
			USU_MODIFICACION=:USU_MODIFICACION,
			FEC_MODIFICACION=:FEC_MODIFICACION
			WHERE
			PERICODI=:PCODI
		</query>
	</Sql>
	<Sql>
		<key>GetLastPeriodoID</key>
		<query>
			SELECT * FROM CAM_PERIODO
			ORDER BY PERICODI DESC
			FETCH FIRST 1 ROWS ONLY
		</query>
	</Sql>
	

	<Sql>
		<key>DeletePeriodoById</key>
		<query>
			UPDATE CAM_PERIODO SET IND_DEL = :IND_DEL,  USU_MODIFICACION = :USU_MODIFICACION, FEC_MODIFICACION = :FEC_MODIFICACION WHERE PERICODI = :ID
		</query>
	</Sql>



	<Sql>
		<key>GetPeriodoById</key>
		<query>
			SELECT * FROM CAM_PERIODO WHERE PERICODI = :ID AND IND_DEL = :IND_DEL
		</query>
	</Sql>

	<Sql>
		<key>GetPeriodoByDate</key>
		<query>
			<![CDATA[
				SELECT COUNT(*)
				FROM CAM_PERIODO
				WHERE ( PERIFECHAINICIO <=  :PERIFECHAFIN
				AND  PERIFECHAFIN >= :PERIFECHAINICIO)
				AND PERICODI != :ID
				AND IND_DEL = :IND_DEL
			]]>
		</query>
	</Sql>
</Sqls>
