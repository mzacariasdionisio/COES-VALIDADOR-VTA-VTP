<?xml version="1.0" encoding="utf-8" ?>
<Sqls>

  <Sql>
    <key>GetMaxId</key>
    <query>
       select nvl(max(comedicodi), 0) + 1 from co_medicion60
    </query>
  </Sql>

  <Sql>
    <key>Save</key>
    <query>
       insert into co_medicion60(
           comedicodi,
           prodiacodi,
           cotidacodi,
           grupocodi,
           equicodi,
           canalcodi,
           comedihora,
           comediminuto,
           h1,
           h2,
           h3,
           h4,
           h5,
           h6,
           h7,
           h8,
           h9,
           h10,
           h11,
           
           h12,
           h13,
           h14,
           h15,
           h16,
           h17,
           h18,
           h19,
           h20,
           h21,
           h22,
           h23,
           h24,
           h25,
           h26,
           h27,
           h28,
           h29,
           h30,
           h31,
           h32,
           h33,
           h34,
           h35,
           h36,
           h37,
           h38,
           h39,
           h40,
           h41,
           h42,
           h43,
           h44,
           h45,
           h46,
           h47,
           h48,
           h49,
           h50,
           h51,
           h52,
           h53,
           h54,
           h55,
           h56,
           h57,
           h58,
           h59,
           h60                      
           
       )
       values(
           :comedicodi,
           :prodiacodi,
           :cotidacodi,
           :grupocodi,
           :equicodi,
           :canalcodi,
           :comedihora,
           :comediminuto,
           :h1,
           :h2,
           :h3,
           :h4,
           :h5,
           :h6,
           :h7,
           :h8,
           :h9,
           :h10,
           :h11,
           
           :h12,
           :h13,
           :h14,
           :h15,
           :h16,
           :h17,
           :h18,
           :h19,
           :h20,
           :h21,
           :h22,
           :h23,
           :h24,
           :h25,
           :h26,
           :h27,
           :h28,
           :h29,
           :h30,
           :h31,
           :h32,
           :h33,
           :h34,
           :h35,
           :h36,
           :h37,
           :h38,
           :h39,
           :h40,
           :h41,
           :h42,
           :h43,
           :h44,
           :h45,
           :h46,
           :h47,
           :h48,
           :h49,
           :h50,
           :h51,
           :h52,
           :h53,
           :h54,
           :h55,
           :h56,
           :h57,
           :h58,
           :h59,
           :h60
                                 
       )
    </query>
  </Sql>

  <Sql>
    <key>Update</key>
    <query>
       update co_medicion60
       set
           h56 = :h56,
           h57 = :h57,
           h58 = :h58,
           h59 = :h59,
           h60 = :h60,
           h55 = :h55,
           h12 = :h12,
           h13 = :h13,
           h14 = :h14,
           h15 = :h15,
           h16 = :h16,
           h17 = :h17,
           h18 = :h18,
           h19 = :h19,
           h20 = :h20,
           h21 = :h21,
           h22 = :h22,
           h23 = :h23,
           h24 = :h24,
           h25 = :h25,
           h26 = :h26,
           h27 = :h27,
           h28 = :h28,
           h29 = :h29,
           h30 = :h30,
           h31 = :h31,
           h32 = :h32,
           h33 = :h33,
           h34 = :h34,
           h35 = :h35,
           h36 = :h36,
           h37 = :h37,
           h38 = :h38,
           h39 = :h39,
           h40 = :h40,
           h41 = :h41,
           h42 = :h42,
           h43 = :h43,
           h44 = :h44,
           h45 = :h45,
           h46 = :h46,
           h47 = :h47,
           h48 = :h48,
           h49 = :h49,
           h50 = :h50,
           h51 = :h51,
           h52 = :h52,
           h53 = :h53,
           h54 = :h54,
           prodiacodi = :prodiacodi,
           cotidacodi = :cotidacodi,
           grupocodi = :grupocodi,
           equicodi = :equicodi,
           canalcodi = :canalcodi,
           comedihora = :comedihora,
           comediminuto = :comediminuto,
           h1 = :h1,
           h2 = :h2,
           h3 = :h3,
           h4 = :h4,
           h5 = :h5,
           h6 = :h6,
           h7 = :h7,
           h8 = :h8,
           h9 = :h9,
           h10 = :h10,
           h11 = :h11
       where
           comedicodi = :comedicodi
    </query>
  </Sql>

  <Sql>
    <key>Delete</key>
    <query>
       delete from co_medicion60
       where
           comedicodi = :comedicodi
    </query>
  </Sql>

  <Sql>
    <key>GetById</key>
    <query>
       select
           h56,
           h57,
           h58,
           h59,
           h60,
           h55,
           h12,
           h13,
           h14,
           h15,
           h16,
           h17,
           h18,
           h19,
           h20,
           h21,
           h22,
           h23,
           h24,
           h25,
           h26,
           h27,
           h28,
           h29,
           h30,
           h31,
           h32,
           h33,
           h34,
           h35,
           h36,
           h37,
           h38,
           h39,
           h40,
           h41,
           h42,
           h43,
           h44,
           h45,
           h46,
           h47,
           h48,
           h49,
           h50,
           h51,
           h52,
           h53,
           h54,
           comedicodi,
           prodiacodi,
           cotidacodi,
           grupocodi,
           equicodi,
           canalcodi,
           comedihora,
           comediminuto,
           h1,
           h2,
           h3,
           h4,
           h5,
           h6,
           h7,
           h8,
           h9,
           h10,
           h11
       from
           co_medicion60
       where
           comedicodi = :comedicodi
       
    </query>
  </Sql>

  <Sql>
    <key>List</key>
    <query>
       select
           h56,
           h57,
           h58,
           h59,
           h60,
           h55,
           h12,
           h13,
           h14,
           h15,
           h16,
           h17,
           h18,
           h19,
           h20,
           h21,
           h22,
           h23,
           h24,
           h25,
           h26,
           h27,
           h28,
           h29,
           h30,
           h31,
           h32,
           h33,
           h34,
           h35,
           h36,
           h37,
           h38,
           h39,
           h40,
           h41,
           h42,
           h43,
           h44,
           h45,
           h46,
           h47,
           h48,
           h49,
           h50,
           h51,
           h52,
           h53,
           h54,
           comedicodi,
           prodiacodi,
           cotidacodi,
           grupocodi,
           equicodi,
           canalcodi,
           comedihora,
           comediminuto,
           h1,
           h2,
           h3,
           h4,
           h5,
           h6,
           h7,
           h8,
           h9,
           h10,
           h11
       from
           co_medicion60
    </query>
  </Sql>

  <Sql>
    <key>GetByCriteria</key>
    <query>
       select
           h56,
           h57,
           h58,
           h59,
           h60,
           h55,
           h12,
           h13,
           h14,
           h15,
           h16,
           h17,
           h18,
           h19,
           h20,
           h21,
           h22,
           h23,
           h24,
           h25,
           h26,
           h27,
           h28,
           h29,
           h30,
           h31,
           h32,
           h33,
           h34,
           h35,
           h36,
           h37,
           h38,
           h39,
           h40,
           h41,
           h42,
           h43,
           h44,
           h45,
           h46,
           h47,
           h48,
           h49,
           h50,
           h51,
           h52,
           h53,
           h54,
           comedicodi,
           prodiacodi,
           cotidacodi,
           grupocodi,
           equicodi,
           canalcodi,
           comedihora,
           comediminuto,
           h1,
           h2,
           h3,
           h4,
           h5,
           h6,
           h7,
           h8,
           h9,
           h10,
           h11
       from
           co_medicion60
    </query>
  </Sql>

  <Sql>
    <key>ListarUltimoMinutoPorRango</key>
    <query>
      SELECT PD.PRODIAFECHA AS FECHA, M.* FROM CO_MEDICION60 M
      INNER JOIN CO_PROCESO_DIARIO PD ON PD.PRODIACODI = M.PRODIACODI
      WHERE (TO_DATE(PD.PRODIAFECHA) IN ({0}) ) AND M.COMEDIHORA = 23 AND COMEDIMINUTO = 59 AND M.CANALCODI IN ({1})
    </query>
  </Sql>

  <Sql>
    <key>ListarUltimoMinutoDiaAnteriorMuchasTablas</key>
    <query>
      {0}
    </query>
  </Sql>
    

  <Sql>
    <key>EliminarMedicion60XTabla</key>
    <query>
      delete from {0}
      where
      prodiacodi in ({1})
    </query>
  </Sql>

  <Sql>
    <key>EliminarTodaDataMed60</key>
    <query>
      TRUNCATE TABLE {0}
    </query>
  </Sql>

	<Sql>
		<key>ObtenerDataReporte</key>
		<query>
			select * from {3} where prodiacodi = {0} and canalcodi in ({1}) and cotidacodi in ({2})
		</query>
	</Sql>

	<Sql>
		<key>ObtenerDataReporteFP</key>
		<query>
			select * from {3} where prodiacodi =  {0} and (grupocodi = {1} or {1} = 0) and cotidacodi =  {2}
		</query>
	</Sql>

  <Sql>
    <key>ListarTablas</key>
    <query>
      SELECT TABLE_NAME AS TABLANOMB FROM ALL_TABLES WHERE  TABLE_NAME IN ('{0}')
    </query>
  </Sql>

  <Sql>
    <key>ObtenerIdInicial</key>
    <query>
      select nvl(max(comedicodi), 0) + 1 from {0}
    </query>
  </Sql>
  

	<Sql>
		<key>ObtenerDataReporteFU</key>
		<query>
			select
			med.comedihora, med.comediminuto,
			sum(h1) as h1, sum(h2) as h2, sum(h3) as h3, sum(h4) as h4,
			sum(h5) as h5, sum(h6) as h6, sum(h7) as h7, sum(h8) as h8,
			sum(h9) as h9, sum(h10) as h10,
			sum(h11) as h11, sum(h12) as h12, sum(h13) as h13, sum(h14) as h14,
			sum(h15) as h15, sum(h16) as h16, sum(h17) as h17, sum(h18) as h18,
			sum(h19) as h19, sum(h20) as h20, sum(h21) as h21, sum(h22) as h22,
			sum(h23) as h23, sum(h24) as h24, sum(h25) as h25, sum(h26) as h26,
			sum(h27) as h27, sum(h28) as h28, sum(h29) as h29, sum(h30) as h30,
			sum(h31) as h31, sum(h32) as h32, sum(h33) as h33, sum(h34) as h34,
			sum(h35) as h35, sum(h36) as h36, sum(h37) as h37, sum(h38) as h38,
			sum(h39) as h39, sum(h40) as h40, sum(h41) as h41, sum(h42) as h42,
			sum(h43) as h43, sum(h44) as h44, sum(h45) as h45, sum(h46) as h46,
			sum(h47) as h47, sum(h48) as h48, sum(h49) as h49, sum(h50) as h50,
			sum(h51) as h51, sum(h52) as h52, sum(h53) as h53, sum(h54) as h54,
			sum(h55) as h55, sum(h56) as h56, sum(h57) as h57, sum(h58) as h58,
			sum(h59) as h59, sum(h60) as h60
			from {1} med where med.prodiacodi = {0} and med.cotidacodi = {2}
			group by med.comedihora, med.comediminuto
			order by med.comedihora, med.comediminuto
		</query>
	</Sql>
  
  <!--CREAR TABLA POR PERIODO O VERSION-->
  <Sql>
    <key>CrearTabla</key>
    <query>
      CREATE TABLE CO_MEDICION60_{0}
      (
      COMEDICODI                 NUMBER(8,0)    NOT NULL,
      PRODIACODI                 NUMBER(5,0)    NULL,
      COTIDACODI                 NUMBER(3,0)    NULL,
      GRUPOCODI                  NUMBER(5,0)    NULL,
      EQUICODI                   NUMBER(5,0)    NULL,
      H1                         NUMBER(10,4)   NULL,
      H2                         NUMBER(10,4)   NULL,
      H3                         NUMBER(10,4)   NULL,
      H4                         NUMBER(10,4)   NULL,
      H5                         NUMBER(10,4)   NULL,
      H6                         NUMBER(10,4)   NULL,
      H7                         NUMBER(10,4)   NULL,
      H8                         NUMBER(10,4)   NULL,
      H9                         NUMBER(10,4)   NULL,
      H10                        NUMBER(10,4)   NULL,
      H11                        NUMBER(10,4)   NULL,
      H12                        NUMBER(10,4)   NULL,
      H13                        NUMBER(10,4)   NULL,
      H14                        NUMBER(10,4)   NULL,
      H15                        NUMBER(10,4)   NULL,
      H16                        NUMBER(10,4)   NULL,
      H17                        NUMBER(10,4)   NULL,
      H18                        NUMBER(10,4)   NULL,
      H19                        NUMBER(10,4)   NULL,
      H20                        NUMBER(10,4)   NULL,
      H21                        NUMBER(10,4)   NULL,
      H22                        NUMBER(10,4)   NULL,
      H23                        NUMBER(10,4)   NULL,
      H24                        NUMBER(10,4)   NULL,
      H25                        NUMBER(10,4)   NULL,
      H26                        NUMBER(10,4)   NULL,
      H27                        NUMBER(10,4)   NULL,
      H28                        NUMBER(10,4)   NULL,
      H29                        NUMBER(10,4)   NULL,
      H30                        NUMBER(10,4)   NULL,
      H31                        NUMBER(10,4)   NULL,
      H32                        NUMBER(10,4)   NULL,
      H33                        NUMBER(10,4)   NULL,
      H34                        NUMBER(10,4)   NULL,
      H35                        NUMBER(10,4)   NULL,
      H36                        NUMBER(10,4)   NULL,
      H37                        NUMBER(10,4)   NULL,
      H38                        NUMBER(10,4)   NULL,
      H39                        NUMBER(10,4)   NULL,
      H40                        NUMBER(10,4)   NULL,
      H41                        NUMBER(10,4)   NULL,
      H42                        NUMBER(10,4)   NULL,
      H43                        NUMBER(10,4)   NULL,
      H44                        NUMBER(10,4)   NULL,
      H45                        NUMBER(10,4)   NULL,
      H46                        NUMBER(10,4)   NULL,
      H47                        NUMBER(10,4)   NULL,
      H48                        NUMBER(10,4)   NULL,
      H49                        NUMBER(10,4)   NULL,
      H50                        NUMBER(10,4)   NULL,
      H51                        NUMBER(10,4)   NULL,
      H52                        NUMBER(10,4)   NULL,
      H53                        NUMBER(10,4)   NULL,
      H54                        NUMBER(10,4)   NULL,
      H55                        NUMBER(10,4)   NULL,
      H56                        NUMBER(10,4)   NULL,
      H57                        NUMBER(10,4)   NULL,
      H58                        NUMBER(10,4)   NULL,
      H59                        NUMBER(10,4)   NULL,
      H60                        NUMBER(10,4)   NULL,
      CANALCODI                  NUMBER(10,0)   NULL,
      COMEDIHORA                 NUMBER(2,0)    NULL,
      COMEDIMINUTO               NUMBER(2,0)    NULL,
      COMEDITIPO                 NUMBER(2,0)    NULL
      )
    </query>
  </Sql>

  <Sql>
    <key>CrearIndex</key>
    <query>
      CREATE UNIQUE INDEX PK_CO_MEDICION60_{0} ON CO_MEDICION60_{0} (COMEDICODI ASC)
    </query>
  </Sql>

  <Sql>
    <key>CrearPKMedicion60</key>
    <query>
      ALTER TABLE CO_MEDICION60_{0} ADD CONSTRAINT PK_CO_MEDICION60_{0} PRIMARY KEY (COMEDICODI)
    </query>
  </Sql>

  <Sql>
    <key>CrearFKProcesoDiario</key>
    <query>
      ALTER TABLE CO_MEDICION60_{0}
      ADD (CONSTRAINT FK_COMEDI_PRODIA_{0} FOREIGN KEY (PRODIACODI) REFERENCES CO_PROCESO_DIARIO (PRODIACODI))
    </query>
  </Sql>

  <Sql>
    <key>CrearFKGrupo</key>
    <query>
      ALTER TABLE CO_MEDICION60_{0}
      ADD (CONSTRAINT FK_COMEDI_GRUPO_{0} FOREIGN KEY (GRUPOCODI) REFERENCES PR_GRUPO (GRUPOCODI))
    </query>
  </Sql>

  <Sql>
    <key>CrearFKEquipo</key>
    <query>
      ALTER TABLE CO_MEDICION60_{0}
      ADD (CONSTRAINT FK_COMEDI_EQUI_{0} FOREIGN KEY (EQUICODI) REFERENCES EQ_EQUIPO (EQUICODI))
    </query>
  </Sql>

  <Sql>
    <key>CrearFKTipoDato</key>
    <query>
      ALTER TABLE CO_MEDICION60_{0}
      ADD (CONSTRAINT FK_COMEDI_COTIDA_{0} FOREIGN KEY (COTIDACODI) REFERENCES CO_TIPO_DATO (COTIDACODI))
    </query>
  </Sql>

  <Sql>
    <key>CrearFKCanalSP7</key>
    <query>
      ALTER TABLE CO_MEDICION60_{0}
      ADD (FOREIGN KEY (CANALCODI) REFERENCES TR_CANAL_SP7 (CANALCODI))
    </query>
  </Sql>

	<Sql>
		<key>CrearIndiceBusqueda</key>
		<query>
			CREATE INDEX CO_MED60_{0}_PRODIA ON CO_MEDICION60_{0} (PRODIACODI)
		</query>
	</Sql>

	<Sql>
		<key>VerificarExisttenciaTabla</key>
		<query>
			SELECT COUNT(*)
			FROM USER_TABLES
			WHERE TABLE_NAME = UPPER('CO_MEDICION60_{0}')
		</query>
	</Sql>

  <Sql>
    <key>GetInformacionAGC</key>
    <query>
      SELECT * FROM co_medicion60_{0} M
      INNER JOIN co_proceso_diario pd ON pd.prodiacodi = M.prodiacodi
      WHERE
      (TRUNC (pd.prodiafecha) = TO_DATE('{1}','DD-MM-YYYY'))
      AND ('{2}'='-1' OR grupocodi IN ({2}))
      AND ('{3}'='-1' OR equicodi IN ({3}))
      AND ('{4}'='-1' OR cotidacodi IN ({4}))
    </query>
  </Sql>

	<Sql>
		<key>ProcesarTabla</key>
		<query>
			declare
			max_id number;

			begin

			delete from {0} where prodiacodi = {1};
			select nvl(max(comedicodi), 0) + 1 into max_id from {0};

			insert into {0}(
			comedicodi,
			prodiacodi,
			cotidacodi,
			grupocodi,
			equicodi,
			canalcodi,
			comedihora,
			comediminuto,
			h1, h2, h3, h4, h5, h6, h7, h8, h9, h10,
			h11, h12, h13, h14, h15, h16, h17, h18, h19, h20,
			h21, h22, h23, h24, h25, h26, h27, h28, h29, h30,
			h31, h32, h33, h34, h35, h36, h37, h38, h39, h40,
			h41, h42, h43, h44, h45, h46, h47, h48, h49, h50,
			h51, h52, h53, h54, h55, h56, h57, h58, h59, h60)
			select
			max_id + rownum as comedicodi,
			prodiacodi,
			cotidacodi,
			grupocodi,
			equicodi,
			canalcodi,
			comedihora,
			comediminuto,
			h1, h2, h3, h4, h5, h6, h7, h8, h9, h10,
			h11, h12, h13, h14, h15, h16, h17, h18, h19, h20,
			h21, h22, h23, h24, h25, h26, h27, h28, h29, h30,
			h31, h32, h33, h34, h35, h36, h37, h38, h39, h40,
			h41, h42, h43, h44, h45, h46, h47, h48, h49, h50,
			h51, h52, h53, h54, h55, h56, h57, h58, h59, h60
			from co_medicion60;
			end;
		</query>
	</Sql>
  
</Sqls>
