<?xml version="1.0" encoding="utf-8" ?>
<Sqls>
  <Sql>
    <key>Save</key>
    <query>
      insert into dpo_estimadorraw_tmp(
      ptomedicodi,
      prnvarcodi,
      dporawfuente,
      dporawtipomedi,
      dporawfecha,
      dporawvalor
      )
      values(
      :ptomedicodi,
      :prnvarcodi,
      :dporawfuente,
      :dporawtipomedi,
      :dporawfecha,
      :dporawvalor
      )
    </query>
  </Sql>

  <Sql>
    <key>Update</key>
    <query>
      update dpo_estimadorraw_tmp
      set
      dporawvalor = :dporawvalor
      where
      ptomedicodi = :ptomedicodi and
      prnvarcodi = :prnvarcodi and
      dporawfuente = :dporawfuente and
      dporawtipomedi = :dporawtipomedi and
      dporawfecha = :dporawfecha
    </query>
  </Sql>

  <Sql>
    <key>Delete</key>
    <query>
      delete from dpo_estimadorraw_tmp
      where
      ptomedicodi = :ptomedicodi and
      prnvarcodi = :prnvarcodi and
      dporawfuente = :dporawfuente and
      dporawtipomedi = :dporawtipomedi and
      dporawfecha = :dporawfecha
    </query>
  </Sql>

  <Sql>
    <key>List</key>
    <query>
      select
      ptomedicodi,
      prnvarcodi,
      dporawfuente,
      dporawtipomedi,
      dporawfecha,
      dporawvalor
      from dpo_estimadorraw_tmp
    </query>
  </Sql>

  <Sql>
    <key>GetById</key>
    <query>
      select
      ptomedicodi,
      prnvarcodi,
      dporawfuente,
      dporawtipomedi,
      dporawfecha,
      dporawvalor
      from dpo_estimadorraw_tmp
      where
      ptomedicodi = {0} and
      prnvarcodi = :{1} and
      dporawfuente = {2} and
      dporawtipomedi = {3} and
      dporawfecha = TO_DATE('{4}', 'DD/MM/YYYY HH24:mi')
    </query>
  </Sql>

  <Sql>
    <key>TruncateTablaTemporal</key>
    <query>
      truncate table {0}
    </query>
  </Sql>

  <Sql>
    <key>DeleteRawsHistoricos</key>
    <query>
      delete from dpo_estimadorraw_log
      where fechaarchivoraw &lt;= to_date('{0}','DD/MM/YYYY')
    </query>
  </Sql>

  <Sql>
    <key>MigrarRawsProcesadosHora</key>
    <query>
      insert into dpo_estimadorraw_{0} (ptomedicodi, prnvarcodi, dporawfuente, dporawtipomedi, dporawfecha,
      dporawvalorh1, dporawvalorh2, dporawvalorh3, dporawvalorh4, dporawvalorh5, dporawvalorh6, dporawvalorh7, dporawvalorh8, dporawvalorh9, dporawvalorh10,
      dporawvalorh11, dporawvalorh12, dporawvalorh13, dporawvalorh14, dporawvalorh15, dporawvalorh16, dporawvalorh17, dporawvalorh18, dporawvalorh19, dporawvalorh20,
      dporawvalorh21, dporawvalorh22, dporawvalorh23, dporawvalorh24, dporawvalorh25, dporawvalorh26, dporawvalorh27, dporawvalorh28, dporawvalorh29, dporawvalorh30,
      dporawvalorh31, dporawvalorh32, dporawvalorh33, dporawvalorh34, dporawvalorh35, dporawvalorh36, dporawvalorh37, dporawvalorh38, dporawvalorh39, dporawvalorh40,
      dporawvalorh41, dporawvalorh42, dporawvalorh43, dporawvalorh44, dporawvalorh45, dporawvalorh46, dporawvalorh47, dporawvalorh48, dporawvalorh49, dporawvalorh50,
      dporawvalorh51, dporawvalorh52, dporawvalorh53, dporawvalorh54, dporawvalorh55, dporawvalorh56, dporawvalorh57, dporawvalorh58, dporawvalorh59, dporawvalorh60)
      select
      ptomedicodi, prnvarcodi, dporawfuente, dporawtipomedi, TO_DATE('{1}','DD/MM/YYYY HH24:MI') as fecha,
      sum(h1) as h1, sum(h2) as h2, sum(h3) as h3, sum(h4) as h4, sum(h5) as h5,
      sum(h6) as h6, sum(h7) as h7, sum(h8) as h8, sum(h9) as h9, sum(h10) as h10,
      sum(h11) as h11, sum(h12) as h12, sum(h13) as h13, sum(h14) as h14, sum(h15) as h15,
      sum(h16) as h16, sum(h17) as h17, sum(h18) as h18, sum(h19) as h19, sum(h20) as h20,
      sum(h21) as h21, sum(h22) as h22, sum(h23) as h23, sum(h24) as h24, sum(h25) as h25,
      sum(h26) as h26, sum(h27) as h27, sum(h28) as h28, sum(h29) as h29, sum(h30) as h30,
      sum(h31) as h31, sum(h32) as h32, sum(h33) as h33, sum(h34) as h34, sum(h35) as h35,
      sum(h36) as h36, sum(h37) as h37, sum(h38) as h38, sum(h39) as h39, sum(h40) as h40,
      sum(h41) as h41, sum(h42) as h42, sum(h43) as h43, sum(h44) as h44, sum(h45) as h45,
      sum(h46) as h46, sum(h47) as h47, sum(h48) as h48, sum(h49) as h49, sum(h50) as h50,
      sum(h51) as h51, sum(h52) as h52, sum(h53) as h53, sum(h54) as h54, sum(h55) as h55,
      sum(h56) as h56, sum(h57) as h57, sum(h58) as h58, sum(h59) as h59, sum(h60) as h60
      from (
      select tmp.ptomedicodi, tmp.prnvarcodi, tmp.dporawfuente, tmp.dporawtipomedi, tmp.dporawfecha,
      tmp.dporawvalor as h1, null as h2, null as h3, null as h4, null as h5, null as h6, null as h7, null as h8, null as h9, null as h10,
      null as h11, null as h12, null as h13, null as h14, null as h15, null as h16, null as h17, null as h18, null as h19, null as h20,
      null as h21, null as h22, null as h23, null as h24, null as h25, null as h26, null as h27, null as h28, null as h29, null as h30,
      null as h31, null as h32, null as h33, null as h34, null as h35, null as h36, null as h37, null as h38, null as h39, null as h40,
      null as h41, null as h42, null as h43, null as h44, null as h45, null as h46, null as h47, null as h48, null as h49, null as h50,
      null as h51, null as h52, null as h53, null as h54, null as h55, null as h56, null as h57, null as h58, null as h59, null as h60
      from dpo_estimadorraw_{5} tmp
      where tmp.dporawfecha = to_date('{3} {2}:01','DD/MM/YYYY HH24:MI')
      union
      select tmp.ptomedicodi, tmp.prnvarcodi, tmp.dporawfuente, tmp.dporawtipomedi, tmp.dporawfecha,
      null as h1, tmp.dporawvalor as h2, null as h3, null as h4, null as h5, null as h6, null as h7, null as h8, null as h9, null as h10,
      null as h11, null as h12, null as h13, null as h14, null as h15, null as h16, null as h17, null as h18, null as h19, null as h20,
      null as h21, null as h22, null as h23, null as h24, null as h25, null as h26, null as h27, null as h28, null as h29, null as h30,
      null as h31, null as h32, null as h33, null as h34, null as h35, null as h36, null as h37, null as h38, null as h39, null as h40,
      null as h41, null as h42, null as h43, null as h44, null as h45, null as h46, null as h47, null as h48, null as h49, null as h50,
      null as h51, null as h52, null as h53, null as h54, null as h55, null as h56, null as h57, null as h58, null as h59, null as h60
      from dpo_estimadorraw_{5} tmp
      where tmp.dporawfecha = to_date('{3} {2}:02','DD/MM/YYYY HH24:MI')
      union
      select tmp.ptomedicodi, tmp.prnvarcodi, tmp.dporawfuente, tmp.dporawtipomedi, tmp.dporawfecha,
      null as h1, null as h2, tmp.dporawvalor as h3, null as h4, null as h5, null as h6, null as h7, null as h8, null as h9, null as h10,
      null as h11, null as h12, null as h13, null as h14, null as h15, null as h16, null as h17, null as h18, null as h19, null as h20,
      null as h21, null as h22, null as h23, null as h24, null as h25, null as h26, null as h27, null as h28, null as h29, null as h30,
      null as h31, null as h32, null as h33, null as h34, null as h35, null as h36, null as h37, null as h38, null as h39, null as h40,
      null as h41, null as h42, null as h43, null as h44, null as h45, null as h46, null as h47, null as h48, null as h49, null as h50,
      null as h51, null as h52, null as h53, null as h54, null as h55, null as h56, null as h57, null as h58, null as h59, null as h60
      from dpo_estimadorraw_{5} tmp
      where tmp.dporawfecha = to_date('{3} {2}:03','DD/MM/YYYY HH24:MI')
      union
      select tmp.ptomedicodi, tmp.prnvarcodi, tmp.dporawfuente, tmp.dporawtipomedi, tmp.dporawfecha,
      null as h1, null as h2, null as h3, tmp.dporawvalor as h4, null as h5, null as h6, null as h7, null as h8, null as h9, null as h10,
      null as h11, null as h12, null as h13, null as h14, null as h15, null as h16, null as h17, null as h18, null as h19, null as h20,
      null as h21, null as h22, null as h23, null as h24, null as h25, null as h26, null as h27, null as h28, null as h29, null as h30,
      null as h31, null as h32, null as h33, null as h34, null as h35, null as h36, null as h37, null as h38, null as h39, null as h40,
      null as h41, null as h42, null as h43, null as h44, null as h45, null as h46, null as h47, null as h48, null as h49, null as h50,
      null as h51, null as h52, null as h53, null as h54, null as h55, null as h56, null as h57, null as h58, null as h59, null as h60
      from dpo_estimadorraw_{5} tmp
      where tmp.dporawfecha = to_date('{3} {2}:04','DD/MM/YYYY HH24:MI')
      union
      select tmp.ptomedicodi, tmp.prnvarcodi, tmp.dporawfuente, tmp.dporawtipomedi, tmp.dporawfecha,
      null as h1, null as h2, null as h3, null as h4, tmp.dporawvalor as h5, null as h6, null as h7, null as h8, null as h9, null as h10,
      null as h11, null as h12, null as h13, null as h14, null as h15, null as h16, null as h17, null as h18, null as h19, null as h20,
      null as h21, null as h22, null as h23, null as h24, null as h25, null as h26, null as h27, null as h28, null as h29, null as h30,
      null as h31, null as h32, null as h33, null as h34, null as h35, null as h36, null as h37, null as h38, null as h39, null as h40,
      null as h41, null as h42, null as h43, null as h44, null as h45, null as h46, null as h47, null as h48, null as h49, null as h50,
      null as h51, null as h52, null as h53, null as h54, null as h55, null as h56, null as h57, null as h58, null as h59, null as h60
      from dpo_estimadorraw_{5} tmp
      where tmp.dporawfecha = to_date('{3} {2}:05','DD/MM/YYYY HH24:MI')
      union
      select tmp.ptomedicodi, tmp.prnvarcodi, tmp.dporawfuente, tmp.dporawtipomedi, tmp.dporawfecha,
      null as h1, null as h2, null as h3, null as h4, null as h5, tmp.dporawvalor as h6, null as h7, null as h8, null as h9, null as h10,
      null as h11, null as h12, null as h13, null as h14, null as h15, null as h16, null as h17, null as h18, null as h19, null as h20,
      null as h21, null as h22, null as h23, null as h24, null as h25, null as h26, null as h27, null as h28, null as h29, null as h30,
      null as h31, null as h32, null as h33, null as h34, null as h35, null as h36, null as h37, null as h38, null as h39, null as h40,
      null as h41, null as h42, null as h43, null as h44, null as h45, null as h46, null as h47, null as h48, null as h49, null as h50,
      null as h51, null as h52, null as h53, null as h54, null as h55, null as h56, null as h57, null as h58, null as h59, null as h60
      from dpo_estimadorraw_{5} tmp
      where tmp.dporawfecha = to_date('{3} {2}:06','DD/MM/YYYY HH24:MI')
      union
      select tmp.ptomedicodi, tmp.prnvarcodi, tmp.dporawfuente, tmp.dporawtipomedi, tmp.dporawfecha,
      null as h1, null as h2, null as h3, null as h4, null as h5, null as h6, tmp.dporawvalor as h7, null as h8, null as h9, null as h10,
      null as h11, null as h12, null as h13, null as h14, null as h15, null as h16, null as h17, null as h18, null as h19, null as h20,
      null as h21, null as h22, null as h23, null as h24, null as h25, null as h26, null as h27, null as h28, null as h29, null as h30,
      null as h31, null as h32, null as h33, null as h34, null as h35, null as h36, null as h37, null as h38, null as h39, null as h40,
      null as h41, null as h42, null as h43, null as h44, null as h45, null as h46, null as h47, null as h48, null as h49, null as h50,
      null as h51, null as h52, null as h53, null as h54, null as h55, null as h56, null as h57, null as h58, null as h59, null as h60
      from dpo_estimadorraw_{5} tmp
      where tmp.dporawfecha = to_date('{3} {2}:07','DD/MM/YYYY HH24:MI')
      union
      select tmp.ptomedicodi, tmp.prnvarcodi, tmp.dporawfuente, tmp.dporawtipomedi, tmp.dporawfecha,
      null as h1, null as h2, null as h3, null as h4, null as h5, null as h6, null as h7, tmp.dporawvalor as h8, null as h9, null as h10,
      null as h11, null as h12, null as h13, null as h14, null as h15, null as h16, null as h17, null as h18, null as h19, null as h20,
      null as h21, null as h22, null as h23, null as h24, null as h25, null as h26, null as h27, null as h28, null as h29, null as h30,
      null as h31, null as h32, null as h33, null as h34, null as h35, null as h36, null as h37, null as h38, null as h39, null as h40,
      null as h41, null as h42, null as h43, null as h44, null as h45, null as h46, null as h47, null as h48, null as h49, null as h50,
      null as h51, null as h52, null as h53, null as h54, null as h55, null as h56, null as h57, null as h58, null as h59, null as h60
      from dpo_estimadorraw_{5} tmp
      where tmp.dporawfecha = to_date('{3} {2}:08','DD/MM/YYYY HH24:MI')
      union
      select tmp.ptomedicodi, tmp.prnvarcodi, tmp.dporawfuente, tmp.dporawtipomedi, tmp.dporawfecha,
      null as h1, null as h2, null as h3, null as h4, null as h5, null as h6, null as h7, null as h8, tmp.dporawvalor as h9, null as h10,
      null as h11, null as h12, null as h13, null as h14, null as h15, null as h16, null as h17, null as h18, null as h19, null as h20,
      null as h21, null as h22, null as h23, null as h24, null as h25, null as h26, null as h27, null as h28, null as h29, null as h30,
      null as h31, null as h32, null as h33, null as h34, null as h35, null as h36, null as h37, null as h38, null as h39, null as h40,
      null as h41, null as h42, null as h43, null as h44, null as h45, null as h46, null as h47, null as h48, null as h49, null as h50,
      null as h51, null as h52, null as h53, null as h54, null as h55, null as h56, null as h57, null as h58, null as h59, null as h60
      from dpo_estimadorraw_{5} tmp
      where tmp.dporawfecha = to_date('{3} {2}:09','DD/MM/YYYY HH24:MI')
      union
      select tmp.ptomedicodi, tmp.prnvarcodi, tmp.dporawfuente, tmp.dporawtipomedi, tmp.dporawfecha,
      null as h1, null as h2, null as h3, null as h4, null as h5, null as h6, null as h7, null as h8, null as h9, tmp.dporawvalor as h10,
      null as h11, null as h12, null as h13, null as h14, null as h15, null as h16, null as h17, null as h18, null as h19, null as h20,
      null as h21, null as h22, null as h23, null as h24, null as h25, null as h26, null as h27, null as h28, null as h29, null as h30,
      null as h31, null as h32, null as h33, null as h34, null as h35, null as h36, null as h37, null as h38, null as h39, null as h40,
      null as h41, null as h42, null as h43, null as h44, null as h45, null as h46, null as h47, null as h48, null as h49, null as h50,
      null as h51, null as h52, null as h53, null as h54, null as h55, null as h56, null as h57, null as h58, null as h59, null as h60
      from dpo_estimadorraw_{5} tmp
      where tmp.dporawfecha = to_date('{3} {2}:10','DD/MM/YYYY HH24:MI')
      union
      select tmp.ptomedicodi, tmp.prnvarcodi, tmp.dporawfuente, tmp.dporawtipomedi, tmp.dporawfecha,
      null as h1, null as h2, null as h3, null as h4, null as h5, null as h6, null as h7, null as h8, null as h9, null as h10,
      tmp.dporawvalor as h11, null as h12, null as h13, null as h14, null as h15, null as h16, null as h17, null as h18, null as h19, null as h20,
      null as h21, null as h22, null as h23, null as h24, null as h25, null as h26, null as h27, null as h28, null as h29, null as h30,
      null as h31, null as h32, null as h33, null as h34, null as h35, null as h36, null as h37, null as h38, null as h39, null as h40,
      null as h41, null as h42, null as h43, null as h44, null as h45, null as h46, null as h47, null as h48, null as h49, null as h50,
      null as h51, null as h52, null as h53, null as h54, null as h55, null as h56, null as h57, null as h58, null as h59, null as h60
      from dpo_estimadorraw_{5} tmp
      where tmp.dporawfecha = to_date('{3} {2}:11','DD/MM/YYYY HH24:MI')
      union
      select tmp.ptomedicodi, tmp.prnvarcodi, tmp.dporawfuente, tmp.dporawtipomedi, tmp.dporawfecha,
      null as h1, null as h2, null as h3, null as h4, null as h5, null as h6, null as h7, null as h8, null as h9, null as h10,
      null as h11, tmp.dporawvalor as h12, null as h13, null as h14, null as h15, null as h16, null as h17, null as h18, null as h19, null as h20,
      null as h21, null as h22, null as h23, null as h24, null as h25, null as h26, null as h27, null as h28, null as h29, null as h30,
      null as h31, null as h32, null as h33, null as h34, null as h35, null as h36, null as h37, null as h38, null as h39, null as h40,
      null as h41, null as h42, null as h43, null as h44, null as h45, null as h46, null as h47, null as h48, null as h49, null as h50,
      null as h51, null as h52, null as h53, null as h54, null as h55, null as h56, null as h57, null as h58, null as h59, null as h60
      from dpo_estimadorraw_{5} tmp
      where tmp.dporawfecha = to_date('{3} {2}:12','DD/MM/YYYY HH24:MI')
      union
      select tmp.ptomedicodi, tmp.prnvarcodi, tmp.dporawfuente, tmp.dporawtipomedi, tmp.dporawfecha,
      null as h1, null as h2, null as h3, null as h4, null as h5, null as h6, null as h7, null as h8, null as h9, null as h10,
      null as h11, null as h12, tmp.dporawvalor as h13, null as h14, null as h15, null as h16, null as h17, null as h18, null as h19, null as h20,
      null as h21, null as h22, null as h23, null as h24, null as h25, null as h26, null as h27, null as h28, null as h29, null as h30,
      null as h31, null as h32, null as h33, null as h34, null as h35, null as h36, null as h37, null as h38, null as h39, null as h40,
      null as h41, null as h42, null as h43, null as h44, null as h45, null as h46, null as h47, null as h48, null as h49, null as h50,
      null as h51, null as h52, null as h53, null as h54, null as h55, null as h56, null as h57, null as h58, null as h59, null as h60
      from dpo_estimadorraw_{5} tmp
      where tmp.dporawfecha = to_date('{3} {2}:13','DD/MM/YYYY HH24:MI')
      union
      select tmp.ptomedicodi, tmp.prnvarcodi, tmp.dporawfuente, tmp.dporawtipomedi, tmp.dporawfecha,
      null as h1, null as h2, null as h3, null as h4, null as h5, null as h6, null as h7, null as h8, null as h9, null as h10,
      null as h11, null as h12, null as h13, tmp.dporawvalor as h14, null as h15, null as h16, null as h17, null as h18, null as h19, null as h20,
      null as h21, null as h22, null as h23, null as h24, null as h25, null as h26, null as h27, null as h28, null as h29, null as h30,
      null as h31, null as h32, null as h33, null as h34, null as h35, null as h36, null as h37, null as h38, null as h39, null as h40,
      null as h41, null as h42, null as h43, null as h44, null as h45, null as h46, null as h47, null as h48, null as h49, null as h50,
      null as h51, null as h52, null as h53, null as h54, null as h55, null as h56, null as h57, null as h58, null as h59, null as h60
      from dpo_estimadorraw_{5} tmp
      where tmp.dporawfecha = to_date('{3} {2}:14','DD/MM/YYYY HH24:MI')
      union
      select tmp.ptomedicodi, tmp.prnvarcodi, tmp.dporawfuente, tmp.dporawtipomedi, tmp.dporawfecha,
      null as h1, null as h2, null as h3, null as h4, null as h5, null as h6, null as h7, null as h8, null as h9, null as h10,
      null as h11, null as h12, null as h13, null as h14, tmp.dporawvalor as h15, null as h16, null as h17, null as h18, null as h19, null as h20,
      null as h21, null as h22, null as h23, null as h24, null as h25, null as h26, null as h27, null as h28, null as h29, null as h30,
      null as h31, null as h32, null as h33, null as h34, null as h35, null as h36, null as h37, null as h38, null as h39, null as h40,
      null as h41, null as h42, null as h43, null as h44, null as h45, null as h46, null as h47, null as h48, null as h49, null as h50,
      null as h51, null as h52, null as h53, null as h54, null as h55, null as h56, null as h57, null as h58, null as h59, null as h60
      from dpo_estimadorraw_{5} tmp
      where tmp.dporawfecha = to_date('{3} {2}:15','DD/MM/YYYY HH24:MI')
      union
      select tmp.ptomedicodi, tmp.prnvarcodi, tmp.dporawfuente, tmp.dporawtipomedi, tmp.dporawfecha,
      null as h1, null as h2, null as h3, null as h4, null as h5, null as h6, null as h7, null as h8, null as h9, null as h10,
      null as h11, null as h12, null as h13, null as h14, null as h15, tmp.dporawvalor as h16, null as h17, null as h18, null as h19, null as h20,
      null as h21, null as h22, null as h23, null as h24, null as h25, null as h26, null as h27, null as h28, null as h29, null as h30,
      null as h31, null as h32, null as h33, null as h34, null as h35, null as h36, null as h37, null as h38, null as h39, null as h40,
      null as h41, null as h42, null as h43, null as h44, null as h45, null as h46, null as h47, null as h48, null as h49, null as h50,
      null as h51, null as h52, null as h53, null as h54, null as h55, null as h56, null as h57, null as h58, null as h59, null as h60
      from dpo_estimadorraw_{5} tmp
      where tmp.dporawfecha = to_date('{3} {2}:16','DD/MM/YYYY HH24:MI')
      union
      select tmp.ptomedicodi, tmp.prnvarcodi, tmp.dporawfuente, tmp.dporawtipomedi, tmp.dporawfecha,
      null as h1, null as h2, null as h3, null as h4, null as h5, null as h6, null as h7, null as h8, null as h9, null as h10,
      null as h11, null as h12, null as h13, null as h14, null as h15, null as h16, tmp.dporawvalor as h17, null as h18, null as h19, null as h20,
      null as h21, null as h22, null as h23, null as h24, null as h25, null as h26, null as h27, null as h28, null as h29, null as h30,
      null as h31, null as h32, null as h33, null as h34, null as h35, null as h36, null as h37, null as h38, null as h39, null as h40,
      null as h41, null as h42, null as h43, null as h44, null as h45, null as h46, null as h47, null as h48, null as h49, null as h50,
      null as h51, null as h52, null as h53, null as h54, null as h55, null as h56, null as h57, null as h58, null as h59, null as h60
      from dpo_estimadorraw_{5} tmp
      where tmp.dporawfecha = to_date('{3} {2}:17','DD/MM/YYYY HH24:MI')
      union
      select tmp.ptomedicodi, tmp.prnvarcodi, tmp.dporawfuente, tmp.dporawtipomedi, tmp.dporawfecha,
      null as h1, null as h2, null as h3, null as h4, null as h5, null as h6, null as h7, null as h8, null as h9, null as h10,
      null as h11, null as h12, null as h13, null as h14, null as h15, null as h16, null as h17, tmp.dporawvalor as h18, null as h19, null as h20,
      null as h21, null as h22, null as h23, null as h24, null as h25, null as h26, null as h27, null as h28, null as h29, null as h30,
      null as h31, null as h32, null as h33, null as h34, null as h35, null as h36, null as h37, null as h38, null as h39, null as h40,
      null as h41, null as h42, null as h43, null as h44, null as h45, null as h46, null as h47, null as h48, null as h49, null as h50,
      null as h51, null as h52, null as h53, null as h54, null as h55, null as h56, null as h57, null as h58, null as h59, null as h60
      from dpo_estimadorraw_{5} tmp
      where tmp.dporawfecha = to_date('{3} {2}:18','DD/MM/YYYY HH24:MI')
      union
      select tmp.ptomedicodi, tmp.prnvarcodi, tmp.dporawfuente, tmp.dporawtipomedi, tmp.dporawfecha,
      null as h1, null as h2, null as h3, null as h4, null as h5, null as h6, null as h7, null as h8, null as h9, null as h10,
      null as h11, null as h12, null as h13, null as h14, null as h15, null as h16, null as h17, null as h18, tmp.dporawvalor as h19, null as h20,
      null as h21, null as h22, null as h23, null as h24, null as h25, null as h26, null as h27, null as h28, null as h29, null as h30,
      null as h31, null as h32, null as h33, null as h34, null as h35, null as h36, null as h37, null as h38, null as h39, null as h40,
      null as h41, null as h42, null as h43, null as h44, null as h45, null as h46, null as h47, null as h48, null as h49, null as h50,
      null as h51, null as h52, null as h53, null as h54, null as h55, null as h56, null as h57, null as h58, null as h59, null as h60
      from dpo_estimadorraw_{5} tmp
      where tmp.dporawfecha = to_date('{3} {2}:19','DD/MM/YYYY HH24:MI')
      union
      select tmp.ptomedicodi, tmp.prnvarcodi, tmp.dporawfuente, tmp.dporawtipomedi, tmp.dporawfecha,
      null as h1, null as h2, null as h3, null as h4, null as h5, null as h6, null as h7, null as h8, null as h9, null as h10,
      null as h11, null as h12, null as h13, null as h14, null as h15, null as h16, null as h17, null as h18, null as h19, tmp.dporawvalor as h20,
      null as h21, null as h22, null as h23, null as h24, null as h25, null as h26, null as h27, null as h28, null as h29, null as h30,
      null as h31, null as h32, null as h33, null as h34, null as h35, null as h36, null as h37, null as h38, null as h39, null as h40,
      null as h41, null as h42, null as h43, null as h44, null as h45, null as h46, null as h47, null as h48, null as h49, null as h50,
      null as h51, null as h52, null as h53, null as h54, null as h55, null as h56, null as h57, null as h58, null as h59, null as h60
      from dpo_estimadorraw_{5} tmp
      where tmp.dporawfecha = to_date('{3} {2}:20','DD/MM/YYYY HH24:MI')
      union
      select tmp.ptomedicodi, tmp.prnvarcodi, tmp.dporawfuente, tmp.dporawtipomedi, tmp.dporawfecha,
      null as h1, null as h2, null as h3, null as h4, null as h5, null as h6, null as h7, null as h8, null as h9, null as h10,
      null as h11, null as h12, null as h13, null as h14, null as h15, null as h16, null as h17, null as h18, null as h19, null as h20,
      tmp.dporawvalor as h21, null as h22, null as h23, null as h24, null as h25, null as h26, null as h27, null as h28, null as h29, null as h30,
      null as h31, null as h32, null as h33, null as h34, null as h35, null as h36, null as h37, null as h38, null as h39, null as h40,
      null as h41, null as h42, null as h43, null as h44, null as h45, null as h46, null as h47, null as h48, null as h49, null as h50,
      null as h51, null as h52, null as h53, null as h54, null as h55, null as h56, null as h57, null as h58, null as h59, null as h60
      from dpo_estimadorraw_{5} tmp
      where tmp.dporawfecha = to_date('{3} {2}:21','DD/MM/YYYY HH24:MI')
      union
      select tmp.ptomedicodi, tmp.prnvarcodi, tmp.dporawfuente, tmp.dporawtipomedi, tmp.dporawfecha,
      null as h1, null as h2, null as h3, null as h4, null as h5, null as h6, null as h7, null as h8, null as h9, null as h10,
      null as h11, null as h12, null as h13, null as h14, null as h15, null as h16, null as h17, null as h18, null as h19, null as h20,
      null as h21, tmp.dporawvalor as h22, null as h23, null as h24, null as h25, null as h26, null as h27, null as h28, null as h29, null as h30,
      null as h31, null as h32, null as h33, null as h34, null as h35, null as h36, null as h37, null as h38, null as h39, null as h40,
      null as h41, null as h42, null as h43, null as h44, null as h45, null as h46, null as h47, null as h48, null as h49, null as h50,
      null as h51, null as h52, null as h53, null as h54, null as h55, null as h56, null as h57, null as h58, null as h59, null as h60
      from dpo_estimadorraw_{5} tmp
      where tmp.dporawfecha = to_date('{3} {2}:22','DD/MM/YYYY HH24:MI')
      union
      select tmp.ptomedicodi, tmp.prnvarcodi, tmp.dporawfuente, tmp.dporawtipomedi, tmp.dporawfecha,
      null as h1, null as h2, null as h3, null as h4, null as h5, null as h6, null as h7, null as h8, null as h9, null as h10,
      null as h11, null as h12, null as h13, null as h14, null as h15, null as h16, null as h17, null as h18, null as h19, null as h20,
      null as h21, null as h22, tmp.dporawvalor as h23, null as h24, null as h25, null as h26, null as h27, null as h28, null as h29, null as h30,
      null as h31, null as h32, null as h33, null as h34, null as h35, null as h36, null as h37, null as h38, null as h39, null as h40,
      null as h41, null as h42, null as h43, null as h44, null as h45, null as h46, null as h47, null as h48, null as h49, null as h50,
      null as h51, null as h52, null as h53, null as h54, null as h55, null as h56, null as h57, null as h58, null as h59, null as h60
      from dpo_estimadorraw_{5} tmp
      where tmp.dporawfecha = to_date('{3} {2}:23','DD/MM/YYYY HH24:MI')
      union
      select tmp.ptomedicodi, tmp.prnvarcodi, tmp.dporawfuente, tmp.dporawtipomedi, tmp.dporawfecha,
      null as h1, null as h2, null as h3, null as h4, null as h5, null as h6, null as h7, null as h8, null as h9, null as h10,
      null as h11, null as h12, null as h13, null as h14, null as h15, null as h16, null as h17, null as h18, null as h19, null as h20,
      null as h21, null as h22, null as h23, tmp.dporawvalor as h24, null as h25, null as h26, null as h27, null as h28, null as h29, null as h30,
      null as h31, null as h32, null as h33, null as h34, null as h35, null as h36, null as h37, null as h38, null as h39, null as h40,
      null as h41, null as h42, null as h43, null as h44, null as h45, null as h46, null as h47, null as h48, null as h49, null as h50,
      null as h51, null as h52, null as h53, null as h54, null as h55, null as h56, null as h57, null as h58, null as h59, null as h60
      from dpo_estimadorraw_{5} tmp
      where tmp.dporawfecha = to_date('{3} {2}:24','DD/MM/YYYY HH24:MI')
      union
      select tmp.ptomedicodi, tmp.prnvarcodi, tmp.dporawfuente, tmp.dporawtipomedi, tmp.dporawfecha,
      null as h1, null as h2, null as h3, null as h4, null as h5, null as h6, null as h7, null as h8, null as h9, null as h10,
      null as h11, null as h12, null as h13, null as h14, null as h15, null as h16, null as h17, null as h18, null as h19, null as h20,
      null as h21, null as h22, null as h23, null as h24, tmp.dporawvalor as h25, null as h26, null as h27, null as h28, null as h29, null as h30,
      null as h31, null as h32, null as h33, null as h34, null as h35, null as h36, null as h37, null as h38, null as h39, null as h40,
      null as h41, null as h42, null as h43, null as h44, null as h45, null as h46, null as h47, null as h48, null as h49, null as h50,
      null as h51, null as h52, null as h53, null as h54, null as h55, null as h56, null as h57, null as h58, null as h59, null as h60
      from dpo_estimadorraw_{5} tmp
      where tmp.dporawfecha = to_date('{3} {2}:25','DD/MM/YYYY HH24:MI')
      union
      select tmp.ptomedicodi, tmp.prnvarcodi, tmp.dporawfuente, tmp.dporawtipomedi, tmp.dporawfecha,
      null as h1, null as h2, null as h3, null as h4, null as h5, null as h6, null as h7, null as h8, null as h9, null as h10,
      null as h11, null as h12, null as h13, null as h14, null as h15, null as h16, null as h17, null as h18, null as h19, null as h20,
      null as h21, null as h22, null as h23, null as h24, null as h25, tmp.dporawvalor as h26, null as h27, null as h28, null as h29, null as h30,
      null as h31, null as h32, null as h33, null as h34, null as h35, null as h36, null as h37, null as h38, null as h39, null as h40,
      null as h41, null as h42, null as h43, null as h44, null as h45, null as h46, null as h47, null as h48, null as h49, null as h50,
      null as h51, null as h52, null as h53, null as h54, null as h55, null as h56, null as h57, null as h58, null as h59, null as h60
      from dpo_estimadorraw_{5} tmp
      where tmp.dporawfecha = to_date('{3} {2}:26','DD/MM/YYYY HH24:MI')
      union
      select tmp.ptomedicodi, tmp.prnvarcodi, tmp.dporawfuente, tmp.dporawtipomedi, tmp.dporawfecha,
      null as h1, null as h2, null as h3, null as h4, null as h5, null as h6, null as h7, null as h8, null as h9, null as h10,
      null as h11, null as h12, null as h13, null as h14, null as h15, null as h16, null as h17, null as h18, null as h19, null as h20,
      null as h21, null as h22, null as h23, null as h24, null as h25, null as h26, tmp.dporawvalor as h27, null as h28, null as h29, null as h30,
      null as h31, null as h32, null as h33, null as h34, null as h35, null as h36, null as h37, null as h38, null as h39, null as h40,
      null as h41, null as h42, null as h43, null as h44, null as h45, null as h46, null as h47, null as h48, null as h49, null as h50,
      null as h51, null as h52, null as h53, null as h54, null as h55, null as h56, null as h57, null as h58, null as h59, null as h60
      from dpo_estimadorraw_{5} tmp
      where tmp.dporawfecha = to_date('{3} {2}:27','DD/MM/YYYY HH24:MI')
      union
      select tmp.ptomedicodi, tmp.prnvarcodi, tmp.dporawfuente, tmp.dporawtipomedi, tmp.dporawfecha,
      null as h1, null as h2, null as h3, null as h4, null as h5, null as h6, null as h7, null as h8, null as h9, null as h10,
      null as h11, null as h12, null as h13, null as h14, null as h15, null as h16, null as h17, null as h18, null as h19, null as h20,
      null as h21, null as h22, null as h23, null as h24, null as h25, null as h26, null as h27, tmp.dporawvalor as h28, null as h29, null as h30,
      null as h31, null as h32, null as h33, null as h34, null as h35, null as h36, null as h37, null as h38, null as h39, null as h40,
      null as h41, null as h42, null as h43, null as h44, null as h45, null as h46, null as h47, null as h48, null as h49, null as h50,
      null as h51, null as h52, null as h53, null as h54, null as h55, null as h56, null as h57, null as h58, null as h59, null as h60
      from dpo_estimadorraw_{5} tmp
      where tmp.dporawfecha = to_date('{3} {2}:28','DD/MM/YYYY HH24:MI')
      union
      select tmp.ptomedicodi, tmp.prnvarcodi, tmp.dporawfuente, tmp.dporawtipomedi, tmp.dporawfecha,
      null as h1, null as h2, null as h3, null as h4, null as h5, null as h6, null as h7, null as h8, null as h9, null as h10,
      null as h11, null as h12, null as h13, null as h14, null as h15, null as h16, null as h17, null as h18, null as h19, null as h20,
      null as h21, null as h22, null as h23, null as h24, null as h25, null as h26, null as h27, null as h28, tmp.dporawvalor as h29, null as h30,
      null as h31, null as h32, null as h33, null as h34, null as h35, null as h36, null as h37, null as h38, null as h39, null as h40,
      null as h41, null as h42, null as h43, null as h44, null as h45, null as h46, null as h47, null as h48, null as h49, null as h50,
      null as h51, null as h52, null as h53, null as h54, null as h55, null as h56, null as h57, null as h58, null as h59, null as h60
      from dpo_estimadorraw_{5} tmp
      where tmp.dporawfecha = to_date('{3} {2}:29','DD/MM/YYYY HH24:MI')
      union
      select tmp.ptomedicodi, tmp.prnvarcodi, tmp.dporawfuente, tmp.dporawtipomedi, tmp.dporawfecha,
      null as h1, null as h2, null as h3, null as h4, null as h5, null as h6, null as h7, null as h8, null as h9, null as h10,
      null as h11, null as h12, null as h13, null as h14, null as h15, null as h16, null as h17, null as h18, null as h19, null as h20,
      null as h21, null as h22, null as h23, null as h24, null as h25, null as h26, null as h27, null as h28, null as h29, tmp.dporawvalor as h30,
      null as h31, null as h32, null as h33, null as h34, null as h35, null as h36, null as h37, null as h38, null as h39, null as h40,
      null as h41, null as h42, null as h43, null as h44, null as h45, null as h46, null as h47, null as h48, null as h49, null as h50,
      null as h51, null as h52, null as h53, null as h54, null as h55, null as h56, null as h57, null as h58, null as h59, null as h60
      from dpo_estimadorraw_{5} tmp
      where tmp.dporawfecha = to_date('{3} {2}:30','DD/MM/YYYY HH24:MI')
      union
      select tmp.ptomedicodi, tmp.prnvarcodi, tmp.dporawfuente, tmp.dporawtipomedi, tmp.dporawfecha,
      null as h1, null as h2, null as h3, null as h4, null as h5, null as h6, null as h7, null as h8, null as h9, null as h10,
      null as h11, null as h12, null as h13, null as h14, null as h15, null as h16, null as h17, null as h18, null as h19, null as h20,
      null as h21, null as h22, null as h23, null as h24, null as h25, null as h26, null as h27, null as h28, null as h29, null as h30,
      tmp.dporawvalor as h31, null as h32, null as h33, null as h34, null as h35, null as h36, null as h37, null as h38, null as h39, null as h40,
      null as h41, null as h42, null as h43, null as h44, null as h45, null as h46, null as h47, null as h48, null as h49, null as h50,
      null as h51, null as h52, null as h53, null as h54, null as h55, null as h56, null as h57, null as h58, null as h59, null as h60
      from dpo_estimadorraw_{5} tmp
      where tmp.dporawfecha = to_date('{3} {2}:31','DD/MM/YYYY HH24:MI')
      union
      select tmp.ptomedicodi, tmp.prnvarcodi, tmp.dporawfuente, tmp.dporawtipomedi, tmp.dporawfecha,
      null as h1, null as h2, null as h3, null as h4, null as h5, null as h6, null as h7, null as h8, null as h9, null as h10,
      null as h11, null as h12, null as h13, null as h14, null as h15, null as h16, null as h17, null as h18, null as h19, null as h20,
      null as h21, null as h22, null as h23, null as h24, null as h25, null as h26, null as h27, null as h28, null as h29, null as h30,
      null as h31, tmp.dporawvalor as h32, null as h33, null as h34, null as h35, null as h36, null as h37, null as h38, null as h39, null as h40,
      null as h41, null as h42, null as h43, null as h44, null as h45, null as h46, null as h47, null as h48, null as h49, null as h50,
      null as h51, null as h52, null as h53, null as h54, null as h55, null as h56, null as h57, null as h58, null as h59, null as h60
      from dpo_estimadorraw_{5} tmp
      where tmp.dporawfecha = to_date('{3} {2}:32','DD/MM/YYYY HH24:MI')
      union
      select tmp.ptomedicodi, tmp.prnvarcodi, tmp.dporawfuente, tmp.dporawtipomedi, tmp.dporawfecha,
      null as h1, null as h2, null as h3, null as h4, null as h5, null as h6, null as h7, null as h8, null as h9, null as h10,
      null as h11, null as h12, null as h13, null as h14, null as h15, null as h16, null as h17, null as h18, null as h19, null as h20,
      null as h21, null as h22, null as h23, null as h24, null as h25, null as h26, null as h27, null as h28, null as h29, null as h30,
      null as h31, null as h32, tmp.dporawvalor as h33, null as h34, null as h35, null as h36, null as h37, null as h38, null as h39, null as h40,
      null as h41, null as h42, null as h43, null as h44, null as h45, null as h46, null as h47, null as h48, null as h49, null as h50,
      null as h51, null as h52, null as h53, null as h54, null as h55, null as h56, null as h57, null as h58, null as h59, null as h60
      from dpo_estimadorraw_{5} tmp
      where tmp.dporawfecha = to_date('{3} {2}:33','DD/MM/YYYY HH24:MI')
      union
      select tmp.ptomedicodi, tmp.prnvarcodi, tmp.dporawfuente, tmp.dporawtipomedi, tmp.dporawfecha,
      null as h1, null as h2, null as h3, null as h4, null as h5, null as h6, null as h7, null as h8, null as h9, null as h10,
      null as h11, null as h12, null as h13, null as h14, null as h15, null as h16, null as h17, null as h18, null as h19, null as h20,
      null as h21, null as h22, null as h23, null as h24, null as h25, null as h26, null as h27, null as h28, null as h29, null as h30,
      null as h31, null as h32, null as h33, tmp.dporawvalor as h34, null as h35, null as h36, null as h37, null as h38, null as h39, null as h40,
      null as h41, null as h42, null as h43, null as h44, null as h45, null as h46, null as h47, null as h48, null as h49, null as h50,
      null as h51, null as h52, null as h53, null as h54, null as h55, null as h56, null as h57, null as h58, null as h59, null as h60
      from dpo_estimadorraw_{5} tmp
      where tmp.dporawfecha = to_date('{3} {2}:34','DD/MM/YYYY HH24:MI')
      union
      select tmp.ptomedicodi, tmp.prnvarcodi, tmp.dporawfuente, tmp.dporawtipomedi, tmp.dporawfecha,
      null as h1, null as h2, null as h3, null as h4, null as h5, null as h6, null as h7, null as h8, null as h9, null as h10,
      null as h11, null as h12, null as h13, null as h14, null as h15, null as h16, null as h17, null as h18, null as h19, null as h20,
      null as h21, null as h22, null as h23, null as h24, null as h25, null as h26, null as h27, null as h28, null as h29, null as h30,
      null as h31, null as h32, null as h33, null as h34, tmp.dporawvalor as h35, null as h36, null as h37, null as h38, null as h39, null as h40,
      null as h41, null as h42, null as h43, null as h44, null as h45, null as h46, null as h47, null as h48, null as h49, null as h50,
      null as h51, null as h52, null as h53, null as h54, null as h55, null as h56, null as h57, null as h58, null as h59, null as h60
      from dpo_estimadorraw_{5} tmp
      where tmp.dporawfecha = to_date('{3} {2}:35','DD/MM/YYYY HH24:MI')
      union
      select tmp.ptomedicodi, tmp.prnvarcodi, tmp.dporawfuente, tmp.dporawtipomedi, tmp.dporawfecha,
      null as h1, null as h2, null as h3, null as h4, null as h5, null as h6, null as h7, null as h8, null as h9, null as h10,
      null as h11, null as h12, null as h13, null as h14, null as h15, null as h16, null as h17, null as h18, null as h19, null as h20,
      null as h21, null as h22, null as h23, null as h24, null as h25, null as h26, null as h27, null as h28, null as h29, null as h30,
      null as h31, null as h32, null as h33, null as h34, null as h35, tmp.dporawvalor as h36, null as h37, null as h38, null as h39, null as h40,
      null as h41, null as h42, null as h43, null as h44, null as h45, null as h46, null as h47, null as h48, null as h49, null as h50,
      null as h51, null as h52, null as h53, null as h54, null as h55, null as h56, null as h57, null as h58, null as h59, null as h60
      from dpo_estimadorraw_{5} tmp
      where tmp.dporawfecha = to_date('{3} {2}:36','DD/MM/YYYY HH24:MI')
      union
      select tmp.ptomedicodi, tmp.prnvarcodi, tmp.dporawfuente, tmp.dporawtipomedi, tmp.dporawfecha,
      null as h1, null as h2, null as h3, null as h4, null as h5, null as h6, null as h7, null as h8, null as h9, null as h10,
      null as h11, null as h12, null as h13, null as h14, null as h15, null as h16, null as h17, null as h18, null as h19, null as h20,
      null as h21, null as h22, null as h23, null as h24, null as h25, null as h26, null as h27, null as h28, null as h29, null as h30,
      null as h31, null as h32, null as h33, null as h34, null as h35, null as h36, tmp.dporawvalor as h37, null as h38, null as h39, null as h40,
      null as h41, null as h42, null as h43, null as h44, null as h45, null as h46, null as h47, null as h48, null as h49, null as h50,
      null as h51, null as h52, null as h53, null as h54, null as h55, null as h56, null as h57, null as h58, null as h59, null as h60
      from dpo_estimadorraw_{5} tmp
      where tmp.dporawfecha = to_date('{3} {2}:37','DD/MM/YYYY HH24:MI')
      union
      select tmp.ptomedicodi, tmp.prnvarcodi, tmp.dporawfuente, tmp.dporawtipomedi, tmp.dporawfecha,
      null as h1, null as h2, null as h3, null as h4, null as h5, null as h6, null as h7, null as h8, null as h9, null as h10,
      null as h11, null as h12, null as h13, null as h14, null as h15, null as h16, null as h17, null as h18, null as h19, null as h20,
      null as h21, null as h22, null as h23, null as h24, null as h25, null as h26, null as h27, null as h28, null as h29, null as h30,
      null as h31, null as h32, null as h33, null as h34, null as h35, null as h36, null as h37, tmp.dporawvalor as h38, null as h39, null as h40,
      null as h41, null as h42, null as h43, null as h44, null as h45, null as h46, null as h47, null as h48, null as h49, null as h50,
      null as h51, null as h52, null as h53, null as h54, null as h55, null as h56, null as h57, null as h58, null as h59, null as h60
      from dpo_estimadorraw_{5} tmp
      where tmp.dporawfecha = to_date('{3} {2}:38','DD/MM/YYYY HH24:MI')
      union
      select tmp.ptomedicodi, tmp.prnvarcodi, tmp.dporawfuente, tmp.dporawtipomedi, tmp.dporawfecha,
      null as h1, null as h2, null as h3, null as h4, null as h5, null as h6, null as h7, null as h8, null as h9, null as h10,
      null as h11, null as h12, null as h13, null as h14, null as h15, null as h16, null as h17, null as h18, null as h19, null as h20,
      null as h21, null as h22, null as h23, null as h24, null as h25, null as h26, null as h27, null as h28, null as h29, null as h30,
      null as h31, null as h32, null as h33, null as h34, null as h35, null as h36, null as h37, null as h38, tmp.dporawvalor as h39, null as h40,
      null as h41, null as h42, null as h43, null as h44, null as h45, null as h46, null as h47, null as h48, null as h49, null as h50,
      null as h51, null as h52, null as h53, null as h54, null as h55, null as h56, null as h57, null as h58, null as h59, null as h60
      from dpo_estimadorraw_{5} tmp
      where tmp.dporawfecha = to_date('{3} {2}:39','DD/MM/YYYY HH24:MI')
      union
      select tmp.ptomedicodi, tmp.prnvarcodi, tmp.dporawfuente, tmp.dporawtipomedi, tmp.dporawfecha,
      null as h1, null as h2, null as h3, null as h4, null as h5, null as h6, null as h7, null as h8, null as h9, null as h10,
      null as h11, null as h12, null as h13, null as h14, null as h15, null as h16, null as h17, null as h18, null as h19, null as h20,
      null as h21, null as h22, null as h23, null as h24, null as h25, null as h26, null as h27, null as h28, null as h29, null as h30,
      null as h31, null as h32, null as h33, null as h34, null as h35, null as h36, null as h37, null as h38, null as h39, tmp.dporawvalor as h40,
      null as h41, null as h42, null as h43, null as h44, null as h45, null as h46, null as h47, null as h48, null as h49, null as h50,
      null as h51, null as h52, null as h53, null as h54, null as h55, null as h56, null as h57, null as h58, null as h59, null as h60
      from dpo_estimadorraw_{5} tmp
      where tmp.dporawfecha = to_date('{3} {2}:40','DD/MM/YYYY HH24:MI')
      union
      select tmp.ptomedicodi, tmp.prnvarcodi, tmp.dporawfuente, tmp.dporawtipomedi, tmp.dporawfecha,
      null as h1, null as h2, null as h3, null as h4, null as h5, null as h6, null as h7, null as h8, null as h9, null as h10,
      null as h11, null as h12, null as h13, null as h14, null as h15, null as h16, null as h17, null as h18, null as h19, null as h20,
      null as h21, null as h22, null as h23, null as h24, null as h25, null as h26, null as h27, null as h28, null as h29, null as h30,
      null as h31, null as h32, null as h33, null as h34, null as h35, null as h36, null as h37, null as h38, null as h39, null as h40,
      tmp.dporawvalor as h41, null as h42, null as h43, null as h44, null as h45, null as h46, null as h47, null as h48, null as h49, null as h50,
      null as h51, null as h52, null as h53, null as h54, null as h55, null as h56, null as h57, null as h58, null as h59, null as h60
      from dpo_estimadorraw_{5} tmp
      where tmp.dporawfecha = to_date('{3} {2}:41','DD/MM/YYYY HH24:MI')
      union
      select tmp.ptomedicodi, tmp.prnvarcodi, tmp.dporawfuente, tmp.dporawtipomedi, tmp.dporawfecha,
      null as h1, null as h2, null as h3, null as h4, null as h5, null as h6, null as h7, null as h8, null as h9, null as h10,
      null as h11, null as h12, null as h13, null as h14, null as h15, null as h16, null as h17, null as h18, null as h19, null as h20,
      null as h21, null as h22, null as h23, null as h24, null as h25, null as h26, null as h27, null as h28, null as h29, null as h30,
      null as h31, null as h32, null as h33, null as h34, null as h35, null as h36, null as h37, null as h38, null as h39, null as h40,
      null as h41, tmp.dporawvalor as h42, null as h43, null as h44, null as h45, null as h46, null as h47, null as h48, null as h49, null as h50,
      null as h51, null as h52, null as h53, null as h54, null as h55, null as h56, null as h57, null as h58, null as h59, null as h60
      from dpo_estimadorraw_{5} tmp
      where tmp.dporawfecha = to_date('{3} {2}:42','DD/MM/YYYY HH24:MI')
      union
      select tmp.ptomedicodi, tmp.prnvarcodi, tmp.dporawfuente, tmp.dporawtipomedi, tmp.dporawfecha,
      null as h1, null as h2, null as h3, null as h4, null as h5, null as h6, null as h7, null as h8, null as h9, null as h10,
      null as h11, null as h12, null as h13, null as h14, null as h15, null as h16, null as h17, null as h18, null as h19, null as h20,
      null as h21, null as h22, null as h23, null as h24, null as h25, null as h26, null as h27, null as h28, null as h29, null as h30,
      null as h31, null as h32, null as h33, null as h34, null as h35, null as h36, null as h37, null as h38, null as h39, null as h40,
      null as h41, null as h42, tmp.dporawvalor as h43, null as h44, null as h45, null as h46, null as h47, null as h48, null as h49, null as h50,
      null as h51, null as h52, null as h53, null as h54, null as h55, null as h56, null as h57, null as h58, null as h59, null as h60
      from dpo_estimadorraw_{5} tmp
      where tmp.dporawfecha = to_date('{3} {2}:43','DD/MM/YYYY HH24:MI')
      union
      select tmp.ptomedicodi, tmp.prnvarcodi, tmp.dporawfuente, tmp.dporawtipomedi, tmp.dporawfecha,
      null as h1, null as h2, null as h3, null as h4, null as h5, null as h6, null as h7, null as h8, null as h9, null as h10,
      null as h11, null as h12, null as h13, null as h14, null as h15, null as h16, null as h17, null as h18, null as h19, null as h20,
      null as h21, null as h22, null as h23, null as h24, null as h25, null as h26, null as h27, null as h28, null as h29, null as h30,
      null as h31, null as h32, null as h33, null as h34, null as h35, null as h36, null as h37, null as h38, null as h39, null as h40,
      null as h41, null as h42, null as h43, tmp.dporawvalor as h44, null as h45, null as h46, null as h47, null as h48, null as h49, null as h50,
      null as h51, null as h52, null as h53, null as h54, null as h55, null as h56, null as h57, null as h58, null as h59, null as h60
      from dpo_estimadorraw_{5} tmp
      where tmp.dporawfecha = to_date('{3} {2}:44','DD/MM/YYYY HH24:MI')
      union
      select tmp.ptomedicodi, tmp.prnvarcodi, tmp.dporawfuente, tmp.dporawtipomedi, tmp.dporawfecha,
      null as h1, null as h2, null as h3, null as h4, null as h5, null as h6, null as h7, null as h8, null as h9, null as h10,
      null as h11, null as h12, null as h13, null as h14, null as h15, null as h16, null as h17, null as h18, null as h19, null as h20,
      null as h21, null as h22, null as h23, null as h24, null as h25, null as h26, null as h27, null as h28, null as h29, null as h30,
      null as h31, null as h32, null as h33, null as h34, null as h35, null as h36, null as h37, null as h38, null as h39, null as h40,
      null as h41, null as h42, null as h43, null as h44, tmp.dporawvalor as h45, null as h46, null as h47, null as h48, null as h49, null as h50,
      null as h51, null as h52, null as h53, null as h54, null as h55, null as h56, null as h57, null as h58, null as h59, null as h60
      from dpo_estimadorraw_{5} tmp
      where tmp.dporawfecha = to_date('{3} {2}:45','DD/MM/YYYY HH24:MI')
      union
      select tmp.ptomedicodi, tmp.prnvarcodi, tmp.dporawfuente, tmp.dporawtipomedi, tmp.dporawfecha,
      null as h1, null as h2, null as h3, null as h4, null as h5, null as h6, null as h7, null as h8, null as h9, null as h10,
      null as h11, null as h12, null as h13, null as h14, null as h15, null as h16, null as h17, null as h18, null as h19, null as h20,
      null as h21, null as h22, null as h23, null as h24, null as h25, null as h26, null as h27, null as h28, null as h29, null as h30,
      null as h31, null as h32, null as h33, null as h34, null as h35, null as h36, null as h37, null as h38, null as h39, null as h40,
      null as h41, null as h42, null as h43, null as h44, null as h45, tmp.dporawvalor as h46, null as h47, null as h48, null as h49, null as h50,
      null as h51, null as h52, null as h53, null as h54, null as h55, null as h56, null as h57, null as h58, null as h59, null as h60
      from dpo_estimadorraw_{5} tmp
      where tmp.dporawfecha = to_date('{3} {2}:46','DD/MM/YYYY HH24:MI')
      union
      select tmp.ptomedicodi, tmp.prnvarcodi, tmp.dporawfuente, tmp.dporawtipomedi, tmp.dporawfecha,
      null as h1, null as h2, null as h3, null as h4, null as h5, null as h6, null as h7, null as h8, null as h9, null as h10,
      null as h11, null as h12, null as h13, null as h14, null as h15, null as h16, null as h17, null as h18, null as h19, null as h20,
      null as h21, null as h22, null as h23, null as h24, null as h25, null as h26, null as h27, null as h28, null as h29, null as h30,
      null as h31, null as h32, null as h33, null as h34, null as h35, null as h36, null as h37, null as h38, null as h39, null as h40,
      null as h41, null as h42, null as h43, null as h44, null as h45, null as h46, tmp.dporawvalor as h47, null as h48, null as h49, null as h50,
      null as h51, null as h52, null as h53, null as h54, null as h55, null as h56, null as h57, null as h58, null as h59, null as h60
      from dpo_estimadorraw_{5} tmp
      where tmp.dporawfecha = to_date('{3} {2}:47','DD/MM/YYYY HH24:MI')
      union
      select tmp.ptomedicodi, tmp.prnvarcodi, tmp.dporawfuente, tmp.dporawtipomedi, tmp.dporawfecha,
      null as h1, null as h2, null as h3, null as h4, null as h5, null as h6, null as h7, null as h8, null as h9, null as h10,
      null as h11, null as h12, null as h13, null as h14, null as h15, null as h16, null as h17, null as h18, null as h19, null as h20,
      null as h21, null as h22, null as h23, null as h24, null as h25, null as h26, null as h27, null as h28, null as h29, null as h30,
      null as h31, null as h32, null as h33, null as h34, null as h35, null as h36, null as h37, null as h38, null as h39, null as h40,
      null as h41, null as h42, null as h43, null as h44, null as h45, null as h46, null as h47, tmp.dporawvalor as h48, null as h49, null as h50,
      null as h51, null as h52, null as h53, null as h54, null as h55, null as h56, null as h57, null as h58, null as h59, null as h60
      from dpo_estimadorraw_{5} tmp
      where tmp.dporawfecha = to_date('{3} {2}:48','DD/MM/YYYY HH24:MI')
      union
      select tmp.ptomedicodi, tmp.prnvarcodi, tmp.dporawfuente, tmp.dporawtipomedi, tmp.dporawfecha,
      null as h1, null as h2, null as h3, null as h4, null as h5, null as h6, null as h7, null as h8, null as h9, null as h10,
      null as h11, null as h12, null as h13, null as h14, null as h15, null as h16, null as h17, null as h18, null as h19, null as h20,
      null as h21, null as h22, null as h23, null as h24, null as h25, null as h26, null as h27, null as h28, null as h29, null as h30,
      null as h31, null as h32, null as h33, null as h34, null as h35, null as h36, null as h37, null as h38, null as h39, null as h40,
      null as h41, null as h42, null as h43, null as h44, null as h45, null as h46, null as h47, null as h48, tmp.dporawvalor as h49, null as h50,
      null as h51, null as h52, null as h53, null as h54, null as h55, null as h56, null as h57, null as h58, null as h59, null as h60
      from dpo_estimadorraw_{5} tmp
      where tmp.dporawfecha = to_date('{3} {2}:49','DD/MM/YYYY HH24:MI')
      union
      select tmp.ptomedicodi, tmp.prnvarcodi, tmp.dporawfuente, tmp.dporawtipomedi, tmp.dporawfecha,
      null as h1, null as h2, null as h3, null as h4, null as h5, null as h6, null as h7, null as h8, null as h9, null as h10,
      null as h11, null as h12, null as h13, null as h14, null as h15, null as h16, null as h17, null as h18, null as h19, null as h20,
      null as h21, null as h22, null as h23, null as h24, null as h25, null as h26, null as h27, null as h28, null as h29, null as h30,
      null as h31, null as h32, null as h33, null as h34, null as h35, null as h36, null as h37, null as h38, null as h39, null as h40,
      null as h41, null as h42, null as h43, null as h44, null as h45, null as h46, null as h47, null as h48, null as h49, tmp.dporawvalor as h50,
      null as h51, null as h52, null as h53, null as h54, null as h55, null as h56, null as h57, null as h58, null as h59, null as h60
      from dpo_estimadorraw_{5} tmp
      where tmp.dporawfecha = to_date('{3} {2}:50','DD/MM/YYYY HH24:MI')
      union
      select tmp.ptomedicodi, tmp.prnvarcodi, tmp.dporawfuente, tmp.dporawtipomedi, tmp.dporawfecha,
      null as h1, null as h2, null as h3, null as h4, null as h5, null as h6, null as h7, null as h8, null as h9, null as h10,
      null as h11, null as h12, null as h13, null as h14, null as h15, null as h16, null as h17, null as h18, null as h19, null as h20,
      null as h21, null as h22, null as h23, null as h24, null as h25, null as h26, null as h27, null as h28, null as h29, null as h30,
      null as h31, null as h32, null as h33, null as h34, null as h35, null as h36, null as h37, null as h38, null as h39, null as h40,
      null as h41, null as h42, null as h43, null as h44, null as h45, null as h46, null as h47, null as h48, null as h49, null as h50,
      tmp.dporawvalor as h51, null as h52, null as h53, null as h54, null as h55, null as h56, null as h57, null as h58, null as h59, null as h60
      from dpo_estimadorraw_{5} tmp
      where tmp.dporawfecha = to_date('{3} {2}:51','DD/MM/YYYY HH24:MI')
      union
      select tmp.ptomedicodi, tmp.prnvarcodi, tmp.dporawfuente, tmp.dporawtipomedi, tmp.dporawfecha,
      null as h1, null as h2, null as h3, null as h4, null as h5, null as h6, null as h7, null as h8, null as h9, null as h10,
      null as h11, null as h12, null as h13, null as h14, null as h15, null as h16, null as h17, null as h18, null as h19, null as h20,
      null as h21, null as h22, null as h23, null as h24, null as h25, null as h26, null as h27, null as h28, null as h29, null as h30,
      null as h31, null as h32, null as h33, null as h34, null as h35, null as h36, null as h37, null as h38, null as h39, null as h40,
      null as h41, null as h42, null as h43, null as h44, null as h45, null as h46, null as h47, null as h48, null as h49, null as h50,
      null as h51, tmp.dporawvalor as h52, null as h53, null as h54, null as h55, null as h56, null as h57, null as h58, null as h59, null as h60
      from dpo_estimadorraw_{5} tmp
      where tmp.dporawfecha = to_date('{3} {2}:52','DD/MM/YYYY HH24:MI')
      union
      select tmp.ptomedicodi, tmp.prnvarcodi, tmp.dporawfuente, tmp.dporawtipomedi, tmp.dporawfecha,
      null as h1, null as h2, null as h3, null as h4, null as h5, null as h6, null as h7, null as h8, null as h9, null as h10,
      null as h11, null as h12, null as h13, null as h14, null as h15, null as h16, null as h17, null as h18, null as h19, null as h20,
      null as h21, null as h22, null as h23, null as h24, null as h25, null as h26, null as h27, null as h28, null as h29, null as h30,
      null as h31, null as h32, null as h33, null as h34, null as h35, null as h36, null as h37, null as h38, null as h39, null as h40,
      null as h41, null as h42, null as h43, null as h44, null as h45, null as h46, null as h47, null as h48, null as h49, null as h50,
      null as h51, null as h52, tmp.dporawvalor as h53, null as h54, null as h55, null as h56, null as h57, null as h58, null as h59, null as h60
      from dpo_estimadorraw_{5} tmp
      where tmp.dporawfecha = to_date('{3} {2}:53','DD/MM/YYYY HH24:MI')
      union
      select tmp.ptomedicodi, tmp.prnvarcodi, tmp.dporawfuente, tmp.dporawtipomedi, tmp.dporawfecha,
      null as h1, null as h2, null as h3, null as h4, null as h5, null as h6, null as h7, null as h8, null as h9, null as h10,
      null as h11, null as h12, null as h13, null as h14, null as h15, null as h16, null as h17, null as h18, null as h19, null as h20,
      null as h21, null as h22, null as h23, null as h24, null as h25, null as h26, null as h27, null as h28, null as h29, null as h30,
      null as h31, null as h32, null as h33, null as h34, null as h35, null as h36, null as h37, null as h38, null as h39, null as h40,
      null as h41, null as h42, null as h43, null as h44, null as h45, null as h46, null as h47, null as h48, null as h49, null as h50,
      null as h51, null as h52, null as h53, tmp.dporawvalor as h54, null as h55, null as h56, null as h57, null as h58, null as h59, null as h60
      from dpo_estimadorraw_{5} tmp
      where tmp.dporawfecha = to_date('{3} {2}:54','DD/MM/YYYY HH24:MI')
      union
      select tmp.ptomedicodi, tmp.prnvarcodi, tmp.dporawfuente, tmp.dporawtipomedi, tmp.dporawfecha,
      null as h1, null as h2, null as h3, null as h4, null as h5, null as h6, null as h7, null as h8, null as h9, null as h10,
      null as h11, null as h12, null as h13, null as h14, null as h15, null as h16, null as h17, null as h18, null as h19, null as h20,
      null as h21, null as h22, null as h23, null as h24, null as h25, null as h26, null as h27, null as h28, null as h29, null as h30,
      null as h31, null as h32, null as h33, null as h34, null as h35, null as h36, null as h37, null as h38, null as h39, null as h40,
      null as h41, null as h42, null as h43, null as h44, null as h45, null as h46, null as h47, null as h48, null as h49, null as h50,
      null as h51, null as h52, null as h53, null as h54, tmp.dporawvalor as h55, null as h56, null as h57, null as h58, null as h59, null as h60
      from dpo_estimadorraw_{5} tmp
      where tmp.dporawfecha = to_date('{3} {2}:55','DD/MM/YYYY HH24:MI')
      union
      select tmp.ptomedicodi, tmp.prnvarcodi, tmp.dporawfuente, tmp.dporawtipomedi, tmp.dporawfecha,
      null as h1, null as h2, null as h3, null as h4, null as h5, null as h6, null as h7, null as h8, null as h9, null as h10,
      null as h11, null as h12, null as h13, null as h14, null as h15, null as h16, null as h17, null as h18, null as h19, null as h20,
      null as h21, null as h22, null as h23, null as h24, null as h25, null as h26, null as h27, null as h28, null as h29, null as h30,
      null as h31, null as h32, null as h33, null as h34, null as h35, null as h36, null as h37, null as h38, null as h39, null as h40,
      null as h41, null as h42, null as h43, null as h44, null as h45, null as h46, null as h47, null as h48, null as h49, null as h50,
      null as h51, null as h52, null as h53, null as h54, null as h55, tmp.dporawvalor as h56, null as h57, null as h58, null as h59, null as h60
      from dpo_estimadorraw_{5} tmp
      where tmp.dporawfecha = to_date('{3} {2}:56','DD/MM/YYYY HH24:MI')
      union
      select tmp.ptomedicodi, tmp.prnvarcodi, tmp.dporawfuente, tmp.dporawtipomedi, tmp.dporawfecha,
      null as h1, null as h2, null as h3, null as h4, null as h5, null as h6, null as h7, null as h8, null as h9, null as h10,
      null as h11, null as h12, null as h13, null as h14, null as h15, null as h16, null as h17, null as h18, null as h19, null as h20,
      null as h21, null as h22, null as h23, null as h24, null as h25, null as h26, null as h27, null as h28, null as h29, null as h30,
      null as h31, null as h32, null as h33, null as h34, null as h35, null as h36, null as h37, null as h38, null as h39, null as h40,
      null as h41, null as h42, null as h43, null as h44, null as h45, null as h46, null as h47, null as h48, null as h49, null as h50,
      null as h51, null as h52, null as h53, null as h54, null as h55, null as h56, tmp.dporawvalor as h57, null as h58, null as h59, null as h60
      from dpo_estimadorraw_{5} tmp
      where tmp.dporawfecha = to_date('{3} {2}:57','DD/MM/YYYY HH24:MI')
      union
      select tmp.ptomedicodi, tmp.prnvarcodi, tmp.dporawfuente, tmp.dporawtipomedi, tmp.dporawfecha,
      null as h1, null as h2, null as h3, null as h4, null as h5, null as h6, null as h7, null as h8, null as h9, null as h10,
      null as h11, null as h12, null as h13, null as h14, null as h15, null as h16, null as h17, null as h18, null as h19, null as h20,
      null as h21, null as h22, null as h23, null as h24, null as h25, null as h26, null as h27, null as h28, null as h29, null as h30,
      null as h31, null as h32, null as h33, null as h34, null as h35, null as h36, null as h37, null as h38, null as h39, null as h40,
      null as h41, null as h42, null as h43, null as h44, null as h45, null as h46, null as h47, null as h48, null as h49, null as h50,
      null as h51, null as h52, null as h53, null as h54, null as h55, null as h56, null as h57, tmp.dporawvalor as h58, null as h59, null as h60
      from dpo_estimadorraw_{5} tmp
      where tmp.dporawfecha = to_date('{3} {2}:58','DD/MM/YYYY HH24:MI')
      union
      select tmp.ptomedicodi, tmp.prnvarcodi, tmp.dporawfuente, tmp.dporawtipomedi, tmp.dporawfecha,
      null as h1, null as h2, null as h3, null as h4, null as h5, null as h6, null as h7, null as h8, null as h9, null as h10,
      null as h11, null as h12, null as h13, null as h14, null as h15, null as h16, null as h17, null as h18, null as h19, null as h20,
      null as h21, null as h22, null as h23, null as h24, null as h25, null as h26, null as h27, null as h28, null as h29, null as h30,
      null as h31, null as h32, null as h33, null as h34, null as h35, null as h36, null as h37, null as h38, null as h39, null as h40,
      null as h41, null as h42, null as h43, null as h44, null as h45, null as h46, null as h47, null as h48, null as h49, null as h50,
      null as h51, null as h52, null as h53, null as h54, null as h55, null as h56, null as h57, null as h58, tmp.dporawvalor as h59, null as h60
      from dpo_estimadorraw_{5} tmp
      where tmp.dporawfecha = to_date('{3} {2}:59','DD/MM/YYYY HH24:MI')
      union
      select tmp.ptomedicodi, tmp.prnvarcodi, tmp.dporawfuente, tmp.dporawtipomedi, tmp.dporawfecha,
      null as h1, null as h2, null as h3, null as h4, null as h5, null as h6, null as h7, null as h8, null as h9, null as h10,
      null as h11, null as h12, null as h13, null as h14, null as h15, null as h16, null as h17, null as h18, null as h19, null as h20,
      null as h21, null as h22, null as h23, null as h24, null as h25, null as h26, null as h27, null as h28, null as h29, null as h30,
      null as h31, null as h32, null as h33, null as h34, null as h35, null as h36, null as h37, null as h38, null as h39, null as h40,
      null as h41, null as h42, null as h43, null as h44, null as h45, null as h46, null as h47, null as h48, null as h49, null as h50,
      null as h51, null as h52, null as h53, null as h54, null as h55, null as h56, null as h57, null as h58, null as h59, tmp.dporawvalor as h60
      from dpo_estimadorraw_{5} tmp
      where tmp.dporawfecha = to_date('{4}','DD/MM/YYYY HH24:MI')
      ) t2
      group by ptomedicodi, prnvarcodi, dporawfuente, dporawtipomedi
      /* order by ptomedicodi, prnvarcodi, dporawfuente, dporawtipomedi */
    </query>
  </Sql>

  <Sql>
    <key>ListFileRawTmp</key>
    <query>
      select
      ptomedicodi,
      prnvarcodi,
      dporawfuente,
      dporawtipomedi,
      dporawfecha,
      dporawvalor
      from dpo_estimadorraw_tmp
    </query>
  </Sql>

  <Sql>
    <key>InsertLogRaw</key>
    <query>
      insert into dpo_estimadorraw_log(
      nomarchivoraw,
      fechaarchivoraw,
      tipo
      )
      values(
      :nomarchivoraw,
      :fechaarchivoraw,
      :tipo
      )
    </query>
  </Sql>

  <Sql>
    <key>DeleteLogRaw</key>
    <query>
      delete from dpo_estimadorraw_log
      where
      nomarchivoraw = :nomarchivoraw and
      fechaarchivoraw = :fechaarchivoraw
    </query>
  </Sql>

  <Sql>
    <key>ListFilesLogRaw</key>
    <query>
      select nomarchivoraw, fechaarchivoraw, tipo from dpo_estimadorraw_log
      where tipo = {0}
      and fechaarchivoraw BETWEEN (TO_DATE('{1}', 'DD/MM/YYYY HH24:MI') - 1) AND TO_DATE('{1}', 'DD/MM/YYYY HH24:MI')
      group by nomarchivoraw, fechaarchivoraw, tipo
      order by nomarchivoraw
    </query>
  </Sql>

  <Sql>
    <key>ListFilesLogRawHora</key>
    <query>
      select nomarchivoraw, fechaarchivoraw, tipo from DPO_ESTIMADORRAW_FILES
      where tipo = {0} and flag = 0
      and fechaarchivoraw BETWEEN to_date('{1}', 'DD/MM/YYYY HH24:MI') and to_date('{2}', 'DD/MM/YYYY HH24:MI')
      group by nomarchivoraw, fechaarchivoraw, tipo
      union
      select nomarchivoraw, fechaarchivoraw, tipo from dpo_estimadorraw_log
      where tipo = {0} and fechaarchivoraw BETWEEN TO_DATE('{1}', 'DD/MM/YYYY HH24:MI') AND TO_DATE('{2}', 'DD/MM/YYYY HH24:MI')
      group by nomarchivoraw, fechaarchivoraw, tipo
      order by nomarchivoraw
    </query>
  </Sql>

  <Sql>
    <key>GetFileLogRaw</key>
    <query>
      select * from dpo_estimadorraw_log
      where
      nomarchivoraw = '{0}' and
      fechaarchivoraw = TO_DATE('{1}', 'DD/MM/YYYY HH24:MI')
    </query>
  </Sql>

  <!--No se esta usando esta consulta GetByIdFileRaw-->
  <Sql>
    <key>GetByIdFileRaw</key>
    <query>
      select
      ptomedicodi,
      prnvarcodi,
      dporawfuente,
      dporawtipomedi,
      dporawfecha,
      dporawvalor
      from dpo_estimadorraw
      where
      ptomedicodi = {0} and
      prnvarcodi = :{1} and
      dporawfuente = {2} and
      dporawtipomedi = {3} and
      dporawfecha = TO_DATE('{4}', 'DD/MM/YYYY HH24:MI')
    </query>
  </Sql>

  <Sql>
    <key>UpdateRawsProcesadosHora</key>
    <query>
      MERGE INTO dpo_estimadorraw_{0} er USING dpo_estimadorraw_tmp temp
      ON (er.ptomedicodi=temp.ptomedicodi and
      er.prnvarcodi=temp.prnvarcodi and
      er.dporawfuente=temp.dporawfuente and
      er.dporawtipomedi=temp.dporawtipomedi and
      er.dporawfecha = TO_DATE(TO_CHAR(temp.dporawfecha, 'DD/MM/YYYY HH24'),'DD/MM/YYYY HH24'))
      WHEN MATCHED THEN
      UPDATE SET
      {1} = temp.dporawvalor
    </query>
  </Sql>

  <Sql>
    <key>InsertFileRaw</key>
    <query>
      insert into dpo_estimadorraw_files(
      nomarchivoraw,
      fechaarchivoraw,
      tipo,
      flag
      )
      values(
      :nomarchivoraw,
      :fechaarchivoraw,
      :tipo,
      :flag
      )
    </query>
  </Sql>

  <Sql>
    <key>UpdateFileRaw</key>
    <query>
      update dpo_estimadorraw_files
      set
      tipo = :tipo,
      flag = :flag
      where
      nomarchivoraw = :nomarchivoraw and
      fechaarchivoraw = :fechaarchivoraw
    </query>
  </Sql>

  <Sql>
    <key>ListFilesRaw</key>
    <query>
      select nomarchivoraw, fechaarchivoraw, flag, tipo
      from dpo_estimadorraw_files
      where tipo = {0} and fechaarchivoraw BETWEEN TO_DATE('{1}', 'DD/MM/YYYY HH24:MI') AND TO_DATE('{2}', 'DD/MM/YYYY HH24:MI')
      group by nomarchivoraw, fechaarchivoraw, flag, tipo
      order by nomarchivoraw
    </query>
  </Sql>

  <Sql>
    <key>UpdateRawsProcesados30Minutos</key>
    <query>
      MERGE INTO dpo_estimadorraw_{0} er
      USING (select * from dpo_estimadorraw_cmtmp
      where dporawfecha BETWEEN to_date('{1} 00:30', 'DD/MM/YYYY HH24:MI') and to_date('{1} 23:30', 'DD/MM/YYYY HH24:MI')
      and TO_CHAR(dporawfecha, 'MI') = '30') temp
      ON (er.ptomedicodi=temp.ptomedicodi and
      er.prnvarcodi=temp.prnvarcodi and
      er.dporawfuente=temp.dporawfuente and
      er.dporawtipomedi=temp.dporawtipomedi and
      er.dporawfecha = TO_DATE(TO_CHAR(temp.dporawfecha, 'DD/MM/YYYY HH24'),'DD/MM/YYYY HH24'))
      WHEN MATCHED THEN
      UPDATE SET dporawvalorh30 = temp.dporawvalor
    </query>
  </Sql>

  <Sql>
    <key>UpdateRawsProcesados60Minutos</key>
    <query>
      MERGE INTO dpo_estimadorraw_{0} er
      USING (select ptomedicodi, prnvarcodi, dporawfuente, dporawtipomedi, (dporawfecha - INTERVAL '1' HOUR) AS dporawfecha, dporawvalor
      from dpo_estimadorraw_cmtmp
      where dporawfecha BETWEEN to_date('{1} 01:00', 'DD/MM/YYYY HH24:MI') and to_date('{2} 00:00', 'DD/MM/YYYY HH24:MI')
      and TO_CHAR(dporawfecha, 'MI') = '00') temp
      ON (er.ptomedicodi=temp.ptomedicodi and
      er.prnvarcodi=temp.prnvarcodi and
      er.dporawfuente=temp.dporawfuente and
      er.dporawtipomedi=temp.dporawtipomedi and
      er.dporawfecha = TO_DATE(TO_CHAR(temp.dporawfecha, 'DD/MM/YYYY HH24'),'DD/MM/YYYY HH24'))
      WHEN MATCHED THEN
      UPDATE SET dporawvalorh60 = temp.dporawvalor
    </query>
  </Sql>

  <Sql>
    <key>ListEstimadorRawManual</key>
    <query>
      select
      ptomedicodi,
      prnvarcodi,
      dporawfuente,
      dporawtipomedi,
      dporawfecha,
      dporawvalor
      from dpo_estimadorraw_manual
    </query>
  </Sql>

  <Sql>
    <key>ListEstimadorRawManualHora</key>
    <query>
      select to_char(dporawfecha, 'HH24') Hora
      from dpo_estimadorraw_manual
      group by TO_CHAR(dporawfecha, 'HH24')
      order by TO_CHAR(dporawfecha, 'HH24')
    </query>
  </Sql>

  <Sql>
    <key>ListEstimadorRawManualMinuto</key>
    <query>
      select TO_CHAR(dporawfecha, 'MI') Minuto
      from dpo_estimadorraw_manual
      group by TO_CHAR(dporawfecha, 'MI')
      order by TO_CHAR(dporawfecha, 'MI')
    </query>
  </Sql>

  <Sql>
    <key>UpdateRawManual</key>
    <query>
      MERGE INTO dpo_estimadorraw_{0} er USING dpo_estimadorraw_manual temp
      ON (er.ptomedicodi=temp.ptomedicodi and
      er.prnvarcodi=temp.prnvarcodi and
      er.dporawfuente=temp.dporawfuente and
      er.dporawtipomedi=temp.dporawtipomedi and
      er.dporawfecha = to_date(to_char(temp.dporawfecha, 'DD/MM/YYYY HH24'), 'DD/MM/YYYY HH24')
      )
      WHEN MATCHED THEN
      UPDATE SET
      {3} = temp.dporawvalor
      where temp.dporawfecha = TO_DATE('{1}','DD/MM/YYYY HH24:MI')
    </query>
  </Sql>

  <Sql>
    <key>ListFilesRawPorMinuto</key>
    <query>
      select * from dpo_estimadorraw_files
      where tipo = '1' and flag = '0'
      order by nomarchivoraw
    </query>
  </Sql>

  <Sql>
    <key>ListFilesRawIeod</key>
    <query>
      select * from dpo_estimadorraw_files
      where tipo = '2' and flag = '0'
      order by nomarchivoraw
    </query>
  </Sql>

  <Sql>
    <key>DeleteREstimadorRawFileByDiaProceso</key>
    <query>
      delete from dpo_estimadorraw_files
      where tipo = {0} and fechaarchivoraw BETWEEN TO_DATE('{1}', 'DD/MM/YYYY HH24:MI') AND TO_DATE('{2}', 'DD/MM/YYYY HH24:MI')
    </query>
  </Sql>

  <Sql>
    <key>DeleteREstimadorRawLogByDiaProceso</key>
    <query>
      delete from dpo_estimadorraw_log
      where tipo = {0} and fechaarchivoraw BETWEEN TO_DATE('{1}', 'DD/MM/YYYY HH24:MI') AND TO_DATE('{2}', 'DD/MM/YYYY HH24:MI')
    </query>
  </Sql>

  <Sql>
    <key>DeleteREstimadorRawTemporalByDiaProceso</key>
    <query>
      delete from dpo_estimadorraw_tmp
      where dporawfecha BETWEEN TO_DATE('{0}', 'DD/MM/YYYY HH24:MI') AND TO_DATE('{1}', 'DD/MM/YYYY HH24:MI')
    </query>
  </Sql>

  <Sql>
    <key>DeleteREstimadorRawCmTemporalByDiaProceso</key>
    <query>
      delete from dpo_estimadorraw_cmtmp
      where dporawfecha BETWEEN TO_DATE('{0}', 'DD/MM/YYYY HH24:MI') AND TO_DATE('{1}', 'DD/MM/YYYY HH24:MI')
    </query>
  </Sql>

  <Sql>
    <key>DeleteREstimadorRawByDiaProceso</key>
    <query>
      delete from dpo_estimadorraw_{0}
      where dporawfecha BETWEEN TO_DATE('{1}', 'DD/MM/YYYY HH24:MI') AND TO_DATE('{2}', 'DD/MM/YYYY HH24:MI')
    </query>
  </Sql>

  <Sql>
    <key>DeleteREstimadorRawFileByNomArchivo</key>
    <query>
      delete from dpo_estimadorraw_files
      where nomarchivoraw = '{0}' AND tipo = {1}
    </query>
  </Sql>

  <!--El SQl no se esta usando ObtenerPorRangoFuente-->
  <!--<Sql>
		<key>ObtenerPorRangoFuente</key>
		<query>
			select
			ptomedicodi,
			prnvarcodi,
			dporawfuente,
			dporawtipomedi,
			dporawfecha,
			dporawvalorh1,
			dporawvalorh2,
			dporawvalorh3,
			dporawvalorh4,
			dporawvalorh5,
			dporawvalorh6,
			dporawvalorh7,
			dporawvalorh8,
			dporawvalorh9,
			dporawvalorh10,
			dporawvalorh11,
			dporawvalorh12,
			dporawvalorh13,
			dporawvalorh14,
			dporawvalorh15,
			dporawvalorh16,
			dporawvalorh17,
			dporawvalorh18,
			dporawvalorh19,
			dporawvalorh20,
			dporawvalorh21,
			dporawvalorh22,
			dporawvalorh23,
			dporawvalorh24,
			dporawvalorh25,
			dporawvalorh26,
			dporawvalorh27,
			dporawvalorh28,
			dporawvalorh29,
			dporawvalorh30,
			dporawvalorh31,
			dporawvalorh32,
			dporawvalorh33,
			dporawvalorh34,
			dporawvalorh35,
			dporawvalorh36,
			dporawvalorh37,
			dporawvalorh38,
			dporawvalorh39,
			dporawvalorh40,
			dporawvalorh41,
			dporawvalorh42,
			dporawvalorh43,
			dporawvalorh44,
			dporawvalorh45,
			dporawvalorh46,
			dporawvalorh47,
			dporawvalorh48,
			dporawvalorh49,
			dporawvalorh50,
			dporawvalorh51,
			dporawvalorh52,
			dporawvalorh53,
			dporawvalorh54,
			dporawvalorh55,
			dporawvalorh56,
			dporawvalorh57,
			dporawvalorh58,
			dporawvalorh59,
			dporawvalorh60
			from dpo_estimadorraw
			where
			dporawfuente = {0} and
			dporawfecha between
			to_date('{1}', 'DD/MM/YYYY') and to_date('{2}', 'DD/MM/YYYY')
		</query>
	</Sql>-->

  <Sql>
    <key>DatosPorPtoMedicion</key>
    <query>
      select
      ptomedicodi,
      prnvarcodi,
      dporawfuente,
      dporawtipomedi,
      dporawfecha,
      dporawvalorh1,
      dporawvalorh2,
      dporawvalorh3,
      dporawvalorh4,
      dporawvalorh5,
      dporawvalorh6,
      dporawvalorh7,
      dporawvalorh8,
      dporawvalorh9,
      dporawvalorh10,
      dporawvalorh11,
      dporawvalorh12,
      dporawvalorh13,
      dporawvalorh14,
      dporawvalorh15,
      dporawvalorh16,
      dporawvalorh17,
      dporawvalorh18,
      dporawvalorh19,
      dporawvalorh20,
      dporawvalorh21,
      dporawvalorh22,
      dporawvalorh23,
      dporawvalorh24,
      dporawvalorh25,
      dporawvalorh26,
      dporawvalorh27,
      dporawvalorh28,
      dporawvalorh29,
      dporawvalorh30,
      dporawvalorh31,
      dporawvalorh32,
      dporawvalorh33,
      dporawvalorh34,
      dporawvalorh35,
      dporawvalorh36,
      dporawvalorh37,
      dporawvalorh38,
      dporawvalorh39,
      dporawvalorh40,
      dporawvalorh41,
      dporawvalorh42,
      dporawvalorh43,
      dporawvalorh44,
      dporawvalorh45,
      dporawvalorh46,
      dporawvalorh47,
      dporawvalorh48,
      dporawvalorh49,
      dporawvalorh50,
      dporawvalorh51,
      dporawvalorh52,
      dporawvalorh53,
      dporawvalorh54,
      dporawvalorh55,
      dporawvalorh56,
      dporawvalorh57,
      dporawvalorh58,
      dporawvalorh59,
      dporawvalorh60
      from {0}
      where
      dporawfuente = {1} and
      ptomedicodi = {2}
    </query>
  </Sql>

  <Sql>
    <key>ObtenerPorRangoFuente</key>
    <query>
      select
      ptomedicodi,
      prnvarcodi,
      dporawfuente,
      dporawtipomedi,
      dporawfecha,
      dporawvalorh1,
      dporawvalorh2,
      dporawvalorh3,
      dporawvalorh4,
      dporawvalorh5,
      dporawvalorh6,
      dporawvalorh7,
      dporawvalorh8,
      dporawvalorh9,
      dporawvalorh10,
      dporawvalorh11,
      dporawvalorh12,
      dporawvalorh13,
      dporawvalorh14,
      dporawvalorh15,
      dporawvalorh16,
      dporawvalorh17,
      dporawvalorh18,
      dporawvalorh19,
      dporawvalorh20,
      dporawvalorh21,
      dporawvalorh22,
      dporawvalorh23,
      dporawvalorh24,
      dporawvalorh25,
      dporawvalorh26,
      dporawvalorh27,
      dporawvalorh28,
      dporawvalorh29,
      dporawvalorh30,
      dporawvalorh31,
      dporawvalorh32,
      dporawvalorh33,
      dporawvalorh34,
      dporawvalorh35,
      dporawvalorh36,
      dporawvalorh37,
      dporawvalorh38,
      dporawvalorh39,
      dporawvalorh40,
      dporawvalorh41,
      dporawvalorh42,
      dporawvalorh43,
      dporawvalorh44,
      dporawvalorh45,
      dporawvalorh46,
      dporawvalorh47,
      dporawvalorh48,
      dporawvalorh49,
      dporawvalorh50,
      dporawvalorh51,
      dporawvalorh52,
      dporawvalorh53,
      dporawvalorh54,
      dporawvalorh55,
      dporawvalorh56,
      dporawvalorh57,
      dporawvalorh58,
      dporawvalorh59,
      dporawvalorh60
      from dpo_estimadorraw
      where
      dporawfuente = {0} and
      dporawfecha between
      to_date('{1}', 'DD/MM/YYYY') and to_date('{2}', 'DD/MM/YYYY')
    </query>
  </Sql>

  <Sql>
    <key>ObtenerUltimoEstimadorRawFiles</key>
    <query>
      select * from dpo_estimadorraw_files
      where fechaarchivoraw = (select max(fechaarchivoraw) from dpo_estimadorraw_files where tipo = 1)
      and tipo = 1
      order by fechaarchivoraw desc
    </query>
  </Sql>

  <!--<Sql>
    <key>DeleteEstimadorRawTemporal</key>
    <query>
      truncate table {0}
    </query>
  </Sql>-->

  <Sql>
    <key>UpdateTMP</key>
    <query>
      alter index {0} rebuild
    </query>
  </Sql>

  <Sql>
    <key>ObtenerEstimadorRawFilesFlag</key>
    <query>
      select * from dpo_estimadorraw_files where flag = 2
    </query>
  </Sql>

  <Sql>
    <key>VerificarFaltantesDia</key>
    <query>
      SELECT to_date('{0}', 'DD/MM/YYYY') + (LEVEL-1)/24 as dporawfecha
      FROM DUAL
      CONNECT BY LEVEL &lt;= 24
      MINUS
      select dporawfecha from dpo_estimadorraw_{1}
      where to_char(dporawfecha, 'DD/MM/YYYY') = '{0}'
      group by dporawfecha
      order by dporawfecha
    </query>
  </Sql>

	<Sql>
		<key>ObtenerDemActivaPorDia</key>
		<query>
			select
			est.ptomedicodi,
			pto2.ptomedicodi ieod,
			est.prnvarcodi,
			est.dporawfuente,
			est.dporawtipomedi,
			est.dporawfecha,
			est.dporawvalorh1,
			est.dporawvalorh2,
			est.dporawvalorh3,
			est.dporawvalorh4,
			est.dporawvalorh5,
			est.dporawvalorh6,
			est.dporawvalorh7,
			est.dporawvalorh8,
			est.dporawvalorh9,
			est.dporawvalorh10,
			est.dporawvalorh11,
			est.dporawvalorh12,
			est.dporawvalorh13,
			est.dporawvalorh14,
			est.dporawvalorh15,
			est.dporawvalorh16,
			est.dporawvalorh17,
			est.dporawvalorh18,
			est.dporawvalorh19,
			est.dporawvalorh20,
			est.dporawvalorh21,
			est.dporawvalorh22,
			est.dporawvalorh23,
			est.dporawvalorh24,
			est.dporawvalorh25,
			est.dporawvalorh26,
			est.dporawvalorh27,
			est.dporawvalorh28,
			est.dporawvalorh29,
			est.dporawvalorh30,
			est.dporawvalorh31,
			est.dporawvalorh32,
			est.dporawvalorh33,
			est.dporawvalorh34,
			est.dporawvalorh35,
			est.dporawvalorh36,
			est.dporawvalorh37,
			est.dporawvalorh38,
			est.dporawvalorh39,
			est.dporawvalorh40,
			est.dporawvalorh41,
			est.dporawvalorh42,
			est.dporawvalorh43,
			est.dporawvalorh44,
			est.dporawvalorh45,
			est.dporawvalorh46,
			est.dporawvalorh47,
			est.dporawvalorh48,
			est.dporawvalorh49,
			est.dporawvalorh50,
			est.dporawvalorh51,
			est.dporawvalorh52,
			est.dporawvalorh53,
			est.dporawvalorh54,
			est.dporawvalorh55,
			est.dporawvalorh56,
			est.dporawvalorh57,
			est.dporawvalorh58,
			est.dporawvalorh59,
			est.dporawvalorh60
			from
			{0} est
			join me_ptomedicion pto1 on est.ptomedicodi = pto1.ptomedicodi
			and (pto1.origlectcodi = 36)
			join me_ptomedicion pto2 on pto1.ptomedidesc = pto2.ptomedidesc
			and (pto2.origlectcodi = 37)
			where
			est.dporawfuente = {1} and
			est.prnvarcodi in({3}) and
			est.dporawfecha between to_date('{4}', 'DD/MM/YYYY') and to_date('{5}', 'DD/MM/YYYY') and
			pto2.ptomedicodi in ({2})
		</query>
	</Sql>
	
	<Sql>
		<key>ReporteDatosEstimadorxHora</key>
		<query>
			select
			(select p.ptomedidesc from me_ptomedicion p where dpo.ptomedicodi = p.ptomedicodi) as ptomedidesc,
			(select v.prnvarnom from prn_variable v where dpo.prnvarcodi = v.prnvarcodi) as prnvarnom,
			dpo.*
			from {0} dpo
			where dporawfecha BETWEEN to_date('{1}', 'DD/MM/YYYY HH24:MI') and to_date('{2}', 'DD/MM/YYYY HH24:MI')
			and dporawtipomedi = {3}
			order by dporawfecha desc, ptomedicodi, prnvarcodi asc
		</query>
	</Sql>
  <!--ASSETEC: 20240610-->
  <Sql>
    <key>GetFileRaw</key>
    <query>
      select * from dpo_estimadorraw_files
      where nomarchivoraw = '{0}' 
    </query>
  </Sql>
</Sqls>