<?xml version="1.0" encoding="utf-8" ?>
<Sqls>

	<Sql>
		<key>GetMaxId</key>
		<query>
			select nvl(max(equicodi), 0) + 1 from eq_equipo
		</query>
	</Sql>

	<Sql>
		<key>Save</key>
		<query>
			insert into eq_equipo(
			equicodi,
			emprcodi,
			grupocodi,
			elecodi,
			areacodi,
			famcodi,
			equiabrev,
			equinomb,
			equiabrev2,
			equitension,
			equipadre,
			equipot,
			lastuser,
			lastdate,
			ecodigo,
			equiestado,
			lastcodi,
			equifechiniopcom,
			equifechfinopcom,
			equimaniobra,
			osinergcodi,
			operadoremprcodi
			)
			values(
			:equicodi,
			:emprcodi,
			:grupocodi,
			:elecodi,
			:areacodi,
			:famcodi,
			:equiabrev,
			:equinomb,
			:equiabrev2,
			:equitension,
			:equipadre,
			:equipot,
			:lastuser,
			SYSDATE,
			:ecodigo,
			:equiestado,
			:lastcodi,
			:equifechiniopcom,
			:equifechfinopcom,
			:equimaniobra,
			:osinergcodi,
			:operadoremprcodi
			)
		</query>
	</Sql>

	<Sql>
		<key>Update</key>
		<query>
			update eq_equipo
			set
			emprcodi = :emprcodi,
			grupocodi = :grupocodi,
			elecodi = :elecodi,
			areacodi = :areacodi,
			famcodi = :famcodi,
			equiabrev = :equiabrev,
			equinomb = :equinomb,
			equiabrev2 = :equiabrev2,
			equitension = :equitension,
			equipadre = :equipadre,
			equipot = :equipot,
			ecodigo = :ecodigo,
			equiestado = :equiestado,
			osinergcodi = :Osinergcodi,
			osinergcodigen = :OsinergcodiGen,				<!--ticket-6068-->
			lastcodi = :lastcodi,
			equifechiniopcom = :equifechiniopcom,
			equifechfinopcom = :equifechfinopcom,
			equimaniobra=:equimaniobra,
			usuarioupdate=:usuarioupdate,
			fechaupdate=SYSDATE,
			operadoremprcodi =:operadoremprcodi
			where
			equicodi = :equicodi
		</query>
	</Sql>

	<Sql>
		<key>Delete</key>
		<query>
			delete from eq_equipo
			where
			equicodi = :equicodi
		</query>
	</Sql>

	<Sql>
		<key>UpdateAuditoria</key>
		<query>
			update aud_eq_equipo
			set USERAUDITORIA = :usuarioupdate
			where
			equicodi = :equicodi
			and ACTIONAUDITORIA = 'DELETE'
		</query>
	</Sql>

	<Sql>
		<key>GetByIdEquipo</key>
		<query>
			select *
			from eq_equipo
			where equicodi= {0}
		</query>
	</Sql>

  <Sql>
    <key>ListByIdEquipo</key>
    <query>
      select fu.tgenercodi,pr.fenergcodi,pr.grupotipocogen,fu.fenergnomb,
      emp.emprnomb,
      a.areanomb,
      fam.famabrev,
      eq.*
      from eq_equipo eq
      left join eq_familia fam on fam.famcodi = eq.famcodi
      left join pr_grupo pr on eq.grupocodi=pr.grupocodi
      left join si_fuenteenergia fu on fu.fenergcodi=pr.fenergcodi
      left join si_empresa emp on emp.emprcodi=eq.emprcodi
      left join eq_area a on a.areacodi=eq.areacodi
      where eq.equicodi in ({0})
    </query>
  </Sql>
	
	<Sql>
		<key>GetById</key>
		<query>
			select
			eq_equipo.equicodi,
			eq_equipo.emprcodi,
			eq_equipo.grupocodi,
			eq_equipo.elecodi,
			eq_equipo.areacodi,
			eq_equipo.famcodi,
			eq_equipo.equiabrev,
			eq_equipo.equinomb,
			eq_equipo.equiabrev2,
			eq_equipo.equitension,
			eq_equipo.equipadre,
			eq_equipo.equipot,
			eq_equipo.lastuser,
			eq_equipo.lastdate,
			eq_equipo.ecodigo,
			eq_equipo.equiestado,
			eq_equipo.osinergcodi,
			eq_equipo.osinergcodigen,				<!--ticket-6068-->
			eq_equipo.operadoremprcodi,
			eq_equipo.lastcodi,
			eq_equipo.equifechiniopcom,
			eq_equipo.equifechfinopcom,
			emp.emprnomb,
			fam.famnomb,
			fam.famabrev,
			a.areanomb,
			ta.tareaabrev,
			eq_equipo.usuarioupdate,
			eq_equipo.fechaupdate,
			eq_equipo.equimaniobra
			from
			eq_equipo
			inner join si_empresa emp on emp.emprcodi=eq_equipo.emprcodi
			inner join eq_familia fam on fam.famcodi=eq_equipo.famcodi
			inner join eq_area a on a.areacodi=eq_equipo.areacodi
			inner join eq_tipoarea ta on a.tareacodi = ta.tareacodi
			where
			equicodi = :equicodi
		</query>
	</Sql>

	<Sql>
		<key>List</key>
		<query>
			select * from eq_equipo
		</query>
	</Sql>
	<Sql>
		<key>GetBasicList</key>
		<query>
			select equicodi, equiabrev, equinomb, famcodi, areacodi, emprcodi, equiestado from eq_equipo
			where famcodi not in (26,27,28,30,31,32,43,44,45,46) and equiestado not in ('X')
			and equicodi>0 and areacodi>0 and famcodi>0 and emprcodi>1
			order by emprcodi,famcodi,areacodi
		</query>
	</Sql>
	<Sql>
		<key>GetByCriteria</key>
		<query>
			select
			*
			from
			eq_equipo a
			inner join eq_area ar on ar.areacodi = a.areacodi
			where
			a.emprcodi = :emprcodi and
			a.famcodi = :famcodi
		</query>
	</Sql>

	<Sql>
		<key>GetByEmprFamCentral</key>
		<query>
      select
      *
      from
      eq_equipo a
      inner join eq_area ar on ar.areacodi = a.areacodi
      where
      ('-2' = '{0}' or a.emprcodi = {0})
      and ('-2' = '{1}' or a.famcodi = {1})
      and ('-2' = '{2}' or a.equipadre = {2})
      and a.equiestado in ('A','P')
      order by a.equinomb
    </query>
	</Sql>
	
	<Sql>
		<key>ObtenerEquiposPorFamilia</key>
		<query>
			select
			trim(tipoarea.tareaabrev) as tareaabrev, trim(area.areanomb) as areanomb, familia.famabrev, trim(equipo.equiabrev) as equiabrev, trim(equipo.equinomb) as equinomb, equipo.equicodi, emp.emprnomb, familia.famnomb
			from eq_equipo equipo
			inner join eq_area area on equipo.areacodi = area.areacodi
			inner join eq_tipoarea tipoarea on area.tareacodi = tipoarea.tareacodi
			inner join eq_familia familia on equipo.famcodi = familia.famcodi
			inner join si_empresa emp on emp.emprcodi = equipo.emprcodi
			where equipo.emprcodi = :emprcodi and equipo.famcodi = :famcodi and equipo.equiestado in ('A', 'P')
		</query>
	</Sql>

	<Sql>
		<key>ListadoCentralesOsinergmin</key>
		<query>
			select
			emprcodi,
			grupocodi,
			famcodi,
			equicodi,
			equinomb,
			equifechiniopcom,
			equifechfinopcom
			from
			eq_equipo
			where
			famcodi in (39,4,37,5) and equiestado ='A'
		</query>
	</Sql>

	<Sql>
		<key>SQLListarEquiposxFiltro</key>
		<query>
			select equicodi,
			e.emprcodi,
			e.grupocodi,
			e.elecodi,
			e.areacodi,
			e.famcodi,
			e.equiabrev,
			e.equinomb,
			e.equiabrev2,
			e.equitension,
			e.equipadre,
			e.equipot,
			e.lastuser,
			e.lastdate,
			e.ecodigo,
			e.equiestado,
			e.osigrupocodi,
			e.lastcodi,
			e.equifechiniopcom,
			e.equifechfinopcom,
			emp.emprnomb,
			fam.famnomb,
			a.areanomb,
			e.usuarioupdate,
			e.fechaupdate,
			e.equimaniobra,
			e.osinergcodi,
			e.osinergcodigen,					<!--ticket-6068-->
			e.operadoremprcodi
			from eq_equipo e
			inner join si_empresa emp on emp.emprcodi=e.emprcodi
			inner join eq_familia fam on fam.famcodi=e.famcodi
			inner join eq_area a on a.areacodi=e.areacodi
			where
			(emp.emprcodi= {0} or 0= {0})and
			(fam.famcodi={1} or 0={1}) and
			(emp.tipoemprcodi={2} or 0={2}) and
			upper(e.equinomb) like '%{3}%' and
			(e.equipadre={4} or -99={4})
			order by e.equinomb
		</query>
	</Sql>

	<Sql>
		<key>SqlBuscarEquipoPorNombrePaginado</key>
		<query>
			select
			*
			from (
			select equicodi,
			emprcodi,
			grupocodi,
			elecodi,
			areacodi,
			famcodi,
			equiabrev,
			equinomb,
			equiabrev2,
			equitension,
			equipadre,
			equipot,
			lastuser,
			lastdate,
			ecodigo,
			equiestado,
			osigrupocodi,
			lastcodi,
			equifechiniopcom,
			equifechfinopcom,
			osinergcodi,
			(row_number() over (order by eq_equipo.equinomb)) as r
			from eq_equipo
			where
			equinomb like '%:equinomb%'
			order by equinomb asc
			)
			where r >= (((:nropaginas-1) * :nroFilas) + 1) and r &lt; ((:nropaginas * :nroFilas) + 1 )
		</query>
	</Sql>

	<Sql>
		<key>EquiposxFamilias</key>
		<query>
			select e.*,
			emp.emprnomb,
			fam.famnomb,
			a.areanomb     
			from eq_equipo e
			inner join si_empresa emp on emp.emprcodi=e.emprcodi
			inner join eq_familia fam on fam.famcodi=e.famcodi
			inner join eq_area a on a.areacodi=e.areacodi
			where e.famcodi in ({0}) and equiestado='A'
		</query>
	</Sql>
  
	<Sql>
		<key>EquiposxFamiliasActivosyProyectos</key>
		<query>
			select e.*,
			emp.emprnomb,
			fam.famnomb,
			a.areanomb     
			from eq_equipo e
			inner join si_empresa emp on emp.emprcodi=e.emprcodi
			inner join eq_familia fam on fam.famcodi=e.famcodi
			inner join eq_area a on a.areacodi=e.areacodi
			where e.famcodi in ({0}) and equiestado in ('A', 'P')
		</query>
	</Sql>

	<Sql>
		<key>UnidadesFitradasXEnsayo</key>
		<query>
			select *
			from eq_equipo e1
			inner join
			(  select eme.equicodi
			from  en_ensayomodequi eme
			inner join en_ensayomodo em
			on eme.enmodocodi=em.enmodocodi
			where em.ensayocodi={0}
			group by eme.equicodi
			order by eme.equicodi
			) e2
			on e1.equicodi=e2.equicodi
		</query>
	</Sql>

	<Sql>
		<key>SQLListarEquiposxFiltroPaginado</key>
		<query>
			select
			*
			from (
			select equicodi,
			e.emprcodi,
			e.grupocodi,
			e.elecodi,
			e.areacodi,
			e.famcodi,
			e.equiabrev,
			e.equinomb,
			e.equiabrev2,
			e.equitension,
			e.equipadre,
			e.equipot,
			e.lastuser,
			e.lastdate,
			e.ecodigo,
			e.equiestado,
			e.osigrupocodi,
			e.lastcodi,
			e.equifechiniopcom,
			e.equifechfinopcom,
			emp.emprnomb,
			fam.famnomb,
			a.areanomb,
			e.usuarioupdate,
			e.fechaupdate,
			e.osinergcodi
			from eq_equipo e
			inner join si_empresa emp on emp.emprcodi=e.emprcodi
			inner join eq_familia fam on fam.famcodi=e.famcodi
			inner join eq_area a on a.areacodi=e.areacodi
			where
			(emp.emprcodi= :emprcodi or 0= emprcodi)and
			(fam.famcodi=:famcodi or 0=famcodi) and
			(emp.tipoemprcodi=:tipoemprcodi or 0=:tipoemprcodi) and
			e.equinomb like '%:equinomb%' and
			(e.equipadre=:equipadre or -99=:equipadre)
			order by e.equinomb
			)
			where r >= (((:nropaginas-1) * :nroFilas) + 1) and r &lt; ((:nropaginas * :nroFilas) + 1 )
		</query>
	</Sql>
	
	<Sql>
		<key>ObtenerDetalleEquipo</key>
		<query>
			select
			eq.equipadre,
			eq.equicodi,
			(select case when x.equicodi = 0 then eq.equinomb  when x.equicodi > 0
			then x.equinomb else eq.equinomb end from eq_equipo x where x.equicodi = eq.equipadre) as descentral,
			eq.equinomb,
			emp.emprcodi,
			emp.emprnomb,
			eta.tareaabrev,
			ea.areanomb,
			eq.equitension,
			fam.famabrev,
			fam.famcodi,
			eq.equiabrev,
			eq.usuarioupdate,
			eq.fechaupdate,
			eq.equimaniobra
			from eq_equipo eq
			inner join eq_area ea on eq.areacodi = ea.areacodi
			inner join eq_tipoarea eta on ea.tareacodi = eta.tareacodi
			inner join eq_familia fam on eq.famcodi = fam.famcodi
			inner join si_empresa emp on eq.emprcodi = emp.emprcodi
			where eq.equicodi = :equicodi
		</query>
	</Sql>
	
	<Sql>
		<key>ObtenerEquipoPorAreaEmpresa</key>
		<query>
      select eq_equipo.famcodi, si_empresa.emprnomb, 
      eq_familia.famabrev, eq_equipo.equinomb, eq_equipo.equicodi, eq_equipo.equiabrev, eq_equipo.emprcodi, eq_equipo.equiestado
      from eq_equipo, eq_familia, si_empresa
      where eq_familia.famcodi=eq_equipo.famcodi and eq_equipo.equiestado != 'B'
      <!--and  eq_equipo.areacodi = :areacodi  and  eq_equipo.emprcodi = :emprcodi-->
      and si_empresa.emprcodi = eq_equipo.emprcodi
      and  (eq_equipo.areacodi = {1} )
      and  (eq_equipo.emprcodi = {0} or '-1'='{0}')
      order by  eq_familia.famabrev, eq_equipo.equiabrev
    </query>
	</Sql>
	
	<Sql>
	 <key>ObtenerEquipoPorAreaEmpresaTodos</key>
	 <query>
			select eq_familia.famabrev || ' - ' ||  eq_equipo.equiabrev || ' (' || eq_equipo.equicodi || ')' as equinomb, eq_equipo.equicodi
			from eq_equipo, eq_familia where eq_familia.famcodi=eq_equipo.famcodi and eq_equipo.equiestado != 'X'
			and  eq_equipo.areacodi = :areacodi  and  eq_equipo.emprcodi = :emprcodi
			order by  eq_familia.famabrev, eq_equipo.equiabrev
		</query>
	</Sql>
	
	<Sql>
		<key>ObtenerPadresHidrologia</key>
		<query>
			select eq_familia.famabrev || ' - ' ||  eq_equipo.equiabrev || ' (' || eq_equipo.equicodi || ')' as equinomb, eq_equipo.equicodi
			from eq_equipo, eq_familia where eq_familia.famcodi=eq_equipo.famcodi and eq_equipo.equiestado != 'B'
			and  eq_equipo.famcodi = 41
			order by  eq_familia.famabrev, eq_equipo.equiabrev
		</query>
	</Sql>
	
	<Sql>
		<key>ObtenerPadresHidrologiaTodos</key>
		<query>
			select eq_familia.famabrev || ' - ' ||  eq_equipo.equiabrev || ' (' || eq_equipo.equicodi || ')' as equinomb, eq_equipo.equicodi
			from eq_equipo, eq_familia where eq_familia.famcodi=eq_equipo.famcodi and eq_equipo.equiestado != 'X'
			and  eq_equipo.famcodi = 41
			order by  eq_familia.famabrev, eq_equipo.equiabrev
		</query>
	</Sql>
	
	<Sql>
		<key>CentralesXCombustible</key>
		<query>
			select * from eq_equipo eq
			inner join pr_grupo pr on pr.grupocodi = eq.grupocodi
			where eq.famcodi = 5 and pr.fenergcodi = {0}
			and eq.emprcodi = {1}
		</query>
	</Sql>
	
	<Sql>
		<key>CentralesXEmpresaGEN</key>
		<query>
			select * from eq_equipo
			where famcodi = 5 and ( emprcodi in ({0}) or '{0}' = '-1' )
		</query>
	</Sql>

	<Sql>
		<key>CentralesXEmpresaGEN2</key>
		<query>
			select * from (select * from eq_equipo eq1 inner join (select areacodi from eq_equipo
			where (famcodi = 3 and ( emprcodi in ({0}) or '{0}' = '-1' ) and equiestado='A') group by areacodi) t1 on eq1.areacodi=t1.areacodi where eq1.famcodi=5 ) where emprcodi in ({0}) or '{0}' = '-1' order by equinomb
		</query>
	</Sql>
	
	<Sql>
		<key>ListaEquiposEnsayo</key>
		<query>
			select * from eq_equipo
			where famcodi in (2,3) and ( equipadre = {0} )
		</query>
	</Sql>

	<Sql>
		<key>ObtenerPorPadre</key>
		<query>
			select equicodi, equiabrev as equinomb,equiestado,famcodi from eq_equipo where equipadre = :equipadre and equiestado = 'A' and equicodi not in (16358)
		</query>
	</Sql>

	<Sql>
		<key>SqlListadoEquipamientoPaginado</key>
		<query>
			select
			*
			from (
			select equicodi,
			e.emprcodi,
			e.grupocodi,
			e.elecodi,
			e.areacodi,
			e.famcodi,
			e.equiabrev,
			e.equinomb,
			e.equiabrev2,
			e.equitension,
			e.equipadre,
			e.equipot,
			e.lastuser,
			e.lastdate,
			e.ecodigo,
			e.equiestado,
			e.osigrupocodi,
			e.lastcodi,
			e.equifechiniopcom,
			e.equifechfinopcom,
			emp.emprnomb,
			fam.famnomb,
			fam.famabrev,
			a.areanomb,
			e.usuarioupdate,
			e.fechaupdate,
			e.equimaniobra,
			te.tipoemprdesc,
			e.osinergcodi,
			e.osinergcodigen,				<!--ticket-6068-->
			e.operadoremprcodi,
			(row_number() over (order by e.equinomb)) as r
			from eq_equipo e
			inner join si_empresa emp on emp.emprcodi=e.emprcodi
			inner join eq_familia fam on fam.famcodi=e.famcodi
			inner join eq_area a on a.areacodi=e.areacodi
			inner join si_tipoempresa te on te.tipoemprcodi=emp.tipoemprcodi
			where
			(emp.emprcodi= {0} or -2= {0})and
			(fam.famcodi={1} or -2={1}) and
			(emp.tipoemprcodi={2} or -2={2}) and
			(e.equicodi = {3} or -2={3}) and
			(e.equiestado='{4}' or ' '='{4}') and
			(lower(nvl(e.equinomb,' ')) like '%{5}%')
			order by e.equinomb
			)
			where (r >= ((({6}-1) * {7}) + 1) and r &lt; (({6} * {7}) + 1 )) or ({6} = -1 and {7} = -1)
		</query>
	</Sql>
	
	<Sql>
		<key>SQLTotalListadoEquipamiento</key>
		<query>
		select count(*)
		from eq_equipo e
		inner join si_empresa emp on emp.emprcodi=e.emprcodi
		inner join eq_familia fam on fam.famcodi=e.famcodi
		inner join eq_area a on a.areacodi=e.areacodi
		where
		(emp.emprcodi= {0} or -2= {0})and
		(fam.famcodi={1} or -2={1}) and
		(emp.tipoemprcodi={2} or -2={2}) and
		(e.equicodi = {3} or -2={3}) and
		(e.equiestado='{4}' or ' '='{4}') and
		(lower(nvl(e.equinomb,' ')) like '%{5}%')
	</query>
	</Sql>

	<Sql>
		<key>ObtenerEquiposProcManiobras</key>
		<query>
			select empresa.emprnomb, empresa.emprcodi, area.areanomb, familia.famabrev, equipo.equiabrev, tipoarea.tareaabrev, equipo.equicodi, equipo.equinomb, equipo.famcodi,
			(select prop.valor from eq_propequi prop where prop.equicodi = equipo.equicodi and prop.propcodi = :propcodi and rownum = 1) as urlmaniobra
			from eq_equipo equipo
			inner join eq_area area on equipo.areacodi = area.areacodi
			inner join eq_tipoarea tipoarea on area.tareacodi = tipoarea.tareacodi
			inner join eq_familia familia on equipo.famcodi = familia.famcodi
			inner join si_empresa empresa on equipo.emprcodi = empresa.emprcodi
			where  equipo.equimaniobra = 'S' and equipo.famcodi = :famcodi and equipo.equiestado in ('P', 'A')
			order by equipo.equinomb asc
		</query>
	</Sql>
	
	<Sql>
		<key>GeneradoresPorModoOperacionSimple</key>
		<query>
			select
			equicodi,
			emprcodi,
			grupocodi,
			elecodi,
			areacodi,
			famcodi,
			equiabrev,
			equinomb,
			equiabrev2,
			equitension,
			equipadre,
			equipot,
			lastuser,
			lastdate,
			ecodigo,
			equiestado,
			osigrupocodi,
			lastcodi,
			equifechiniopcom,
			equifechfinopcom,
			usuarioupdate,
			fechaupdate,
			equimaniobra,
			osinergcodi
			from eq_equipo 
			where grupocodi in (select grupopadre from pr_grupo where grupocodi = {0})
		</query>
	</Sql>
	
	<Sql>
		<key>GeneradoresPorModoOperacionCombinado</key>
		<query>
			select
			equicodi,
			emprcodi,
			grupocodi,
			elecodi,
			areacodi,
			famcodi,
			equiabrev,
			equinomb,
			equiabrev2,
			equitension,
			equipadre,
			equipot,
			lastuser,
			lastdate,
			ecodigo,
			equiestado,
			osigrupocodi,
			lastcodi,
			equifechiniopcom,
			equifechfinopcom,
			usuarioupdate,
			fechaupdate,
			equimaniobra,
			osinergcodi
			from eq_equipo
			where grupocodi in (select grupocodidet from PR_GRUPOCC where grupocodicc={0})
		</query>
	</Sql>
	
	<Sql>
		<key>ReportePotenciaEfectivaHidraulicas</key>
		<query>
			select eq.equicodi,e.emprnomb,eqp.equinomb as Central, eq.equinomb {2}
			from eq_equipo eq
			inner join si_empresa e on e.emprcodi= eq.emprcodi
			inner join eq_equipo eqp on eqp.equicodi=eq.equipadre
			where
			eq.famcodi=2 and
			eq.equiestado !='X' and
			(eq.emprcodi = {0} or {0}=-2) and
			(eqp.equicodi= {1} or {1}=-2)
			order by 2,3
		</query>
	</Sql>
	
	<Sql>
		<key>ReportePotenciaEfectivaSolares</key>
		<query>
			select eq.equicodi,e.emprnomb,eqp.equinomb as Central, eq.equinomb {2}
			from eq_equipo eq
			inner join si_empresa e on e.emprcodi= eq.emprcodi
			inner join eq_equipo eqp on eqp.equicodi=eq.equipadre
			where
			eq.famcodi=36 and
			eq.equiestado !='X' and
			(eq.emprcodi = {0} or {0}=-2) and
			(eqp.equicodi= {1} or {1}=-2)
			order by 2,3
		</query>
	</Sql>
	
	<Sql>
		<key>ReportePotenciaEfectivaEolicas</key>
		<query>
			select eq.equicodi,e.emprnomb,eqp.equinomb as Central, eq.equinomb {2}
			from eq_equipo eq
			inner join si_empresa e on e.emprcodi= eq.emprcodi
			inner join eq_equipo eqp on eqp.equicodi=eq.equipadre
			where
			eq.famcodi=38 and
			eq.equiestado !='X' and
			(eq.emprcodi = {0} or {0}=-2) and
			(eqp.equicodi= {1} or {1}=-2)
			order by 2,3
		</query>
	</Sql>
	
	<Sql>
		<key>EquiposxFamiliasxEmpresas</key>
		<query>
			select e.*,
			emp.emprnomb,
			fam.famnomb,
			a.areanomb     
			from eq_equipo e
			inner join si_empresa emp on emp.emprcodi=e.emprcodi
			inner join eq_familia fam on fam.famcodi=e.famcodi
			inner join eq_area a on a.areacodi=e.areacodi
			where e.famcodi in ({0}) and equiestado='A' and emp.emprcodi in ({1})
		</query>
	</Sql>

	<Sql>
		<key>EquipoPropiedadAGC</key>
		<query>
			select
			a.equicodi,a.famcodi,nvl(a.equipadre,-1) equipadre,
			b.emprnomb,d.areanomb, c.famnomb , a.equiabrev,
			(select max(valor) from eq_propequi z where propcodi in (1817,1828,1822,1826,1824,1820) and
			fechapropequi=(select max(fechapropequi) from eq_propequi d where z.equicodi=d.equicodi and
			z.equicodi=d.equicodi and z.propcodi=d.propcodi
			and d.fechapropequi&lt;to_date('{0}','dd/mm/yyyy')+1) and z.equicodi=a.equicodi) B2,
			(select max(valor) from eq_propequi z where propcodi in (1818,1827,1825,1829,1821,1823) and
			fechapropequi=(select max(fechapropequi) from eq_propequi d where z.equicodi=d.equicodi and
			z.equicodi=d.equicodi and z.propcodi=d.propcodi
			and d.fechapropequi&lt;to_date('{0}','dd/mm/yyyy')+1) and z.equicodi=a.equicodi) B3
			from
			eq_equipo a, si_empresa b, eq_familia c, eq_area d
			where
			a.emprcodi=b.emprcodi and a.famcodi=c.famcodi and a.areacodi=d.areacodi
			and a.equicodi in (select equicodi from eq_propequi where propcodi in (1817,1828,1822,1826,1824,1820,1818,1827,1825,1829,1821,1823))
		</query>
	</Sql>

	<Sql>
		<key>EquipoAGC</key>
		<query>
			select
			c. equicodi,
			trim(a.emprabrev)||' / '||trim(d.tareaabrev)||' '||trim(b.areanomb)||' / '||trim(equiabrev) equiabrev
			from
			si_empresa a,
			eq_tipoarea d,
			eq_area b,
			eq_equipo c
			where
			a.emprcodi=c.emprcodi and
			b.areacodi=c.areacodi and
			d.tareacodi=b.tareacodi and
			a.emprcodi not in (-1,0) and
			d.tareacodi not in (-1,0) and
			b.areacodi not in (-1,0) and
			c.famcodi in (2,3,36,38) and
			c.equiestado='A'
			order by
			a.emprnomb,
			d.tareaabrev,
			b.areanomb,
			c.equiabrev
		</query>
	</Sql>
	
	<Sql>
		<key>ListaEquipoNombre</key>
		<query>
			select b.equicodi,b.famcodi,
			trim(c.tareaabrev)||' '||trim(a.areanomb)||' ('||trim(b.equiabrev)||' - '||trim(b.equinomb)||')' equinomb
			from
			eq_area a, eq_equipo b, eq_tipoarea c
			where      
			a.areacodi=b.areacodi and c.tareacodi=a.tareacodi
      and ('-1' = '{0}' or b.famcodi in ({0}))
			and (b.equiestado in ('A', 'P', 'B') ) and
			((c.tareacodi>0 and a.areacodi>0 and b.equicodi>0)or b.equicodi=-1)
			order by
			trim(c.tareaabrev)||' '||trim(a.areanomb)||' ('||trim(b.equiabrev)||' - '||trim(b.equinomb)||')'
		</query>
	</Sql>
		
		
	<!--alpha.HDT - Inicio 27/10/2016: Se agregÃ³ para la sincronizaciÃ³n de maestros.-->
	<Sql>
		<key>ListaEquiposXFamilia</key>
		<query>
      select
      fe.FENERGCODI, fe.FENERGNOMB, tg.TGENERCODI, tg.TGENERNOMB,pg.TIPOGENERRER,pg.grupotipocogen,
      TA.TAREAABREV, a.areanomb, fam.famnomb,fam.famabrev,
      pg.osinergcodi as OsinergcodiDespacho,
      eq.*,em.EMPRNOMB,em.emprabrev, em.Tipoemprcodi
      from eq_equipo eq
      left join eq_familia fam on fam.famcodi=eq.famcodi
      inner join SI_EMPRESA em on em.emprcodi=eq.emprcodi
      left join pr_grupo pg on pg.grupocodi = eq.grupocodi
      left join si_fuenteenergia fe on pg.FENERGCODI = fe.FENERGCODI
      left join si_tipogeneracion tg on tg.tgenercodi = fe.tgenercodi
      left join eq_area a on a.areacodi=eq.areacodi
      left join eq_tipoarea ta on a.tareacodi= ta.tareacodi
      where eq.famcodi in ({0})
    </query>
	</Sql>

	<!--alpha.HDT - Inicio 31/10/2016: Se agregÃ³ para la sincronizaciÃ³n de maestros.-->
	<Sql>
		<key>GetByIdOsinergmin</key>
		<query>
			select
			eq_equipo.equicodi,
			eq_equipo.emprcodi,
			eq_equipo.grupocodi,
			eq_equipo.elecodi,
			eq_equipo.areacodi,
			eq_equipo.famcodi,
			eq_equipo.equiabrev,
			eq_equipo.equinomb,
			eq_equipo.equiabrev2,
			eq_equipo.equitension,
			eq_equipo.equipadre,
			eq_equipo.equipot,
			eq_equipo.lastuser,
			eq_equipo.lastdate,
			eq_equipo.ecodigo,
			eq_equipo.equiestado,
			eq_equipo.osigrupocodi,
			eq_equipo.lastcodi,
			eq_equipo.equifechiniopcom,
			eq_equipo.equifechfinopcom,
			emp.emprnomb,
			fam.famnomb,
			a.areanomb,
			eq_equipo.usuarioupdate,
			eq_equipo.fechaupdate,
			eq_equipo.equimaniobra,
			eq_equipo.osinergcodi
			from
			eq_equipo
			inner join si_empresa emp on emp.emprcodi=eq_equipo.emprcodi
			left join eq_familia fam on fam.famcodi=eq_equipo.famcodi
			left join eq_area a on a.areacodi=eq_equipo.areacodi
			where
			equicodi = :equicodi
		</query>
	</Sql>

	<!--alpha.HDT - Inicio 31/10/2016: Se agregÃ³ para la sincronizaciÃ³n de maestros.-->
	<Sql>
		<key>UpdateOsinergmin</key>
		<query>
			update eq_equipo
			set
			emprcodi = :emprcodi,
			grupocodi = :grupocodi,
			elecodi = :elecodi,
			areacodi = :areacodi,
			famcodi = :famcodi,
			equiabrev = :equiabrev,
			equinomb = :equinomb,
			equiabrev2 = :equiabrev2,
			equitension = :equitension,
			equipadre = :equipadre,
			equipot = :equipot,
			ecodigo = :ecodigo,
			equiestado = :equiestado,
			osigrupocodi = :osigrupocodi,
			lastcodi = :lastcodi,
			equifechiniopcom = :equifechiniopcom,
			equifechfinopcom = :equifechfinopcom,
			equimaniobra = :equimaniobra,
			usuarioupdate = :usuarioupdate,
			fechaupdate=SYSDATE,
			osinergcodi =: osinergcodi
			where
			equicodi = :equicodi
		</query>
	</Sql>
	<Sql>
		<key>UpdateOsinergminCodigo</key>
		<query>
			update eq_equipo
			set
			osinergcodi = '{1}'
			where
			equicodi = '{0}'
		</query>
	</Sql>
	<Sql>
		<key>GetByCodOsinergmin</key>
		<query>
			SELECT eqp.EQUICODI
			, eqp.OSINERGCODI
			FROM EQ_EQUIPO eqp
			WHERE eqp.FAMCODI = 45
			AND eqp.OSINERGCODI = '{0}'
		</query>
	</Sql>
	<!--alpha.JDEL - Fin-->

	<Sql>
		<key>EquipoPropiedad</key>
		<query>
			select
			*
			from (
			select {0} as propcodi,b.equicodi,a.emprnomb,d.tareaabrev||' '||c.areanomb areanomb, b.equiabrev, b.equinomb,
			(select max(valor) from eq_propequi z where z.equicodi=b.equicodi and z.propcodi={0}
			and fechapropequi=
			(select max(fechapropequi) from eq_propequi zz where zz.equicodi=b.equicodi and zz.propcodi=z.propcodi
			and fechapropequi&lt;to_date('{1}','yyyy-mm-dd')+1)
			) b2,
			(select max(fechapropequi) from eq_propequi zz where zz.equicodi=b.equicodi and zz.propcodi={0}
			and fechapropequi&lt;to_date('{1}','yyyy-mm-dd')+1
			) fechaupdate,
			CASE b.equiestado WHEN 'A' THEN 'Activo'
			WHEN 'B' THEN 'Baja'
			WHEN 'F' THEN 'Fuera de COES'
			WHEN 'P' THEN 'Proyecto'
			WHEN 'X' THEN 'Anulado'
			ELSE '' END equiestado,
			(row_number() over (order by a.emprnomb, b.equiabrev, b.equinomb)) as r
			from si_empresa a, eq_equipo b, eq_area c, eq_tipoarea d
			where a.emprcodi=b.emprcodi and b.areacodi=c.areacodi and c.tareacodi=d.tareacodi
			and (b.emprcodi={2} or ({2} = 0))
			and (b.areacodi={3} or ({3} = 0))
			and (famcodi={4} or {4} = 0)
			order by a.emprnomb, b.equiabrev, b.equinomb
			)
			where (r >= ((({5}-1) * {6}) + 1) and r &lt; (({5} * {6}) + 1 )) or ({5} = -1 and {6} = -1)
		</query>
	</Sql>

	<Sql>
		<key>TotalEquipoPropiedad</key>
		<query>
			select count(*)
			from si_empresa a, eq_equipo b, eq_area c, eq_tipoarea d
			where a.emprcodi=b.emprcodi and b.areacodi=c.areacodi and c.tareacodi=d.tareacodi
			and (b.emprcodi={0} or ({0} = 0))
			and (b.areacodi={1} or ({1} = 0))
			and (famcodi={2} or {2} = 0)
		</query>
	</Sql>

	<Sql>
		<key>ListaEquipoPrGrupo</key>
		<query>
			select
			*
			from
			eq_equipo
			where
			grupocodi in ({0})
			and
			equiestado='A'
		</query>
	</Sql>

	<Sql>
		<key>ListaEquipoNombre</key>
		<query>
			select b.equicodi,b.famcodi,
			trim(c.tareaabrev)||' '||trim(a.areanomb)||' ('||trim(b.equiabrev)||' - '||trim(b.equinomb)||')' equinomb
			from
			eq_area a, eq_equipo b, eq_tipoarea c
			where
			a.areacodi=b.areacodi and c.tareacodi=a.tareacodi
			and b.equiestado='A' and
			((c.tareacodi>0 and a.areacodi>0 and b.equicodi>0)or b.equicodi=-1)
			order by
			trim(c.tareaabrev)||' '||trim(a.areanomb)||' ('||trim(b.equiabrev)||' - '||trim(b.equinomb)||')'
		</query>
	</Sql>

	<Sql>
		<key>CentralesXEmpresaHorasOperacion</key>
		<query>
			select eq.*, fm.famnomb,fm.famabrev, fm.famcodi famcodipadre, eq2.equinomb nombrecentral, eq2.equicodi codipadre
			from eq_equipo eq
			inner join eq_equipo eq2 on eq2.equicodi = eq.equipadre
			inner join eq_familia fm on fm.famcodi = eq2.famcodi
			where ('-2'='{0}' or eq.emprcodi = {0}) and eq.famcodi in (2,3) and eq.equiestado in ('A','P','F')
			union
			select eq.*, fm.famnomb, fm.famabrev,fm.famcodi famcodipadre, eq.equinomb nombrecentral, eq.equicodi codipadre
			from eq_equipo eq
			inner join eq_familia fm on fm.famcodi = eq.famcodi
			where ('-2'='{0}' or eq.emprcodi = {0}) and eq.famcodi in (37, 39) and eq.equiestado in ('A','P','F')
			union
			select eq2.*, fm.famnomb, fm.famabrev,fm.famcodi famcodipadre, eq2.equinomb nombrecentral, eq2.equicodi codipadre
			from si_hisempeq eqx
			inner join eq_equipo eq2 on eq2.equicodi = eqx.equicodi and eq2.equiestado in ('A','P','F') and eq2.famcodi in (37, 39)
			inner join eq_familia fm on fm.famcodi = eq2.famcodi
			where ('-2'='{0}' or eqx.operadoremprcodi = {0}) and eqx.hempeqestado in ('A') and eqx.hempeqfecha > to_date('{1}','YYYY-MM-DD')
			union
			select eq2.*, fm.famnomb, fm.famabrev,fm.famcodi famcodipadre, eq3.equinomb nombrecentral, eq3.equicodi codipadre
			from si_hisempeq eqx
			inner join eq_equipo eq2 on eq2.equicodi = eqx.equicodi and eq2.equiestado in ('A','P','F') and eq2.famcodi in (2,3)
			inner join eq_equipo eq3 on eq3.equicodi = eq2.equipadre
			inner join eq_familia fm on fm.famcodi = eq3.famcodi
			where ('-2'='{0}' or eqx.operadoremprcodi = {0}) and eqx.hempeqestado in ('A') and eqx.hempeqfecha > to_date('{1}','YYYY-MM-DD')
		</query>
	</Sql>

	<Sql>
		<key>CentralesXEmpresaXFamiliaGEN</key>
		<query>
			select eq.*, fm.famnomb
			from eq_equipo eq
			inner join eq_familia fm on fm.famcodi = eq.famcodi
			where eq.emprcodi in ({0}) and eq.famcodi in ({1}) and eq.equiestado = 'A'
		</query>
	</Sql>

	<Sql>
		<key>ListadoXEmpresa</key>
		<query>
			select eq.*, fm.famnomb, fm.famabrev
			from eq_equipo eq
			inner join eq_familia fm on fm.famcodi = eq.famcodi
			where eq.emprcodi in ({0}) and equiestado ='A'
		</query>
	</Sql>

	<Sql>
		<key>GetByEmprFam2</key>
		<query>
			select * from eq_equipo
			where grupocodi = (select grupopadre from pr_grupo where grupocodi = {0}) and equiestado in ('A','B','P') and famcodi = {1}
			order by equiabrev
		</query>
	</Sql>

	<Sql>
		<key>CentralesXEmpresaXFamiliaGEN2</key>
		<query>
			select eq.*, fm.famnomb, pg.FENERGCODI,pg.GRUPORESERVAFRIA
			from eq_equipo eq
			left join pr_grupo pg on pg.grupocodi = eq.grupocodi
			inner join eq_familia fm on fm.famcodi = eq.famcodi
			where (eq.emprcodi in ({0}) or '{0}' = '-1') and eq.famcodi in ({1}) and (eq.equiestado = '{2}' or '-1' = '{2}')
		</query>
	</Sql>

	<Sql>
		<key>ListarTopologiaEquipoPadres</key>
		<query>
			select emp.emprnomb,  fam.famnomb, eq.*, eqr.EQUIRELUSUMODIFICACION, eqr.EQUIRELFECMODIFICACION
			from eq_equipo eq
			inner join si_empresa emp on emp.emprcodi = eq.emprcodi
			inner join eq_familia fam on fam.famcodi = eq.famcodi
			inner join (
					SELECT a.* FROM
					(
							select e.*, ROW_NUMBER() OVER(PARTITION BY equicodi1  ORDER BY equicodi1,e.EQUIRELFECMODIFICACION DESC) AS NUM
							from eq_equirel e
							where e.tiporelcodi = {2}
					)a where num =1
			)eqr on eqr.equicodi1 = eq.equicodi
			where
			(emp.emprcodi in ({0}) or '{0}' = '-1') and
			(eq.famcodi in ({1}) or '{1}' = '-1') 
			order by emp.emprnomb, eq.equinomb
		</query>
	</Sql>

	<Sql>
		<key>ObtenerPadresHidrologia</key>
		<query>
			select eq_familia.famabrev || ' - ' ||  eq_equipo.equiabrev || ' (' || eq_equipo.equicodi || ')' as equinomb, eq_equipo.equicodi
			from eq_equipo, eq_familia where eq_familia.famcodi=eq_equipo.famcodi and eq_equipo.equiestado != 'B'
			and  eq_equipo.famcodi = 41
			order by  eq_familia.famabrev, eq_equipo.equiabrev
		</query>
	</Sql>
	<Sql>
		<key>ObtenerPadresHidrologiaTodos</key>
		<query>
			select eq_familia.famabrev || ' - ' ||  eq_equipo.equiabrev || ' (' || eq_equipo.equicodi || ')' as equinomb, eq_equipo.equicodi
			from eq_equipo, eq_familia where eq_familia.famcodi=eq_equipo.famcodi and eq_equipo.equiestado != 'X'
			and  eq_equipo.famcodi = 41
			order by  eq_familia.famabrev, eq_equipo.equiabrev
		</query>
	</Sql>


	<Sql>
		<key>ObtenerEquipoPorAreaEmpresaTodos</key>
		<query>
			select eq_familia.famabrev || ' - ' ||  eq_equipo.equiabrev || ' (' || eq_equipo.equicodi || ')' as equinomb, eq_equipo.equicodi
			from eq_equipo, eq_familia where eq_familia.famcodi=eq_equipo.famcodi and eq_equipo.equiestado != 'X'
			and  eq_equipo.areacodi = :areacodi  and  eq_equipo.emprcodi = :emprcodi
			order by  eq_familia.famabrev, eq_equipo.equiabrev
		</query>
	</Sql>
	<Sql>
		<key>GetEquipoParaCreacion</key>
		<query>
			select
			eqp.equicodi,
			eqp.emprcodi,
			eqp.grupocodi,
			eqp.elecodi,
			eqp.areacodi,
			eqp.famcodi,
			eqp.equiabrev,
			eqp.equinomb,
			eqp.equiabrev2,
			eqp.equitension,
			eqp.equipadre,
			eqp.equipot,
			eqp.lastuser,
			eqp.lastdate,
			eqp.ecodigo,
			eqp.equiestado,
			eqp.osigrupocodi,
			eqp.lastcodi,
			eqp.equifechiniopcom,
			eqp.equifechfinopcom,
			emp.emprnomb,
			fam.famnomb,
			a.areanomb,
			eqp.usuarioupdate,
			eqp.fechaupdate,
			eqp.equimaniobra,
			eqp.osinergcodi
			from eq_equipo eqp
			inner join si_empresa emp on emp.emprcodi = eqp.emprcodi
			inner join eq_familia fam on fam.famcodi = eqp.famcodi
			inner join eq_area a on a.areacodi = eqp.areacodi
			where eqp.osinergcodi = :osinergcodi
			and eqp.famcodi = :famcodi
			and eqp.equiestado != 'X'
		</query>
	</Sql>

	<!--INICIO PR5-->
	
	<Sql>
		<key>ListarEquiposXTipoEquipos</key>
		<query>
      select e.EQUICODI
      ,e.EQUIABREV
      ,e.EQUINOMB
      ,e.Equiestado
      ,e.famcodi
      ,emp.EMPRCODI
      ,emp.EMPRNOMB
      ,a.AREACODI
      ,a.AREANOMB
      from eq_equipo e
      inner join si_empresa emp on emp.emprcodi=e.emprcodi
      inner join eq_familia fam on fam.famcodi=e.famcodi
      inner join eq_area a on a.areacodi=e.areacodi
      where
      (e.FAMCODI in ({0})) and
      ( ('{1}'='-1') or a.AREACODI in ({1})) and
      lower(e.equinomb) like '%%'
    </query>
	</Sql>

	<Sql>
		<key>ListarEquiposXEmpresasXArea</key>
		<query>
			select e.EQUICODI
			,e.EQUIABREV
			,e.EQUINOMB
			,emp.EMPRCODI
			,emp.EMPRNOMB
			,a.AREACODI
			,a.AREANOMB
			from eq_equipo e
			inner join si_empresa emp on emp.emprcodi=e.emprcodi
			inner join eq_familia fam on fam.famcodi=e.famcodi
			inner join eq_area a on a.areacodi=e.areacodi
			where
			(emp.EMPRCODI in ({0})) and
			(a.AREACODI in ({1})) and
			lower(e.equinomb) like '%%'
		</query>
	</Sql>
	
	<Sql>
		<key>ObtenerEquiposPorFamiliaOriglectcodi</key>
		<query>
			select
			distinct trim(tipoarea.tareaabrev) as tareaabrev, trim(area.areanomb) as areanomb, familia.famabrev, trim(equipo.equiabrev) as equiabrev, trim(equipo.equinomb) as equinomb, equipo.equicodi, emp.emprnomb, familia.famnomb
			from me_ptomedicion pto
			inner join eq_equipo equipo on pto.equicodi = equipo.equicodi
			inner join eq_area area on equipo.areacodi = area.areacodi
			inner join eq_tipoarea tipoarea on area.tareacodi = tipoarea.tareacodi
			inner join eq_familia familia on equipo.famcodi = familia.famcodi
			inner join si_empresa emp on emp.emprcodi = equipo.emprcodi
			where pto.origlectcodi = {0} and equipo.emprcodi = {1} and equipo.famcodi = {2} and equipo.equiestado not in ('X')
		</query>
	</Sql>
	
	<!-- INICIO INDISPONIBILIDADES-->
	<Sql>
		<key>ListarEquiposTTIE</key>
		<query>
			select
			eq.equicodi,
			EQ.grupocodi,
			EQ.famcodi,
			EQ.equiabrev,
			EQ.equinomb,
			EQ.equiestado,
			vweq.heqdatfecha,
			vweq.heqdatestado,
			vweq.emprcodi,
			vweq.equicodiactual,
			case when eq.famcodi in (4,5,37,39) then eq.equicodi else eqp.equicodi end as equipadre,
			case when eq.famcodi in (4,5,37,39) then eq.equinomb else eqp.equinomb end as central,
			emp.emprnomb,
			gr.gruponomb,
			gr.grupoabrev,
			gr.FENERGCODI,
			f.tgenercodi
			from eq_equipo eq
			inner join si_hisempeq_data vweq on eq.equicodi = vweq.equicodi
			inner join si_empresa emp on emp.emprcodi = vweq.emprcodi
			left join eq_equipo eqp on eqp.equicodi = eq.equipadre
			left join pr_grupo gr on gr.grupocodi = eq.grupocodi
			left join SI_FUENTEENERGIA f on f.fenergcodi = gr.FENERGCODI
			where ('{0}'='-1' or eq.famcodi in ({0}))
		</query>
	</Sql>
	
	<!--%%%%%%%%%% FIN REGION INDISPONIBILIDADES%%%%%%%%%%-->

	<Sql>
		<key>ObtenerEquiposPorFamiliaRechazoCarga</key>
		<query>
			select
			trim(equipo.equiabrev) as equiabrev, trim(equipo.equinomb) as equinomb, equipo.equicodi, equipo.osinergcodi
			from eq_equipo equipo
			where equipo.famcodi = :famcodi and equipo.equiestado in ('A', 'P') {0}
		</query>
	</Sql>
	<Sql>
		<key>ListEquiposGrupocodiFamilia</key>
		<query>
			select
			eq_equipo.equicodi,
			eq_equipo.emprcodi,
			eq_equipo.grupocodi,
			eq_equipo.elecodi,
			eq_equipo.areacodi,
			eq_equipo.famcodi,
			eq_equipo.equiabrev,
			eq_equipo.equinomb,
			eq_equipo.equiabrev2,
			eq_equipo.equitension,
			eq_equipo.equipadre,
			eq_equipo.equipot,
			eq_equipo.lastuser,
			eq_equipo.lastdate,
			eq_equipo.ecodigo,
			eq_equipo.equiestado,
			eq_equipo.osigrupocodi,
			eq_equipo.lastcodi,
			eq_equipo.equifechiniopcom,
			eq_equipo.equifechfinopcom,
			emp.emprnomb,
			fam.famnomb,
			a.areanomb,
			eq_equipo.usuarioupdate,
			eq_equipo.fechaupdate,
			eq_equipo.equimaniobra,
			eq_equipo.osinergcodi
			from
			eq_equipo
			inner join si_empresa emp on emp.emprcodi=eq_equipo.emprcodi
			left join eq_familia fam on fam.famcodi=eq_equipo.famcodi
			left join eq_area a on a.areacodi=eq_equipo.areacodi
			where
			(eq_equipo.grupocodi = {0} or {0}=-2) and
			(eq_equipo.famcodi= {1} or {1}=-2) and
			eq_equipo.equiestado ='A'
		</query>
	</Sql>
	<Sql>
		<key>UpdateGrupoCodiPorCodigoFamilia</key>
		<query>
			UPDATE EQ_EQUIPO
			SET GRUPOCODI ={0}
			WHERE EQUICODI IN ({1}) AND FAMCODI={2}
		</query>
	</Sql>
	<!--region NotificacionesCambiosEquipamiento-->
	<Sql>
		<key>EquiposModificados</key>
		<query>
			select 
			eq.equicodi, 
			eq.equinomb, 
			eq.equiabrev, 
			eq.lastuser, 
			eq.lastdate, 
			emp.emprnomb, 
			fam.famnomb ,
			eq.usuarioupdate,
			eq.fechaupdate,
			eq.equiestado
			from eq_equipo eq inner join si_empresa emp on eq.emprcodi = emp.emprcodi 
			inner join eq_familia fam on eq.famcodi = fam.famcodi
			where 
			(eq.lastdate >=  to_date('{0}', 'DD-MM-YYYY HH24:MI') and eq.lastdate &lt;=  to_date('{1}', 'DD-MM-YYYY HH24:MI')) or
			(eq.fechaupdate >=  to_date('{0}', 'DD-MM-YYYY HH24:MI') and eq.fechaupdate &lt;=  to_date('{1}', 'DD-MM-YYYY HH24:MI'))
		</query>
	</Sql>
	<!--region NotificacionesCambiosEquipamiento -->

	<!--#region Transferencia de Equipos-->
		<Sql>
		<key>ListarEquiposXEmpresas</key>
		<query>
			select e.EQUICODI
			,e.EQUIABREV
			,e.EQUINOMB
			,emp.EMPRCODI
			,emp.EMPRNOMB
			,a.AREACODI
			,a.AREANOMB
			,e.equiestado
			,e.famcodi
			,e.equitension
			,fam.famnomb
			from eq_equipo e
			inner join si_empresa emp on emp.emprcodi=e.emprcodi
			inner join eq_familia fam on fam.famcodi=e.famcodi
			inner join eq_area a on a.areacodi=e.areacodi
			inner join si_tipoempresa te on te.tipoemprcodi=emp.tipoemprcodi
			where
			(emp.EMPRCODI in ({0})) and
			trim(e.equiestado) in ('A','B')

		</query>
	</Sql>

	<Sql>
		<key>ListadoEquiposXEmpresaOrigen</key>
		<query>
			select *
			from eq_equipo
			where emprcodi={0} and trim(equiestado) in ('A','B')
		</query>
	</Sql>


	<Sql>
		<key>GetListaEquiposSiEquipoMigrarByMigracodi</key>
		<query>
			select e.EQUICODI
			,e.EQUIABREV
			,(case when e.EQUINOMB is null then e.EQUIABREV else e.EQUINOMB end) EQUINOMB
			,emp.EMPRCODI
			,emp.EMPRNOMB
			,emp2.EMPRNOMB AS EMPRESAORIGEN
			,a.AREACODI
			,a.AREANOMB
			,e.equiestado
			,e.famcodi
			,e.equitension
			,fam.famnomb
			,emp3.EMPRNOMB AS OPERADORNOMB
			from eq_equipo e
			inner join si_empresa emp on emp.emprcodi=e.emprcodi
			inner join eq_familia fam on fam.famcodi=e.famcodi
			inner join eq_area a on a.areacodi=e.areacodi
			inner join si_tipoempresa te on te.tipoemprcodi=emp.tipoemprcodi
			inner join si_hisempeq eqm on eqm.EQUICODIOLD=e.equicodi
			INNER JOIN SI_MIGRACION mig on mig.migracodi =eqm.migracodi
			INNER JOIN si_migraemprorigen eo on eo.migracodi= eqm.migracodi
			inner join si_empresa emp2 on emp2.emprcodi=eo.emprcodi
			inner join si_empresa emp3 on emp3.emprcodi=eqm.operadoremprcodi
			where
			( mig.MIGRACODI ={0})
			order by fam.famnomb,e.EQUINOMB
		</query>
	</Sql>
	

	<!--FIN Transferencia de Equipos-->

	<!--INICIO MigracionSGOCOES-GrupoB-->

	<Sql>
		<key>ListaLineasDigsilent</key>
		<query>
			select a.equicodi,a.equiabrev, a.equinomb,
			(
			select nvl(trim(max(valor)),' ') from eq_propequi b where propcodi={0} and a.equicodi=b.equicodi and fechapropequi=(select max(fechapropequi) from eq_propequi c where propcodi={0} and b.equicodi=c.equicodi)
			) as valor
			from eq_equipo a where
			a.famcodi={1}
			and a.equiestado='A'
			and
			(
			select max(valor) from eq_propequi b where propcodi={0} and a.equicodi=b.equicodi and fechapropequi=(select max(fechapropequi) from eq_propequi c where propcodi={0} and b.equicodi=c.equicodi)
			) is not null
		</query>
	</Sql>

	<Sql>
		<key>ListaPruebasAleatorias</key>
		<query>
			/*SELECT b.emprNOMB, DECODE(C.FAMCODI,3,trim(e.tareaabrev||' '||trim(d.areanomb) ||' - '|| trim(a.equiabrev)),trim(e.tareaabrev||' '||d.areanomb)) AS equinomb, F.EQUIPOPRUEBA as Ecodigo*/
			SELECT a.equicodi,b.emprNOMB, DECODE(C.FAMCODI,3,trim(e.tareaabrev||' '||trim(d.areanomb)),trim(e.tareaabrev)) AS equinomb, trim(a.equiabrev) as equiabrev, F.EQUIPOPRUEBA as Ecodigo
			fROM eq_equipo a
			inner join eq_familia c on a.famcodi = c.famcodi
			inner join eq_area d on d.areacodi = a.areacodi
			inner join eq_tipoarea e on e.tareacodi = d.tareacodi
			inner join pr_equiposorteo f on f.equicodi = a.equicodi
			inner join si_empresa b on b.emprcodi = (case when coalesce(f.EMPRCODI, -1) > 0 then f.EMPRCODI else a.emprcodi end)
			WHERE f.logfecha>=to_date('{0} 00:00:00','yyyy-mm-dd hh24:mi:ss') and f.logfecha &lt;= to_date('{0} 23:59:59','yyyy-mm-dd hh24:mi:ss')
			Order by b.emprNOMB , equinomb
		</query>
	</Sql>

	<Sql>
		<key>GetListaPotencias</key>
		<query>
			SELECT B.EQUICODI,B.EQUIPADRE, b.equiabrev, b.equinomb ,
			(SELECT VALOR FROM EQ_PROPEQUI Z WHERE FECHAPROPEQUI=(SELECT MAX(FECHAPROPEQUI) FROM EQ_PROPEQUI C WHERE C.EQUICODI=Z.EQUICODI AND PROPCODI IN(299,941) AND FECHAPROPEQUI &lt;= to_date('{0}','YYYY-MM-DD')) AND Z.EQUICODI=B.EQUICODI AND PROPCODI IN(299,941)) Pmin,
			(SELECT VALOR FROM EQ_PROPEQUI Z WHERE FECHAPROPEQUI=(SELECT MAX(FECHAPROPEQUI) FROM EQ_PROPEQUI C WHERE C.EQUICODI=Z.EQUICODI AND PROPCODI IN(298,943) AND FECHAPROPEQUI &lt;= to_date('{0}','YYYY-MM-DD')) AND Z.EQUICODI=B.EQUICODI AND PROPCODI IN(298,943)) Pmax,
			(SELECT VALOR FROM EQ_PROPEQUI Z WHERE FECHAPROPEQUI=(SELECT MAX(FECHAPROPEQUI) FROM EQ_PROPEQUI C WHERE C.EQUICODI=Z.EQUICODI AND PROPCODI IN(164,46) AND FECHAPROPEQUI &lt;= to_date('{0}','YYYY-MM-DD')) AND Z.EQUICODI=B.EQUICODI AND PROPCODI IN(164,46)) Pe,
			(SELECT VALOR FROM EQ_PROPEQUI Z WHERE FECHAPROPEQUI=(SELECT MAX(FECHAPROPEQUI) FROM EQ_PROPEQUI C WHERE C.EQUICODI=Z.EQUICODI AND PROPCODI=204 AND FECHAPROPEQUI &lt;= to_date('{0}','YYYY-MM-DD')) AND Z.EQUICODI=B.EQUICODI AND PROPCODI = 204) TMINPARADA,
			(SELECT VALOR FROM EQ_PROPEQUI Z WHERE FECHAPROPEQUI=(SELECT MAX(FECHAPROPEQUI) FROM EQ_PROPEQUI C WHERE C.EQUICODI=Z.EQUICODI AND PROPCODI=205 AND FECHAPROPEQUI &lt;= to_date('{0}','YYYY-MM-DD')) AND Z.EQUICODI=B.EQUICODI AND PROPCODI = 205) TMINOPERA,
			GRUPOCODI,B.Famcodi
			FROM EQ_EQUIPO B
			WHERE
			B.GRUPOCODI >0 AND
			B.FAMCODI IN (2,3,36,38) AND
			(B.EQUIESTADO ='A' OR B.EQUIESTADO IS NULL)
			ORDER BY GRUPOCODI
		</query>
	</Sql>

	<!--FIN MigracionSGOCOES-GrupoB-->
	
	<!--INICIO INTERVENCIONES-->
	<!--QUERY TRAER DATOS DE EQUIPAMIENTO POR UBICACIÓN-->
	<Sql>
		<key>ListarComboEquiposXUbicaciones</key>
		<query>
			select
				equi.equicodi,
				trim(fam.famabrev) || '-' || trim(equi.equiabrev) || ' (' || equi.equicodi ||')' equidesc
			from
				eq_equipo equi
				inner join eq_familia fam on (equi.famcodi=fam.famcodi)
			where
				equi.areacodi in ({0}) and
				equi.equiestado = 'A' and
				equi.equicodi not in (0,-1) and
				equi.areacodi not in (0,-1)     
		</query>
	</Sql>
	
	<!--QUERY TRAER DATOS DE EQUIPAMIENTO PARA IMPORTACIÓN DE INTERVENCIONES-->  
	<Sql>
		<key>TraerDatosEquipamientoByIdEquipo</key>
		<query>
			select
			equi.emprcodi,
			equi.areacodi,
			equi.equicodi
			from
			eq_equipo equi inner join eq_area area on (equi.areacodi=area.areacodi)
			inner join si_empresa empr on (equi.emprcodi=empr.emprcodi)
			where
			equi.equicodi = :equicodi
		</query>
	</Sql>
	
	<!--QUERY TRAER DATOS DE EQUIPOS POR IDS-->  
	<Sql>
		<key>ListarEquiposByIds</key>
		<query>
      select
      eq.equicodi,
      eq.famcodi,
      eq.equinomb,
      eq.osinergcodi,
      eq.equitension,
      a.areacodi,
      a.areanomb
      from
      eq_equipo eq
      left join eq_area a on a.areacodi=eq.areacodi
      where
      eq.equicodi in ({0})
    </query>
	</Sql>
	
	<!--QUERY TRAER ENLACES -PROCEDIMIENTOS MANIOBRA--> 
	<Sql>
		<key>ObtenerEnlacesByIds</key>
		<query>
			select
			equipo.equicodi,
			'Empresa: ' || trim(empresa.emprnomb) || ',
			Ubicación: ' || trim(tipoarea.tareaabrev) || ' ' || trim(area.areanomb) || ',
			Tipo: ' || trim(familia.famabrev) || ',
			Equipo: ' || equipo.equiabrev as equinomb,
			(select
			prop.valor
			from
			eq_propequi prop
			where
			prop.equicodi = equipo.equicodi and
			prop.propcodi = case equipo.famcodi
			when 6 then 1806
			when 14 then 1807
			when 8 then 1808
			when 17 then 1809
			when 7 then 1810
			when 10 then 1811
			when 9 then 1812
			when 12 then 1813
			else -1 end and
			rownum = 1) as urlmaniobra
			from eq_equipo equipo
			inner join eq_area area on equipo.areacodi = area.areacodi
			inner join eq_tipoarea tipoarea on area.tareacodi = tipoarea.tareacodi
			inner join eq_familia familia on equipo.famcodi = familia.famcodi
			inner join si_empresa empresa on equipo.emprcodi = empresa.emprcodi
			where
			equipo.equimaniobra = 'S' and
			equipo.equicodi in ({0})
		</query>
	</Sql>
	
	<!--QUERY TRAER LAS FAMILIAS-->  
	<Sql>
		<key>ListarComboEquiposXUbicacionesXFamilia</key>
		<query>
      select
      equi.equicodi,
      trim(fam.famabrev) || '-' || trim(equi.equiabrev) || ' (' || equi.equicodi ||')' equidesc,
      equi.areacodi,
      equi.famcodi
      from
      eq_equipo equi
      inner join eq_familia fam on (equi.famcodi=fam.famcodi)
      where
      (equi.areacodi in ({0}) or '{0}' = '0')and
      (equi.famcodi in ({1}) or '{1}' = '0') and
      equi.equiestado = 'A' and
      equi.equicodi not in (0,-1) and
      equi.areacodi not in (0,-1)
    </query>
	</Sql>

  <!--QUERY TRAER DATOS DE EQUIPOS POR PROGRAMA-->
  <Sql>
    <key>ListarEquiposXPrograma</key>
    <query>
      select
      distinct equi.equicodi,
      trim(fam.famabrev) || '-' || trim(equi.equiabrev) || ' (' || equi.equicodi ||')' equidesc,
      equi.areacodi,
      equi.famcodi
      from
      eq_equipo equi
      inner join eq_familia fam on (equi.famcodi=fam.famcodi)
      inner join in_intervencion i on equi.equicodi = i.equicodi
      where
      i.evenclasecodi in ({0})
    </query>
  </Sql>

  <!--QUERY TRAER LAS LÍNEAS QUE INCIEN CON “LT”, “L.T.” o “L. T.” -->
  <Sql>
    <key>ListarLineasValidas</key>
    <query>
      select * from eq_equipo
      where
      famcodi = 8 and
      (equinomb LIKE 'LT%') or
      (equinomb LIKE 'L.T.%') or
      (equinomb LIKE 'L. T.%')
    </query>
  </Sql>

  <!--QUERY TRAER LAS CELDAS QUE INCIEN CON “CL” -->
  <Sql>
    <key>ListarCeldasValidas</key>
    <query>
      select * from eq_equipo
      where
      famcodi = 6 and equinomb LIKE 'CL%'
    </query>
  </Sql>
  
  <!--FIN INTERVENCIONES-->

	<!--INICIO NUMERALES DATOS BASSE-->

	<Sql>
		<key>ListaDatosBase_5_6_6</key>
		<query>
			Select E.EQUINOMB,E.OSIGRUPOCODI, equicodi,grupocodi,equipadre,famcodi,equiestado
			from eq_equipo  E where famcodi in(2,3,4,5, 36,37,38,39)
		</query>
	</Sql>

	<!--FIN NUMERALES DATOS BASSE-->
	<!--INICIO SERVICIOS PR15 MEDIDORES GENERACION-->
	<Sql>
		<key>EquiposPorPuntoMedicion</key>
		<query>
			select
			eq.equicodi,
			eq.emprcodi,
			eq.grupocodi,
			eq.elecodi,
			eq.areacodi,
			eq.famcodi,
			eq.equiabrev,
			eq.equinomb,
			eq.equiabrev2,
			eq.equitension,
			eq.equipadre,
			eq.equipot,
			eq.lastuser,
			eq.lastdate,
			eq.ecodigo,
			eq.equiestado,
			eq.osinergcodi,
			eq.lastcodi,
			eq.equifechiniopcom,
			eq.equifechfinopcom,
			eq.usuarioupdate,
			eq.fechaupdate,
			eq.equimaniobra
			from eq_equipo eq inner join me_ptomedicion pto on (pto.equicodi=eq.equicodi)
			where eq.equiestado='A' and pto.ptomediestado='A'
			and pto.ptomedicodi ={0}
		</query>
	</Sql>
	<!--FIN SERVICIOS PR15 MEDIDORES GENERACION-->

	<!--INICIO Equipos sin datos de ficha técnica-->
	<Sql>
		<key>ListaEqEmpresaFamilia</key>
		<query>
			select eq.*
			,emp.EMPRNOMB
			,fam.famnomb
			,emp.Tipoemprcodi
			,tipoarea.tareaabrev || ' ' || ar.areanomb as areadesc
			from eq_equipo eq
			inner join si_empresa emp on emp.emprcodi=eq.emprcodi
			inner join eq_familia fam on fam.famcodi=eq.famcodi
			INNER JOIN EQ_AREA AR ON AR.AREACODI = EQ.AREACODI
			inner join eq_tipoarea tipoarea on ar.tareacodi = tipoarea.tareacodi
			WHERE ('{0}' = '-1' or eq.EMPRCODI IN ({0}))
			AND ('{1}' = '-1' or eq.FAMCODI IN ({1}))
			AND eq.equiestado in ('P', 'A', 'F')
		</query>
	</Sql>
	<!--FIN Equipos sin datos de ficha técnica-->

  <!--INICIO FICHA TÉCNICA-->
  <Sql>
    <key>ListarSubestacionFT</key>
    <query>
      SELECT
      EQ.EQUICODI,
      EQ.EQUINOMB,
      EQ.EQUIABREV,
      tipoarea.tareaabrev || ' ' || ar.areanomb AS AREADESC,
      emp.emprnomb,
      te.TIPOEMPRDESC
      FROM EQ_EQUIPO EQ
      LEFT JOIN EQ_AREA  AR ON EQ.AREACODI = AR.AREACODI
      LEFT join eq_tipoarea tipoarea on ar.tareacodi = tipoarea.tareacodi
      left join si_empresa emp on emp.emprcodi = eq.emprcodi
      LEFT join si_tipoempresa te on te.tipoemprcodi = nvl(eMP.tipoemprcodi, -1)
      WHERE EQUIESTADO IN ('A','P','F') AND FAMCODI = 1
      ORDER BY 4, 5
    </query>
  </Sql>
  <!--FIN FICHA TÉCNICA-->

  <!--INICIO FICHA TÉCNICA 2023-->
  <Sql>
    <key>ListarPorEmpresaPropietaria</key>
    <query>
      select
      eq.equicodi,
      eq.famcodi,
      eq.equicodi as idElemento,
      emp1.emprcodi as idempresaelemento,
      emp1.emprnomb as nombempresaelemento,
      null as idempresacopelemento,
      null as nombempresacopelemento,
      eq.equinomb  as nombreelemento,
      f.famnomb as tipoelemento,
      ar1.areanomb as areaelemento,
      eq.equiestado as estadoelemento,
      ar1.areacodi
      from eq_equipo eq
      inner join si_empresa emp1 on emp1.emprcodi = eq.emprcodi
      inner join eq_familia f on f.famcodi = eq.famcodi
      inner join eq_area ar1 on ar1.areacodi = eq.areacodi
      where
      (eq.equiestado = 'A' or eq.equiestado = 'F')
      and eq.emprcodi = {0} and
      (eq.famcodi = {1} or '-1' = '{1}')
    </query>
  </Sql>

  <Sql>
    <key>ListarPorEmpresaCopropietaria</key>
    <query>
      select
      eq.equicodi,
      eq.famcodi,
      eq.equicodi as idElemento,
      emp1.emprcodi as idempresaelemento,
      emp1.emprnomb as nombempresaelemento,
      emp2.emprcodi as idempresacopelemento,
      emp2.emprnomb as nombempresacopelemento,
      eq.equinomb  as nombreelemento,
      f.famnomb as tipoelemento,
      ar1.areanomb as areaelemento,
      eq.equiestado as estadoelemento,
      ar1.areacodi
      from eq_equipo eq
      inner join ft_ext_releqemplt relt on relt.equicodi = eq.equicodi
      inner join si_empresa emp1 on emp1.emprcodi = eq.emprcodi
      inner join si_empresa emp2 on emp2.emprcodi = relt.emprcodi
      inner join eq_familia f on f.famcodi = eq.famcodi
      inner join eq_area ar1 on ar1.areacodi = eq.areacodi
      where
      (eq.equiestado = 'A' or eq.equiestado = 'F')
      and relt.emprcodi = {0} and
      (eq.famcodi = {1} or '-1' = '{1}')
    </query>
  </Sql>

  <Sql>
    <key>GetByEmprFamCentral2</key>
    <query>
      select
      *
      from
      eq_equipo a
      inner join eq_area ar on ar.areacodi = a.areacodi
      where
      ('-2' = '{0}' or a.emprcodi = {0})
      and ('-2' = '{1}' or a.famcodi = {1})
      and ('-2' = '{2}' or a.equipadre = {2})
      and a.equiestado in ('A','P','F')
      order by a.equinomb
    </query>
  </Sql>
  <!--FIN FICHA TÉCNICA 2023-->

  <!--DEMANDA DPO - ITERACION 2-->
  <Sql>
    <key>ListaEquipoByEmpresa</key>
    <query>
      SELECT
      EQ.EQUICODI,
      EQ.EQUINOMB,
      EQ.EQUIABREV
      FROM EQ_EQUIPO EQ
      WHERE EQUIESTADO = 'A' AND EMPRCODI = {0}
      ORDER BY EQUINOMB
    </query>
  </Sql>
  <!--DEMANDA DPO - ITERACION 2-->


  <!-- CPPA-ASSETEC.2024-->
  <Sql>
    <key>ListaCentralesGeneradoras</key>
    <query>
      SELECT
      equicodi,
      '[' || equicodi || '] ' || equinomb ||
      CASE
      WHEN equiestado = 'B' THEN ' [' || equiestado || ']'
      WHEN equiestado = 'F' THEN ' [' || equiestado || ']'
      ELSE ''
      END AS equinombconcatenado
      FROM
      vw_eq_central_generacion
      WHERE
      equicodi IN (SELECT equicodi FROM trn_codigo_entrega)
      AND equiestado IN ('A', 'B', 'F')
      ORDER BY
      equinomb ASC
    </query>
  </Sql>
  

  <!--INICIO GESPROTECT - 20241031-->
  <Sql>
		<key>ListaEquipoCOES</key>
		<query>
			SELECT
			e.equicodi,
			CASE WHEN ee.epequicodi IS NOT NULL THEN 1 ELSE 0 END AS flagenprotec,
			ee.epequinomb AS epequinombenprotec,
			emp.emprnomb,
			fam.famnomb,
			a.areanomb,
			e.equinomb,
			e.equiestado,
			ee.epequicodi
			FROM
			eq_equipo e
			INNER JOIN si_empresa emp ON emp.emprcodi = e.emprcodi
			INNER JOIN eq_familia fam ON fam.famcodi = e.famcodi
			INNER JOIN eq_area a ON a.areacodi = e.areacodi
			LEFT JOIN epr_equipo ee ON e.equicodi = ee.equicodi AND ee.EPEQUIESTREGISTRO = '1'
			WHERE e.famcodi in (2,3,6)
			AND e.equiestado in ('A','P')
			AND ( :v_areacodi IS NULL OR e.areacodi = :v_areacodi )
			AND ( :v_famcodi IS NULL OR e.famcodi = :v_famcodi )
			AND ( :v_equinomb IS NULL OR upper(e.equinomb) LIKE '%' || upper(:v_equinomb) || '%' OR upper(e.equiabrev) LIKE '%' || upper(:v_equinomb) || '%' )
			AND ( nvl(:check_en_protect,'N') = 'N' OR (:check_en_protect = 'S' and ee.epequicodi is null ))
			ORDER BY 2 desc,6,5,7
		</query>
	</Sql>

	<Sql>
		<key>ListaReporteEquipoCOES</key>
		<query>
			Select ap.areacodi, az.areanomb as zona, emp.emprnomb as titular,nvl(ap.epareanomb,su.areanomb) as subestacion,nvl(ep.epequinomb,e.equinomb) as celda
			from epr_equipo ep join eq_equipo e on ep.equicodi = e.equicodi and ep.epequiestregistro='1'
			join eq_familia fa on e.famcodi = fa.famcodi
			left join epr_area ap on e.areacodi = ap.areacodi and ap.epareaestregistro='1'
			left join si_empresa emp on e.emprcodi = emp.emprcodi
			left join eq_area su on ap.areacodi = su.areacodi
			left join eq_area az on ap.areacodizona=az.areacodi
			where e.famcodi in (2,3,6)
			AND e.equiestado in ('A','P')
			and (nvl(:areacodi,0)=0 or e.areacodi = :areacodi)
			and (nvl(:famcodi,0)=0 or e.famcodi = :famcodi)
			and (trim(:equinomb) is null or upper(nvl(ep.epequinomb,e.equinomb)) like '%'||upper(:equinomb)||'%')
			order by 1,2,3,4
		</query>
	</Sql>
	<!--FIN GESPROTECT-->

	<!--Equipo Proteccion-->

	<Sql>
		<key>ListMaestroCeldaProteccion</key>
		<query>
			select e.equicodi||'='||trim(nvl(ap.epareanomb,a.areanomb))||'_'||ta.tareaabrev||'\'||trim(nvl(ep.epequinomb,e.equinomb)) as emprabrev,trim(nvl(ap.epareanomb,a.areanomb))||'_'||ta.tareaabrev as areanomb,nvl(ep.epequinomb,e.equinomb) as equinomb,emp.emprnomb
			from eq_equipo e join epr_equipo ep on e.equicodi = ep.equicodi and ep.epequiestregistro='1'
			left join epr_area ap on e.areacodi = ap.areacodi and ap.epareaestregistro='1'
			left join eq_area a on e.areacodi = a.areacodi
			left join si_empresa emp on e.emprcodi = emp.emprcodi
			left join eq_tipoarea ta on a.tareacodi = ta.tareacodi
			where famcodi in (6,2,3)
			and equiestado in ('A','P') 
			order by a.areanomb,nvl(ep.epequinomb,e.equinomb)
		</query>
	</Sql>

	<Sql>
		<key>ListMaestroReleProteccion</key>
		<query>
			with equipo as (
			select e.equicodi||'='||trim(nvl(ap.epareanomb,a.areanomb))||''||trim(ta.tareaabrev)||'\'||trim(nvl(ecp.epequinomb,ec.equinomb))||'\'||trim(e.equinomb) as emprabrev,trim(nvl(ap.epareanomb,a.areanomb))||''||ta.tareaabrev as areanomb,e.equinomb,trim(emp.emprnomb) as emprnomb
			,e.equicodi
			from eq_equipo e
			join eq_equirel er on e.equicodi = er.equicodi2 and er.tiporelcodi = 29
			left join eq_equipo ec on er.equicodi1 = ec.equicodi
			left join epr_equipo ecp on ec.equicodi = ecp.equicodi and ecp.epequiestregistro='1'
			left join eq_area a on e.areacodi = a.areacodi
			left join epr_area ap on a.areacodi = ap.areacodi and ap.epareaestregistro='1'
			left join si_empresa emp on e.emprcodi = emp.emprcodi
			left join eq_tipoarea ta on a.tareacodi = ta.tareacodi
			where e.famcodi = 53
			order by a.areanomb,e.equinomb
			)
			, ult_fecha_prop AS (
			SELECT
			p.equicodi,
			p.propcodi,
			MAX(p.fechapropequi) AS fechapropequi
			FROM
			eq_propequi p
			JOIN equipo e ON p.equicodi = e.equicodi
			GROUP BY
			p.equicodi,
			p.propcodi
			)
			, data_prop AS (
			SELECT
			pe.equicodi,
			pe.propcodi,
			pe.valor
			FROM
			eq_propequi pe
			JOIN ult_fecha_prop up ON pe.equicodi = up.equicodi
			AND pe.propcodi = up.propcodi
			AND pe.fechapropequi = up.fechapropequi
			), eq_propiedad AS (
			SELECT
			*
			FROM
			data_prop PIVOT (
			MAX(valor)
			FOR propcodi
			IN (
			3304 estado
			,3306 tipo_uso
			)
			)
			)
			SELECT
			e.emprabrev,e.areanomb,e.equinomb,e.emprnomb
			FROM
			eq_propiedad p
			JOIN equipo e ON p.equicodi = e.equicodi
			WHERE p.tipo_uso = :tipo_uso
			and p.estado in ('11','12')
		</query>
	</Sql>
	<Sql>
		<key>ListMaestroInterruptorProteccion</key>
		<query>
			select e.equicodi||'='||trim(nvl(ap.epareanomb,a.areanomb))||'_'||trim(ta.tareaabrev)||'\'||trim(e.equinomb) as emprabrev,trim(nvl(ap.epareanomb,a.areanomb))||'_'||trim(ta.tareaabrev) as areanomb,e.equinomb,emp.emprnomb
			from eq_equipo e
			join eq_area a on e.areacodi = a.areacodi
			join epr_area ap on a.areacodi = ap.areacodi and ap.epareaestregistro='1'
			left join si_empresa emp on e.emprcodi = emp.emprcodi
			left join eq_tipoarea ta on a.tareacodi = ta.tareacodi
			where famcodi = 16
			and equiestado in ('A','P') 
			order by a.areanomb,e.equinomb
		</query>
	</Sql>
	<Sql>
		<key>ListLineaEvaluacion</key>
		<query>
			select eq.equicodi
			,null as areadesc
			,emp.emprnomb as EMPRNOMB
			,eq.equiabrev as EQUIABREV
			,ar.areanomb as AREANOMB
			,eq.equitension as EQUITENSION
			,eq.equiestado as EQUIESTADO
			,est.eqcatddescripcion as EQUIESTADODESC
			from eq_equipo eq join si_empresa emp on eq.emprcodi = emp.emprcodi
			left join eq_area ar on eq.areacodi=ar.areacodi
			left join eq_prop_catalogo_data est on est.eqcatccodi = 6 and est.eqcatdabrev = eq.equiestado
			where eq.famcodi=8 and eq.equiestado != 'X'
			and (nvl(:equicodi,0) = 0 or eq.equicodi =:equicodi )
			and (trim(:codigo) is null or upper(eq.equiabrev) like '%'||upper(:codigo)||'%' )
			and (trim(:AREANOMB) is null or upper(ar.areanomb) like '%'||upper(:AREANOMB)||'%' )
			and (nvl(:emprcodi,0) = 0 or eq.emprcodi =:emprcodi )
			and (trim(:equiestado) is null or eq.equiestado = :equiestado )
			and not exists (select 1 from epr_equipo ep
			where ep.equicodi = eq.equicodi
			and ep.epequiestregistro = '1'
			)
			order by eq.equiabrev
		</query>
	</Sql>



	<!--Equipo Proteccion Fin-->

	<!--INICIO GESPROTECT - 20250206-->
	<Sql>
		<key>ListMaestroEquiposLinea</key>
		<query>
			select e.equicodi||'='||trim(a.areanomb)||'\'||trim(e.equiabrev) as emprabrev,
			trim(a.areanomb) as areanomb,e.equiabrev as equinomb,emp.emprnomb
			from eq_equipo e left join epr_equipo ep on e.equicodi = ep.equicodi and ep.epequiestregistro='1'
			left join eq_area a on e.areacodi = a.areacodi
			left join si_empresa emp on e.emprcodi = emp.emprcodi
			left join eq_tipoarea ta on a.tareacodi = ta.tareacodi
			where famcodi = 8
			and equiestado in ('A','P')
			order by e.equiabrev
		</query>
	</Sql>
	<Sql>
		<key>ListMaestroEquiposArea</key>
		<query>
			select ea.areacodi||'='||areanomb as areadesc,areanomb
			from eq_area ea
			where  ea.areaestado='A' and ea.anivelcodi = 5
			order by areanomb asc
		</query>
	</Sql>
	<Sql>
		<key>ListMaestroEquiposCondensador</key>
		<query>
			select e.equicodi||'='||trim(nvl(ap.epareanomb,a.areanomb))||'_'||ta.tareaabrev||'\'||trim(e.equinomb) as emprabrev,trim(nvl(ap.epareanomb,a.areanomb))||'_'||ta.tareaabrev as areanomb,e.equinomb as equinomb,emp.emprnomb
			from eq_equipo e left join epr_equipo ep on e.equicodi = ep.equicodi and ep.epequiestregistro='1'
			left join epr_area ap on e.areacodi = ap.areacodi and ap.epareaestregistro='1'
			left join eq_area a on e.areacodi = a.areacodi
			left join si_empresa emp on e.emprcodi = emp.emprcodi
			left join eq_tipoarea ta on a.tareacodi = ta.tareacodi
			where famcodi = 15
			and equiestado in ('A','P')
			order by a.areanomb,nvl(ep.epequinomb,e.equinomb)
		</query>
	</Sql>
	<Sql>
		<key>ListMaestroEquiposReactor</key>
		<query>
			select e.equicodi||'='||trim(a.areanomb)||'\'||trim(e.equiabrev) as emprabrev,
			trim(a.areanomb) as areanomb,e.equiabrev as equinomb,emp.emprnomb
			from eq_equipo e
			left join eq_area a on e.areacodi = a.areacodi
			left join si_empresa emp on e.emprcodi = emp.emprcodi
			left join eq_tipoarea ta on a.tareacodi = ta.tareacodi
			where famcodi = 12
			and equiestado in ('A','P')
			order by e.equiabrev
		</query>
	</Sql>
	<Sql>
		<key>ListMaestroEquiposCeldasAcoplamiento</key>
		<query>
			select e.equicodi||'='||ta.tareaabrev||' '||trim(nvl(ap.epareanomb,a.areanomb))||'\'||trim(nvl(ep.epequinomb,e.equinomb)) as emprabrev,
			ta.tareaabrev||' '||trim(nvl(ap.epareanomb,a.areanomb)) as areanomb,nvl(ep.epequinomb,e.equinomb) as equinomb,emp.emprnomb
			from eq_equipo e left join epr_equipo ep on e.equicodi = ep.equicodi and ep.epequiestregistro='1'
			left join epr_area ap on e.areacodi = ap.areacodi and ap.epareaestregistro='1'
			left join eq_area a on e.areacodi = a.areacodi
			left join si_empresa emp on e.emprcodi = emp.emprcodi
			left join eq_tipoarea ta on a.tareacodi = ta.tareacodi
			where famcodi = 6
			and equiestado='A'
			and equinomb like '%ACOP%'
			order by a.areanomb,nvl(ep.epequinomb,e.equinomb)
		</query>
	</Sql>
	<Sql>
		<key>ListMaestroEquiposTransformador</key>
		<query>
			select e.equicodi||'='||trim(a.areanomb)||'\'||trim(fa.famabrev)||'\'||trim(e.equiabrev) as emprabrev,
			trim(a.areanomb) as areanomb,e.equiabrev as equinomb,emp.emprnomb
			from eq_equipo e join eq_familia fa on e.famcodi = fa.famcodi
			left join eq_area a on e.areacodi = a.areacodi
			left join si_empresa emp on e.emprcodi = emp.emprcodi
			left join eq_tipoarea ta on a.tareacodi = ta.tareacodi
			where e.famcodi in (9,10,47)
			and e.equiestado in ('A','P')
			order by a.areanomb,e.equiabrev
		</query>
	</Sql>
	<!--FIN GESPROTECT - 20250206-->

</Sqls>