<?xml version="1.0" encoding="utf-8" ?>

<Sqls>

  <Sql>
    <key>GetById</key>
    <query>select * from trn_factor_perdida where facpercodi = :facpercodi</query>
  </Sql>

  <Sql>
    <key>Save</key>
    <query>
      insert into trn_factor_perdida
      (
      facpercodi, barrcodi, facperbarrnombre, pericodi, facperbase, facperversion, facperdia,
      facper1, facper2, facper3, facper4, facper5, facper6, facper7, facper8, facper9, facper10, facper11, facper12,
      facper13, facper14, facper15, facper16, facper17, facper18, facper19, facper20, facper21, facper22, facper23, facper24,
      facper25, facper26, facper27, facper28, facper29, facper30, facper31, facper32, facper33, facper34, facper35, facper36,
      facper37, facper38, facper39, facper40, facper41, facper42, facper43, facper44, facper45, facper46, facper47, facper48,
      facperusername, facperfecins
      )
      values
      (
      :facpercodi, :barrcodi, :barrnombre, :pericodi, :facperbase, :facperversion, :facperdia,
      :facper1, :facper2, :facper3, :facper4, :facper5, :facper6, :facper7, :facper8, :facper9, :facper10, :facper11, :facper12,
      :facper13, :facper14, :facper15, :facper16, :facper17, :facper18, :facper19, :facper20, :facper21, :facper22, :facper23, :facper24,
      :facper25, :facper26, :facper27, :facper28, :facper29, :facper30, :facper31, :facper32, :facper33, :facper34, :facper35, :facper36,
      :facper37, :facper38, :facper39, :facper40, :facper41, :facper42, :facper43, :facper44, :facper45, :facper46, :facper47, :facper48,
      :facperusername, :facperfecins
      )
    </query>
  </Sql>

  <Sql>
    <key>Delete</key>
    <query>delete from trn_factor_perdida where pericodi = :pericodi and facperversion = :facperversion</query>
  </Sql>
  
  <Sql>
    <key>GetMaxId</key>
    <query>
      select nvl(max(facpercodi), 0) + 1 from trn_factor_perdida
    </query>
  </Sql>

  <Sql>
    <key>GetMinId</key>
    <query>
      select nvl(min(facpercodi), 0) - 2 from trn_factor_perdida
    </query>
  </Sql>
  
  <Sql>
    <key>ListByPeriodoVersion</key>
    <query>
      select * from trn_factor_perdida where pericodi = :pericodi and facperversion = :facperversion Order by facpercodi
    </query>
  </Sql>
  
  <Sql>
    <key>CopiarFactorPerdida</key>
    <query>
      Insert into trn_factor_perdida (facpercodi,pericodi,facperversion,
      barrcodi, facperdia, facperbase, facperbarrnombre,
      facper1,facper2,facper3,facper4,facper5,facper6,facper7,facper8,facper9,facper10,
      facper11,facper12,facper13,facper14,facper15,facper16,facper17,facper18,facper19,facper20,
      facper21,facper22,facper23,facper24,facper25,facper26,facper27,facper28,facper29,facper30,
      facper31,facper32,facper33,facper34,facper35,facper36,facper37,facper38,facper39,facper40,
      facper41,facper42,facper43,facper44,facper45,facper46,facper47,facper48,facperusername,facperfecins)
      select (:facpercodi - rownum) as facpercodi, :pericodi, :facperversion <!--iVersionNew-->,
      barrcodi, facperdia, facperbase, facperbarrnombre,
      facper1,facper2,facper3,facper4,facper5,facper6,facper7,facper8,facper9,facper10,
      facper11,facper12,facper13,facper14,facper15,facper16,facper17,facper18,facper19,facper20,
      facper21,facper22,facper23,facper24,facper25,facper26,facper27,facper28,facper29,facper30,
      facper31,facper32,facper33,facper34,facper35,facper36,facper37,facper38,facper39,facper40,
      facper41,facper42,facper43,facper44,facper45,facper46,facper47,facper48,facperusername,sysdate
      from trn_factor_perdida where pericodi = :pericodi and facperversion = :barrcodi <!--iVersionOld-->
      order by facperbase desc, barrcodi, facperdia
    </query>
  </Sql>
  <Sql>
    <key>CopiarFactorPerdidaCongestion</key>
    <query>
      Insert into TRN_COSTO_MARGINAL_CONGENE (congenecodi,TIPCOSTO,pericodi,congeneversion,
      barrcodi, congenedia, congenebase, congenebarrnombre,
      CONGENEPROMEDIO,
      congene1,congene2,congene3,congene4,congene5,congene6,congene7,congene8,congene9,congene10,
      congene11,congene12,congene13,congene14,congene15,congene16,congene17,congene18,congene19,congene20,
      congene21,congene22,congene23,congene24,congene25,congene26,congene27,congene28,congene29,congene30,
      congene31,congene32,congene33,congene34,congene35,congene36,congene37,congene38,congene39,congene40,
      congene41,congene42,congene43,congene44,congene45,congene46,congene47,congene48,congeneusername,congenefecins)
      select (:congenecodi - rownum) as congenecodi, TIPCOSTO,:pericodi, :congeneversion <!--iVersionNew-->,
      barrcodi, congenedia, congenebase, congenebarrnombre,
      CONGENEPROMEDIO,
      congene1,congene2,congene3,congene4,congene5,congene6,congene7,congene8,congene9,congene10,
      congene11,congene12,congene13,congene14,congene15,congene16,congene17,congene18,congene19,congene20,
      congene21,congene22,congene23,congene24,congene25,congene26,congene27,congene28,congene29,congene30,
      congene31,congene32,congene33,congene34,congene35,congene36,congene37,congene38,congene39,congene40,
      congene41,congene42,congene43,congene44,congene45,congene46,congene47,congene48,congeneusername,sysdate
      from TRN_COSTO_MARGINAL_CONGENE where pericodi = :pericodi and congeneversion = :barrcodi <!--iVersionOld-->
      order by congenebase desc, barrcodi, congenedia
    </query>
  </Sql>
  <Sql>
    <key>CopiarCostoMarginal</key>
    <query>
      insert into trn_costo_marginal (cosmarcodi, pericodi, cosmarversion, facpercodi,
      barrcodi, cosmardia, cosmarbarratransferencia, cosmarpromediodia,
      cosmar1,cosmar2,cosmar3,cosmar4,cosmar5,cosmar6,cosmar7,cosmar8,cosmar9,cosmar10,
      cosmar11,cosmar12,cosmar13,cosmar14,cosmar15,cosmar16,cosmar17,cosmar18,cosmar19,cosmar20,
      cosmar21,cosmar22,cosmar23,cosmar24,cosmar25,cosmar26,cosmar27,cosmar28,cosmar29,cosmar30,
      cosmar31,cosmar32,cosmar33,cosmar34,cosmar35,cosmar36,cosmar37,cosmar38,cosmar39,cosmar40,
      cosmar41,cosmar42,cosmar43,cosmar44,cosmar45,cosmar46,cosmar47,cosmar48,cosmar49,cosmar50,
      cosmar51,cosmar52,cosmar53,cosmar54,cosmar55,cosmar56,cosmar57,cosmar58,cosmar59,cosmar60,
      cosmar61,cosmar62,cosmar63,cosmar64,cosmar65,cosmar66,cosmar67,cosmar68,cosmar69,cosmar70,
      cosmar71,cosmar72,cosmar73,cosmar74,cosmar75,cosmar76,cosmar77,cosmar78,cosmar79,cosmar80,
      cosmar81,cosmar82,cosmar83,cosmar84,cosmar85,cosmar86,cosmar87,cosmar88,cosmar89,cosmar90,
      cosmar91,cosmar92,cosmar93,cosmar94,cosmar95,cosmar96,cosmarusername, cosmarfecins)
      select (:cosmarcodi - rownum) as cosmarcodi, :pericodi, :facperversion <!--iVersionNew-->, tmp.idnuevo,
      barrcodi, cosmardia, cosmarbarratransferencia, cosmarpromediodia,
      cosmar1,cosmar2,cosmar3,cosmar4,cosmar5,cosmar6,cosmar7,cosmar8,cosmar9,cosmar10,
      cosmar11,cosmar12,cosmar13,cosmar14,cosmar15,cosmar16,cosmar17,cosmar18,cosmar19,cosmar20,
      cosmar21,cosmar22,cosmar23,cosmar24,cosmar25,cosmar26,cosmar27,cosmar28,cosmar29,cosmar30,
      cosmar31,cosmar32,cosmar33,cosmar34,cosmar35,cosmar36,cosmar37,cosmar38,cosmar39,cosmar40,
      cosmar41,cosmar42,cosmar43,cosmar44,cosmar45,cosmar46,cosmar47,cosmar48,cosmar49,cosmar50,
      cosmar51,cosmar52,cosmar53,cosmar54,cosmar55,cosmar56,cosmar57,cosmar58,cosmar59,cosmar60,
      cosmar61,cosmar62,cosmar63,cosmar64,cosmar65,cosmar66,cosmar67,cosmar68,cosmar69,cosmar70,
      cosmar71,cosmar72,cosmar73,cosmar74,cosmar75,cosmar76,cosmar77,cosmar78,cosmar79,cosmar80,
      cosmar81,cosmar82,cosmar83,cosmar84,cosmar85,cosmar86,cosmar87,cosmar88,cosmar89,cosmar90,
      cosmar91,cosmar92,cosmar93,cosmar94,cosmar95,cosmar96,cosmarusername, sysdate
      from trn_costo_marginal cm inner join trn_tmp_equiv tmp on cm.facpercodi = tmp.idanterior
      order by barrcodi, cosmardia
    </query>
  </Sql>
  
  <Sql>
    <key>CopiarTemporal</key>
    <query>
      insert into trn_tmp_equiv (idnuevo, idanterior)
      select :facpercodi - rownum as idnuevo, facpercodi as idanterior
      from trn_factor_perdida where pericodi = :pericodi and facperversion = :barrcodi <!--iVersionOld-->
      order by facperbase desc, barrcodi, facperdia
    </query>
  </Sql>

  <Sql>
    <key>CopiarSGOCOES_OLD</key>
    <query>
      insert into trn_factor_perdida (facpercodi,pericodi,barrcodi,facperversion,facperdia,facperbase,facperbarrnombre,
      facper1,facper2,facper3,facper4,facper5,facper6,facper7,facper8,facper9,facper10,
      facper11,facper12,facper13,facper14,facper15,facper16,facper17,facper18,facper19,facper20,
      facper21,facper22,facper23,facper24,facper25,facper26,facper27,facper28,facper29,facper30,
      facper31,facper32,facper33,facper34,facper35,facper36,facper37,facper38,facper39,facper40,
      facper41,facper42,facper43,facper44,facper45,facper46,facper47,facper48,
      facperusername,facperfecins)
      select (:facpercodi + rownum) as facpercodi, :pericodi, barrcodi, :facperversion, to_number(substr(fecha, 9,2)) as facperdia, 'N' as facperbase,
      (select b.barrbarratransferencia from trn_barra b where b.barrcodi = t1.barrcodi) as facperbarrnombre,
      facper1,facper2,facper3,facper4,facper5,facper6,facper7,facper8,facper9,facper10,
      facper11,facper12,facper13,facper14,facper15,facper16,facper17,facper18,facper19,facper20,
      facper21,facper22,facper23,facper24,facper25,facper26,facper27,facper28,facper29,facper30,
      facper31,facper32,facper33,facper34,facper35,facper36,facper37,facper38,facper39,facper40,
      facper41,facper42,facper43,facper44,facper45,facper46,facper47,facper48,
      :facperusername, sysdate
      from (
      select barrcodi, to_char(fecha, 'YYYY-MM-DD') as fecha,
      sum(h1) as facper1, sum(h2) as facper2, sum(h3) as facper3, sum(h4) as facper4, sum(h5) as facper5,
      sum(h6) as facper6, sum(h7) as facper7, sum(h8) as facper8, sum(h9) as facper9, sum(h10) as facper10,
      sum(h11) as facper11, sum(h12) as facper12, sum(h13) as facper13, sum(h14) as facper14, sum(h15) as facper15,
      sum(h16) as facper16, sum(h17) as facper17, sum(h18) as facper18, sum(h19) as facper19, sum(h20) as facper20,
      sum(h21) as facper21, sum(h22) as facper22, sum(h23) as facper23, sum(h24) as facper24, sum(h25) as facper25,
      sum(h26) as facper26, sum(h27) as facper27, sum(h28) as facper28, sum(h29) as facper29, sum(h30) as facper30,
      sum(h31) as facper31, sum(h32) as facper32, sum(h33) as facper33, sum(h34) as facper34, sum(h35) as facper35,
      sum(h36) as facper36, sum(h37) as facper37, sum(h38) as facper38, sum(h39) as facper39, sum(h40) as facper40,
      sum(h41) as facper41, sum(h42) as facper42, sum(h43) as facper43, sum(h44) as facper44, sum(h45) as facper45,
      sum(h46) as facper46, sum(h47) as facper47, sum(h48) as facper48
      from (
      select cm.barrcodi, cm.cmgrfecha as fecha, cm.cmgrcorrelativo, (nvl(cm.cmgrtotal, 0) / 1000) as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm
      where cm.cmgrcorrelativo = 1 and to_char(cm.cmgrfecha, 'YYYYMM') = :facperbase
      union
      select cm.barrcodi, cm.cmgrfecha as fecha, cm.cmgrcorrelativo, 0 as h1, (nvl(cm.cmgrtotal, 0) / 1000) as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm
      where cm.cmgrcorrelativo = 2 and to_char(cm.cmgrfecha, 'YYYYMM') = :facperbase
      union
      select cm.barrcodi, cm.cmgrfecha as fecha, cm.cmgrcorrelativo, 0 as h1, 0 as h2, (nvl(cm.cmgrtotal, 0) / 1000) as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm
      where cm.cmgrcorrelativo = 3 and to_char(cm.cmgrfecha, 'YYYYMM') = :facperbase
      union
      select cm.barrcodi, cm.cmgrfecha as fecha, cm.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, (nvl(cm.cmgrtotal, 0) / 1000) as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm
      where cm.cmgrcorrelativo = 4 and to_char(cm.cmgrfecha, 'YYYYMM') = :facperbase
      union
      select cm.barrcodi, cm.cmgrfecha as fecha, cm.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, (nvl(cm.cmgrtotal, 0) / 1000) as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm
      where cm.cmgrcorrelativo = 5 and to_char(cm.cmgrfecha, 'YYYYMM') = :facperbase
      union
      select cm.barrcodi, cm.cmgrfecha as fecha, cm.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, (nvl(cm.cmgrtotal, 0) / 1000) as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm
      where cm.cmgrcorrelativo = 6 and to_char(cm.cmgrfecha, 'YYYYMM') = :facperbase
      union
      select cm.barrcodi, cm.cmgrfecha as fecha, cm.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, (nvl(cm.cmgrtotal, 0) / 1000) as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm
      where cm.cmgrcorrelativo = 7 and to_char(cm.cmgrfecha, 'YYYYMM') = :facperbase
      union
      select cm.barrcodi, cm.cmgrfecha as fecha, cm.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, (nvl(cm.cmgrtotal, 0) / 1000) as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm
      where cm.cmgrcorrelativo = 8 and to_char(cm.cmgrfecha, 'YYYYMM') = :facperbase
      union
      select cm.barrcodi, cm.cmgrfecha as fecha, cm.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, (nvl(cm.cmgrtotal, 0) / 1000) as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm
      where cm.cmgrcorrelativo = 9 and to_char(cm.cmgrfecha, 'YYYYMM') = :facperbase
      union
      select cm.barrcodi, cm.cmgrfecha as fecha, cm.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, (nvl(cm.cmgrtotal, 0) / 1000) as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm
      where cm.cmgrcorrelativo = 10 and to_char(cm.cmgrfecha, 'YYYYMM') = :facperbase
      union
      select cm.barrcodi, cm.cmgrfecha as fecha, cm.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      (nvl(cm.cmgrtotal, 0) / 1000) as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm
      where cm.cmgrcorrelativo = 11 and to_char(cm.cmgrfecha, 'YYYYMM') = :facperbase
      union
      select cm.barrcodi, cm.cmgrfecha as fecha, cm.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, (nvl(cm.cmgrtotal, 0) / 1000) as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm
      where cm.cmgrcorrelativo = 12 and to_char(cm.cmgrfecha, 'YYYYMM') = :facperbase
      union
      select cm.barrcodi, cm.cmgrfecha as fecha, cm.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, (nvl(cm.cmgrtotal, 0) / 1000) as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm
      where cm.cmgrcorrelativo = 13 and to_char(cm.cmgrfecha, 'YYYYMM') = :facperbase
      union
      select cm.barrcodi, cm.cmgrfecha as fecha, cm.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, (nvl(cm.cmgrtotal, 0) / 1000) as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm
      where cm.cmgrcorrelativo = 14 and to_char(cm.cmgrfecha, 'YYYYMM') = :facperbase
      union
      select cm.barrcodi, cm.cmgrfecha as fecha, cm.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, (nvl(cm.cmgrtotal, 0) / 1000) as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm
      where cm.cmgrcorrelativo = 15 and to_char(cm.cmgrfecha, 'YYYYMM') = :facperbase
      union
      select cm.barrcodi, cm.cmgrfecha as fecha, cm.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, (nvl(cm.cmgrtotal, 0) / 1000) as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm
      where cm.cmgrcorrelativo = 16 and to_char(cm.cmgrfecha, 'YYYYMM') = :facperbase
      union
      select cm.barrcodi, cm.cmgrfecha as fecha, cm.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, (nvl(cm.cmgrtotal, 0) / 1000) as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm
      where cm.cmgrcorrelativo = 17 and to_char(cm.cmgrfecha, 'YYYYMM') = :facperbase
      union
      select cm.barrcodi, cm.cmgrfecha as fecha, cm.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, (nvl(cm.cmgrtotal, 0) / 1000) as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm
      where cm.cmgrcorrelativo = 18 and to_char(cm.cmgrfecha, 'YYYYMM') = :facperbase
      union
      select cm.barrcodi, cm.cmgrfecha as fecha, cm.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, (nvl(cm.cmgrtotal, 0) / 1000) as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm
      where cm.cmgrcorrelativo = 19 and to_char(cm.cmgrfecha, 'YYYYMM') = :facperbase
      union
      select cm.barrcodi, cm.cmgrfecha as fecha, cm.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, (nvl(cm.cmgrtotal, 0) / 1000) as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm
      where cm.cmgrcorrelativo = 20 and to_char(cm.cmgrfecha, 'YYYYMM') = :facperbase
      union
      select cm.barrcodi, cm.cmgrfecha as fecha, cm.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      (nvl(cm.cmgrtotal, 0) / 1000) as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm
      where cm.cmgrcorrelativo = 21 and to_char(cm.cmgrfecha, 'YYYYMM') = :facperbase
      union
      select cm.barrcodi, cm.cmgrfecha as fecha, cm.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, (nvl(cm.cmgrtotal, 0) / 1000) as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm
      where cm.cmgrcorrelativo = 22 and to_char(cm.cmgrfecha, 'YYYYMM') = :facperbase
      union
      select cm.barrcodi, cm.cmgrfecha as fecha, cm.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, (nvl(cm.cmgrtotal, 0) / 1000) as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm
      where cm.cmgrcorrelativo = 23 and to_char(cm.cmgrfecha, 'YYYYMM') = :facperbase
      union
      select cm.barrcodi, cm.cmgrfecha as fecha, cm.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, (nvl(cm.cmgrtotal, 0) / 1000) as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm
      where cm.cmgrcorrelativo = 24 and to_char(cm.cmgrfecha, 'YYYYMM') = :facperbase
      union
      select cm.barrcodi, cm.cmgrfecha as fecha, cm.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, (nvl(cm.cmgrtotal, 0) / 1000) as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm
      where cm.cmgrcorrelativo = 25 and to_char(cm.cmgrfecha, 'YYYYMM') = :facperbase
      union
      select cm.barrcodi, cm.cmgrfecha as fecha, cm.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, (nvl(cm.cmgrtotal, 0) / 1000) as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm
      where cm.cmgrcorrelativo = 26 and to_char(cm.cmgrfecha, 'YYYYMM') = :facperbase
      union
      select cm.barrcodi, cm.cmgrfecha as fecha, cm.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, (nvl(cm.cmgrtotal, 0) / 1000) as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm
      where cm.cmgrcorrelativo = 27 and to_char(cm.cmgrfecha, 'YYYYMM') = :facperbase
      union
      select cm.barrcodi, cm.cmgrfecha as fecha, cm.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, (nvl(cm.cmgrtotal, 0) / 1000) as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm
      where cm.cmgrcorrelativo = 28 and to_char(cm.cmgrfecha, 'YYYYMM') = :facperbase
      union
      select cm.barrcodi, cm.cmgrfecha as fecha, cm.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, (nvl(cm.cmgrtotal, 0) / 1000) as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm
      where cm.cmgrcorrelativo = 29 and to_char(cm.cmgrfecha, 'YYYYMM') = :facperbase
      union
      select cm.barrcodi, cm.cmgrfecha as fecha, cm.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, (nvl(cm.cmgrtotal, 0) / 1000) as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm
      where cm.cmgrcorrelativo = 30 and to_char(cm.cmgrfecha, 'YYYYMM') = :facperbase
      union
      select cm.barrcodi, cm.cmgrfecha as fecha, cm.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      (nvl(cm.cmgrtotal, 0) / 1000) as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm
      where cm.cmgrcorrelativo = 31 and to_char(cm.cmgrfecha, 'YYYYMM') = :facperbase
      union
      select cm.barrcodi, cm.cmgrfecha as fecha, cm.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, (nvl(cm.cmgrtotal, 0) / 1000) as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm
      where cm.cmgrcorrelativo = 32 and to_char(cm.cmgrfecha, 'YYYYMM') = :facperbase
      union
      select cm.barrcodi, cm.cmgrfecha as fecha, cm.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, (nvl(cm.cmgrtotal, 0) / 1000) as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm
      where cm.cmgrcorrelativo = 33 and to_char(cm.cmgrfecha, 'YYYYMM') = :facperbase
      union
      select cm.barrcodi, cm.cmgrfecha as fecha, cm.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, (nvl(cm.cmgrtotal, 0) / 1000) as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm
      where cm.cmgrcorrelativo = 34 and to_char(cm.cmgrfecha, 'YYYYMM') = :facperbase
      union
      select cm.barrcodi, cm.cmgrfecha as fecha, cm.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, (nvl(cm.cmgrtotal, 0) / 1000) as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm
      where cm.cmgrcorrelativo = 35 and to_char(cm.cmgrfecha, 'YYYYMM') = :facperbase
      union
      select cm.barrcodi, cm.cmgrfecha as fecha, cm.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, (nvl(cm.cmgrtotal, 0) / 1000) as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm
      where cm.cmgrcorrelativo = 36 and to_char(cm.cmgrfecha, 'YYYYMM') = :facperbase
      union
      select cm.barrcodi, cm.cmgrfecha as fecha, cm.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, (nvl(cm.cmgrtotal, 0) / 1000) as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm
      where cm.cmgrcorrelativo = 37 and to_char(cm.cmgrfecha, 'YYYYMM') = :facperbase
      union
      select cm.barrcodi, cm.cmgrfecha as fecha, cm.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, (nvl(cm.cmgrtotal, 0) / 1000) as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm
      where cm.cmgrcorrelativo = 38 and to_char(cm.cmgrfecha, 'YYYYMM') = :facperbase
      union
      select cm.barrcodi, cm.cmgrfecha as fecha, cm.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, (nvl(cm.cmgrtotal, 0) / 1000) as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm
      where cm.cmgrcorrelativo = 39 and to_char(cm.cmgrfecha, 'YYYYMM') = :facperbase
      union
      select cm.barrcodi, cm.cmgrfecha as fecha, cm.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, (nvl(cm.cmgrtotal, 0) / 1000) as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm
      where cm.cmgrcorrelativo = 40 and to_char(cm.cmgrfecha, 'YYYYMM') = :facperbase
      union
      select cm.barrcodi, cm.cmgrfecha as fecha, cm.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      (nvl(cm.cmgrtotal, 0) / 1000) as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm
      where cm.cmgrcorrelativo = 41 and to_char(cm.cmgrfecha, 'YYYYMM') = :facperbase
      union
      select cm.barrcodi, cm.cmgrfecha as fecha, cm.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, (nvl(cm.cmgrtotal, 0) / 1000) as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm
      where cm.cmgrcorrelativo = 42 and to_char(cm.cmgrfecha, 'YYYYMM') = :facperbase
      union
      select cm.barrcodi, cm.cmgrfecha as fecha, cm.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, (nvl(cm.cmgrtotal, 0) / 1000) as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm
      where cm.cmgrcorrelativo = 43 and to_char(cm.cmgrfecha, 'YYYYMM') = :facperbase
      union
      select cm.barrcodi, cm.cmgrfecha as fecha, cm.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, (nvl(cm.cmgrtotal, 0) / 1000) as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm
      where cm.cmgrcorrelativo = 44 and to_char(cm.cmgrfecha, 'YYYYMM') = :facperbase
      union
      select cm.barrcodi, cm.cmgrfecha as fecha, cm.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, (nvl(cm.cmgrtotal, 0) / 1000) as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm
      where cm.cmgrcorrelativo = 45 and to_char(cm.cmgrfecha, 'YYYYMM') = :facperbase
      union
      select cm.barrcodi, cm.cmgrfecha as fecha, cm.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, (nvl(cm.cmgrtotal, 0) / 1000) as h46, 0 as h47, 0 as h48
      from si_costomarginal cm
      where cm.cmgrcorrelativo = 46 and to_char(cm.cmgrfecha, 'YYYYMM') = :facperbase
      union
      select cm.barrcodi, cm.cmgrfecha as fecha, cm.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, (nvl(cm.cmgrtotal, 0) / 1000) as h47, 0 as h48
      from si_costomarginal cm
      where cm.cmgrcorrelativo = 47 and to_char(cm.cmgrfecha, 'YYYYMM') = :facperbase
      union
      select cm.barrcodi, cm.cmgrfecha as fecha, cm.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, (nvl(cm.cmgrtotal, 0) / 1000) as h48
      from si_costomarginal cm
      where cm.cmgrcorrelativo = 48 and to_char(cm.cmgrfecha, 'YYYYMM') = :facperbase
      --order by 1, 2, 3
      ) t2
      group by barrcodi, to_char(fecha, 'YYYY-MM-DD')
      order by 1, 2
      ) t1
    </query>
  </Sql>
  
  <Sql>
    <key>CopiarSGOCOESCM</key>
    <query>
      insert into trn_costo_marginal (cosmarcodi,pericodi,barrcodi,facpercodi,cosmarversion,cosmardia,cosmarbarratransferencia,
      cosmarpromediodia,
      cosmar1,cosmar2,cosmar3,cosmar4,cosmar5,cosmar6,cosmar7,cosmar8,cosmar9,cosmar10,
      cosmar11,cosmar12,cosmar13,cosmar14,cosmar15,cosmar16,cosmar17,cosmar18,cosmar19,cosmar20,
      cosmar21,cosmar22,cosmar23,cosmar24,cosmar25,cosmar26,cosmar27,cosmar28,cosmar29,cosmar30,
      cosmar31,cosmar32,cosmar33,cosmar34,cosmar35,cosmar36,cosmar37,cosmar38,cosmar39,cosmar40,
      cosmar41,cosmar42,cosmar43,cosmar44,cosmar45,cosmar46,cosmar47,cosmar48,cosmar49,cosmar50,
      cosmar51,cosmar52,cosmar53,cosmar54,cosmar55,cosmar56,cosmar57,cosmar58,cosmar59,cosmar60,
      cosmar61,cosmar62,cosmar63,cosmar64,cosmar65,cosmar66,cosmar67,cosmar68,cosmar69,cosmar70,
      cosmar71,cosmar72,cosmar73,cosmar74,cosmar75,cosmar76,cosmar77,cosmar78,cosmar79,cosmar80,
      cosmar81,cosmar82,cosmar83,cosmar84,cosmar85,cosmar86,cosmar87,cosmar88,cosmar89,cosmar90,
      cosmar91,cosmar92,cosmar93,cosmar94,cosmar95,cosmar96,cosmarusername,cosmarfecins)
      select (:cosmarcodi + rownum) as cosmarcodi, pericodi, barrcodi, facpercodi, facperversion, facperdia, facperbarrnombre,
      (facper1 + facper2 + facper3 + facper4 + facper5 + facper6 + facper7 + facper8 + facper9 + facper10 +
      facper11 + facper12 + facper13 + facper14 + facper15 + facper16 + facper17 + facper18 + facper19 + facper20 +
      facper21 + facper22 + facper23 + facper24 + facper25 + facper26 + facper27 + facper28 + facper29 + facper30 +
      facper31 + facper32 + facper33 + facper34 + facper35 + facper36 + facper37 + facper38 + facper39 + facper40 +
      facper41 + facper42 + facper43 + facper44 + facper45 + facper46 + facper47 + facper48)/48 as cosmarpromediodia,
      facper1,facper1, facper2,facper2, facper3,facper3, facper4,facper4, facper5,facper5,
      facper6,facper6, facper7,facper7, facper8,facper8, facper9,facper9, facper10,facper10,
      facper11,facper11, facper12,facper12, facper13,facper13, facper14,facper14, facper15,facper15,
      facper16,facper16, facper17,facper17, facper18,facper18, facper19,facper19, facper20,facper20,
      facper21,facper21, facper22,facper22, facper23,facper23, facper24,facper24, facper25,facper25,
      facper26,facper26, facper27,facper27, facper28,facper28, facper29,facper29, facper30,facper30,
      facper31,facper31, facper32,facper32, facper33,facper33, facper34,facper34, facper35,facper35,
      facper36,facper36, facper37,facper37, facper38,facper38, facper39,facper39, facper40,facper40,
      facper41,facper41, facper42,facper42, facper43,facper43, facper44,facper44, facper45,facper45,
      facper46,facper46, facper47,facper47, facper48,facper48,
      facperusername,facperfecins
      from trn_factor_perdida
      where pericodi = :pericodi and facperversion = :facperversion
    </query>
  </Sql>

  <!--ASSETEC 202002-->
  <Sql>
    <key>DeleteCMTMP</key>
    <query>delete from trn_costo_marginal_tmp</query>
  </Sql>

  <Sql>
    <key>ListBarrasSiCostMarg</key>
    <query>
      select distinct cm.barrcodi, (select b.barrbarratransferencia from trn_barra b where cm.barrcodi = b.barrcodi) as facperbarrnombre
      from si_costomarginal cm where cm.cmgrcorrelativo = 1 and to_char(cm.cmgrfecha, 'YYYYMM') = :facperbase order by 2, 1
    </query>
  </Sql>
  
  <Sql>
    <key>SaveCostMargTmp</key>
    <query>
      insert into trn_costo_marginal_tmp (
      select :barrcodi, (TRUNC (to_date(:facperbase,'YYYYMM'), 'MON')+rownum-1 + (1*30)/1440) as cmgrfecha, 1 as cmgrcorrelativo,
      0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from dual CONNECT BY LEVEL &lt;= :pericodi
      union
      select :barrcodi, (TRUNC (to_date(:facperbase,'YYYYMM'), 'MON')+rownum-1 + (2*30)/1440) as cmgrfecha, 2 as cmgrcorrelativo,
      0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from dual CONNECT BY LEVEL &lt;= :pericodi
      union
      select :barrcodi, (TRUNC (to_date(:facperbase,'YYYYMM'), 'MON')+rownum-1 + (3*30)/1440) as cmgrfecha, 3 as cmgrcorrelativo,
      0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from dual CONNECT BY LEVEL &lt;= :pericodi
      union
      select :barrcodi, (TRUNC (to_date(:facperbase,'YYYYMM'), 'MON')+rownum-1 + (4*30)/1440) as cmgrfecha, 4 as cmgrcorrelativo,
      0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from dual CONNECT BY LEVEL &lt;= :pericodi
      union
      select :barrcodi, (TRUNC (to_date(:facperbase,'YYYYMM'), 'MON')+rownum-1 + (5*30)/1440) as cmgrfecha, 5 as cmgrcorrelativo,
      0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from dual CONNECT BY LEVEL &lt;= :pericodi
      union
      select :barrcodi, (TRUNC (to_date(:facperbase,'YYYYMM'), 'MON')+rownum-1 + (6*30)/1440) as cmgrfecha, 6 as cmgrcorrelativo,
      0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from dual CONNECT BY LEVEL &lt;= :pericodi
      union
      select :barrcodi, (TRUNC (to_date(:facperbase,'YYYYMM'), 'MON')+rownum-1 + (7*30)/1440) as cmgrfecha, 7 as cmgrcorrelativo,
      0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from dual CONNECT BY LEVEL &lt;= :pericodi
      union
      select :barrcodi, (TRUNC (to_date(:facperbase,'YYYYMM'), 'MON')+rownum-1 + (8*30)/1440) as cmgrfecha, 8 as cmgrcorrelativo,
      0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from dual CONNECT BY LEVEL &lt;= :pericodi
      union
      select :barrcodi, (TRUNC (to_date(:facperbase,'YYYYMM'), 'MON')+rownum-1 + (9*30)/1440) as cmgrfecha, 9 as cmgrcorrelativo,
      0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from dual CONNECT BY LEVEL &lt;= :pericodi
      union
      select :barrcodi, (TRUNC (to_date(:facperbase,'YYYYMM'), 'MON')+rownum-1 + (10*30)/1440) as cmgrfecha, 10 as cmgrcorrelativo,
      0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from dual CONNECT BY LEVEL &lt;= :pericodi
      union
      select :barrcodi, (TRUNC (to_date(:facperbase,'YYYYMM'), 'MON')+rownum-1 + (11*30)/1440) as cmgrfecha, 11 as cmgrcorrelativo,
      0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from dual CONNECT BY LEVEL &lt;= :pericodi
      union
      select :barrcodi, (TRUNC (to_date(:facperbase,'YYYYMM'), 'MON')+rownum-1 + (12*30)/1440) as cmgrfecha, 12 as cmgrcorrelativo,
      0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from dual CONNECT BY LEVEL &lt;= :pericodi
      union
      select :barrcodi, (TRUNC (to_date(:facperbase,'YYYYMM'), 'MON')+rownum-1 + (13*30)/1440) as cmgrfecha, 13 as cmgrcorrelativo,
      0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from dual CONNECT BY LEVEL &lt;= :pericodi
      union
      select :barrcodi, (TRUNC (to_date(:facperbase,'YYYYMM'), 'MON')+rownum-1 + (14*30)/1440) as cmgrfecha, 14 as cmgrcorrelativo,
      0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from dual CONNECT BY LEVEL &lt;= :pericodi
      union
      select :barrcodi, (TRUNC (to_date(:facperbase,'YYYYMM'), 'MON')+rownum-1 + (15*30)/1440) as cmgrfecha, 15 as cmgrcorrelativo,
      0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from dual CONNECT BY LEVEL &lt;= :pericodi
      union
      select :barrcodi, (TRUNC (to_date(:facperbase,'YYYYMM'), 'MON')+rownum-1 + (16*30)/1440) as cmgrfecha, 16 as cmgrcorrelativo,
      0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from dual CONNECT BY LEVEL &lt;= :pericodi
      union
      select :barrcodi, (TRUNC (to_date(:facperbase,'YYYYMM'), 'MON')+rownum-1 + (17*30)/1440) as cmgrfecha, 17 as cmgrcorrelativo,
      0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from dual CONNECT BY LEVEL &lt;= :pericodi
      union
      select :barrcodi, (TRUNC (to_date(:facperbase,'YYYYMM'), 'MON')+rownum-1 + (18*30)/1440) as cmgrfecha, 18 as cmgrcorrelativo,
      0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from dual CONNECT BY LEVEL &lt;= :pericodi
      union
      select :barrcodi, (TRUNC (to_date(:facperbase,'YYYYMM'), 'MON')+rownum-1 + (19*30)/1440) as cmgrfecha, 19 as cmgrcorrelativo,
      0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from dual CONNECT BY LEVEL &lt;= :pericodi
      union
      select :barrcodi, (TRUNC (to_date(:facperbase,'YYYYMM'), 'MON')+rownum-1 + (20*30)/1440) as cmgrfecha, 20 as cmgrcorrelativo,
      0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from dual CONNECT BY LEVEL &lt;= :pericodi
      union
      select :barrcodi, (TRUNC (to_date(:facperbase,'YYYYMM'), 'MON')+rownum-1 + (21*30)/1440) as cmgrfecha, 21 as cmgrcorrelativo,
      0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from dual CONNECT BY LEVEL &lt;= :pericodi
      union
      select :barrcodi, (TRUNC (to_date(:facperbase,'YYYYMM'), 'MON')+rownum-1 + (22*30)/1440) as cmgrfecha, 22 as cmgrcorrelativo,
      0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from dual CONNECT BY LEVEL &lt;= :pericodi
      union
      select :barrcodi, (TRUNC (to_date(:facperbase,'YYYYMM'), 'MON')+rownum-1 + (23*30)/1440) as cmgrfecha, 23 as cmgrcorrelativo,
      0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from dual CONNECT BY LEVEL &lt;= :pericodi
      union
      select :barrcodi, (TRUNC (to_date(:facperbase,'YYYYMM'), 'MON')+rownum-1 + (24*30)/1440) as cmgrfecha, 24 as cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from dual CONNECT BY LEVEL &lt;= :pericodi
      union
      select :barrcodi, (TRUNC (to_date(:facperbase,'YYYYMM'), 'MON')+rownum-1 + (25*30)/1440) as cmgrfecha, 25 as cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from dual CONNECT BY LEVEL &lt;= :pericodi
      union
      select :barrcodi, (TRUNC (to_date(:facperbase,'YYYYMM'), 'MON')+rownum-1 + (26*30)/1440) as cmgrfecha, 26 as cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from dual CONNECT BY LEVEL &lt;= :pericodi
      union
      select :barrcodi, (TRUNC (to_date(:facperbase,'YYYYMM'), 'MON')+rownum-1 + (27*30)/1440) as cmgrfecha, 27 as cmgrcorrelativo,
      0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from dual CONNECT BY LEVEL &lt;= :pericodi
      union
      select :barrcodi, (TRUNC (to_date(:facperbase,'YYYYMM'), 'MON')+rownum-1 + (28*30)/1440) as cmgrfecha, 28 as cmgrcorrelativo,
      0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from dual CONNECT BY LEVEL &lt;= :pericodi
      union
      select :barrcodi, (TRUNC (to_date(:facperbase,'YYYYMM'), 'MON')+rownum-1 + (29*30)/1440) as cmgrfecha, 29 as cmgrcorrelativo,
      0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from dual CONNECT BY LEVEL &lt;= :pericodi
      union
      select :barrcodi, (TRUNC (to_date(:facperbase,'YYYYMM'), 'MON')+rownum-1 + (30*30)/1440) as cmgrfecha, 30 as cmgrcorrelativo,
      0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from dual CONNECT BY LEVEL &lt;= :pericodi
      union
      select :barrcodi, (TRUNC (to_date(:facperbase,'YYYYMM'), 'MON')+rownum-1 + (31*30)/1440) as cmgrfecha, 31 as cmgrcorrelativo,
      0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from dual CONNECT BY LEVEL &lt;= :pericodi
      union
      select :barrcodi, (TRUNC (to_date(:facperbase,'YYYYMM'), 'MON')+rownum-1 + (32*30)/1440) as cmgrfecha, 32 as cmgrcorrelativo,
      0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from dual CONNECT BY LEVEL &lt;= :pericodi
      union
      select :barrcodi, (TRUNC (to_date(:facperbase,'YYYYMM'), 'MON')+rownum-1 + (33*30)/1440) as cmgrfecha, 33 as cmgrcorrelativo,
      0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from dual CONNECT BY LEVEL &lt;= :pericodi
      union
      select :barrcodi, (TRUNC (to_date(:facperbase,'YYYYMM'), 'MON')+rownum-1 + (34*30)/1440) as cmgrfecha, 34 as cmgrcorrelativo,
      0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from dual CONNECT BY LEVEL &lt;= :pericodi
      union
      select :barrcodi, (TRUNC (to_date(:facperbase,'YYYYMM'), 'MON')+rownum-1 + (35*30)/1440) as cmgrfecha, 35 as cmgrcorrelativo,
      0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from dual CONNECT BY LEVEL &lt;= :pericodi
      union
      select :barrcodi, (TRUNC (to_date(:facperbase,'YYYYMM'), 'MON')+rownum-1 + (36*30)/1440) as cmgrfecha, 36 as cmgrcorrelativo,
      0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from dual CONNECT BY LEVEL &lt;= :pericodi
      union
      select :barrcodi, (TRUNC (to_date(:facperbase,'YYYYMM'), 'MON')+rownum-1 + (37*30)/1440) as cmgrfecha, 37 as cmgrcorrelativo,
      0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from dual CONNECT BY LEVEL &lt;= :pericodi
      union
      select :barrcodi, (TRUNC (to_date(:facperbase,'YYYYMM'), 'MON')+rownum-1 + (38*30)/1440) as cmgrfecha, 38 as cmgrcorrelativo,
      0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from dual CONNECT BY LEVEL &lt;= :pericodi
      union
      select :barrcodi, (TRUNC (to_date(:facperbase,'YYYYMM'), 'MON')+rownum-1 + (39*30)/1440) as cmgrfecha, 39 as cmgrcorrelativo,
      0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from dual CONNECT BY LEVEL &lt;= :pericodi
      union
      select :barrcodi, (TRUNC (to_date(:facperbase,'YYYYMM'), 'MON')+rownum-1 + (40*30)/1440) as cmgrfecha, 40 as cmgrcorrelativo,
      0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from dual CONNECT BY LEVEL &lt;= :pericodi
      union
      select :barrcodi, (TRUNC (to_date(:facperbase,'YYYYMM'), 'MON')+rownum-1 + (41*30)/1440) as cmgrfecha, 41 as cmgrcorrelativo,
      0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from dual CONNECT BY LEVEL &lt;= :pericodi
      union
      select :barrcodi, (TRUNC (to_date(:facperbase,'YYYYMM'), 'MON')+rownum-1 + (42*30)/1440) as cmgrfecha, 42 as cmgrcorrelativo,
      0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from dual CONNECT BY LEVEL &lt;= :pericodi
      union
      select :barrcodi, (TRUNC (to_date(:facperbase,'YYYYMM'), 'MON')+rownum-1 + (43*30)/1440) as cmgrfecha, 43 as cmgrcorrelativo,
      0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from dual CONNECT BY LEVEL &lt;= :pericodi
      union
      select :barrcodi, (TRUNC (to_date(:facperbase,'YYYYMM'), 'MON')+rownum-1 + (44*30)/1440) as cmgrfecha, 44 as cmgrcorrelativo,
      0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from dual CONNECT BY LEVEL &lt;= :pericodi
      union
      select :barrcodi, (TRUNC (to_date(:facperbase,'YYYYMM'), 'MON')+rownum-1 + (45*30)/1440) as cmgrfecha, 45 as cmgrcorrelativo,
      0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from dual CONNECT BY LEVEL &lt;= :pericodi
      union
      select :barrcodi, (TRUNC (to_date(:facperbase,'YYYYMM'), 'MON')+rownum-1 + (46*30)/1440) as cmgrfecha, 46 as cmgrcorrelativo,
      0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from dual CONNECT BY LEVEL &lt;= :pericodi
      union
      select :barrcodi, (TRUNC (to_date(:facperbase,'YYYYMM'), 'MON')+rownum-1 + (47*30)/1440) as cmgrfecha, 47 as cmgrcorrelativo,
      0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from dual CONNECT BY LEVEL &lt;= :pericodi
      union
      select :barrcodi, (TRUNC (to_date(:facperbase,'YYYYMM'), 'MON')+rownum-1 + (47*30 + 29)/1440) as cmgrfecha, 48 as cmgrcorrelativo,
      0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from dual CONNECT BY LEVEL &lt;= :pericodi)
    </query>
  </Sql>

  <Sql>
    <key>CopiarSGOCOES</key>
    <query>
      insert into trn_factor_perdida (facpercodi,pericodi,barrcodi,facperversion,facperdia,facperbase,facperbarrnombre,
      facper1,facper2,facper3,facper4,facper5,facper6,facper7,facper8,facper9,facper10,
      facper11,facper12,facper13,facper14,facper15,facper16,facper17,facper18,facper19,facper20,
      facper21,facper22,facper23,facper24,facper25,facper26,facper27,facper28,facper29,facper30,
      facper31,facper32,facper33,facper34,facper35,facper36,facper37,facper38,facper39,facper40,
      facper41,facper42,facper43,facper44,facper45,facper46,facper47,facper48,
      facperusername,facperfecins)
      select (:facpercodi + rownum) as facpercodi, :pericodi, barrcodi, :facperversion, to_number(substr(fecha, 9,2)) as facperdia, 'N' as facperbase,
      (select b.barrbarratransferencia from trn_barra b where b.barrcodi = t1.barrcodi) as facperbarrnombre,
      facper1,facper2,facper3,facper4,facper5,facper6,facper7,facper8,facper9,facper10,
      facper11,facper12,facper13,facper14,facper15,facper16,facper17,facper18,facper19,facper20,
      facper21,facper22,facper23,facper24,facper25,facper26,facper27,facper28,facper29,facper30,
      facper31,facper32,facper33,facper34,facper35,facper36,facper37,facper38,facper39,facper40,
      facper41,facper42,facper43,facper44,facper45,facper46,facper47,facper48,
      :facperusername, sysdate
      from (
      select barrcodi, to_char(fecha, 'YYYY-MM-DD') as fecha,
      sum(h1) as facper1, sum(h2) as facper2, sum(h3) as facper3, sum(h4) as facper4, sum(h5) as facper5,
      sum(h6) as facper6, sum(h7) as facper7, sum(h8) as facper8, sum(h9) as facper9, sum(h10) as facper10,
      sum(h11) as facper11, sum(h12) as facper12, sum(h13) as facper13, sum(h14) as facper14, sum(h15) as facper15,
      sum(h16) as facper16, sum(h17) as facper17, sum(h18) as facper18, sum(h19) as facper19, sum(h20) as facper20,
      sum(h21) as facper21, sum(h22) as facper22, sum(h23) as facper23, sum(h24) as facper24, sum(h25) as facper25,
      sum(h26) as facper26, sum(h27) as facper27, sum(h28) as facper28, sum(h29) as facper29, sum(h30) as facper30,
      sum(h31) as facper31, sum(h32) as facper32, sum(h33) as facper33, sum(h34) as facper34, sum(h35) as facper35,
      sum(h36) as facper36, sum(h37) as facper37, sum(h38) as facper38, sum(h39) as facper39, sum(h40) as facper40,
      sum(h41) as facper41, sum(h42) as facper42, sum(h43) as facper43, sum(h44) as facper44, sum(h45) as facper45,
      sum(h46) as facper46, sum(h47) as facper47, sum(h48) as facper48
      from (
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, nvl((cm.cmgrtotal / 1000),0) as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 1 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 1 and to_char(cm.cmgrfecha, 'YYYYMM') = :facperbase
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='00:30'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, nvl((cm.cmgrtotal / 1000),0) as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 2 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 2 and to_char(cm.cmgrfecha, 'YYYYMM') = :facperbase
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='01:00'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, nvl((cm.cmgrtotal / 1000),0) as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 3 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 3 and to_char(cm.cmgrfecha, 'YYYYMM') = :facperbase
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='01:30'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, nvl((cm.cmgrtotal / 1000),0) as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 4 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 4 and to_char(cm.cmgrfecha, 'YYYYMM') = :facperbase
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='02:00'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, nvl((cm.cmgrtotal / 1000),0) as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 5 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 5 and to_char(cm.cmgrfecha, 'YYYYMM') = :facperbase
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='02:30'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, nvl((cm.cmgrtotal / 1000),0) as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 6 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 6 and to_char(cm.cmgrfecha, 'YYYYMM') = :facperbase
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='03:00'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, nvl((cm.cmgrtotal / 1000),0) as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 7 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 7 and to_char(cm.cmgrfecha, 'YYYYMM') = :facperbase
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='03:30'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, nvl((cm.cmgrtotal / 1000),0) as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 8 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 8 and to_char(cm.cmgrfecha, 'YYYYMM') = :facperbase
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='04:00'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, nvl((cm.cmgrtotal / 1000),0) as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 9 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 9 and to_char(cm.cmgrfecha, 'YYYYMM') = :facperbase
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='04:30'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, nvl((cm.cmgrtotal / 1000),0) as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 10 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 10 and to_char(cm.cmgrfecha, 'YYYYMM') = :facperbase
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='05:00'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      nvl((cm.cmgrtotal / 1000),0) as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 11 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 11 and to_char(cm.cmgrfecha, 'YYYYMM') = :facperbase
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='05:30'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, nvl((cm.cmgrtotal / 1000),0) as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 12 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 12 and to_char(cm.cmgrfecha, 'YYYYMM') = :facperbase
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='06:00'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, nvl((cm.cmgrtotal / 1000),0) as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 13 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 13 and to_char(cm.cmgrfecha, 'YYYYMM') = :facperbase
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='06:30'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, nvl((cm.cmgrtotal / 1000),0) as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 14 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 14 and to_char(cm.cmgrfecha, 'YYYYMM') = :facperbase
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='07:00'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, nvl((cm.cmgrtotal / 1000),0) as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 15 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 15 and to_char(cm.cmgrfecha, 'YYYYMM') = :facperbase
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='07:30'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, nvl((cm.cmgrtotal / 1000),0) as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 16 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 16 and to_char(cm.cmgrfecha, 'YYYYMM') = :facperbase
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='08:00'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, nvl((cm.cmgrtotal / 1000),0) as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 17 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 17 and to_char(cm.cmgrfecha, 'YYYYMM') = :facperbase
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='08:30'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, nvl((cm.cmgrtotal / 1000),0) as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 18 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 18 and to_char(cm.cmgrfecha, 'YYYYMM') = :facperbase
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='09:00'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, nvl((cm.cmgrtotal / 1000),0) as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 19 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 19 and to_char(cm.cmgrfecha, 'YYYYMM') = :facperbase
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='09:30'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, nvl((cm.cmgrtotal / 1000),0) as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 20 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 20 and to_char(cm.cmgrfecha, 'YYYYMM') = :facperbase
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='10:00'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      nvl((cm.cmgrtotal / 1000),0) as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 21 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 21 and to_char(cm.cmgrfecha, 'YYYYMM') = :facperbase
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='10:30'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, nvl((cm.cmgrtotal / 1000),0) as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 22 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 22 and to_char(cm.cmgrfecha, 'YYYYMM') = :facperbase
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='11:00'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, nvl((cm.cmgrtotal / 1000),0) as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 23 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 23 and to_char(cm.cmgrfecha, 'YYYYMM') = :facperbase
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='11:30'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, nvl((cm.cmgrtotal / 1000),0) as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 24 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 24 and to_char(cm.cmgrfecha, 'YYYYMM') = :facperbase
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='12:00'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, nvl((cm.cmgrtotal / 1000),0) as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 25 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 25 and to_char(cm.cmgrfecha, 'YYYYMM') = :facperbase
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='12:30'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, nvl((cm.cmgrtotal / 1000),0) as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 26 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 26 and to_char(cm.cmgrfecha, 'YYYYMM') = :facperbase
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='13:00'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, nvl((cm.cmgrtotal / 1000),0) as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 27 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 27 and to_char(cm.cmgrfecha, 'YYYYMM') = :facperbase
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='13:30'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, nvl((cm.cmgrtotal / 1000),0) as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 28 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 28 and to_char(cm.cmgrfecha, 'YYYYMM') = :facperbase
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='14:00'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, nvl((cm.cmgrtotal / 1000),0) as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 29 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 29 and to_char(cm.cmgrfecha, 'YYYYMM') = :facperbase
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='14:30'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, nvl((cm.cmgrtotal / 1000),0) as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 30 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 30 and to_char(cm.cmgrfecha, 'YYYYMM') = :facperbase
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='15:00'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      nvl((cm.cmgrtotal / 1000),0) as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 31 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 31 and to_char(cm.cmgrfecha, 'YYYYMM') = :facperbase
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='15:30'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, nvl((cm.cmgrtotal / 1000),0) as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 32 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 32 and to_char(cm.cmgrfecha, 'YYYYMM') = :facperbase
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='16:00'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, nvl((cm.cmgrtotal / 1000),0) as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 33 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 33 and to_char(cm.cmgrfecha, 'YYYYMM') = :facperbase
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='16:30'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, nvl((cm.cmgrtotal / 1000),0) as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 34 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 34 and to_char(cm.cmgrfecha, 'YYYYMM') = :facperbase
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='17:00'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, nvl((cm.cmgrtotal / 1000),0) as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 35 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 35 and to_char(cm.cmgrfecha, 'YYYYMM') = :facperbase
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='17:30'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, nvl((cm.cmgrtotal / 1000),0) as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 36 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 36 and to_char(cm.cmgrfecha, 'YYYYMM') = :facperbase
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='18:00'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, nvl((cm.cmgrtotal / 1000),0) as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 37 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 37 and to_char(cm.cmgrfecha, 'YYYYMM') = :facperbase
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='18:30'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, nvl((cm.cmgrtotal / 1000),0) as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 38 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 38 and to_char(cm.cmgrfecha, 'YYYYMM') = :facperbase
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='19:00'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, nvl((cm.cmgrtotal / 1000),0) as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 39 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 39 and to_char(cm.cmgrfecha, 'YYYYMM') = :facperbase
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='19:30'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, nvl((cm.cmgrtotal / 1000),0) as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 40 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 40 and to_char(cm.cmgrfecha, 'YYYYMM') = :facperbase
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='20:00'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      nvl((cm.cmgrtotal / 1000),0) as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 41 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 41 and to_char(cm.cmgrfecha, 'YYYYMM') = :facperbase
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='20:30'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, nvl((cm.cmgrtotal / 1000),0) as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 42 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 42 and to_char(cm.cmgrfecha, 'YYYYMM') = :facperbase
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='21:00'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, nvl((cm.cmgrtotal / 1000),0) as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 43 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 43 and to_char(cm.cmgrfecha, 'YYYYMM') = :facperbase
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='21:30'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, nvl((cm.cmgrtotal / 1000),0) as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 44 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 44 and to_char(cm.cmgrfecha, 'YYYYMM') = :facperbase
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='22:00'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, nvl((cm.cmgrtotal / 1000),0) as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 45 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 45 and to_char(cm.cmgrfecha, 'YYYYMM') = :facperbase
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='22:30'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, nvl((cm.cmgrtotal / 1000),0) as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 46 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 46 and to_char(cm.cmgrfecha, 'YYYYMM') = :facperbase
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='23:00'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, nvl((cm.cmgrtotal / 1000),0) as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 47 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 47 and to_char(cm.cmgrfecha, 'YYYYMM') = :facperbase
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='23:30'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, nvl((cm.cmgrtotal / 1000),0) as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 48 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 48 and to_char(cm.cmgrfecha, 'YYYYMM') = :facperbase
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='23:59'
      ) t2
      group by barrcodi, to_char(fecha, 'YYYY-MM-DD')
      order by 1, 2
      ) t1
    </query>
  </Sql>

    <Sql>
    <key>CopiarSGOCOES_CONGESTION</key>
    <query>
      insert into TRN_COSTO_MARGINAL_CONGENE (congenecodi,tipcosto,pericodi,barrcodi,congeneversion,congenedia,congenebase,congenebarrnombre,
      CONGENEPROMEDIO,
      congene1,congene2,congene3,congene4,congene5,congene6,congene7,congene8,congene9,congene10,
      congene11,congene12,congene13,congene14,congene15,congene16,congene17,congene18,congene19,congene20,
      congene21,congene22,congene23,congene24,congene25,congene26,congene27,congene28,congene29,congene30,
      congene31,congene32,congene33,congene34,congene35,congene36,congene37,congene38,congene39,congene40,
      congene41,congene42,congene43,congene44,congene45,congene46,congene47,congene48,
      congeneusername,congenefecins)
      select (:congenecodi + rownum) as congenecodi,1, :pericodi, barrcodi, :congeneversion, to_number(substr(fecha, 9,2)) as congenedia, 'N' as congenebase,
      (select b.barrbarratransferencia from trn_barra b where b.barrcodi = t1.barrcodi) as congenebarrnombre,
      (congene1+congene2+congene3+congene4+congene5+congene6+congene7+congene8+congene9+congene10+
      congene11+congene12+congene13+congene14+congene15+congene16+congene17+congene18+congene19+congene20+
      congene21+congene22+congene23+congene24+congene25+congene26+congene27+congene28+congene29+congene30+
      congene31+congene32+congene33+congene34+congene35+congene36+congene37+congene38+congene39+congene40+
      congene41+congene42+congene43+congene44+congene45+congene46+congene47+congene48)/48,
      congene1,congene2,congene3,congene4,congene5,congene6,congene7,congene8,congene9,congene10,
      congene11,congene12,congene13,congene14,congene15,congene16,congene17,congene18,congene19,congene20,
      congene21,congene22,congene23,congene24,congene25,congene26,congene27,congene28,congene29,congene30,
      congene31,congene32,congene33,congene34,congene35,congene36,congene37,congene38,congene39,congene40,
      congene41,congene42,congene43,congene44,congene45,congene46,congene47,congene48,
      :congeneusername, sysdate
      from (
      select barrcodi, to_char(fecha, 'YYYY-MM-DD') as fecha,
      sum(h1) as congene1, sum(h2) as congene2, sum(h3) as congene3, sum(h4) as congene4, sum(h5) as congene5,
      sum(h6) as congene6, sum(h7) as congene7, sum(h8) as congene8, sum(h9) as congene9, sum(h10) as congene10,
      sum(h11) as congene11, sum(h12) as congene12, sum(h13) as congene13, sum(h14) as congene14, sum(h15) as congene15,
      sum(h16) as congene16, sum(h17) as congene17, sum(h18) as congene18, sum(h19) as congene19, sum(h20) as congene20,
      sum(h21) as congene21, sum(h22) as congene22, sum(h23) as congene23, sum(h24) as congene24, sum(h25) as congene25,
      sum(h26) as congene26, sum(h27) as congene27, sum(h28) as congene28, sum(h29) as congene29, sum(h30) as congene30,
      sum(h31) as congene31, sum(h32) as congene32, sum(h33) as congene33, sum(h34) as congene34, sum(h35) as congene35,
      sum(h36) as congene36, sum(h37) as congene37, sum(h38) as congene38, sum(h39) as congene39, sum(h40) as congene40,
      sum(h41) as congene41, sum(h42) as congene42, sum(h43) as congene43, sum(h44) as congene44, sum(h45) as congene45,
      sum(h46) as congene46, sum(h47) as congene47, sum(h48) as congene48
      from (
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, nvl((cm.CMGRCONGESTION / 1000),0) as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 1 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 1 and to_char(cm.cmgrfecha, 'YYYYMM') = :congenebase
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='00:30'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, nvl((cm.CMGRCONGESTION / 1000),0) as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 2 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 2 and to_char(cm.cmgrfecha, 'YYYYMM') = :congenebase
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='01:00'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, nvl((cm.CMGRCONGESTION / 1000),0) as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 3 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 3 and to_char(cm.cmgrfecha, 'YYYYMM') = :congenebase
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='01:30'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, nvl((cm.CMGRCONGESTION / 1000),0) as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 4 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 4 and to_char(cm.cmgrfecha, 'YYYYMM') = :congenebase
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='02:00'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, nvl((cm.CMGRCONGESTION / 1000),0) as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 5 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 5 and to_char(cm.cmgrfecha, 'YYYYMM') = :congenebase
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='02:30'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, nvl((cm.CMGRCONGESTION / 1000),0) as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 6 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 6 and to_char(cm.cmgrfecha, 'YYYYMM') = :congenebase
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='03:00'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, nvl((cm.CMGRCONGESTION / 1000),0) as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 7 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 7 and to_char(cm.cmgrfecha, 'YYYYMM') = :congenebase
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='03:30'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, nvl((cm.CMGRCONGESTION / 1000),0) as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 8 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 8 and to_char(cm.cmgrfecha, 'YYYYMM') = :congenebase
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='04:00'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, nvl((cm.CMGRCONGESTION / 1000),0) as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 9 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 9 and to_char(cm.cmgrfecha, 'YYYYMM') = :congenebase
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='04:30'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, nvl((cm.CMGRCONGESTION / 1000),0) as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 10 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 10 and to_char(cm.cmgrfecha, 'YYYYMM') = :congenebase
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='05:00'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      nvl((cm.CMGRCONGESTION / 1000),0) as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 11 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 11 and to_char(cm.cmgrfecha, 'YYYYMM') = :congenebase
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='05:30'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, nvl((cm.CMGRCONGESTION / 1000),0) as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 12 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 12 and to_char(cm.cmgrfecha, 'YYYYMM') = :congenebase
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='06:00'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, nvl((cm.CMGRCONGESTION / 1000),0) as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 13 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 13 and to_char(cm.cmgrfecha, 'YYYYMM') = :congenebase
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='06:30'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, nvl((cm.CMGRCONGESTION / 1000),0) as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 14 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 14 and to_char(cm.cmgrfecha, 'YYYYMM') = :congenebase
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='07:00'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, nvl((cm.CMGRCONGESTION / 1000),0) as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 15 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 15 and to_char(cm.cmgrfecha, 'YYYYMM') = :congenebase
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='07:30'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, nvl((cm.CMGRCONGESTION / 1000),0) as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 16 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 16 and to_char(cm.cmgrfecha, 'YYYYMM') = :congenebase
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='08:00'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, nvl((cm.CMGRCONGESTION / 1000),0) as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 17 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 17 and to_char(cm.cmgrfecha, 'YYYYMM') = :congenebase
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='08:30'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, nvl((cm.CMGRCONGESTION / 1000),0) as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 18 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 18 and to_char(cm.cmgrfecha, 'YYYYMM') = :congenebase
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='09:00'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, nvl((cm.CMGRCONGESTION / 1000),0) as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 19 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 19 and to_char(cm.cmgrfecha, 'YYYYMM') = :congenebase
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='09:30'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, nvl((cm.CMGRCONGESTION / 1000),0) as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 20 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 20 and to_char(cm.cmgrfecha, 'YYYYMM') = :congenebase
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='10:00'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      nvl((cm.CMGRCONGESTION / 1000),0) as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 21 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 21 and to_char(cm.cmgrfecha, 'YYYYMM') = :congenebase
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='10:30'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, nvl((cm.CMGRCONGESTION / 1000),0) as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 22 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 22 and to_char(cm.cmgrfecha, 'YYYYMM') = :congenebase
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='11:00'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, nvl((cm.CMGRCONGESTION / 1000),0) as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 23 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 23 and to_char(cm.cmgrfecha, 'YYYYMM') = :congenebase
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='11:30'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, nvl((cm.CMGRCONGESTION / 1000),0) as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 24 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 24 and to_char(cm.cmgrfecha, 'YYYYMM') = :congenebase
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='12:00'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, nvl((cm.CMGRCONGESTION / 1000),0) as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 25 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 25 and to_char(cm.cmgrfecha, 'YYYYMM') = :congenebase
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='12:30'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, nvl((cm.CMGRCONGESTION / 1000),0) as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 26 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 26 and to_char(cm.cmgrfecha, 'YYYYMM') = :congenebase
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='13:00'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, nvl((cm.CMGRCONGESTION / 1000),0) as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 27 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 27 and to_char(cm.cmgrfecha, 'YYYYMM') = :congenebase
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='13:30'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, nvl((cm.CMGRCONGESTION / 1000),0) as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 28 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 28 and to_char(cm.cmgrfecha, 'YYYYMM') = :congenebase
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='14:00'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, nvl((cm.CMGRCONGESTION / 1000),0) as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 29 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 29 and to_char(cm.cmgrfecha, 'YYYYMM') = :congenebase
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='14:30'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, nvl((cm.CMGRCONGESTION / 1000),0) as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 30 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 30 and to_char(cm.cmgrfecha, 'YYYYMM') = :congenebase
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='15:00'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      nvl((cm.CMGRCONGESTION / 1000),0) as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 31 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 31 and to_char(cm.cmgrfecha, 'YYYYMM') = :congenebase
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='15:30'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, nvl((cm.CMGRCONGESTION / 1000),0) as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 32 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 32 and to_char(cm.cmgrfecha, 'YYYYMM') = :congenebase
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='16:00'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, nvl((cm.CMGRCONGESTION / 1000),0) as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 33 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 33 and to_char(cm.cmgrfecha, 'YYYYMM') = :congenebase
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='16:30'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, nvl((cm.CMGRCONGESTION / 1000),0) as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 34 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 34 and to_char(cm.cmgrfecha, 'YYYYMM') = :congenebase
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='17:00'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, nvl((cm.CMGRCONGESTION / 1000),0) as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 35 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 35 and to_char(cm.cmgrfecha, 'YYYYMM') = :congenebase
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='17:30'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, nvl((cm.CMGRCONGESTION / 1000),0) as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 36 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 36 and to_char(cm.cmgrfecha, 'YYYYMM') = :congenebase
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='18:00'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, nvl((cm.CMGRCONGESTION / 1000),0) as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 37 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 37 and to_char(cm.cmgrfecha, 'YYYYMM') = :congenebase
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='18:30'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, nvl((cm.CMGRCONGESTION / 1000),0) as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 38 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 38 and to_char(cm.cmgrfecha, 'YYYYMM') = :congenebase
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='19:00'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, nvl((cm.CMGRCONGESTION / 1000),0) as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 39 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 39 and to_char(cm.cmgrfecha, 'YYYYMM') = :congenebase
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='19:30'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, nvl((cm.CMGRCONGESTION / 1000),0) as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 40 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 40 and to_char(cm.cmgrfecha, 'YYYYMM') = :congenebase
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='20:00'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      nvl((cm.CMGRCONGESTION / 1000),0) as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 41 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 41 and to_char(cm.cmgrfecha, 'YYYYMM') = :congenebase
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='20:30'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, nvl((cm.CMGRCONGESTION / 1000),0) as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 42 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 42 and to_char(cm.cmgrfecha, 'YYYYMM') = :congenebase
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='21:00'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, nvl((cm.CMGRCONGESTION / 1000),0) as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 43 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 43 and to_char(cm.cmgrfecha, 'YYYYMM') = :congenebase
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='21:30'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, nvl((cm.CMGRCONGESTION / 1000),0) as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 44 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 44 and to_char(cm.cmgrfecha, 'YYYYMM') = :congenebase
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='22:00'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, nvl((cm.CMGRCONGESTION / 1000),0) as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 45 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 45 and to_char(cm.cmgrfecha, 'YYYYMM') = :congenebase
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='22:30'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, nvl((cm.CMGRCONGESTION / 1000),0) as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 46 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 46 and to_char(cm.cmgrfecha, 'YYYYMM') = :congenebase
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='23:00'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, nvl((cm.CMGRCONGESTION / 1000),0) as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 47 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 47 and to_char(cm.cmgrfecha, 'YYYYMM') = :congenebase
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='23:30'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, nvl((cm.CMGRCONGESTION / 1000),0) as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 48 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 48 and to_char(cm.cmgrfecha, 'YYYYMM') = :congenebase
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='23:59'
      ) t2
      group by barrcodi, to_char(fecha, 'YYYY-MM-DD')
      order by 1, 2
      ) t1
    </query>
  </Sql>

  <Sql>
    <key>CopiarSGOCOES_ENERGIA</key>
    <query>
      insert into TRN_COSTO_MARGINAL_CONGENE (congenecodi,tipcosto,pericodi,barrcodi,congeneversion,congenedia,congenebase,congenebarrnombre,
      CONGENEPROMEDIO,
      congene1,congene2,congene3,congene4,congene5,congene6,congene7,congene8,congene9,congene10,
      congene11,congene12,congene13,congene14,congene15,congene16,congene17,congene18,congene19,congene20,
      congene21,congene22,congene23,congene24,congene25,congene26,congene27,congene28,congene29,congene30,
      congene31,congene32,congene33,congene34,congene35,congene36,congene37,congene38,congene39,congene40,
      congene41,congene42,congene43,congene44,congene45,congene46,congene47,congene48,
      congeneusername,congenefecins)
      select (:congenecodi + rownum) as congenecodi,2, :pericodi, barrcodi, :congeneversion, to_number(substr(fecha, 9,2)) as congenedia, 'N' as congenebase,
      (select b.barrbarratransferencia from trn_barra b where b.barrcodi = t1.barrcodi) as congenebarrnombre,
      (congene1+congene2+congene3+congene4+congene5+congene6+congene7+congene8+congene9+congene10+
      congene11+congene12+congene13+congene14+congene15+congene16+congene17+congene18+congene19+congene20+
      congene21+congene22+congene23+congene24+congene25+congene26+congene27+congene28+congene29+congene30+
      congene31+congene32+congene33+congene34+congene35+congene36+congene37+congene38+congene39+congene40+
      congene41+congene42+congene43+congene44+congene45+congene46+congene47+congene48)/48,
      congene1,congene2,congene3,congene4,congene5,congene6,congene7,congene8,congene9,congene10,
      congene11,congene12,congene13,congene14,congene15,congene16,congene17,congene18,congene19,congene20,
      congene21,congene22,congene23,congene24,congene25,congene26,congene27,congene28,congene29,congene30,
      congene31,congene32,congene33,congene34,congene35,congene36,congene37,congene38,congene39,congene40,
      congene41,congene42,congene43,congene44,congene45,congene46,congene47,congene48,
      :congeneusername, sysdate
      from (
      select barrcodi, to_char(fecha, 'YYYY-MM-DD') as fecha,
      sum(h1) as congene1, sum(h2) as congene2, sum(h3) as congene3, sum(h4) as congene4, sum(h5) as congene5,
      sum(h6) as congene6, sum(h7) as congene7, sum(h8) as congene8, sum(h9) as congene9, sum(h10) as congene10,
      sum(h11) as congene11, sum(h12) as congene12, sum(h13) as congene13, sum(h14) as congene14, sum(h15) as congene15,
      sum(h16) as congene16, sum(h17) as congene17, sum(h18) as congene18, sum(h19) as congene19, sum(h20) as congene20,
      sum(h21) as congene21, sum(h22) as congene22, sum(h23) as congene23, sum(h24) as congene24, sum(h25) as congene25,
      sum(h26) as congene26, sum(h27) as congene27, sum(h28) as congene28, sum(h29) as congene29, sum(h30) as congene30,
      sum(h31) as congene31, sum(h32) as congene32, sum(h33) as congene33, sum(h34) as congene34, sum(h35) as congene35,
      sum(h36) as congene36, sum(h37) as congene37, sum(h38) as congene38, sum(h39) as congene39, sum(h40) as congene40,
      sum(h41) as congene41, sum(h42) as congene42, sum(h43) as congene43, sum(h44) as congene44, sum(h45) as congene45,
      sum(h46) as congene46, sum(h47) as congene47, sum(h48) as congene48
      from (
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, nvl((cm.CMGRENERGIA / 1000),0) as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 1 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 1 and to_char(cm.cmgrfecha, 'YYYYMM') = :congenebase
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='00:30'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, nvl((cm.CMGRENERGIA / 1000),0) as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 2 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 2 and to_char(cm.cmgrfecha, 'YYYYMM') = :congenebase
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='01:00'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, nvl((cm.CMGRENERGIA / 1000),0) as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 3 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 3 and to_char(cm.cmgrfecha, 'YYYYMM') = :congenebase
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='01:30'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, nvl((cm.CMGRENERGIA / 1000),0) as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 4 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 4 and to_char(cm.cmgrfecha, 'YYYYMM') = :congenebase
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='02:00'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, nvl((cm.CMGRENERGIA / 1000),0) as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 5 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 5 and to_char(cm.cmgrfecha, 'YYYYMM') = :congenebase
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='02:30'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, nvl((cm.CMGRENERGIA / 1000),0) as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 6 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 6 and to_char(cm.cmgrfecha, 'YYYYMM') = :congenebase
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='03:00'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, nvl((cm.CMGRENERGIA / 1000),0) as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 7 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 7 and to_char(cm.cmgrfecha, 'YYYYMM') = :congenebase
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='03:30'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, nvl((cm.CMGRENERGIA / 1000),0) as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 8 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 8 and to_char(cm.cmgrfecha, 'YYYYMM') = :congenebase
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='04:00'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, nvl((cm.CMGRENERGIA / 1000),0) as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 9 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 9 and to_char(cm.cmgrfecha, 'YYYYMM') = :congenebase
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='04:30'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, nvl((cm.CMGRENERGIA / 1000),0) as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 10 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 10 and to_char(cm.cmgrfecha, 'YYYYMM') = :congenebase
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='05:00'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      nvl((cm.CMGRENERGIA / 1000),0) as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 11 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 11 and to_char(cm.cmgrfecha, 'YYYYMM') = :congenebase
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='05:30'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, nvl((cm.CMGRENERGIA / 1000),0) as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 12 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 12 and to_char(cm.cmgrfecha, 'YYYYMM') = :congenebase
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='06:00'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, nvl((cm.CMGRENERGIA / 1000),0) as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 13 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 13 and to_char(cm.cmgrfecha, 'YYYYMM') = :congenebase
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='06:30'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, nvl((cm.CMGRENERGIA / 1000),0) as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 14 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 14 and to_char(cm.cmgrfecha, 'YYYYMM') = :congenebase
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='07:00'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, nvl((cm.CMGRENERGIA / 1000),0) as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 15 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 15 and to_char(cm.cmgrfecha, 'YYYYMM') = :congenebase
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='07:30'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, nvl((cm.CMGRENERGIA / 1000),0) as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 16 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 16 and to_char(cm.cmgrfecha, 'YYYYMM') = :congenebase
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='08:00'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, nvl((cm.CMGRENERGIA / 1000),0) as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 17 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 17 and to_char(cm.cmgrfecha, 'YYYYMM') = :congenebase
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='08:30'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, nvl((cm.CMGRENERGIA / 1000),0) as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 18 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 18 and to_char(cm.cmgrfecha, 'YYYYMM') = :congenebase
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='09:00'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, nvl((cm.CMGRENERGIA / 1000),0) as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 19 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 19 and to_char(cm.cmgrfecha, 'YYYYMM') = :congenebase
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='09:30'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, nvl((cm.CMGRENERGIA / 1000),0) as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 20 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 20 and to_char(cm.cmgrfecha, 'YYYYMM') = :congenebase
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='10:00'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      nvl((cm.CMGRENERGIA / 1000),0) as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 21 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 21 and to_char(cm.cmgrfecha, 'YYYYMM') = :congenebase
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='10:30'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, nvl((cm.CMGRENERGIA / 1000),0) as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 22 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 22 and to_char(cm.cmgrfecha, 'YYYYMM') = :congenebase
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='11:00'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, nvl((cm.CMGRENERGIA / 1000),0) as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 23 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 23 and to_char(cm.cmgrfecha, 'YYYYMM') = :congenebase
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='11:30'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, nvl((cm.CMGRENERGIA / 1000),0) as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 24 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 24 and to_char(cm.cmgrfecha, 'YYYYMM') = :congenebase
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='12:00'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, nvl((cm.CMGRENERGIA / 1000),0) as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 25 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 25 and to_char(cm.cmgrfecha, 'YYYYMM') = :congenebase
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='12:30'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, nvl((cm.CMGRENERGIA / 1000),0) as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 26 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 26 and to_char(cm.cmgrfecha, 'YYYYMM') = :congenebase
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='13:00'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, nvl((cm.CMGRENERGIA / 1000),0) as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 27 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 27 and to_char(cm.cmgrfecha, 'YYYYMM') = :congenebase
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='13:30'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, nvl((cm.CMGRENERGIA / 1000),0) as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 28 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 28 and to_char(cm.cmgrfecha, 'YYYYMM') = :congenebase
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='14:00'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, nvl((cm.CMGRENERGIA / 1000),0) as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 29 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 29 and to_char(cm.cmgrfecha, 'YYYYMM') = :congenebase
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='14:30'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, nvl((cm.CMGRENERGIA / 1000),0) as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 30 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 30 and to_char(cm.cmgrfecha, 'YYYYMM') = :congenebase
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='15:00'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      nvl((cm.CMGRENERGIA / 1000),0) as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 31 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 31 and to_char(cm.cmgrfecha, 'YYYYMM') = :congenebase
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='15:30'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, nvl((cm.CMGRENERGIA / 1000),0) as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 32 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 32 and to_char(cm.cmgrfecha, 'YYYYMM') = :congenebase
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='16:00'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, nvl((cm.CMGRENERGIA / 1000),0) as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 33 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 33 and to_char(cm.cmgrfecha, 'YYYYMM') = :congenebase
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='16:30'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, nvl((cm.CMGRENERGIA / 1000),0) as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 34 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 34 and to_char(cm.cmgrfecha, 'YYYYMM') = :congenebase
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='17:00'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, nvl((cm.CMGRENERGIA / 1000),0) as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 35 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 35 and to_char(cm.cmgrfecha, 'YYYYMM') = :congenebase
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='17:30'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, nvl((cm.CMGRENERGIA / 1000),0) as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 36 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 36 and to_char(cm.cmgrfecha, 'YYYYMM') = :congenebase
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='18:00'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, nvl((cm.CMGRENERGIA / 1000),0) as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 37 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 37 and to_char(cm.cmgrfecha, 'YYYYMM') = :congenebase
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='18:30'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, nvl((cm.CMGRENERGIA / 1000),0) as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 38 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 38 and to_char(cm.cmgrfecha, 'YYYYMM') = :congenebase
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='19:00'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, nvl((cm.CMGRENERGIA / 1000),0) as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 39 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 39 and to_char(cm.cmgrfecha, 'YYYYMM') = :congenebase
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='19:30'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, nvl((cm.CMGRENERGIA / 1000),0) as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 40 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 40 and to_char(cm.cmgrfecha, 'YYYYMM') = :congenebase
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='20:00'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      nvl((cm.CMGRENERGIA / 1000),0) as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 41 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 41 and to_char(cm.cmgrfecha, 'YYYYMM') = :congenebase
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='20:30'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, nvl((cm.CMGRENERGIA / 1000),0) as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 42 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 42 and to_char(cm.cmgrfecha, 'YYYYMM') = :congenebase
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='21:00'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, nvl((cm.CMGRENERGIA / 1000),0) as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 43 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 43 and to_char(cm.cmgrfecha, 'YYYYMM') = :congenebase
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='21:30'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, nvl((cm.CMGRENERGIA / 1000),0) as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 44 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 44 and to_char(cm.cmgrfecha, 'YYYYMM') = :congenebase
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='22:00'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, nvl((cm.CMGRENERGIA / 1000),0) as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 45 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 45 and to_char(cm.cmgrfecha, 'YYYYMM') = :congenebase
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='22:30'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, nvl((cm.CMGRENERGIA / 1000),0) as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 46 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 46 and to_char(cm.cmgrfecha, 'YYYYMM') = :congenebase
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='23:00'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, nvl((cm.CMGRENERGIA / 1000),0) as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 47 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 47 and to_char(cm.cmgrfecha, 'YYYYMM') = :congenebase
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='23:30'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, nvl((cm.CMGRENERGIA / 1000),0) as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 48 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 48 and to_char(cm.cmgrfecha, 'YYYYMM') = :congenebase
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='23:59'
      ) t2
      group by barrcodi, to_char(fecha, 'YYYY-MM-DD')
      order by 1, 2
      ) t1
    </query>
  </Sql>

  <Sql>
    <key>ListFechaXBarraSiCostMarg</key>
    <query>
      select (TRUNC(x.cmgrfecha, 'DD') + (count(*))/1440) as facperfecins, count(*) as facperdia
      from (
      select cmgrfecha from trn_costo_marginal_tmp where barrcodi = :barrcodi
      minus
      select cm.cmgrfecha from si_costomarginal cm where cm.barrcodi = :barrcodi and to_char(cm.cmgrfecha, 'YYYYMM') = :facperbase
      ) x
      group by TRUNC(x.cmgrfecha, 'DD')
      order by 1
    </query>
  </Sql>
</Sqls>
