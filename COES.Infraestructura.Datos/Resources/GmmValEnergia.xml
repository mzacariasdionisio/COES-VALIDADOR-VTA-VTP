<?xml version="1.0" encoding="utf-8" ?>
<Sqls>
  <Sql>
    <key>GetMaxId</key>
    <query>
      select nvl(max(VALOCODI), 0) + 1 from GMM_VALENERGIA
    </query>
  </Sql>
  <Sql>
    <key>Save</key>
    <query>
      INSERT INTO GMM_VALENERGIA (
      VALOCODI,
      PERICODI,
      EMPRCODI,
      EMPGCODI,
      BARRCODI,
      CASDDBBARRA,
      PTOMEDICODI,
      TPTOMEDICODI,
      TIPOINFOCODI,
      MEDIFECHA,
      LECTCODI,
      VALANIO,
      VALMES,
      VALOVALOR1,
      VALOVALOR2,
      VALOVALOR3,
      VALOVALOR4,
      VALOVALOR5,
      VALOVALOR6,
      VALOVALOR7,
      VALOVALOR8,
      VALOVALOR9,
      VALOVALOR10,
      VALOVALOR11,
      VALOVALOR12,
      VALOVALOR13,
      VALOVALOR14,
      VALOVALOR15,
      VALOVALOR16,
      VALOVALOR17,
      VALOVALOR18,
      VALOVALOR19,
      VALOVALOR20,
      VALOVALOR21,
      VALOVALOR22,
      VALOVALOR23,
      VALOVALOR24,
      VALOVALOR25,
      VALOVALOR26,
      VALOVALOR28,
      VALOVALOR27,
      VALOVALOR29,
      VALOVALOR30,
      VALOVALOR31,
      VALOVALOR32,
      VALOVALOR33,
      VALOVALOR34,
      VALOVALOR35,
      VALOVALOR36,
      VALOVALOR37,
      VALOVALOR38,
      VALOVALOR39,
      VALOVALOR40,
      VALOVALOR41,
      VALOVALOR42,
      VALOVALOR43,
      VALOVALOR44,
      VALOVALOR45,
      VALOVALOR46,
      VALOVALOR47,
      VALOVALOR48,
      VALOVALOR49,
      VALOVALOR50,
      VALOVALOR51,
      VALOVALOR52,
      VALOVALOR53,
      VALOVALOR54,
      VALOVALOR55,
      VALOVALOR56,
      VALOVALOR57,
      VALOVALOR58,
      VALOVALOR59,
      VALOVALOR60,
      VALOVALOR61,
      VALOVALOR62,
      VALOVALOR63,
      VALOVALOR64,
      VALOVALOR65,
      VALOVALOR66,
      VALOVALOR67,
      VALOVALOR68,
      VALOVALOR69,
      VALOVALOR70,
      VALOVALOR71,
      VALOVALOR72,
      VALOVALOR73,
      VALOVALOR74,
      VALOVALOR75,
      VALOVALOR76,
      VALOVALOR77,
      VALOVALOR78,
      VALOVALOR79,
      VALOVALOR80,
      VALOVALOR81,
      VALOVALOR82,
      VALOVALOR83,
      VALOVALOR84,
      VALOVALOR85,
      VALOVALOR86,
      VALOVALOR87,
      VALOVALOR88,
      VALOVALOR89,
      VALOVALOR90,
      VALOVALOR91,
      VALOVALOR92,
      VALOVALOR93,
      VALOVALOR94,
      VALOVALOR95,
      VALOVALOR96,
      VALOVALORCM1,
      VALOVALORCM2,
      VALOVALORCM3,
      VALOVALORCM4,
      VALOVALORCM5,
      VALOVALORCM6,
      VALOVALORCM7,
      VALOVALORCM8,
      VALOVALORCM9,
      VALOVALORCM10,
      VALOVALORCM11,
      VALOVALORCM12,
      VALOVALORCM13,
      VALOVALORCM14,
      VALOVALORCM15,
      VALOVALORCM16,
      VALOVALORCM17,
      VALOVALORCM18,
      VALOVALORCM19,
      VALOVALORCM20,
      VALOVALORCM21,
      VALOVALORCM22,
      VALOVALORCM23,
      VALOVALORCM24,
      VALOVALORCM25,
      VALOVALORCM26,
      VALOVALORCM27,
      VALOVALORCM28,
      VALOVALORCM29,
      VALOVALORCM30,
      VALOVALORCM31,
      VALOVALORCM32,
      VALOVALORCM33,
      VALOVALORCM34,
      VALOVALORCM35,
      VALOVALORCM36,
      VALOVALORCM37,
      VALOVALORCM38,
      VALOVALORCM39,
      VALOVALORCM40,
      VALOVALORCM41,
      VALOVALORCM42,
      VALOVALORCM43,
      VALOVALORCM44,
      VALOVALORCM45,
      VALOVALORCM46,
      VALOVALORCM47,
      VALOVALORCM48,
      VALOVALORCM49,
      VALOVALORCM50,
      VALOVALORCM51,
      VALOVALORCM52,
      VALOVALORCM53,
      VALOVALORCM54,
      VALOVALORCM55,
      VALOVALORCM56,
      VALOVALORCM57,
      VALOVALORCM58,
      VALOVALORCM59,
      VALOVALORCM60,
      VALOVALORCM61,
      VALOVALORCM62,
      VALOVALORCM63,
      VALOVALORCM64,
      VALOVALORCM65,
      VALOVALORCM66,
      VALOVALORCM67,
      VALOVALORCM68,
      VALOVALORCM69,
      VALOVALORCM70,
      VALOVALORCM71,
      VALOVALORCM72,
      VALOVALORCM73,
      VALOVALORCM74,
      VALOVALORCM75,
      VALOVALORCM76,
      VALOVALORCM77,
      VALOVALORCM78,
      VALOVALORCM79,
      VALOVALORCM80,
      VALOVALORCM81,
      VALOVALORCM82,
      VALOVALORCM83,
      VALOVALORCM84,
      VALOVALORCM85,
      VALOVALORCM86,
      VALOVALORCM87,
      VALOVALORCM88,
      VALOVALORCM89,
      VALOVALORCM90,
      VALOVALORCM91,
      VALOVALORCM92,
      VALOVALORCM93,
      VALOVALORCM94,
      VALOVALORCM95,
      VALOVALORCM96,
      VALUSUCREACION,
      VALFECCREACION
      ) VALUES (
      :VALOCODI,
      :PERICODI,
      :EMPRCODI,
      :EMPGCODI,
      :BARRCODI,
      :CASDDBBARRA,
      :PTOMEDICODI,
      :TPTOMEDICODI,
      :TIPOINFOCODI,
      to_date(:MEDIFECHA,'yyyy-mm-dd'),
      :LECTCODI,
      :VALANIO,
      :VALMES,
      :VALOVALOR1,
      :VALOVALOR2,
      :VALOVALOR3,
      :VALOVALOR4,
      :VALOVALOR5,
      :VALOVALOR6,
      :VALOVALOR7,
      :VALOVALOR8,
      :VALOVALOR9,
      :VALOVALOR10,
      :VALOVALOR11,
      :VALOVALOR12,
      :VALOVALOR13,
      :VALOVALOR14,
      :VALOVALOR15,
      :VALOVALOR16,
      :VALOVALOR17,
      :VALOVALOR18,
      :VALOVALOR19,
      :VALOVALOR20,
      :VALOVALOR21,
      :VALOVALOR22,
      :VALOVALOR23,
      :VALOVALOR24,
      :VALOVALOR25,
      :VALOVALOR26,
      :VALOVALOR28,
      :VALOVALOR27,
      :VALOVALOR29,
      :VALOVALOR30,
      :VALOVALOR31,
      :VALOVALOR32,
      :VALOVALOR33,
      :VALOVALOR34,
      :VALOVALOR35,
      :VALOVALOR36,
      :VALOVALOR37,
      :VALOVALOR38,
      :VALOVALOR39,
      :VALOVALOR40,
      :VALOVALOR41,
      :VALOVALOR42,
      :VALOVALOR43,
      :VALOVALOR44,
      :VALOVALOR45,
      :VALOVALOR46,
      :VALOVALOR47,
      :VALOVALOR48,
      :VALOVALOR49,
      :VALOVALOR50,
      :VALOVALOR51,
      :VALOVALOR52,
      :VALOVALOR53,
      :VALOVALOR54,
      :VALOVALOR55,
      :VALOVALOR56,
      :VALOVALOR57,
      :VALOVALOR58,
      :VALOVALOR59,
      :VALOVALOR60,
      :VALOVALOR61,
      :VALOVALOR62,
      :VALOVALOR63,
      :VALOVALOR64,
      :VALOVALOR65,
      :VALOVALOR66,
      :VALOVALOR67,
      :VALOVALOR68,
      :VALOVALOR69,
      :VALOVALOR70,
      :VALOVALOR71,
      :VALOVALOR72,
      :VALOVALOR73,
      :VALOVALOR74,
      :VALOVALOR75,
      :VALOVALOR76,
      :VALOVALOR77,
      :VALOVALOR78,
      :VALOVALOR79,
      :VALOVALOR80,
      :VALOVALOR81,
      :VALOVALOR82,
      :VALOVALOR83,
      :VALOVALOR84,
      :VALOVALOR85,
      :VALOVALOR86,
      :VALOVALOR87,
      :VALOVALOR88,
      :VALOVALOR89,
      :VALOVALOR90,
      :VALOVALOR91,
      :VALOVALOR92,
      :VALOVALOR93,
      :VALOVALOR94,
      :VALOVALOR95,
      :VALOVALOR96,
      :VALOVALORCM1,
      :VALOVALORCM2,
      :VALOVALORCM3,
      :VALOVALORCM4,
      :VALOVALORCM5,
      :VALOVALORCM6,
      :VALOVALORCM7,
      :VALOVALORCM8,
      :VALOVALORCM9,
      :VALOVALORCM10,
      :VALOVALORCM11,
      :VALOVALORCM12,
      :VALOVALORCM13,
      :VALOVALORCM14,
      :VALOVALORCM15,
      :VALOVALORCM16,
      :VALOVALORCM17,
      :VALOVALORCM18,
      :VALOVALORCM19,
      :VALOVALORCM20,
      :VALOVALORCM21,
      :VALOVALORCM22,
      :VALOVALORCM23,
      :VALOVALORCM24,
      :VALOVALORCM25,
      :VALOVALORCM26,
      :VALOVALORCM27,
      :VALOVALORCM28,
      :VALOVALORCM29,
      :VALOVALORCM30,
      :VALOVALORCM31,
      :VALOVALORCM32,
      :VALOVALORCM33,
      :VALOVALORCM34,
      :VALOVALORCM35,
      :VALOVALORCM36,
      :VALOVALORCM37,
      :VALOVALORCM38,
      :VALOVALORCM39,
      :VALOVALORCM40,
      :VALOVALORCM41,
      :VALOVALORCM42,
      :VALOVALORCM43,
      :VALOVALORCM44,
      :VALOVALORCM45,
      :VALOVALORCM46,
      :VALOVALORCM47,
      :VALOVALORCM48,
      :VALOVALORCM49,
      :VALOVALORCM50,
      :VALOVALORCM51,
      :VALOVALORCM52,
      :VALOVALORCM53,
      :VALOVALORCM54,
      :VALOVALORCM55,
      :VALOVALORCM56,
      :VALOVALORCM57,
      :VALOVALORCM58,
      :VALOVALORCM59,
      :VALOVALORCM60,
      :VALOVALORCM61,
      :VALOVALORCM62,
      :VALOVALORCM63,
      :VALOVALORCM64,
      :VALOVALORCM65,
      :VALOVALORCM66,
      :VALOVALORCM67,
      :VALOVALORCM68,
      :VALOVALORCM69,
      :VALOVALORCM70,
      :VALOVALORCM71,
      :VALOVALORCM72,
      :VALOVALORCM73,
      :VALOVALORCM74,
      :VALOVALORCM75,
      :VALOVALORCM76,
      :VALOVALORCM77,
      :VALOVALORCM78,
      :VALOVALORCM79,
      :VALOVALORCM80,
      :VALOVALORCM81,
      :VALOVALORCM82,
      :VALOVALORCM83,
      :VALOVALORCM84,
      :VALOVALORCM85,
      :VALOVALORCM86,
      :VALOVALORCM87,
      :VALOVALORCM88,
      :VALOVALORCM89,
      :VALOVALORCM90,
      :VALOVALORCM91,
      :VALOVALORCM92,
      :VALOVALORCM93,
      :VALOVALORCM94,
      :VALOVALORCM95,
      :VALOVALORCM96,
      :VALUSUCREACION,
      sysdate
      )
    </query>
  </Sql>
  <Sql>
    <key>Update</key>
    <query>
     </query>
  </Sql>
  <Sql>
    <key>Delete</key>
    <query>
    </query>
  </Sql>
  <Sql>
    <key>GetById</key>
    <query>
      select * from GMM_VALENERGIA where VALOCODI = :VALOCODI
    </query>
  </Sql>
  <Sql>
    <key>ListarValores96Originales</key>
    <query>
      select
      me.LECTCODI,
      me.MEDIFECHA,
      EXTRACT(year from me.MEDIFECHA) AS VALANIO,
      EXTRACT(month from me.MEDIFECHA) AS VALMES,
      H1 as VALOVALOR1,
      H2 as VALOVALOR2,
      H3 as VALOVALOR3,
      H4 as VALOVALOR4,
      H5 as VALOVALOR5,
      H6 as VALOVALOR6,
      H7 as VALOVALOR7,
      H8 as VALOVALOR8,
      H9 as VALOVALOR9,
      H10 as VALOVALOR10,
      H11 as VALOVALOR11,
      H12 as VALOVALOR12,
      H13 as VALOVALOR13,
      H14 as VALOVALOR14,
      H15 as VALOVALOR15,
      H16 as VALOVALOR16,
      H17 as VALOVALOR17,
      H18 as VALOVALOR18,
      H19 as VALOVALOR19,
      H20 as VALOVALOR20,
      H21 as VALOVALOR21,
      H22 as VALOVALOR22,
      H23 as VALOVALOR23,
      H24 as VALOVALOR24,
      H25 as VALOVALOR25,
      H26 as VALOVALOR26,
      H27 as VALOVALOR27,
      H28 as VALOVALOR28,
      H29 as VALOVALOR29,
      H30 as VALOVALOR30,
      H31 as VALOVALOR31,
      H32 as VALOVALOR32,
      H33 as VALOVALOR33,
      H34 as VALOVALOR34,
      H35 as VALOVALOR35,
      H36 as VALOVALOR36,
      H37 as VALOVALOR37,
      H38 as VALOVALOR38,
      H39 as VALOVALOR39,
      H40 as VALOVALOR40,
      H41 as VALOVALOR41,
      H42 as VALOVALOR42,
      H43 as VALOVALOR43,
      H44 as VALOVALOR44,
      H45 as VALOVALOR45,
      H46 as VALOVALOR46,
      H47 as VALOVALOR47,
      H48 as VALOVALOR48,
      H49 as VALOVALOR49,
      H50 as VALOVALOR50,
      H51 as VALOVALOR51,
      H52 as VALOVALOR52,
      H53 as VALOVALOR53,
      H54 as VALOVALOR54,
      H55 as VALOVALOR55,
      H56 as VALOVALOR56,
      H57 as VALOVALOR57,
      H58 as VALOVALOR58,
      H59 as VALOVALOR59,
      H60 as VALOVALOR60,
      H61 as VALOVALOR61,
      H62 as VALOVALOR62,
      H63 as VALOVALOR63,
      H64 as VALOVALOR64,
      H65 as VALOVALOR65,
      H66 as VALOVALOR66,
      H67 as VALOVALOR67,
      H68 as VALOVALOR68,
      H69 as VALOVALOR69,
      H70 as VALOVALOR70,
      H71 as VALOVALOR71,
      H72 as VALOVALOR72,
      H73 as VALOVALOR73,
      H74 as VALOVALOR74,
      H75 as VALOVALOR75,
      H76 as VALOVALOR76,
      H77 as VALOVALOR77,
      H78 as VALOVALOR78,
      H79 as VALOVALOR79,
      H80 as VALOVALOR80,
      H81 as VALOVALOR81,
      H82 as VALOVALOR82,
      H83 as VALOVALOR83,
      H84 as VALOVALOR84,
      H85 as VALOVALOR85,
      H86 as VALOVALOR86,
      H87 as VALOVALOR87,
      H88 as VALOVALOR88,
      H89 as VALOVALOR89,
      H90 as VALOVALOR90,
      H91 as VALOVALOR91,
      H92 as VALOVALOR92,
      H93 as VALOVALOR93,
      H94 as VALOVALOR94,
      H95 as VALOVALOR95,
      H96 as VALOVALOR96
      from me_medicion96 me
      inner join me_hojaptomed hp on hp.ptomedicodi = me.ptomedicodi and hp.tipoinfocodi = me.tipoinfocodi and hp.TPTOMEDICODI = me.TPTOMEDICODI
      inner join me_formato fh on fh.formatcodi = hp.formatcodi and fh.lectcodi = me.lectcodi
      inner join me_ptomedicion pto on pto.ptomedicodi = hp.ptomedicodi
      where hp.formatcodi = {0} and pto.EMPRCODI = {1} and pto.ptomedicodi = {2}
      and extract(year from me.MEDIFECHA) || EXTRACT(month from me.MEDIFECHA) in ({3}, {4},{5})
      order by MEDIFECHA asc
    </query>
  </Sql>
  <Sql>
    <key>ListarValoresCostoMarginal</key>
    <query>
      SELECT BA.PTOMEDICODI,TRIM(BA.PTOMEDIDESC) PTOMEDIDESC, BH.PMBLOQNOMBRE,SE.SEMANANUM||'/'||SE.SEMANAANHIO AS SEMANA,
      GE.MEDINTH1,
      BA.MEDINTFECHAINI, GE.MEDINTBLQNUMERO
      FROM (SELECT * FROM (SELECT DISTINCT MI.MEDINTFECHAINI
      FROM ME_MEDICIONXINTERVALO MI
      WHERE MI.LECTCODI= 109 AND MI.TPTOMEDICODI = 80 AND MI.enviocodi = {0}) D1
      ,(SELECT DISTINCT PTO.PTOMEDICODI,PTO.PTOMEDIDESC
      FROM ME_MEDICIONXINTERVALO MI JOIN ME_PTOMEDICION PTO ON MI.PTOMEDICODI = PTO.PTOMEDICODI
      WHERE MI.LECTCODI= 109 AND MI.TPTOMEDICODI = 80 AND MI.enviocodi = {1}) D2
      ,(SELECT DISTINCT MI.MEDINTBLQNUMERO
      FROM ME_MEDICIONXINTERVALO MI
      WHERE MI.LECTCODI= 109 AND MI.TPTOMEDICODI = 80 AND MI.enviocodi = {2}) D3
      ) BA LEFT JOIN (SELECT MI.MEDINTFECHAINI,PTO.PTOMEDICODI,MI.MEDINTBLQNUMERO, MAX(MI.MEDINTH1) AS MEDINTH1
      FROM ME_MEDICIONXINTERVALO MI JOIN ME_PTOMEDICION PTO ON MI.PTOMEDICODI = PTO.PTOMEDICODI
      WHERE MI.LECTCODI= 109 AND MI.TPTOMEDICODI = 80
      AND MI.enviocodi = {3} GROUP BY MI.MEDINTFECHAINI,PTO.PTOMEDICODI,MI.MEDINTBLQNUMERO
      ) GE
      ON BA.MEDINTFECHAINI = GE.MEDINTFECHAINI AND BA.PTOMEDICODI = GE.PTOMEDICODI AND BA.MEDINTBLQNUMERO = GE.MEDINTBLQNUMERO
      LEFT JOIN SI_SEMANA SE ON BA.MEDINTFECHAINI = SE.SEMANAFECHA
      LEFT JOIN PMO_BLOQUE_HOR BH ON GE.MEDINTBLQNUMERO = BH.PMBLOQCODI
      WHERE TRIM(BA.PTOMEDIDESC) = '{4}'
      AND SE.semanacodi = {5}
      ORDER BY BA.MEDINTBLQNUMERO
    </query>
</Sql>
<Sql>
    <key>GetSemana</key>
    <query>
      select semanacodi, enviocodi from
      (select distinct semanacodi, MI.enviocodi
      from si_semana se join ME_MEDICIONXINTERVALO mi
      on se.semanafecha = mi.medintfechaini
      where MI.LECTCODI= 109 AND MI.TPTOMEDICODI = 80
      and (se.semanafecha - to_date('{0}', 'yyyy-mm-dd')) BETWEEN -6 and 0
      order by MI.enviocodi desc)
      where rownum = 1
    </query>
</Sql>
<Sql>
    <key>GetEnvio</key>
    <query>
      SELECT MI.ENVIOCODI, TRIM(TO_CHAR(en.enviofechaperiodo,'Month','nls_date_language=spanish' )) ||TO_CHAR(en.enviofechaperiodo,' YYYY')  ||'  '||TO_CHAR(en.enviofechaini,'DD-MM-YYYY')||' ['||COUNT(*)||']' AS DESCRIPCION
      FROM ME_MEDICIONXINTERVALO MI
      JOIN ME_ENVIO EN ON MI.ENVIOCODI=EN.ENVIOCODI
      WHERE MI.LECTCODI= 109 AND MI.ENVIOCODI &lt;&gt; 0
      AND extract(year from en.enviofechaperiodo) = {0} and EXTRACT(month from en.enviofechaperiodo) = {1}
      GROUP BY MI.ENVIOCODI,en.enviofechaperiodo,en.enviofechaini
      ORDER BY en.enviofechaperiodo DESC
    </query>
</Sql>
</Sqls>