<?xml version="1.0" encoding="utf-8" ?>
<Sqls>
  <Sql>
    <key>GetMaxId</key>
    <query>
      select nvl(max(VALENECODI), 0) + 1 from GMM_VALENERGIAENTREGA
    </query>
  </Sql>
  <Sql>
    <key>Save</key>
    <query>
      INSERT INTO GMM_VALENERGIAENTREGA (
      VALENECODI,
      PERICODI,
      EMPRCODI,
      EMPGCODI,
      BARRCODI,
      CASDDBBARRA,
      PTOMEDICODI,
      TPTOMEDICODI,
      TIPOINFOCODI,
      MEDIFECHA,
      LECTCODI,
      VALANIO,
      VALMES,
      VALENEVALENEVAL1,
      VALENEVALENEVAL2,
      VALENEVALENEVAL3,
      VALENEVALENEVAL4,
      VALENEVALENEVAL5,
      VALENEVALENEVAL6,
      VALENEVALENEVAL7,
      VALENEVALENEVAL8,
      VALENEVALENEVAL9,
      VALENEVALENEVAL10,
      VALENEVALENEVAL11,
      VALENEVALENEVAL12,
      VALENEVALENEVAL13,
      VALENEVALENEVAL14,
      VALENEVALENEVAL15,
      VALENEVALENEVAL16,
      VALENEVALENEVAL17,
      VALENEVALENEVAL18,
      VALENEVALENEVAL19,
      VALENEVALENEVAL20,
      VALENEVALENEVAL21,
      VALENEVALENEVAL22,
      VALENEVALENEVAL23,
      VALENEVALENEVAL24,
      VALENEVALENEVAL25,
      VALENEVALENEVAL26,
      VALENEVALENEVAL28,
      VALENEVALENEVAL27,
      VALENEVALENEVAL29,
      VALENEVALENEVAL30,
      VALENEVALENEVAL31,
      VALENEVALENEVAL32,
      VALENEVALENEVAL33,
      VALENEVALENEVAL34,
      VALENEVALENEVAL35,
      VALENEVALENEVAL36,
      VALENEVALENEVAL37,
      VALENEVALENEVAL38,
      VALENEVALENEVAL39,
      VALENEVALENEVAL40,
      VALENEVALENEVAL41,
      VALENEVALENEVAL42,
      VALENEVALENEVAL43,
      VALENEVALENEVAL44,
      VALENEVALENEVAL45,
      VALENEVALENEVAL46,
      VALENEVALENEVAL47,
      VALENEVALENEVAL48,
      VALENEVALENEVAL49,
      VALENEVALENEVAL50,
      VALENEVALENEVAL51,
      VALENEVALENEVAL52,
      VALENEVALENEVAL53,
      VALENEVALENEVAL54,
      VALENEVALENEVAL55,
      VALENEVALENEVAL56,
      VALENEVALENEVAL57,
      VALENEVALENEVAL58,
      VALENEVALENEVAL59,
      VALENEVALENEVAL60,
      VALENEVALENEVAL61,
      VALENEVALENEVAL62,
      VALENEVALENEVAL63,
      VALENEVALENEVAL64,
      VALENEVALENEVAL65,
      VALENEVALENEVAL66,
      VALENEVALENEVAL67,
      VALENEVALENEVAL68,
      VALENEVALENEVAL69,
      VALENEVALENEVAL70,
      VALENEVALENEVAL71,
      VALENEVALENEVAL72,
      VALENEVALENEVAL73,
      VALENEVALENEVAL74,
      VALENEVALENEVAL75,
      VALENEVALENEVAL76,
      VALENEVALENEVAL77,
      VALENEVALENEVAL78,
      VALENEVALENEVAL79,
      VALENEVALENEVAL80,
      VALENEVALENEVAL81,
      VALENEVALENEVAL82,
      VALENEVALENEVAL83,
      VALENEVALENEVAL84,
      VALENEVALENEVAL85,
      VALENEVALENEVAL86,
      VALENEVALENEVAL87,
      VALENEVALENEVAL88,
      VALENEVALENEVAL89,
      VALENEVALENEVAL90,
      VALENEVALENEVAL91,
      VALENEVALENEVAL92,
      VALENEVALENEVAL93,
      VALENEVALENEVAL94,
      VALENEVALENEVAL95,
      VALENEVALENEVAL96,
      VALENEVALENEVALCM1,
      VALENEVALENEVALCM2,
      VALENEVALENEVALCM3,
      VALENEVALENEVALCM4,
      VALENEVALENEVALCM5,
      VALENEVALENEVALCM6,
      VALENEVALENEVALCM7,
      VALENEVALENEVALCM8,
      VALENEVALENEVALCM9,
      VALENEVALENEVALCM10,
      VALENEVALENEVALCM11,
      VALENEVALENEVALCM12,
      VALENEVALENEVALCM13,
      VALENEVALENEVALCM14,
      VALENEVALENEVALCM15,
      VALENEVALENEVALCM16,
      VALENEVALENEVALCM17,
      VALENEVALENEVALCM18,
      VALENEVALENEVALCM19,
      VALENEVALENEVALCM20,
      VALENEVALENEVALCM21,
      VALENEVALENEVALCM22,
      VALENEVALENEVALCM23,
      VALENEVALENEVALCM24,
      VALENEVALENEVALCM25,
      VALENEVALENEVALCM26,
      VALENEVALENEVALCM27,
      VALENEVALENEVALCM28,
      VALENEVALENEVALCM29,
      VALENEVALENEVALCM30,
      VALENEVALENEVALCM31,
      VALENEVALENEVALCM32,
      VALENEVALENEVALCM33,
      VALENEVALENEVALCM34,
      VALENEVALENEVALCM35,
      VALENEVALENEVALCM36,
      VALENEVALENEVALCM37,
      VALENEVALENEVALCM38,
      VALENEVALENEVALCM39,
      VALENEVALENEVALCM40,
      VALENEVALENEVALCM41,
      VALENEVALENEVALCM42,
      VALENEVALENEVALCM43,
      VALENEVALENEVALCM44,
      VALENEVALENEVALCM45,
      VALENEVALENEVALCM46,
      VALENEVALENEVALCM47,
      VALENEVALENEVALCM48,
      VALENEVALENEVALCM49,
      VALENEVALENEVALCM50,
      VALENEVALENEVALCM51,
      VALENEVALENEVALCM52,
      VALENEVALENEVALCM53,
      VALENEVALENEVALCM54,
      VALENEVALENEVALCM55,
      VALENEVALENEVALCM56,
      VALENEVALENEVALCM57,
      VALENEVALENEVALCM58,
      VALENEVALENEVALCM59,
      VALENEVALENEVALCM60,
      VALENEVALENEVALCM61,
      VALENEVALENEVALCM62,
      VALENEVALENEVALCM63,
      VALENEVALENEVALCM64,
      VALENEVALENEVALCM65,
      VALENEVALENEVALCM66,
      VALENEVALENEVALCM67,
      VALENEVALENEVALCM68,
      VALENEVALENEVALCM69,
      VALENEVALENEVALCM70,
      VALENEVALENEVALCM71,
      VALENEVALENEVALCM72,
      VALENEVALENEVALCM73,
      VALENEVALENEVALCM74,
      VALENEVALENEVALCM75,
      VALENEVALENEVALCM76,
      VALENEVALENEVALCM77,
      VALENEVALENEVALCM78,
      VALENEVALENEVALCM79,
      VALENEVALENEVALCM80,
      VALENEVALENEVALCM81,
      VALENEVALENEVALCM82,
      VALENEVALENEVALCM83,
      VALENEVALENEVALCM84,
      VALENEVALENEVALCM85,
      VALENEVALENEVALCM86,
      VALENEVALENEVALCM87,
      VALENEVALENEVALCM88,
      VALENEVALENEVALCM89,
      VALENEVALENEVALCM90,
      VALENEVALENEVALCM91,
      VALENEVALENEVALCM92,
      VALENEVALENEVALCM93,
      VALENEVALENEVALCM94,
      VALENEVALENEVALCM95,
      VALENEVALENEVALCM96,
      VALUSUCREACION,
      VALFECCREACION
      ) VALUES (
      :VALENECODI,
      :PERICODI,
      :EMPRCODI,
      :EMPGCODI,
      :BARRCODI,
      :CASDDBBARRA,
      :PTOMEDICODI,
      :TPTOMEDICODI,
      :TIPOINFOCODI,
      to_date(:MEDIFECHA,'yyyy-mm-dd'),
      :LECTCODI,
      :VALANIO,
      :VALMES,
      :VALENEVALENEVAL1,
      :VALENEVALENEVAL2,
      :VALENEVALENEVAL3,
      :VALENEVALENEVAL4,
      :VALENEVALENEVAL5,
      :VALENEVALENEVAL6,
      :VALENEVALENEVAL7,
      :VALENEVALENEVAL8,
      :VALENEVALENEVAL9,
      :VALENEVALENEVAL10,
      :VALENEVALENEVAL11,
      :VALENEVALENEVAL12,
      :VALENEVALENEVAL13,
      :VALENEVALENEVAL14,
      :VALENEVALENEVAL15,
      :VALENEVALENEVAL16,
      :VALENEVALENEVAL17,
      :VALENEVALENEVAL18,
      :VALENEVALENEVAL19,
      :VALENEVALENEVAL20,
      :VALENEVALENEVAL21,
      :VALENEVALENEVAL22,
      :VALENEVALENEVAL23,
      :VALENEVALENEVAL24,
      :VALENEVALENEVAL25,
      :VALENEVALENEVAL26,
      :VALENEVALENEVAL28,
      :VALENEVALENEVAL27,
      :VALENEVALENEVAL29,
      :VALENEVALENEVAL30,
      :VALENEVALENEVAL31,
      :VALENEVALENEVAL32,
      :VALENEVALENEVAL33,
      :VALENEVALENEVAL34,
      :VALENEVALENEVAL35,
      :VALENEVALENEVAL36,
      :VALENEVALENEVAL37,
      :VALENEVALENEVAL38,
      :VALENEVALENEVAL39,
      :VALENEVALENEVAL40,
      :VALENEVALENEVAL41,
      :VALENEVALENEVAL42,
      :VALENEVALENEVAL43,
      :VALENEVALENEVAL44,
      :VALENEVALENEVAL45,
      :VALENEVALENEVAL46,
      :VALENEVALENEVAL47,
      :VALENEVALENEVAL48,
      :VALENEVALENEVAL49,
      :VALENEVALENEVAL50,
      :VALENEVALENEVAL51,
      :VALENEVALENEVAL52,
      :VALENEVALENEVAL53,
      :VALENEVALENEVAL54,
      :VALENEVALENEVAL55,
      :VALENEVALENEVAL56,
      :VALENEVALENEVAL57,
      :VALENEVALENEVAL58,
      :VALENEVALENEVAL59,
      :VALENEVALENEVAL60,
      :VALENEVALENEVAL61,
      :VALENEVALENEVAL62,
      :VALENEVALENEVAL63,
      :VALENEVALENEVAL64,
      :VALENEVALENEVAL65,
      :VALENEVALENEVAL66,
      :VALENEVALENEVAL67,
      :VALENEVALENEVAL68,
      :VALENEVALENEVAL69,
      :VALENEVALENEVAL70,
      :VALENEVALENEVAL71,
      :VALENEVALENEVAL72,
      :VALENEVALENEVAL73,
      :VALENEVALENEVAL74,
      :VALENEVALENEVAL75,
      :VALENEVALENEVAL76,
      :VALENEVALENEVAL77,
      :VALENEVALENEVAL78,
      :VALENEVALENEVAL79,
      :VALENEVALENEVAL80,
      :VALENEVALENEVAL81,
      :VALENEVALENEVAL82,
      :VALENEVALENEVAL83,
      :VALENEVALENEVAL84,
      :VALENEVALENEVAL85,
      :VALENEVALENEVAL86,
      :VALENEVALENEVAL87,
      :VALENEVALENEVAL88,
      :VALENEVALENEVAL89,
      :VALENEVALENEVAL90,
      :VALENEVALENEVAL91,
      :VALENEVALENEVAL92,
      :VALENEVALENEVAL93,
      :VALENEVALENEVAL94,
      :VALENEVALENEVAL95,
      :VALENEVALENEVAL96,
      :VALENEVALENEVALCM1,
      :VALENEVALENEVALCM2,
      :VALENEVALENEVALCM3,
      :VALENEVALENEVALCM4,
      :VALENEVALENEVALCM5,
      :VALENEVALENEVALCM6,
      :VALENEVALENEVALCM7,
      :VALENEVALENEVALCM8,
      :VALENEVALENEVALCM9,
      :VALENEVALENEVALCM10,
      :VALENEVALENEVALCM11,
      :VALENEVALENEVALCM12,
      :VALENEVALENEVALCM13,
      :VALENEVALENEVALCM14,
      :VALENEVALENEVALCM15,
      :VALENEVALENEVALCM16,
      :VALENEVALENEVALCM17,
      :VALENEVALENEVALCM18,
      :VALENEVALENEVALCM19,
      :VALENEVALENEVALCM20,
      :VALENEVALENEVALCM21,
      :VALENEVALENEVALCM22,
      :VALENEVALENEVALCM23,
      :VALENEVALENEVALCM24,
      :VALENEVALENEVALCM25,
      :VALENEVALENEVALCM26,
      :VALENEVALENEVALCM27,
      :VALENEVALENEVALCM28,
      :VALENEVALENEVALCM29,
      :VALENEVALENEVALCM30,
      :VALENEVALENEVALCM31,
      :VALENEVALENEVALCM32,
      :VALENEVALENEVALCM33,
      :VALENEVALENEVALCM34,
      :VALENEVALENEVALCM35,
      :VALENEVALENEVALCM36,
      :VALENEVALENEVALCM37,
      :VALENEVALENEVALCM38,
      :VALENEVALENEVALCM39,
      :VALENEVALENEVALCM40,
      :VALENEVALENEVALCM41,
      :VALENEVALENEVALCM42,
      :VALENEVALENEVALCM43,
      :VALENEVALENEVALCM44,
      :VALENEVALENEVALCM45,
      :VALENEVALENEVALCM46,
      :VALENEVALENEVALCM47,
      :VALENEVALENEVALCM48,
      :VALENEVALENEVALCM49,
      :VALENEVALENEVALCM50,
      :VALENEVALENEVALCM51,
      :VALENEVALENEVALCM52,
      :VALENEVALENEVALCM53,
      :VALENEVALENEVALCM54,
      :VALENEVALENEVALCM55,
      :VALENEVALENEVALCM56,
      :VALENEVALENEVALCM57,
      :VALENEVALENEVALCM58,
      :VALENEVALENEVALCM59,
      :VALENEVALENEVALCM60,
      :VALENEVALENEVALCM61,
      :VALENEVALENEVALCM62,
      :VALENEVALENEVALCM63,
      :VALENEVALENEVALCM64,
      :VALENEVALENEVALCM65,
      :VALENEVALENEVALCM66,
      :VALENEVALENEVALCM67,
      :VALENEVALENEVALCM68,
      :VALENEVALENEVALCM69,
      :VALENEVALENEVALCM70,
      :VALENEVALENEVALCM71,
      :VALENEVALENEVALCM72,
      :VALENEVALENEVALCM73,
      :VALENEVALENEVALCM74,
      :VALENEVALENEVALCM75,
      :VALENEVALENEVALCM76,
      :VALENEVALENEVALCM77,
      :VALENEVALENEVALCM78,
      :VALENEVALENEVALCM79,
      :VALENEVALENEVALCM80,
      :VALENEVALENEVALCM81,
      :VALENEVALENEVALCM82,
      :VALENEVALENEVALCM83,
      :VALENEVALENEVALCM84,
      :VALENEVALENEVALCM85,
      :VALENEVALENEVALCM86,
      :VALENEVALENEVALCM87,
      :VALENEVALENEVALCM88,
      :VALENEVALENEVALCM89,
      :VALENEVALENEVALCM90,
      :VALENEVALENEVALCM91,
      :VALENEVALENEVALCM92,
      :VALENEVALENEVALCM93,
      :VALENEVALENEVALCM94,
      :VALENEVALENEVALCM95,
      :VALENEVALENEVALCM96,
      :VALUSUCREACION,
      sysdate
      )
    </query>
  </Sql>
  <Sql>
    <key>Update</key>
    <query>
     </query>
  </Sql>
  <Sql>
    <key>Delete</key>
    <query>
    </query>
  </Sql>
  <Sql>
    <key>GetById</key>
    <query>
      select * from GMM_VALENERGIAENTREGA where VALENECODI = :VALENECODI
    </query>
  </Sql>
  <Sql>
    <key>ListarValores96Originales</key>
    <query>
      select
      me.LECTCODI,
      me.MEDIFECHA,
      EXTRACT(year from me.MEDIFECHA) AS VALANIO,
      EXTRACT(month from me.MEDIFECHA) AS VALMES,
      H1 as VALENEVALENEVAL1,
      H2 as VALENEVALENEVAL2,
      H3 as VALENEVALENEVAL3,
      H4 as VALENEVALENEVAL4,
      H5 as VALENEVALENEVAL5,
      H6 as VALENEVALENEVAL6,
      H7 as VALENEVALENEVAL7,
      H8 as VALENEVALENEVAL8,
      H9 as VALENEVALENEVAL9,
      H10 as VALENEVALENEVAL10,
      H11 as VALENEVALENEVAL11,
      H12 as VALENEVALENEVAL12,
      H13 as VALENEVALENEVAL13,
      H14 as VALENEVALENEVAL14,
      H15 as VALENEVALENEVAL15,
      H16 as VALENEVALENEVAL16,
      H17 as VALENEVALENEVAL17,
      H18 as VALENEVALENEVAL18,
      H19 as VALENEVALENEVAL19,
      H20 as VALENEVALENEVAL20,
      H21 as VALENEVALENEVAL21,
      H22 as VALENEVALENEVAL22,
      H23 as VALENEVALENEVAL23,
      H24 as VALENEVALENEVAL24,
      H25 as VALENEVALENEVAL25,
      H26 as VALENEVALENEVAL26,
      H27 as VALENEVALENEVAL27,
      H28 as VALENEVALENEVAL28,
      H29 as VALENEVALENEVAL29,
      H30 as VALENEVALENEVAL30,
      H31 as VALENEVALENEVAL31,
      H32 as VALENEVALENEVAL32,
      H33 as VALENEVALENEVAL33,
      H34 as VALENEVALENEVAL34,
      H35 as VALENEVALENEVAL35,
      H36 as VALENEVALENEVAL36,
      H37 as VALENEVALENEVAL37,
      H38 as VALENEVALENEVAL38,
      H39 as VALENEVALENEVAL39,
      H40 as VALENEVALENEVAL40,
      H41 as VALENEVALENEVAL41,
      H42 as VALENEVALENEVAL42,
      H43 as VALENEVALENEVAL43,
      H44 as VALENEVALENEVAL44,
      H45 as VALENEVALENEVAL45,
      H46 as VALENEVALENEVAL46,
      H47 as VALENEVALENEVAL47,
      H48 as VALENEVALENEVAL48,
      H49 as VALENEVALENEVAL49,
      H50 as VALENEVALENEVAL50,
      H51 as VALENEVALENEVAL51,
      H52 as VALENEVALENEVAL52,
      H53 as VALENEVALENEVAL53,
      H54 as VALENEVALENEVAL54,
      H55 as VALENEVALENEVAL55,
      H56 as VALENEVALENEVAL56,
      H57 as VALENEVALENEVAL57,
      H58 as VALENEVALENEVAL58,
      H59 as VALENEVALENEVAL59,
      H60 as VALENEVALENEVAL60,
      H61 as VALENEVALENEVAL61,
      H62 as VALENEVALENEVAL62,
      H63 as VALENEVALENEVAL63,
      H64 as VALENEVALENEVAL64,
      H65 as VALENEVALENEVAL65,
      H66 as VALENEVALENEVAL66,
      H67 as VALENEVALENEVAL67,
      H68 as VALENEVALENEVAL68,
      H69 as VALENEVALENEVAL69,
      H70 as VALENEVALENEVAL70,
      H71 as VALENEVALENEVAL71,
      H72 as VALENEVALENEVAL72,
      H73 as VALENEVALENEVAL73,
      H74 as VALENEVALENEVAL74,
      H75 as VALENEVALENEVAL75,
      H76 as VALENEVALENEVAL76,
      H77 as VALENEVALENEVAL77,
      H78 as VALENEVALENEVAL78,
      H79 as VALENEVALENEVAL79,
      H80 as VALENEVALENEVAL80,
      H81 as VALENEVALENEVAL81,
      H82 as VALENEVALENEVAL82,
      H83 as VALENEVALENEVAL83,
      H84 as VALENEVALENEVAL84,
      H85 as VALENEVALENEVAL85,
      H86 as VALENEVALENEVAL86,
      H87 as VALENEVALENEVAL87,
      H88 as VALENEVALENEVAL88,
      H89 as VALENEVALENEVAL89,
      H90 as VALENEVALENEVAL90,
      H91 as VALENEVALENEVAL91,
      H92 as VALENEVALENEVAL92,
      H93 as VALENEVALENEVAL93,
      H94 as VALENEVALENEVAL94,
      H95 as VALENEVALENEVAL95,
      H96 as VALENEVALENEVAL96
      from me_medicion96 me
      inner join me_hojaptomed hp on hp.ptomedicodi = me.ptomedicodi and hp.tipoinfocodi = me.tipoinfocodi and hp.TPTOMEDICODI = me.TPTOMEDICODI
      inner join me_formato fh on fh.formatcodi = hp.formatcodi and fh.lectcodi = me.lectcodi
      inner join me_ptomedicion pto on pto.ptomedicodi = hp.ptomedicodi
      where hp.formatcodi = {0} and pto.EMPRCODI = {1} and pto.ptomedicodi = {2}
      and extract(year from me.MEDIFECHA) || EXTRACT(month from me.MEDIFECHA) in ({3}, {4},{5})
      order by MEDIFECHA asc
    </query>
  </Sql>
  <Sql>
    <key>ListarValoresCostoMarginal</key>
    <query>
      SELECT BA.PTOMEDICODI,TRIM(BA.PTOMEDIDESC) PTOMEDIDESC, BH.PMBLOQNOMBRE,SE.SEMANANUM||'/'||SE.SEMANAANHIO AS SEMANA,
      GE.MEDINTH1,
      BA.MEDINTFECHAINI, GE.MEDINTBLQNUMERO
      FROM (SELECT * FROM (SELECT DISTINCT MI.MEDINTFECHAINI
      FROM ME_MEDICIONXINTERVALO MI
      WHERE MI.LECTCODI= 109 AND MI.TPTOMEDICODI = 80 AND MI.enviocodi = {0}) D1
      ,(SELECT DISTINCT PTO.PTOMEDICODI,PTO.PTOMEDIDESC
      FROM ME_MEDICIONXINTERVALO MI JOIN ME_PTOMEDICION PTO ON MI.PTOMEDICODI = PTO.PTOMEDICODI
      WHERE MI.LECTCODI= 109 AND MI.TPTOMEDICODI = 80 AND MI.enviocodi = {1}) D2
      ,(SELECT DISTINCT MI.MEDINTBLQNUMERO
      FROM ME_MEDICIONXINTERVALO MI
      WHERE MI.LECTCODI= 109 AND MI.TPTOMEDICODI = 80 AND MI.enviocodi = {2}) D3
      ) BA LEFT JOIN (SELECT MI.MEDINTFECHAINI,PTO.PTOMEDICODI,MI.MEDINTBLQNUMERO, MAX(MI.MEDINTH1) AS MEDINTH1
      FROM ME_MEDICIONXINTERVALO MI JOIN ME_PTOMEDICION PTO ON MI.PTOMEDICODI = PTO.PTOMEDICODI
      WHERE MI.LECTCODI= 109 AND MI.TPTOMEDICODI = 80
      AND MI.enviocodi = {3} GROUP BY MI.MEDINTFECHAINI,PTO.PTOMEDICODI,MI.MEDINTBLQNUMERO
      ) GE
      ON BA.MEDINTFECHAINI = GE.MEDINTFECHAINI AND BA.PTOMEDICODI = GE.PTOMEDICODI AND BA.MEDINTBLQNUMERO = GE.MEDINTBLQNUMERO
      LEFT JOIN SI_SEMANA SE ON BA.MEDINTFECHAINI = SE.SEMANAFECHA
      LEFT JOIN PMO_BLOQUE_HOR BH ON GE.MEDINTBLQNUMERO = BH.PMBLOQCODI
      WHERE TRIM(BA.PTOMEDIDESC) = '{4}'
      AND SE.semanacodi = {5}
      ORDER BY BA.MEDINTBLQNUMERO
    </query>
</Sql>
<Sql>
    <key>GetSemana</key>
    <query>
      select semanacodi, enviocodi from
      (select distinct semanacodi, MI.enviocodi
      from si_semana se join ME_MEDICIONXINTERVALO mi
      on se.semanafecha = mi.medintfechaini
      where MI.LECTCODI= 109 AND MI.TPTOMEDICODI = 80
      and (se.semanafecha - to_date('{0}', 'yyyy-mm-dd')) BETWEEN -6 and 0
      order by MI.enviocodi desc)
      where rownum = 1
    </query>
</Sql>
<Sql>
    <key>GetEnvio</key>
    <query>
      SELECT MI.ENVIOCODI, TRIM(TO_CHAR(en.enviofechaperiodo,'Month','nls_date_language=spanish' )) ||TO_CHAR(en.enviofechaperiodo,' YYYY')  ||'  '||TO_CHAR(en.enviofechaini,'DD-MM-YYYY')||' ['||COUNT(*)||']' AS DESCRIPCION
      FROM ME_MEDICIONXINTERVALO MI
      JOIN ME_ENVIO EN ON MI.ENVIOCODI=EN.ENVIOCODI
      WHERE MI.LECTCODI= 109 AND MI.ENVIOCODI &lt;&gt; 0
      AND extract(year from en.enviofechaperiodo) = {0} and EXTRACT(month from en.enviofechaperiodo) = {1}
      GROUP BY MI.ENVIOCODI,en.enviofechaperiodo,en.enviofechaini
      ORDER BY en.enviofechaperiodo DESC
    </query>
</Sql>
</Sqls>