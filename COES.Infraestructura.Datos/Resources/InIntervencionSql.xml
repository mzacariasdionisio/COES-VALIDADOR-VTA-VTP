<?xml version="1.0" encoding="utf-8" ?>
<Sqls>
  
  <!--+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->
  <!--QUERY PARA OBTENER EL MAXIMO ID DE LA INTERVENCIÓN-->
  <!--+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->
  <Sql>
    <key>GetMaxId</key>
    <query>
       select nvl(max(intercodi), 0) + 1 from in_intervencion
    </query>
  </Sql>
  <!--+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->
  
  <!--+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->
  <!--QUERY PARA INSERTAR UNA INTERVENCIÓN-->
  <!--+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->
  <Sql>
    <key>Save</key>
    <query>
      insert into in_intervencion(
      intercodi,
      tipoevencodi,
      progrcodi,
      emprcodi,
      equicodi,
      areacodi,
      intermensaje,
      intermensajecoes,
      intermensajeagente,
      interfechapreini,
      interfechaini,
      interfechaprefin,
      interfechafin,
      claprocodi,
      intercodsegempr,
      interrepetir,
      intermwindispo,
      interindispo,
      interinterrup,
      intermantrelev,
      interconexionprov,
      intersistemaaislado,
      interdescrip,
      interjustifaprobrechaz,
      interfecaprobrechaz,
      interprocesado,
      interisfiles,
      intermanttocodi,
      interevenpadre,
      subcausacodi,
      evenclasecodi,
      intercodipadre,
      interregprevactivo,
      estadocodi,
      intercreated,
      interdeleted,
      Interfuentestado,
      Intertipoindisp,
      Interpr,
      interasocproc,
      intercarpetafiles,
      interipagente,
      interusucreacion,
      interfeccreacion,
      interusumodificacion,
      interfecmodificacion,
      operadoremprcodi,
      interusuagrup,
      interfecagrup,
      interleido,
      internota,
      interflagsustento
      )
      values(
      :intercodi,
      :tipoevencodi,
      :progrcodi,
      :emprcodi,
      :equicodi,
      :areacodi,
      :intermensaje,
      :intermensajecoes,
      :intermensajeagente,
      :interfechapreini,
      :interfechaini,
      :interfechaprefin,
      :interfechafin,
      :claprocodi,
      :intercodsegempr,
      :interrepetir,
      :intermwindispo,
      :interindispo,
      :interinterrup,
      :intermantrelev,
      :interconexionprov,
      :intersistemaaislado,
      :interdescrip,
      :interjustifaprobrechaz,
      :interfecaprobrechaz,
      :interprocesado,
      :interisfiles,
      :intermanttocodi,
      :interevenpadre,
      :subcausacodi,
      :evenclasecodi,
      :intercodipadre,
      :interregprevactivo,
      :estadocodi,
      :intercreated,
      :interdeleted,
      :interfuentestado,
      :intertipoindisp,
      :interpr,
      :interasocproc,
      :intercarpetafiles,
      :interipagente,
      :interusucreacion,
      :interfeccreacion,
      :interusumodificacion,
      :interfecmodificacion,
      :operadoremprcodi,
      :interusuagrup,
      :interfecagrup,
      :interleido,
      :internota,
      :interflagsustento
      )
    </query>
  </Sql>
  <!--+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->
  
  <!--+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->
  <!--QUERY PARA OBTENER UNA INTERVENCIÓN POR ID-->
  <!--+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->
  <Sql>
    <key>GetById</key>
    <query>
      select
      i.*,
      tev.tipoevendesc,
      tev.TIPOEVENABREV,
      emp.emprnomb,
      ar.areanomb,
      fam.famnomb,
      fam.famabrev,
      equ.equiabrev,
      ar.areacodi,
      fam.famcodi,
      pr.grupotipocogen,
      emp2.EMPRNOMB as OPERADORNOMB,
      ip.progrsololectura,
      eve.evenclasedesc
      from
      in_intervencion i
      inner join in_programacion ip on (i.progrcodi =ip.progrcodi)
      inner join si_empresa emp on emp.emprcodi = i.emprcodi
      inner join eq_equipo equ on equ.equicodi = i.equicodi
      inner join eq_area ar on (equ.areacodi=ar.areacodi)
      inner join eq_familia fam on (equ.famcodi=fam.famcodi)
      inner join eve_tipoevento tev on (i.tipoevencodi=tev.tipoevencodi)
      left join pr_grupo pr on pr.grupocodi = equ.grupocodi
      left join si_empresa emp2 on (emp2.emprcodi=i.operadoremprcodi)
      left join eve_evenclase eve on (i.evenclasecodi=eve.evenclasecodi)
      where
      i.intercodi = :intercodi
    </query>
  </Sql>
  <!--+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->
  
  <!--+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->
  <!--QUERY PARA DESABILITAR INTERVENCIÓN CON TRAZABILIDAD POR ID-->
  <!--+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->
  <Sql>
    <key>DesabilitarIntervencionConTrazabilidad</key>
    <query>
      update in_intervencion
      set
        interregprevactivo = :interregprevactivo,
        intercreated = :intercreated,
        interdeleted = :interdeleted
      where
        intercodi in ({0})
    </query>
  </Sql>
  
  <Sql>
    <key>DeshabilitarIntervencionesRecepcion</key>
    <query>
      update in_intervencion
      set
      interregprevactivo = 'N',
      intercreated = 1,
      interdeleted = 0
      where
      progrcodi = :progrcodi
      and interregprevactivo = 'S' and interdeleted = 0
    </query>
  </Sql>

  <Sql>
    <key>DeshabilitarIntervencionesEnReversion</key>
    <query>
      update in_intervencion
      set
      interregprevactivo = 'N'
      where
      progrcodi = :progrcodi
      and interregprevactivo = 'S'
      and interprocesado = 2 -- en reversión
      and estadocodi = 2 -- aprobado
    </query>
  </Sql>
  <!--+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->
  
  <!--+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->
  <Sql>
    <key>UpdateIsFiles</key>
    <query>
      update in_intervencion
      set
      INTERISFILES = 'S'
      where
      intercodi in ({0})
    </query>
  </Sql>
  
  <Sql>
    <key>UpdateTieneMensaje</key>
    <query>
      update in_intervencion
      set
      INTERMENSAJE = 'S'
      where
      intercodi in ({0})
    </query>
  </Sql>

  <Sql>
    <key>UpdateEstadoMensajeCOES</key>
    <query>
      update in_intervencion
      set
      INTERMENSAJECOES = {1}
      where
      intercodi in ({0})
    </query>
  </Sql>

  <Sql>
    <key>UpdateEstadoMensajeAgente</key>
    <query>
      update in_intervencion
      set
      INTERMENSAJEAGENTE = {1}
      where
      intercodi in ({0})
    </query>
  </Sql>

  <Sql>
    <key>UpdateIntervencionLeidoAgente</key>
    <query>
      update in_intervencion
      set
      Interleido = 1
      where
      intercodi in ({0})
    </query>
  </Sql>
  
  <!--+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->
  <!--QUERY PARA OBTENER REGISTRO DE INTERVENCIÓN POR ID-->
  <!--+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->

  <Sql>
    <key>GetByCodigoPadre</key>
    <query>
      select
      i.*
      from
      in_intervencion i
      where
      i.INTERCODIPADRE in ({0}) and i.INTERCODIPADRE > 0
    </query>
  </Sql>

  <Sql>
    <key>ListarIntervencionesSinArchivo</key>
    <query>
      select * from
      (
          select
          i.*,
          (select count(*) from IN_INTERVENCION_REL_ARCHIVO r where r.intercodi = i.intercodi ) as total_file
          from
          in_intervencion i
          where
          i.progrcodi in ({0})
          and (i.interregprevactivo = 'S') --visualizar ultima modificacion del historial
          and coalesce(INTERFLAGSUSTENTO, 0) &lt;= 0 --solo los que no tienen sustento
          and i.INTERISFILES = 'S'
      )
      where total_file = 0
    </query>
  </Sql>

  <!--+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->
  
  <!--+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->
  <!--QUERYS DE CONSULTAS PARA MODULO DE REGISTRO DE INTERVENCIONES -->
  <!--+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->

  <Sql>
    <key>ConsultarIntervenciones</key>
    <query>
      select
      (select estadocodi from in_intervencion where intercodi = i.Intercodipadre) estadopadre,
      i.*,
      emp.emprnomb,
      emp.emprabrev,
      ar.areanomb,
      ta.tareaabrev || ' ' || ar.areanomb as areadesc,
      equ.equiabrev,
      tev.tipoevendesc,
      tev.TIPOEVENABREV,
      fam.famnomb,
      fam.famabrev,
      fam.famcodi,
      scev.subcausadesc,
      emp2.EMPRNOMB as OPERADORNOMB,
      equ.equipadre,
      equ.EQUIMANIOBRA
      from in_intervencion i
      inner join eve_tipoevento tev on (i.tipoevencodi=tev.tipoevencodi)
      inner join si_empresa emp on (i.emprcodi=emp.emprcodi)
      inner join eq_equipo equ on (i.equicodi=equ.equicodi)
      inner join eq_area ar on (equ.areacodi=ar.areacodi)
      left join eq_tipoarea ta on (ar.tareacodi = ta.tareacodi)
      inner join eq_familia fam on (equ.famcodi=fam.famcodi)
      inner join si_empresa emp2 on (emp2.emprcodi=i.operadoremprcodi)
      left join eve_subcausaevento scev on (i.subcausacodi=scev.subcausacodi)
      where
      (i.progrcodi = {0} or '{0}' = '0') and
      (i.evenclasecodi in ({1})) and
      (i.emprcodi in ({2}) or '{2}' = '0') and
      (i.tipoevencodi in ({3}) or '{3}' = '0') and
      (ar.areacodi in ({4}) or '{4}' = '0') and
      (fam.famcodi in ({5}) or '{5}' = '0') and
      (i.equicodi in ({12}) or '{12}' = '0') and
      (i.interindispo = '{6}' or '{6}' = '0') and
      (i.interregprevactivo = 'S') and --visualizar ultima modificacion del historial
      (i.estadocodi in ({7}) or '{7}' = '0') and -- estado programacion (1: en proceso,2: aprobado,3: rechazado)
      (i.interdeleted = {8} or '{8}' = '-1') and --flag eliminado (0: no eliminado. 1: eliminado)
      (i.interprocesado = {9} or '{9}' = '-1') and --flag aprobado (0: no aprobado, 1: aprobado)
      (
      ( i.interfechaini >=  to_date('{10} 00:00:00','yyyy-mm-dd hh24:mi:ss')  and i.interfechaini &lt;  to_date('{11} 00:00:00','yyyy-mm-dd hh24:mi:ss') ) or
      ( i.interfechafin >  to_date('{10} 00:00:00','yyyy-mm-dd hh24:mi:ss')  and i.interfechafin &lt;=  to_date('{11} 00:00:00','yyyy-mm-dd hh24:mi:ss') ) or
      ( i.interfechaini &lt;  to_date('{10} 00:00:00','yyyy-mm-dd hh24:mi:ss')  and i.interfechafin >  to_date('{11} 00:00:00','yyyy-mm-dd hh24:mi:ss') )
      )
    </query>
  </Sql>

  <Sql>
    <key>ConsultarIntervencionesXIds</key>
    <query>
      select
      i.*,
      emp.emprnomb,
      emp.emprabrev,
      ar.areanomb,
      equ.equiabrev,
      tev.tipoevendesc,
      tev.TIPOEVENABREV,
      fam.famnomb,
      fam.famabrev,
      fam.famcodi,
      scev.subcausadesc,
      emp2.EMPRNOMB as OPERADORNOMB,
      equ.EQUIMANIOBRA,
      eve.evenclasedesc
      from in_intervencion i
      inner join eve_tipoevento tev on (i.tipoevencodi=tev.tipoevencodi)
      inner join si_empresa emp on (i.emprcodi=emp.emprcodi)
      inner join eq_equipo equ on (i.equicodi=equ.equicodi)
      inner join eq_area ar on (equ.areacodi=ar.areacodi)
      inner join eq_familia fam on (equ.famcodi=fam.famcodi)
      inner join si_empresa emp2 on (emp2.emprcodi=i.operadoremprcodi)
      left join eve_subcausaevento scev on (i.subcausacodi=scev.subcausacodi)
      left join eve_evenclase eve on (i.evenclasecodi=eve.evenclasecodi)
      where
      i.intercodi in ({0})
    </query>
  </Sql>
  
  <!--+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->
  <!--QUERY PARA ACTUALIZAR EL CÓDIGO DE SEGUIMIENTO-->
  <!--+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->
  <Sql>
    <key>ExisteCodigoSeguimiento</key>
    <query>
      select
      count(intercodi) as nroregistros, equicodi
      from
      in_intervencion
      where
      intercodsegempr = :intercodsegempr and
      interregprevactivo = 'S' and
      interdeleted = 0
      group by equicodi
    </query>
  </Sql>

  <Sql>
    <key>ListarIntervencionCandidatoPorCriterio</key>
    <query>
      select
      i.intercodi,
      i.Intercodsegempr,
      i.Interdescrip
      from
      in_intervencion i
      where
      (i.progrcodi = {0}) and
      (i.tipoevencodi in ({1})) and
      (i.equicodi in ({2}) ) and
      (
      ( i.interfechaini >=  to_date('{3}','yyyy-mm-dd hh24:mi:ss')  and i.interfechaini &lt;  to_date('{4}','yyyy-mm-dd hh24:mi:ss') ) or
      ( i.interfechafin >  to_date('{3}','yyyy-mm-dd hh24:mi:ss')  and i.interfechafin &lt;=  to_date('{4}','yyyy-mm-dd hh24:mi:ss') ) or
      ( i.interfechaini &lt;  to_date('{3}','yyyy-mm-dd hh24:mi:ss')  and i.interfechafin >  to_date('{4}','yyyy-mm-dd hh24:mi:ss') )
      ) and
      i.interregprevactivo = 'S' and
      i.INTERDELETED not in (1)
      --Verificar que lógica sea igual a ValidarRegistrosDuplicados
    </query>
  </Sql>

  <!--QUERY PARA CONSULTAR LA TRAZABILIDAD DE LA INTERVENCION-->
  <Sql>
    <key>ConsultarTrazabilidad</key>
    <query>
      (--registro a consulta
      select
        i.*,
        emp.emprnomb,
        ar.areanomb,
        equ.equiabrev,
        tev.tipoevendesc,
        tev.TIPOEVENABREV,
        fam.famnomb,
        fam.famabrev,
        fam.famcodi,
        eve.evenclasedesc
      from
        in_intervencion i
        inner join eve_tipoevento tev on (i.tipoevencodi=tev.tipoevencodi)
        inner join si_empresa emp on (i.emprcodi=emp.emprcodi)
        inner join eq_equipo equ on (i.equicodi=equ.equicodi)
        inner join eq_area ar on (equ.areacodi=ar.areacodi)
        inner join eq_familia fam on (equ.famcodi=fam.famcodi)
        inner join in_programacion prog on (prog.progrcodi=i.progrcodi)
        left join eve_evenclase eve on (i.evenclasecodi=eve.evenclasecodi)
      where
        --(i.interregprevactivo = 'S') and
        --(i.interdeleted = 0) and
        (i.interCodi = :interCodi)
        )
      UNION ALL
      (--horizonte superior aprobados
      select
        i.*,
        emp.emprnomb,
        ar.areanomb,
        equ.equiabrev,
        tev.tipoevendesc,
        tev.TIPOEVENABREV,
        fam.famnomb,
        fam.famabrev,
        fam.famcodi,
        eve.evenclasedesc
      from
        in_intervencion i
        inner join eve_tipoevento tev on (i.tipoevencodi=tev.tipoevencodi)
        inner join si_empresa emp on (i.emprcodi=emp.emprcodi)
        inner join eq_equipo equ on (i.equicodi=equ.equicodi)
        inner join eq_area ar on (equ.areacodi=ar.areacodi)
        inner join eq_familia fam on (equ.famcodi=fam.famcodi)
        inner join in_programacion prog on (prog.progrcodi=i.progrcodi)
        left join eve_evenclase eve on (i.evenclasecodi=eve.evenclasecodi)
      where
        (i.interregprevactivo = 'S') and
        (i.interdeleted = 0) and
        (prog.evenclasecodi > (:evenclasecodi)) and
        (i.intercodsegempr = :interCodSegEmpr))
    </query>
  </Sql>
  
  <!--+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->
  <!--QUERYS PARA REPORTES DE INTERVENCIONES-->
  <!--+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->
  <!--+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->
  <!--QUERYS PARA EL REPORTE DE ANEXOS PROGRAMACIÓN ANUAL-->
  <!--+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->
  <Sql>
    <key>RptIntervencionesMayores</key>
    <query>
      select
      i.intercodsegempr,
      emp.emprnomb,
      ar.areaabrev,
      ar.areanomb,
      equ.equiabrev,
      tev.tipoevendesc,
      tev.TIPOEVENABREV,
      fam.famnomb,
      fam.famabrev,
      i.interfechaini,
      i.interfechafin,
      i.intermwindispo,
      case i.interindispo
      when 'E' then 'E/S'
      when 'F' then 'F/S'
      end interindispo,
      case i.interinterrup
      when 'N' then 'NO'
      when 'S' then 'SI'
      end interinterrup,
      i.intermantrelev,
      i.interdescrip,
      i.interjustifaprobrechaz,
      i.intermensaje,
      i.intermensajecoes,
      i.intermensajeagente,
      i.claprocodi,
      i.progrcodi,
      i.interprocesado,
      i.interisfiles,
      i.interregprevactivo,
      i.estadocodi,
      i.intercreated,
      i.interdeleted,
      i.intercodi,
      i.tipoevencodi,
      i.emprcodi,
      ar.areacodi,
      fam.famcodi,
      i.equicodi,
      i.interusucreacion,
      i.interfeccreacion,
      case i.claprocodi
      when 1 then 'PROGRAMADO'
      when 2 then 'REPROGRAMADO'
      when 3 then 'FORZADO IMPREVISTO'
      end ClaseProgramacion,
      i.intercodipadre
      from
      in_intervencion i
      inner join eve_tipoevento tev on (i.tipoevencodi=tev.tipoevencodi)
      inner join si_empresa emp on (i.emprcodi=emp.emprcodi)
      inner join eq_equipo equ on (i.equicodi=equ.equicodi)
      inner join eq_area ar on (i.areacodi=ar.areacodi)
      inner join eq_familia fam on (equ.famcodi=fam.famcodi)
      where
      (i.evenclasecodi = 5) and
      (i.interregprevactivo = 'S') and
      (i.interdeleted = 0) and
      (i.estadocodi not in (3)) and
      (i.progrcodi = {0}) and
      (i.emprcodi in ({1}) or '{1}' = '0') and
      (i.intersistemaaislado = ('{2}') or '{2}' = '0') and
      (i.interinterrup = ('{3}') or '{3}' = '0') and
      (i.interindispo = ('{4}') or '{4}' = '0')
      order by
      emp.emprnomb
    </query>
  </Sql>

  <Sql>
    <key>RptIntervencionesMayoresAnexo6CruzadoGeneracion</key>
    <query>
      select
        emp.emprnomb,
        ar.areaabrev,
        ar.areanomb,
        equ.equiabrev,
        i.interfechaini,
        i.interfechafin,
        i.interdescrip,
        i.interindispo,
        i.emprcodi,
        equ.areacodi,
        i.Equicodi
      from
        in_intervencion i
        inner join si_empresa emp on (i.emprcodi=emp.emprcodi)
        inner join eq_equipo equ on (i.equicodi=equ.equicodi)
        inner join eq_area ar on (i.areacodi=ar.areacodi)
        inner join eq_tipoarea ta on (ar.tareacodi = ta.tareacodi)
      where
        (i.evenclasecodi = 5) and
        (i.interregprevactivo = 'S') and
        (i.interdeleted = 0) and
        (i.estadocodi not in (3)) and
        (ta.tareacodi in (3, 4, 10, 11, 6)) and
        (i.progrcodi = {0}) and
        (i.emprcodi in ({1}) or '{1}' = '0') and
        (to_char(i.interfechaini, 'YYYY') = {2}) and
        (to_char(i.interfechaini, 'MM') = {3}) and
        (i.interindispo = '{4}')
      order by
        emp.emprnomb,
        ar.areaabrev,
        equ.equiabrev,
        i.interfechaini
    </query>
  </Sql>

  <Sql>
    <key>RptIntervencionesMayoresAnexo6CruzadoTransmision</key>
    <query>
      select
        emp.emprnomb,
        ar.areaabrev,
        ar.areanomb,
        equ.equiabrev,
        i.interfechaini,
        i.interfechafin,
        i.interdescrip,
        i.interindispo,
        i.emprcodi,
        equ.areacodi,
        i.Equicodi
      from
        in_intervencion i
        inner join si_empresa emp on (i.emprcodi=emp.emprcodi)
        inner join eq_equipo equ on (i.equicodi=equ.equicodi)
        inner join eq_area ar on (i.areacodi=ar.areacodi)
        inner join eq_tipoarea ta on (ar.tareacodi = ta.tareacodi)
      where
        (i.evenclasecodi = 5) and
        (i.interregprevactivo = 'S') and
        (i.interdeleted = 0) and
        (i.estadocodi not in (3)) and
        (ta.tareacodi not in (3, 4, 10, 11, 6)) and
        (i.progrcodi = {0}) and
        (i.emprcodi in ({1}) or '{1}' = '0') and
        (to_char(i.interfechaini, 'YYYY') = {2}) and
        (to_char(i.interfechaini, 'MM') = {3}) and
        (i.interindispo = '{4}')
      order by
        emp.emprnomb,
        ar.areaabrev,
        equ.equiabrev,
        i.interfechaini
    </query>
  </Sql>
  <!--+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->

  <!--+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->
  <!--QUERYS PARA EL REPORTE DE INTERVENCIONES MAYORES-->
  <!--+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->
  <Sql>
    <key>RptIntervencionesMayoresPorPeriodo</key>
    <query>
      select
        i.intercodsegempr,
        emp.emprnomb,
        ar.areaabrev,
        ar.areanomb,
        equ.equiabrev,
        tev.tipoevendesc,
        tev.TIPOEVENABREV,
        fam.famnomb,
        fam.famabrev,
        i.interfechaini,
        i.interfechafin,
        i.intermwindispo,
        case i.interindispo
          when 'E' then 'E/S'
          when 'F' then 'F/S'
        end interindispo,
        case i.interinterrup
          when 'N' then 'NO'
          when 'S' then 'SI'
        end interinterrup,
        i.intermantrelev,
        i.interdescrip,
        i.interjustifaprobrechaz,
        i.intermensaje,
        i.intermensajecoes,
        i.intermensajeagente,
        i.claprocodi,
        i.progrcodi,
        i.interprocesado,
        i.interisfiles,
        i.interregprevactivo,
        i.estadocodi,
        i.intercreated,
        i.interdeleted,
        i.intercodi,
        i.tipoevencodi,
        i.emprcodi,
        ar.areacodi,
        fam.famcodi,
        i.equicodi,
        i.interusucreacion,
        i.interfeccreacion,
        case i.claprocodi
          when 1 then 'PROGRAMADO'
          when 2 then 'REPROGRAMADO'
          when 3 then 'FORZADO IMPREVISTO'
        end ClaseProgramacion,
        i.intercodipadre
      from
        in_intervencion i
        inner join eve_tipoevento tev on (i.tipoevencodi=tev.tipoevencodi)
        inner join si_empresa emp on (i.emprcodi=emp.emprcodi)
        inner join eq_equipo equ on (i.equicodi=equ.equicodi)
        inner join eq_area ar on (i.areacodi=ar.areacodi)
        inner join eq_familia fam on (equ.famcodi=fam.famcodi)
      where
        (i.interregprevactivo = 'S') and
        (i.interdeleted = 0) and
        (i.estadocodi not in (3)) and
        (trunc(to_date(i.interfechafin,'dd/mm/yyyy hh24:mi:ss'))-trunc(to_date(i.interfechaini,'dd/mm/yyyy hh24:mi:ss')) >= 24) and
        <!--(i.progrcodi = ({0}) or '{0}' = '0') and-->
        (i.evenclasecodi in ({0}) or '{0}' = '0') and              
        (i.emprcodi in ({1}) or '{1}' = '0') and        
        (( i.interfechaini >= to_date('{2} 00:00:00','dd/mm/yyyy hh24:mi:ss') and i.interfechaini &lt; to_date('{3} 00:00:00','dd/mm/yyyy hh24:mi:ss') ) or
        ( i.interfechafin > to_date('{2} 00:00:00','dd/mm/yyyy hh24:mi:ss') and i.interfechafin &lt;= to_date('{3} 00:00:00','dd/mm/yyyy hh24:mi:ss') ) or
        ( i.interfechaini &lt; to_date('{2} 00:00:00','dd/mm/yyyy hh24:mi:ss') and i.interfechafin > to_date('{3} 00:00:00','dd/mm/yyyy hh24:mi:ss') ))
      order by
        emp.emprnomb
    </query>
  </Sql>

  

 
  <!--+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->

  <!--+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->
  <!--QUERYS PARA EL REPORTE DE INTERVENCIONES IMPORTANTES-->
  <!--+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->
  <Sql>
    <key>RptIntervencionesImportantes</key>
    <query>
      select
        emp.emprnomb,
        ar.areaabrev,
        ar.areanomb,
        equ.equiabrev,
        i.interfechaini,
        i.interfechafin,
        i.Interindispo,
        i.interdescrip, 
        i.tipoevencodi
      from
        in_intervencion i
        inner join eve_tipoevento tev on (i.tipoevencodi=tev.tipoevencodi)
        inner join si_empresa emp on (i.emprcodi=emp.emprcodi)
        inner join eq_equipo equ on (i.equicodi=equ.equicodi)
        inner join eq_area ar on (equ.areacodi=ar.areacodi)
        inner join eq_familia fam on (equ.famcodi=fam.famcodi)
      where
        (i.interregprevactivo = 'S') and
        (i.interdeleted = 0) and
        (i.estadocodi not in (3)) and
        (i.intermantrelev = 1) and
        (i.progrcodi = ({0}) or '{0}' = '0') and
        (i.evenclasecodi in ({1}) or '{1}' = '0') and
        (i.emprcodi in ({2}) or '{2}' = '0') and
        (( i.interfechaini >=  to_date('{3} 00:00:00','dd/mm/yyyy hh24:mi:ss')  and i.interfechaini &lt;  to_date('{4} 00:00:00','dd/mm/yyyy hh24:mi:ss') ) or
        ( i.interfechafin >  to_date('{3} 00:00:00','dd/mm/yyyy hh24:mi:ss')  and i.interfechafin &lt;=  to_date('{4} 00:00:00','dd/mm/yyyy hh24:mi:ss') ) or
        ( i.interfechaini &lt;  to_date('{3} 00:00:00','dd/mm/yyyy hh24:mi:ss')  and i.interfechafin >  to_date('{4} 00:00:00','dd/mm/yyyy hh24:mi:ss') ))
      order by
        emp.emprnomb
    </query>
  </Sql>

 

  <!--+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->

  <!--+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->
  <!--QUERYS PARA EL REPORTE DE EVENTOS-->
  <!--+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->
  <Sql>
    <key>RptEventos</key>
    <query>
      select
      emp.emprnomb,
      ar.areaabrev,
      ar.areanomb,
      equ.equiabrev,
      i.interfechaini,
      i.interfechafin,
      i.Interindispo,
      i.interdescrip
      from
      in_intervencion i
      inner join eve_tipoevento tev on (i.tipoevencodi=tev.tipoevencodi)
      inner join si_empresa emp on (i.emprcodi=emp.emprcodi)
      inner join eq_equipo equ on (i.equicodi=equ.equicodi)
      inner join eq_area ar on (equ.areacodi=ar.areacodi)
      inner join eq_familia fam on (equ.famcodi=fam.famcodi)
      where
      (i.interregprevactivo = 'S') and
      (i.interdeleted = 0) and
      (i.estadocodi not in (3)) and
      (i.TIPOEVENCODI not in (1,2)) and
      (i.progrcodi = ({0}) or '{0}' = '0') and
      (i.evenclasecodi in ({1}) or '{1}' = '0') and
      (i.emprcodi in ({2}) or '{2}' = '0') and
      (( i.interfechaini >=  to_date('{3} 00:00:00','dd/mm/yyyy hh24:mi:ss')  and i.interfechaini &lt;  to_date('{4} 00:00:00','dd/mm/yyyy hh24:mi:ss') ) or
      ( i.interfechafin >  to_date('{3} 00:00:00','dd/mm/yyyy hh24:mi:ss')  and i.interfechafin &lt;=  to_date('{4} 00:00:00','dd/mm/yyyy hh24:mi:ss') ) or
      ( i.interfechaini &lt;  to_date('{3} 00:00:00','dd/mm/yyyy hh24:mi:ss')  and i.interfechafin >  to_date('{4} 00:00:00','dd/mm/yyyy hh24:mi:ss') ))
      order by
      emp.emprnomb
    </query>
  </Sql>
  <!--+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->
  
  <!--+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->
  <!--QUERYS PARA EL REPORTE DE INTERVENCIONES CON CONEXIONES PROVISIONALES-->
  <!--+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->
  <Sql>
    <key>RptConexionesProvisionales</key>
    <query>
      select
        emp.emprnomb,
        ar.areaabrev,
        ar.areanomb,
        equ.equiabrev,
        i.interfechaini,
        i.interfechafin,
        i.interdescrip
      from
        in_intervencion i
        inner join eve_tipoevento tev on (i.tipoevencodi=tev.tipoevencodi)
        inner join si_empresa emp on (i.emprcodi=emp.emprcodi)
        inner join eq_equipo equ on (i.equicodi=equ.equicodi)
        inner join eq_area ar on (equ.areacodi=ar.areacodi)
        inner join eq_familia fam on (equ.famcodi=fam.famcodi)
      where
        (i.interregprevactivo = 'S') and
        (i.interdeleted = 0) and
        (i.estadocodi not in (3)) and
        (i.interconexionprov = 'S') and
        (i.progrcodi = ({0}) or '{0}' = '0') and
        (i.evenclasecodi in ({1}) or '{1}' = '0') and
        (i.emprcodi in ({2}) or '{2}' = '0') and
        (( i.interfechaini >=  to_date('{3} 00:00:00','dd/mm/yyyy hh24:mi:ss')  and i.interfechaini &lt;  to_date('{4} 00:00:00','dd/mm/yyyy hh24:mi:ss') ) or
        ( i.interfechafin >  to_date('{3} 00:00:00','dd/mm/yyyy hh24:mi:ss')  and i.interfechafin &lt;=  to_date('{4} 00:00:00','dd/mm/yyyy hh24:mi:ss') ) or
        ( i.interfechaini &lt;  to_date('{3} 00:00:00','dd/mm/yyyy hh24:mi:ss')  and i.interfechafin >  to_date('{4} 00:00:00','dd/mm/yyyy hh24:mi:ss') ))
      order by
        emp.emprnomb
    </query>
  </Sql>

  

  
  <!--+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->

  <!--+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->
  <!--QUERYS PARA EL REPORTE DE INTERVENCIONES CON SISTEMAS AISLADOS-->
  <!--+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->
  <Sql>
    <key>RptSistemasAislados</key>
    <query>
      select
        emp.emprnomb,
        ar.areaabrev,
        ar.areanomb,
        equ.equiabrev,
        i.interfechaini,
        i.interfechafin,
        i.interdescrip
      from
        in_intervencion i
        inner join eve_tipoevento tev on (i.tipoevencodi=tev.tipoevencodi)
        inner join si_empresa emp on (i.emprcodi=emp.emprcodi)
        inner join eq_equipo equ on (i.equicodi=equ.equicodi)
        inner join eq_area ar on (equ.areacodi=ar.areacodi)
        inner join eq_familia fam on (equ.famcodi=fam.famcodi)
      where
        (i.interregprevactivo = 'S') and
        (i.interdeleted = 0) and
        (i.estadocodi not in (3)) and
        (i.intersistemaaislado = 'S') and
        (i.progrcodi = ({0}) or '{0}' = '0') and
        (i.evenclasecodi in ({1}) or '{1}' = '0') and
        (i.emprcodi in ({2}) or '{2}' = '0') and
        (( i.interfechaini >=  to_date('{3} 00:00:00','dd/mm/yyyy hh24:mi:ss')  and i.interfechaini &lt;  to_date('{4} 00:00:00','dd/mm/yyyy hh24:mi:ss') ) or
        ( i.interfechafin >  to_date('{3} 00:00:00','dd/mm/yyyy hh24:mi:ss')  and i.interfechafin &lt;=  to_date('{4} 00:00:00','dd/mm/yyyy hh24:mi:ss') ) or
        ( i.interfechaini &lt;  to_date('{3} 00:00:00','dd/mm/yyyy hh24:mi:ss')  and i.interfechafin >  to_date('{4} 00:00:00','dd/mm/yyyy hh24:mi:ss') ))
      order by
        emp.emprnomb
    </query>
  </Sql>

 

  <!--+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->

  <!--+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->
  <!--QUERYS PARA EL REPORTE DE INTERVENCIONES CON RESTRICCIÓN DE SUMINISTROS-->
  <!--+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->
  <Sql>
    <key>RptInterrupcionRestriccionSuministros</key>
    <query>
      select
        emp.emprnomb,
        ar.areaabrev,
        ar.areanomb,
        equ.equiabrev,
        i.interfechaini,
        i.interfechafin,
        i.intermwindispo,
        i.interdescrip
      from
        in_intervencion i
        inner join eve_tipoevento tev on (i.tipoevencodi=tev.tipoevencodi)
        inner join si_empresa emp on (i.emprcodi=emp.emprcodi)
        inner join eq_equipo equ on (i.equicodi=equ.equicodi)
        inner join eq_area ar on (equ.areacodi=ar.areacodi)
        inner join eq_familia fam on (equ.famcodi=fam.famcodi)
      where
        (i.interregprevactivo = 'S') and
        (i.interdeleted = 0) and
        (i.estadocodi not in (3)) and
        (i.interinterrup = 'S') and
        (i.intermwindispo > 0) and
        (i.progrcodi = ({0}) or '{0}' = '0') and
        (i.evenclasecodi in ({1}) or '{1}' = '0') and
        (i.emprcodi in ({2}) or '{2}' = '0') and
        (( i.interfechaini >=  to_date('{3} 00:00:00','dd/mm/yyyy hh24:mi:ss')  and i.interfechaini &lt;  to_date('{4} 00:00:00','dd/mm/yyyy hh24:mi:ss') ) or
        ( i.interfechafin >  to_date('{3} 00:00:00','dd/mm/yyyy hh24:mi:ss')  and i.interfechafin &lt;=  to_date('{4} 00:00:00','dd/mm/yyyy hh24:mi:ss') ) or
        ( i.interfechaini &lt;  to_date('{3} 00:00:00','dd/mm/yyyy hh24:mi:ss')  and i.interfechafin >  to_date('{4} 00:00:00','dd/mm/yyyy hh24:mi:ss') ))
      order by
        emp.emprnomb
    </query>
  </Sql>

 

  <!--+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->

  <!--+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->
  <!--QUERYS PARA EL REPORTE DE OSINERGMIN-->
  <!--+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->
  <Sql>
    <key>RptOSINERGMINProc257dListado</key>
    <query>
      select
      i.intercodi,
      emp.emprnomb,
      ar.areaabrev,
      ar.areanomb,
      equ.equiabrev,
      i.equicodi,
      i.interfechaini,
      i.interfechafin,
      case i.evenclasecodi
      when 1 then 'E'
      when 2 then 'D'
      when 3 then 'S'
      when 4 then 'M'
      when 5 then 'A'
      end Clase,
      i.interdescrip,
      ar.tareacodi,
      case ar.tareacodi
      when 3 then 'G'
      when 4 then 'G'
      when 5 then 'G'
      when 6 then 'G'
      else 'T' end Teosinerg
      from
      in_intervencion i
      inner join si_empresa emp on (i.emprcodi=emp.emprcodi)
      inner join eq_equipo equ on (i.equicodi=equ.equicodi)
      inner join eq_area ar on (equ.areacodi=ar.areacodi)
      where
      i.interregprevactivo = 'S' and
      i.interdeleted = 0 and
      i.estadocodi not in (3) and
      i.interfechaini >= to_date('01/07/2019', 'dd/mm/yyyy hh24:mi:ss') and
      i.interfechaini &lt;  to_date('01/07/2019', 'dd/mm/yyyy hh24:mi:ss') + 7
      order by
      emp.emprnomb, ar.areanomb, equ.equiabrev, i.interfechaini
    </query>
  </Sql>
  <!--+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->

  <!--+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->
  <!--QUERYS PARA EL REPORTE DE INTERVENCIONES FORMATO OSINEGMIN-->
  <!--+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->
  <Sql>
    <key>RptIntervenciones</key>
    <query>
      select
      i.intercodi,
      i.tipoevencodi,
      i.evenclasecodi,
      emp.emprnomb,
      ar.areaabrev,
      ar.areanomb,
      equ.equiabrev,
      i.interfechaini,
      i.interfechafin,
      i.interdescrip,
      i.intermwindispo,
      case i.claprocodi
      when 1 then 'P'
      when 2 then 'R'
      when 3 then 'F'
      end Progr,
      case i.interindispo
      when 'E' then 'E/S'
      when 'F' then 'F/S'
      end interindispo,
      i.interinterrup,
      tev.tipoevenabrev,
      i.equicodi,
      case ar.tareacodi
      when 3 then 'G'
      when 4 then 'G'
      when 5 then 'G'
      when 6 then 'G'
      else 'T' end teosinerg
      from
      in_intervencion i
      inner join eve_tipoevento tev on (i.tipoevencodi=tev.tipoevencodi)
      inner join si_empresa emp on (i.emprcodi=emp.emprcodi)
      inner join eq_equipo equ on (i.equicodi=equ.equicodi)
      inner join eq_area ar on (equ.areacodi=ar.areacodi)
      where
      i.interregprevactivo = 'S' and
      i.interdeleted = 0 and
      i.estadocodi not in (3) and
      i.evenclasecodi in ({0}) and
      (i.emprcodi in ({1}) or '0'='{1}') and
      (( i.interfechaini >=  to_date('{2} 00:00:00','dd/mm/yyyy hh24:mi:ss')  and i.interfechaini &lt;  to_date('{3} 00:00:00','dd/mm/yyyy hh24:mi:ss') ) or
      ( i.interfechafin >  to_date('{2} 00:00:00','dd/mm/yyyy hh24:mi:ss')  and i.interfechafin &lt;=  to_date('{3} 00:00:00','dd/mm/yyyy hh24:mi:ss') ) or
      ( i.interfechaini &lt;  to_date('{2} 00:00:00','dd/mm/yyyy hh24:mi:ss')  and i.interfechafin >  to_date('{3} 00:00:00','dd/mm/yyyy hh24:mi:ss') ))
      order by
      emp.emprnomb
    </query>
  </Sql>

  <Sql>
    <key>ListaMantenimientos25</key>
    <query>
      SELECT SI_EMPRESA.EMPRCODI, SI_EMPRESA.EMPRNOMB, Eq_area.areanomb, Eq_equipo.equiabrev, IN_INTERVENCION.EQUICODI, IN_INTERVENCION.Interfechaini, IN_INTERVENCION.Interfechafin,
      '{1}' as EVENCLASEDESC, IN_INTERVENCION.Interdescrip, eq_area.tareacodi
      FROM IN_INTERVENCION, Eq_equipo, Eq_area, SI_EMPRESA WHERE (case when coalesce(IN_INTERVENCION.EMPRCODI, -1) > 0 then IN_INTERVENCION.EMPRCODI else Eq_equipo.emprcodi end) =SI_EMPRESA.EMPRCODI AND IN_INTERVENCION.EQUICODI = Eq_equipo.equicodi  AND Eq_equipo.areacodi = Eq_area.areacodi
      AND IN_INTERVENCION.Evenclasecodi = '{0}'
      and IN_INTERVENCION.interregprevactivo = 'S'
      and IN_INTERVENCION.interdeleted = 0
      and IN_INTERVENCION.estadocodi not in (3)
      AND IN_INTERVENCION.Interfechaini >= to_date('{2}','DD/MM/YYYY') AND IN_INTERVENCION.Interfechaini &lt; to_date('{3}','DD/MM/YYYY')
    </query>
  </Sql>

  <Sql>
    <key>RptIntervencionesOsinergmin</key>
    <query>
      select
      i.intercodi,
      i.tipoevencodi,
      i.evenclasecodi,
      emp.emprnomb,
      ar.areaabrev,
      ar.areanomb,
      equ.equiabrev,
      i.interfechaini,
      i.interfechafin,
      i.interdescrip,
      i.intermwindispo,
      case i.claprocodi
      when 1 then 'P'
      when 2 then 'R'
      when 3 then 'F'
      end Progr,
      case i.interindispo
      when 'E' then 'E/S'
      when 'F' then 'F/S'
      end interindispo,
      i.interinterrup,
      tev.tipoevenabrev,
      i.equicodi,
      case ar.tareacodi
      when 3 then 'G'
      when 4 then 'G'
      when 5 then 'G'
      when 6 then 'G'
      else 'T' end teosinerg
      from
      in_intervencion i
      inner join eve_tipoevento tev on (i.tipoevencodi=tev.tipoevencodi)
      inner join si_empresa emp on (i.emprcodi=emp.emprcodi)
      inner join eq_equipo equ on (i.equicodi=equ.equicodi)
      inner join eq_area ar on (equ.areacodi=ar.areacodi)
      where
      i.interregprevactivo = 'S' and
      i.interdeleted = 0 and
      i.estadocodi not in (3) and
      (i.progrcodi = ({0}) or '{0}' = '0') and
      (i.evenclasecodi in ({1}) or '{1}' = '0') and
      (i.emprcodi in ({2}) or '0'='{2}') and
      (( i.interfechaini >=  to_date('{3} 00:00:00','dd/mm/yyyy hh24:mi:ss')  and i.interfechaini &lt;  to_date('{4} 00:00:00','dd/mm/yyyy hh24:mi:ss') ) or
      ( i.interfechafin >  to_date('{3} 00:00:00','dd/mm/yyyy hh24:mi:ss')  and i.interfechafin &lt;=  to_date('{4} 00:00:00','dd/mm/yyyy hh24:mi:ss') ) or
      ( i.interfechaini &lt;  to_date('{3} 00:00:00','dd/mm/yyyy hh24:mi:ss')  and i.interfechafin >  to_date('{4} 00:00:00','dd/mm/yyyy hh24:mi:ss') ))
      order by
      emp.emprnomb
    </query>
  </Sql>
  <!--+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->

  <!--+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->
  <!--QUERYS PARA EL REPORTE DE INTERVENCIONES PARA AGENTES-->
  <!--+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->
  <Sql>
    <key>RptAgentes</key>
    <query>
      select
      i.intercodsegempr,
      emp.emprnomb,
      ar.areaabrev,
      ar.areanomb,
      equ.equiabrev,
      tev.tipoevendesc,
      tev.TIPOEVENABREV,
      fam.famnomb,
      fam.famabrev,
      i.interfechaini,
      i.interfechafin,
      i.intermwindispo,
      case i.interindispo
      when 'E' then 'E/S'
      when 'F' then 'F/S'
      end interindispo,
      case i.interinterrup
      when 'N' then 'NO'
      when 'S' then 'SI'
      end interinterrup,
      i.intermantrelev,
      i.interdescrip,
      i.interjustifaprobrechaz,
      i.intermensaje,
      i.intermensajecoes,
      i.intermensajeagente,
      i.claprocodi,
      i.progrcodi,
      i.interprocesado,
      i.interisfiles,
      i.interregprevactivo,
      i.estadocodi,
      i.intercreated,
      i.interdeleted,
      i.intercodi,
      i.tipoevencodi,
      i.emprcodi,
      ar.areacodi,
      fam.famcodi,
      i.equicodi,
      i.interusucreacion,
      i.interfeccreacion,
      case i.claprocodi
      when 1 then 'PROGRAMADO'
      when 2 then 'REPROGRAMADO'
      when 3 then 'FORZADO IMPREVISTO'
      end ClaseProgramacion,
      i.intercodipadre
      from
      in_intervencion i
      inner join eve_tipoevento tev on (i.tipoevencodi=tev.tipoevencodi)
      inner join si_empresa emp on (i.emprcodi=emp.emprcodi)
      inner join eq_equipo equ on (i.equicodi=equ.equicodi)
      inner join eq_area ar on (equ.areacodi=ar.areacodi)
      inner join eq_familia fam on (equ.famcodi=fam.famcodi)
      where
      (i.interregprevactivo = 'S') and
      (i.interdeleted = 0) and
      (i.estadocodi not in (3)) and
      (i.progrcodi = {0} or '{0}' = '0') and
      (i.evenclasecodi = {1}) and
      (i.emprcodi in ({2}) or '{2}' = '0') and
      (( i.interfechaini >=  to_date('{3} 00:00:00','dd/mm/yyyy hh24:mi:ss')  and i.interfechaini &lt;  to_date('{4} 00:00:00','dd/mm/yyyy hh24:mi:ss') ) or
      ( i.interfechafin >  to_date('{3} 00:00:00','dd/mm/yyyy hh24:mi:ss')  and i.interfechafin &lt;=  to_date('{4} 00:00:00','dd/mm/yyyy hh24:mi:ss') ) or
      ( i.interfechaini &lt;  to_date('{3} 00:00:00','dd/mm/yyyy hh24:mi:ss')  and i.interfechafin >  to_date('{4} 00:00:00','dd/mm/yyyy hh24:mi:ss') ))
      order by
      i.interfechaini,
      emp.emprnomb,
      equ.equiabrev,
      i.intercodipadre
    </query>
  </Sql>

  

  <Sql>
    <key>TotalRegistrosRptAgentes</key>
    <query>
      select
      count(*) as NroRegistros
      from
      in_intervencion i
      inner join eve_tipoevento tev on (i.tipoevencodi=tev.tipoevencodi)
      inner join si_empresa emp on (i.emprcodi=emp.emprcodi)
      inner join eq_equipo equ on (i.equicodi=equ.equicodi)
      inner join eq_area ar on (equ.areacodi=ar.areacodi)
      inner join eq_familia fam on (equ.famcodi=fam.famcodi)
      where
      (i.interregprevactivo = 'S') and
      (i.interdeleted = 0) and
      (i.estadocodi not in (3)) and
      (i.progrcodi = {0} or '{0}' = '0') and
      (i.evenclasecodi = {1}) and
      (i.emprcodi in ({2}) or '{2}' = '0') and
      (( i.interfechaini >=  to_date('{3} 00:00:00','dd/mm/yyyy hh24:mi:ss')  and i.interfechaini &lt;  to_date('{4} 00:00:00','dd/mm/yyyy hh24:mi:ss') ) or
      ( i.interfechafin >  to_date('{3} 00:00:00','dd/mm/yyyy hh24:mi:ss')  and i.interfechafin &lt;=  to_date('{4} 00:00:00','dd/mm/yyyy hh24:mi:ss') ) or
      ( i.interfechaini &lt;  to_date('{3} 00:00:00','dd/mm/yyyy hh24:mi:ss')  and i.interfechafin >  to_date('{4} 00:00:00','dd/mm/yyyy hh24:mi:ss') ))
    </query>
  </Sql>
  <!--+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->

  <!--+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->
  <!--QUERYS PARA EL REPORTE DE INDICADORES F1 Y F2-->
  <!--+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->
  <!--+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->
  <!--PARA INTERVENCIONES PROGRAMADAS-->
  <!--+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->
  <Sql>
    <key>RptIntervencionesF1F2Programados</key>
    <query>
      select
        inter.intercodsegempr,
        emp.emprnomb,
        ubic.areaabrev,
        ubic.areanomb,
        equ.equiabrev,
        inter.interdescrip,
        inter.interfechaini,
        inter.interfechafin,
        trunc(to_date(inter.interfechafin,'DD/MM/YYYY HH24:MI:SS'))-trunc(to_date(inter.interfechaini,'DD/MM/YYYY HH24:MI:SS')) Duracion,
        <!--'EJECUTADO' Observaciones,-->
        ' ' Observaciones,        
        inter.interjustifaprobrechaz,
        ' ' Comentario,        
        inter.tipoevencodi,
        tipoarea.tareacodi
      from
        in_intervencion inter
        inner join eq_equipo equ on (inter.equicodi=equ.equicodi)
        inner join eq_familia fam on (equ.famcodi=fam.famcodi)
        inner join eq_area ubic on (equ.areacodi=ubic.areacodi)
        inner join eq_tipoarea tipoarea on (ubic.tareacodi=tipoarea.tareacodi)
        inner join si_empresa emp on (equ.emprcodi=emp.emprcodi)
      where
        inter.interregprevactivo = 'S' and
        inter.interdeleted = 0 and
        inter.estadocodi not in (3) and
        inter.interprocesado = 1 and
        inter.evenclasecodi = 4 and
        <!--inter.tipoevencodi in (1) and-->
        <!--tipoarea.tareacodi in (3, 4, 8, 10, 11) and-->
        (trunc(to_date(inter.interfechafin,'DD/MM/YYYY HH24:MI:SS'))-trunc(to_date(inter.interfechaini,'DD/MM/YYYY HH24:MI:SS')) >= 24) and
        (to_char(inter.interfechaini, 'YYYY') = ({0}) or '{0}' = '0') and
        (to_char(inter.interfechaini, 'MM') = ({1}) or '{1}' = '0')
      order by
        inter.interfechaini,
        emp.emprnomb, 
        equ.equiabrev
    </query>
  </Sql>

  <Sql>
    <key>RptBuscarEjecutadoPorCodSeguimiento</key>
    <query>
      select
        count(intercodsegempr) as CodSeguimiento
      from
        in_intervencion
      where
        interregprevactivo = 'S' and
        interdeleted = 0 and
        estadocodi not in (3) and
        evenclasecodi = 1 and <!--Ejecutado-->
        intercodsegempr = :intercodsegempr
    </query>
  </Sql>
  <!--+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->

  <!--+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->
  <!--PARA INTERVENCIONES EJECUTADAS-->
  <!--+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->
  <Sql>
    <key>RptIntervencionesF1F2Ejecutados</key>
    <query>
      select
        intercodsegempr,
        emprnomb,
        areaabrev,
        areanomb,
        equiabrev,
        interdescrip,
        interfechaini,
        interfechafin,
        trunc(to_date(interfechafin,'DD/MM/YYYY HH24:MI:SS'))-trunc(to_date(interfechaini,'DD/MM/YYYY HH24:MI:SS')) Duracion,
        <!--'PROGRAMADO' Observaciones,-->
        ' ' Observaciones,
        interjustifaprobrechaz,
        ' ' Comentario,
        tipoevencodi,
        tareacodi
      from
      (
        select
          inter.intercodsegempr,
          emp.emprnomb,
          ubic.areaabrev,
          ubic.areanomb,
          equ.equiabrev,
          inter.interdescrip,
          min(inter.interfechaini) interfechaini,
          max(inter.interfechafin) interfechafin,
          inter.interjustifaprobrechaz,
          inter.tipoevencodi,
          tipoarea.tareacodi
        from
          in_intervencion inter
          inner join eq_equipo equ on (inter.equicodi=equ.equicodi)
          inner join eq_familia fam on (equ.famcodi=fam.famcodi)
          inner join eq_area ubic on (equ.areacodi=ubic.areacodi)
          inner join eq_tipoarea tipoarea on (ubic.tareacodi=tipoarea.tareacodi)
          inner join si_empresa emp on (equ.emprcodi=emp.emprcodi)
        where
          inter.interregprevactivo = 'S' and
          inter.interdeleted = 0 and
          inter.estadocodi not in (3) and
          inter.evenclasecodi = 1 and
          <!--inter.tipoevencodi in (1) and-->
          <!--tipoarea.tareacodi in (3, 4, 8, 10, 11) and-->
          (to_char(inter.interfechaini, 'YYYY') = ({0}) or '{0}' = '0') and
          (to_char(inter.interfechaini, 'MM') = ({1}) or '{1}' = '0')
        group by
          inter.intercodsegempr,
          emp.emprnomb,
          ubic.areaabrev,
          ubic.areanomb,
          equ.equiabrev,
          inter.interdescrip,
          inter.interjustifaprobrechaz,
          inter.tipoevencodi,
          tipoarea.tareacodi
      )
      order by
        interfechaini,
        emprnomb,
        equiabrev
    </query>
  </Sql>

  <Sql>
    <key>RptBuscarMensualProgramadoPorCodSeguimiento</key>
    <query>
      select
        count(intercodsegempr) as CodSeguimiento
      from
        in_intervencion
      where
        interregprevactivo = 'S' and
        interdeleted = 0 and
        estadocodi not in (3) and
        evenclasecodi = 4 and <!--Programado Mensual-->
        intercodsegempr = :intercodsegempr
    </query>
  </Sql>
  
  <!--+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->

  <!--+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->
  <!--QUERY PARA VALIDACIÓN CON OTROS APLICATIVOS (HORAS OPERACION, EMS, SCADA, IDCC, PR21, MEDIDORES)-->
  <!--+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->
  <!--QUERY PARA LA EXPORTACIÓN A EXCEL DE INTERVENCIONES CONSULTADAS-->
  <Sql>
    <key>ListarIntervencionesEquiposGen</key>
    <query>
		--Unidades de Generadores
		select
		i.*,
		emp.emprnomb,
		ar.areanomb,
		equ.equiabrev,
		tev.tipoevendesc,
		tev.TIPOEVENABREV,
		fam.famnomb,
		fam.famabrev,
		ar.areacodi,
		fam.famcodi,
		equ.equicodi,
		equ.equipadre,
		case i.claprocodi
		when 1 then 'PROGRAMADO'
		when 2 then 'REPROGRAMADO'
		when 3 then 'FORZADO IMPREVISTO'
		end ClaseProgramacion,
		scev.subcausadesc,
		emp2.EMPRNOMB as OPERADORNOMB
		from
		in_intervencion i
		inner join eve_tipoevento tev on (i.tipoevencodi=tev.tipoevencodi)
		inner join si_empresa emp on (i.emprcodi=emp.emprcodi)
		inner join eq_equipo equ on (i.equicodi=equ.equicodi) and equ.famcodi = {2}
		inner join eq_area ar on (equ.areacodi=ar.areacodi)
		inner join eq_familia fam on (equ.famcodi=fam.famcodi)
		inner join si_empresa emp2 on (emp2.emprcodi=i.operadoremprcodi)
		left join eve_subcausaevento scev on (i.subcausacodi=scev.subcausacodi)
		where
		(i.interregprevactivo = 'S') and
		(i.interdeleted = 0) and
		(i.estadocodi not in (3)) and
		(i.evenclasecodi = 1) and
		(i.interindispo='F'  --fuera de servicio
		OR (i.interindispo='E' AND i.TIPOEVENCODI=6) --en servicio pero en PRUEBAS
		) and
		(trunc(i.interfechaini) >=to_date('{0}','YYYY-MM-DD')) and
		(trunc(i.interfechaini) &lt;=to_date('{1}','YYYY-MM-DD'))

		UNION

		--Centrales de generación
		select
		i.*,
		emp.emprnomb,
		ar.areanomb,
		equ.equiabrev,
		tev.tipoevendesc,
		tev.TIPOEVENABREV,
		fam.famnomb,
		fam.famabrev,
		ar.areacodi,
		fam.famcodi,
		equ.equicodi,
		eqp.equicodi equipadre,
		case i.claprocodi
		when 1 then 'PROGRAMADO'
		when 2 then 'REPROGRAMADO'
		when 3 then 'FORZADO IMPREVISTO'
		end ClaseProgramacion,
		scev.subcausadesc,
		emp2.EMPRNOMB as OPERADORNOMB
		from
		in_intervencion i
		inner join eve_tipoevento tev on (i.tipoevencodi=tev.tipoevencodi)
		inner join si_empresa emp on (i.emprcodi=emp.emprcodi)
		inner join eq_equipo eqp on (i.equicodi=eqp.equicodi)  and eqp.famcodi = {3}
		inner join eq_equipo equ on equ.equipadre = eqp.equicodi
		inner join eq_area ar on (eqp.areacodi=ar.areacodi)
		inner join eq_familia fam on (equ.famcodi=fam.famcodi)
		inner join si_empresa emp2 on (emp2.emprcodi=i.operadoremprcodi)
		left join eve_subcausaevento scev on (i.subcausacodi=scev.subcausacodi)
		where
		(i.interregprevactivo = 'S') and
		(i.interdeleted = 0) and
		(i.estadocodi not in (3)) and
		(i.evenclasecodi = 1) and
		(i.interindispo='F'  --fuera de servicio
		OR (i.interindispo='E' AND i.TIPOEVENCODI=6) --en servicio pero en PRUEBAS
		) and
		(trunc(i.interfechaini) >=to_date('{0}','YYYY-MM-DD')) and
		(trunc(i.interfechaini) &lt;=to_date('{1}','YYYY-MM-DD'))
    </query>
  </Sql>


  <!--+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->
  <!--QUERY PARA ACTUALIZAR LOS PERMISOS DE LOS USUARIOS DE LA TABLA FW_USER POR ID-->
  <!--+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->
  <Sql>
    <key>UpdateUserPermiso</key>
    <query>
      update FW_USER
      set
      USERFLAGPERMISO = :valor
      where
      USERCODE = :userCodi
    </query>
  </Sql>
  <!--+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->

  <!--+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->
  <!--QUERY PARA OBTENER EL FLAG DEL PERMISO DEL USUARIO DE LA TABLA FW_USER POR ID-->
  <!--+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->
  <Sql>
    <key>ObtenerFlagUserPermiso</key>
    <query>
      select USERFLAGPERMISO from FW_USER
      where
      USERCODE ={0}
    </query>
  </Sql>
  <!--+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->

  <!--+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->
  <!--QUERY PARA OBTENER EL FLAG DEL PERMISO DEL USUARIO DE LA TABLA FW_USER POR ID-->
  <!--+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->
  <Sql>
    <key>ConsultarPermisos</key>
    <query>
      select USERFLAGPERMISO from FW_USER
      where
      USERLOGIN ='{0}'
    </query>
  </Sql>
  <!--+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->
	
  <!--Inicio Yupana - Portal -->
  <Sql>
    <key>ListarIntervencionesXPagina</key>
    <query>
      select *
      from (
      select
      eq.equiabrev,
      subcausa.subcausaabrev,
      eq.famcodi,
      eq.equitension,
      ar.areanomb,
      tipoarea.tareaabrev || ' ' || ar.areanomb as areadesc,
      f.famabrev,
      f.famnomb,
      emp.emprnomb,
      emp.emprabrev,
      cla.evenclasedesc,
      CLA.EVENCLASEABREV,
      causa.Causaevenabrev,
      tipo_empresa.tipoemprcodi,
      tipo_empresa.tipoemprdesc,
      TIPOEVE.TIPOEVENABREV,
      TIPOEVE.TIPOEVENDESC,
      case f.tipoecodi when 2 then 'G' else 'T' end osigrupocodi,
      mant.*,
      (row_number() over (order by MANT.intercodi)) as r
      from
      in_intervencion mant
      INNER JOIN EVE_TIPOEVENTO TIPOEVE ON TIPOEVE.TIPOEVENCODI = MANT.TIPOEVENCODI
      INNER JOIN EVE_EVENCLASE CLA ON CLA.EVENCLASECODI = MANT.EVENCLASECODI
      inner join eve_subcausaevento subcausa on mant.subcausacodi = subcausa.subcausacodi
      inner join eve_causaevento causa on subcausa.causaevencodi = causa.causaevencodi
      INNER JOIN EQ_EQUIPO EQ ON EQ.EQUICODI = mant.EQUICODI
      INNER JOIN EQ_AREA AR ON AR.AREACODI = EQ.AREACODI
      inner join eq_tipoarea tipoarea on ar.tareacodi = tipoarea.tareacodi
      INNER JOIN EQ_FAMILIA F ON F.FAMCODI = EQ.FAMCODI
      INNER JOIN SI_EMPRESA EMP ON EMP.EMPRCODI = (case when coalesce(mant.EMPRCODI, -1) > 0 then mant.EMPRCODI else eq.emprcodi end)
      inner join si_tipoempresa tipo_empresa on emp.tipoemprcodi = tipo_empresa.tipoemprcodi
      where
      (mant.interdeleted = 0) and
      (mant.interregprevactivo = 'S') and
      (mant.estadocodi not in (3)) and
      (mant.EVENCLASECODI in ({0}) or '{0}' = '-1') and
      (TIPOEVE.TIPOEVENCODI in ({9}) or '{9}' = '-1') and
      (emp.emprcodi in ({1}) or '{1}' = '-1') and
      (tipo_empresa.tipoemprcodi in ({7}) or '{7}' = '-1') and
      (f.famcodi in ({2}) or '{2}' = '-1') and
      (mant.interindispo = '{10}' or '{10}' = '-1') and
      (mant.INTERINTERRUP = '{8}' or '{8}' = '-1') and
      (( interfechaini >=  TO_DATE('{3} 00:00:00','YYYY-MM-DD HH24:MI:SS')  and interfechaini &lt;  TO_DATE('{4} 00:00:00','YYYY-MM-DD HH24:MI:SS')  ) or
      ( interfechafin >  TO_DATE('{3} 00:00:00','YYYY-MM-DD HH24:MI:SS')  and interfechafin &lt;=  TO_DATE('{4} 00:00:00','YYYY-MM-DD HH24:MI:SS')  ) or
      ( interfechaini &lt;  TO_DATE('{3} 00:00:00','YYYY-MM-DD HH24:MI:SS')  and interfechafin >  TO_DATE('{4} 00:00:00','YYYY-MM-DD HH24:MI:SS')  ))
      order by emp.emprnomb asc

      )
      where r >= ((({5}-1) * {6}) + 1) and r &lt; (({6} * {5}) + 1 )
    </query>
  </Sql>

  <Sql>
    <key>ObtenerNroRegistrosPaginado</key>
    <query>
      select
      count(*)
      from in_intervencion mantto
      inner join eq_equipo equipo on mantto.equicodi = equipo.equicodi
      inner join eq_familia familia on equipo.famcodi = familia.famcodi
      inner join eve_subcausaevento subcausa on mantto.subcausacodi = subcausa.subcausacodi
      INNER JOIN EVE_TIPOEVENTO TIPOEVE ON TIPOEVE.TIPOEVENCODI = MANTto.TIPOEVENCODI
      inner join EVE_EVENCLASE clase on mantto.EVENCLASECODI = clase.EVENCLASECODI
      inner join si_empresa empresa on empresa.emprcodi = (case when coalesce(mantto.EMPRCODI, -1) > 0 then mantto.EMPRCODI else equipo.emprcodi end)
      inner join si_tipoempresa tipo_empresa on empresa.tipoemprcodi = tipo_empresa.tipoemprcodi
      inner join eq_area area on equipo.areacodi = area.areacodi
      inner join eve_causaevento causa on subcausa.causaevencodi = causa.causaevencodi
      where
      (mantto.interdeleted = 0) and
      (mantto.interregprevactivo = 'S') and
      (mantto.estadocodi not in (3)) and
      (mantto.EVENCLASECODI in ({0}) or '{0}' = '-1') and
      (TIPOEVE.TIPOEVENCODI in ({7}) or '{7}' = '-1') and
      (empresa.emprcodi in ({1}) or '{1}' = '-1') and
      (tipo_empresa.tipoemprcodi in ({5}) or '{5}' = '-1') and
      (familia.famcodi in ({2}) or '{2}' = '-1') and
      (mantto.interindispo = '{8}' or '{8}' = '-1') and
      (mantto.INTERINTERRUP = '{6}' or '{6}' = '-1') and
      (( interfechaini >=  TO_DATE('{3} 00:00:00','YYYY-MM-DD HH24:MI:SS')  and interfechaini &lt;  TO_DATE('{4} 00:00:00','YYYY-MM-DD HH24:MI:SS')  ) or
      ( interfechafin >  TO_DATE('{3} 00:00:00','YYYY-MM-DD HH24:MI:SS')  and interfechafin &lt;=  TO_DATE('{4} 00:00:00','YYYY-MM-DD HH24:MI:SS')  ) or
      ( interfechaini &lt;  TO_DATE('{3} 00:00:00','YYYY-MM-DD HH24:MI:SS')  and interfechafin >  TO_DATE('{4} 00:00:00','YYYY-MM-DD HH24:MI:SS')  ))

    </query>

  </Sql>
  <Sql>
    <key>ListarIntervencionesGrafico</key>
    <query>
      select
      (case when eq.equipadre = eq2.equicodi then eq2.equinomb else eq.equinomb end) as equinomb ,
      eq.equiabrev,
      mant.*,
      subcausa.subcausaabrev,
      eq.famcodi,
      eq.areacodi,
      eq.equitension,
      ar.areanomb,
      tipoarea.tareaabrev || ' ' || ar.areanomb as areadesc,
      f.famabrev,
      f.famnomb,
      emp.emprnomb,
      emp.emprabrev,
      cla.evenclasedesc,
      CLA.EVENCLASEABREV,
      causa.Causaevenabrev,
      TIPOEVE.TIPOEVENABREV,
      TIPOEVE.TIPOEVENDESC,
      case f.tipoecodi when 2 then 'G' else 'T' end osigrupocodi,
      tipo_empresa.tipoemprdesc,
      eq2.equicodi as equipadre,
      gr.GRUPOTIPOCOGEN
      from
      in_intervencion mant
      INNER JOIN EVE_TIPOEVENTO TIPOEVE ON TIPOEVE.TIPOEVENCODI = MANT.TIPOEVENCODI
      INNER JOIN EVE_EVENCLASE CLA ON CLA.EVENCLASECODI = MANT.EVENCLASECODI
      inner join eve_subcausaevento subcausa on mant.subcausacodi = subcausa.subcausacodi
      inner join eve_causaevento causa on subcausa.causaevencodi = causa.causaevencodi
      INNER JOIN EQ_EQUIPO EQ ON EQ.EQUICODI = mant.EQUICODI
      LEFT JOIN EQ_EQUIPO eq2 ON eq2.EQUICODI = (CASE WHEN EQ.FAMCODI in (4,5,37,39) THEN EQ.equicodi ELSE EQ.EQUIPADRE END)
      left join pr_grupo gr on gr.grupocodi = eq.grupocodi
      INNER JOIN EQ_AREA AR ON AR.AREACODI = EQ.AREACODI
      inner join eq_tipoarea tipoarea on ar.tareacodi = tipoarea.tareacodi
      INNER JOIN EQ_FAMILIA F ON F.FAMCODI = EQ.FAMCODI
      INNER JOIN SI_EMPRESA EMP ON EMP.EMPRCODI = (case when coalesce(mant.EMPRCODI, -1) > 0 then mant.EMPRCODI else eq.emprcodi end)
      inner join si_tipoempresa tipo_empresa on emp.tipoemprcodi = tipo_empresa.tipoemprcodi
      where
      (mant.interdeleted = 0) and
      (mant.interregprevactivo = 'S') and
      (mant.estadocodi not in (3)) and
      --tipoeve.tipoevenabrev not in ('PRUEBA', 'EVENTO') and
      (mant.EVENCLASECODI in ({0}) or '{0}' = '-1') and
      (TIPOEVE.TIPOEVENCODI in ({7}) or '{7}' = '-1') and
      (emp.emprcodi in ({1}) or '{1}' = '-1') and
      (tipo_empresa.tipoemprcodi in ({5}) or '{5}' = '-1') and
      (f.famcodi in ({2}) or '{2}' = '-1') and
      (mant.interindispo = '{8}' or '{8}' = '-1') and
      (mant.INTERINTERRUP = '{6}' or '{6}' = '-1') and
      (( interfechaini >=  TO_DATE('{3} 00:00:00','YYYY-MM-DD HH24:MI:SS')  and interfechaini &lt;  TO_DATE('{4} 00:00:00','YYYY-MM-DD HH24:MI:SS')  ) or
      ( interfechafin >  TO_DATE('{3} 00:00:00','YYYY-MM-DD HH24:MI:SS')  and interfechafin &lt;=  TO_DATE('{4} 00:00:00','YYYY-MM-DD HH24:MI:SS')  ) or
      ( interfechaini &lt;  TO_DATE('{3} 00:00:00','YYYY-MM-DD HH24:MI:SS')  and interfechafin >  TO_DATE('{4} 00:00:00','YYYY-MM-DD HH24:MI:SS')  ))

      order by emp.emprnomb asc
    </query>
  </Sql>
  <!--+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->

  <!--+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->
  <!--QUERY DE CONSULTAS PARA EL MODULO DE CONSULTAS CRUZADAS INTERVENCIONES (XMANTTO) - NTIITR -->
  <!--+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->
  <Sql>
    <key>ListarIntervencionesNTIITR</key>
    <query>
      select
      i.*,
      emp.emprcodi,
      emp.emprabrev,
      emp.emprnomb,
      i.evenclasecodi,
      eve.evenclasedesc,
      eve.evenclaseabrev,
      ar.areanomb,
      fam.famcodi,
      fam.famabrev,
      fam.famnomb,
      equ.equiabrev,
      equ.areacodi,
      fam.tareacodi,
      equ.equipot,
      equ.equimaniobra,
      equ.equinomb,
      ip.progrsololectura
      from
      in_intervencion i
      inner join in_programacion ip on (i.progrcodi=ip.progrcodi)
      inner join si_empresa emp on (i.emprcodi=emp.emprcodi)
      inner join eq_equipo equ on (i.equicodi=equ.equicodi)
      inner join eq_area ar on (equ.areacodi=ar.areacodi)
      inner join eq_familia fam on (equ.famcodi=fam.famcodi)
      left join eve_evenclase eve on (i.evenclasecodi=eve.evenclasecodi)
      where
      (i.interdeleted = 0) and
      (i.interregprevactivo = 'S') and
      (i.estadocodi not in (3)) and
      (i.evenclasecodi in (1)) and
      (i.emprcodi in (0) or '0' = '0') and
      ( i.interfechaini >=  to_date('{0} 00:00:00','YYYY-MM-DD HH24:MI:SS')  and i.interfechaini &lt;=  to_date('{1} 00:00:00','YYYY-MM-DD HH24:MI:SS') ) and
      (i.progrcodi in (0) or '0' = '0') and
      (i.interindispo = 'F') and
      (i.claprocodi = '0' or '0' = '0') and
      (i.tipoevencodi IN (1, 2)) and
      (i.subCausaCodi = '0' or '0' = '0') and
      (equ.equimaniobra = '0' or '0' = '0') and
      (equ.famcodi not in (18, 19, 20, 22, 23, 25, 30, 31, 32, 34, 35, 40, 41, 42, 43, 44, 45))
      order by
      emp.emprnomb,
      ar.areanomb,
      fam.famabrev,
      equ.equiabrev,
      i.evenclasecodi,
      i.interfechaini
    </query>
  </Sql>
  
  <!--Fin Yupana - Portal -->

  <!--+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->
  <!--QUERY PARA HABILITAR Y DESABILITAR INTERVENCIONES POR ELIMINAR LA REVERSIÓN-->
  <!--+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->
  <Sql>
    <key>DeshabilitarIntervencionEnReversion</key>
    <query>
      update in_intervencion
      set
      interregprevactivo = 'N', -- no es visible
      intercreated = 1,
      interdeleted = 0
      where
      progrcodi = :progrcodi
      and interprocesado = 2 -- en reversión
      and estadocodi = 2 -- aprobado
    </query>
  </Sql>
  
  <Sql>
    <key>HabilitarIntervencionesRevertidas</key>
    <query>
      update in_intervencion
      set
      interregprevactivo = 'S', -- será visible
      intercreated = 1,
      interdeleted = 0
      where
      progrcodi = :progrcodi
      and interprocesado = 1 -- en aprobación
      and estadocodi = 2 -- aprobado
      and interregprevactivo = 'N' -- no es visible
    </query>
  </Sql>

  <!--+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->

  <!--+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->
  <!--QUERY PARA RECUPERAR ELIMINADOS Y RECHAZADOS-->
  <!--+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->
  <Sql>
    <key>DeshabilitarIntervencionEliminadaRechazada</key>
    <query>
      update in_intervencion
      set
      interregprevactivo = 'N', -- no es visible
      interprocesado = :interprocesado
      where
      intercodi = :intercodi
    </query>
  </Sql>
  
  <Sql>
    <key>RecuperarIntervencion</key>
    <query>
      update in_intervencion
      set
      interregprevactivo = 'S', -- será visible
      interprocesado = :interprocesado
      where
      intercodi = :intercodi
      and interregprevactivo = 'N' -- no es visible
    </query>
  </Sql>
  <!--+++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++-->


</Sqls>