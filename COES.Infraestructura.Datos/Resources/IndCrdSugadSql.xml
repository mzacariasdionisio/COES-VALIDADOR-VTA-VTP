<?xml version="1.0" encoding="utf-8" ?>

<Sqls>

  <Sql>
    <key>GetMaxId</key>
    <query>
      select nvl(max(crdsgdcodi), 0) + 1 from ind_crdsugad
    </query>
  </Sql>

  <Sql>
    <key>Save</key>
    <query>
      insert into ind_crdsugad(
      crdsgdcodi,
      indcbrcodi,
      equicodicentral,
      equicodiunidad,
      grupocodi,
      famcodi,
      crdsgdtipo,
      d1,
      d2,
      d3,
      d4,
      d5,
      d6,
      d7,
      d8,
      d9,
      d10,
      d11,
      d12,
      d13,
      d14,
      d15,
      d16,
      d17,
      d18,
      d19,
      d20,
      d21,
      d22,
      d23,
      d24,
      d25,
      d26,
      d27,
      d28,
      d29,
      d30,
      d31,
      e1,
      e2,
      e3,
      e4,
      e5,
      e6,
      e7,
      e8,
      e9,
      e10,
      e11,
      e12,
      e13,
      e14,
      e15,
      e16,
      e17,
      e18,
      e19,
      e20,
      e21,
      e22,
      e23,
      e24,
      e25,
      e26,
      e27,
      e28,
      e29,
      e30,
      e31,
      crdsgdusucreacion,
      crdsgdfeccreacion
      )
      values(
      :crdsgdcodi,
      :indcbrcodi,
      :equicodicentral,
      :equicodiunidad,
      :grupocodi,
      :famcodi,
      :crdsgdtipo,
      :d1,
      :d2,
      :d3,
      :d4,
      :d5,
      :d6,
      :d7,
      :d8,
      :d9,
      :d10,
      :d11,
      :d12,
      :d13,
      :d14,
      :d15,
      :d16,
      :d17,
      :d18,
      :d19,
      :d20,
      :d21,
      :d22,
      :d23,
      :d24,
      :d25,
      :d26,
      :d27,
      :d28,
      :d29,
      :d30,
      :d31,
      :e1,
      :e2,
      :e3,
      :e4,
      :e5,
      :e6,
      :e7,
      :e8,
      :e9,
      :e10,
      :e11,
      :e12,
      :e13,
      :e14,
      :e15,
      :e16,
      :e17,
      :e18,
      :e19,
      :e20,
      :e21,
      :e22,
      :e23,
      :e24,
      :e25,
      :e26,
      :e27,
      :e28,
      :e29,
      :e30,
      :e31,
      :crdsgdusucreacion,
      :crdsgdfeccreacion
      )
    </query>
  </Sql>

  <Sql>
    <key>UpdateIndCrdSugad</key>
    <query>
      update ind_crdsugad
      set
          d1 = :d1,
          d2 = :d2,
          d3 = :d3,
          d4 = :d4,
          d5 = :d5,
          d6 = :d6,
          d7 = :d7,
          d8 = :d8,
          d9 = :d9,
          d10 = :d10,
          d11 = :d11,
          d12 = :d12,
          d13 = :d13,
          d14 = :d14,
          d15 = :d15,
          d16 = :d16,
          d17 = :d17,
          d18 = :d18,
          d19 = :d19,
          d20 = :d20,
          d21 = :d21,
          d22 = :d22,
          d23 = :d23,
          d24 = :d24,
          d25 = :d25,
          d26 = :d26,
          d27 = :d27,
          d28 = :d28,
          d29 = :d29,
          d30 = :d30,
          d31 = :d31,
          e1 = :e1,
          e2 = :e2,
          e3 = :e3,
          e4 = :e4,
          e5 = :e5,
          e6 = :e6,
          e7 = :e7,
          e8 = :e8,
          e9 = :e9,
          e10 = :e10,
          e11 = :e11,
          e12 = :e12,
          e13 = :e13,
          e14 = :e14,
          e15 = :e15,
          e16 = :e16,
          e17 = :e17,
          e18 = :e18,
          e19 = :e19,
          e20 = :e20,
          e21 = :e21,
          e22 = :e22,
          e23 = :e23,
          e24 = :e24,
          e25 = :e25,
          e26 = :e26,
          e27 = :e27,
          e28 = :e28,
          e29 = :e29,
          e30 = :e30,
          e31 = :e31
      where crdsgdcodi = :crdsgdcodi
      <!--where indcbrcodi = :indcbrcodi and equicodicentral = :equicodicentral and equicodiunidad = :equicodiunidad
            and grupocodi = :grupocodi and famcodi = :famcodi and crdsgdtipo = :crdsgdtipo-->
    </query>
  </Sql>

  <Sql>
    <key>UpdateIndCrdEstado</key>
    <query>
      update ind_crdsugad
      set
      e1 = :e1,
      e2 = :e2,
      e3 = :e3,
      e4 = :e4,
      e5 = :e5,
      e6 = :e6,
      e7 = :e7,
      e8 = :e8,
      e9 = :e9,
      e10 = :e10,
      e11 = :e11,
      e12 = :e12,
      e13 = :e13,
      e14 = :e14,
      e15 = :e15,
      e16 = :e16,
      e17 = :e17,
      e18 = :e18,
      e19 = :e19,
      e20 = :e20,
      e21 = :e21,
      e22 = :e22,
      e23 = :e23,
      e24 = :e24,
      e25 = :e25,
      e26 = :e26,
      e27 = :e27,
      e28 = :e28,
      e29 = :e29,
      e30 = :e30,
      e31 = :e31
      where crdsgdcodi = :crdsgdcodi
    </query>
  </Sql>

  <Sql>
    <key>GetById</key>
    <query>
      select
      crdsgdcodi,
      equicodicentral,
      equicodiunidad,
      grupocodi,
      famcodi,
      crdsgdtipo,
      d1,d2,d3,d4,d5,d6,d7,d8,d9,d10,
      d11,d12,d13,d14,d15,d16,d17,d18,d19,d20,
      d21,d22,d23,d24,d25,d26,d27,d28,d29,d30,d31,
      e1,e2,e3,e4,e5,e6,e7,e8,e9,e10,
      e11,e12,e13,e14,e15,e16,e17,e18,e19,e20,
      e21,e22,e23,e24,e25,e26,e27,e28,e29,e30,e31
      from ind_crdsugad
      where crdsgdcodi = {0}
    </query>
  </Sql>
  
  <Sql>
    <key>ListCrdSugadByCabecera</key>
    <query>
      select
        crdsgdcodi,
        indcbrcodi,
        equicodicentral,
        equicodiunidad,
        grupocodi,
        famcodi,
        crdsgdtipo,
        d1,d2,d3,d4,d5,d6,d7,d8,d9,d10,
        d11,d12,d13,d14,d15,d16,d17,d18,d19,d20,
        d21,d22,d23,d24,d25,d26,d27,d28,d29,d30,d31,
        e1,e2,e3,e4,e5,e6,e7,e8,e9,e10,
        e11,e12,e13,e14,e15,e16,e17,e18,e19,e20,
        e21,e22,e23,e24,e25,e26,e27,e28,e29,e30,e31
      from ind_crdsugad
      where indcbrcodi = {0}
    </query>
  </Sql>

  <Sql>
    <key>ListByCriteria</key>
    <query>
      select
        cab.indcbrcodi,
        cab.ipericodi, 
        cab.emprcodi, 
        cab.indcbrtipo,
        crdsgd.*
      from
        ind_cabecera cab
        inner join ind_crdsugad crdsgd on crdsgd.indcbrcodi = cab.indcbrcodi
      where
        cab.ipericodi = {0} and
        ('0'='{1}' or cab.emprcodi in ({1})) and
        cab.indcbrtipo in ({2}) and
        ('0'='{3}' or crdsgd.equicodicentral in ({3})) and
        ('0'='{4}' or crdsgd.equicodiunidad in ({4})) and
        ('0'='{5}' or crdsgd.grupocodi in ({5})) and 
        ('0'='{6}' or crdsgd.famcodi in ({6})) and
        crdsgd.crdsgdtipo in ({7})
    </query>
  </Sql>


  <Sql>
    <key>ListCrdSugadJoinCabecera</key>
    <query>
      select
            t1.crdsgdcodi,
            t1.indcbrcodi,
            t2.emprcodi,
            t2.ipericodi,
            t2.indcbrtipo,
            t1.equicodicentral,
            t1.equicodiunidad,
            t1.grupocodi,
            t1.famcodi,
            t1.crdsgdtipo,
            t1.d1,t1.d2,t1.d3,t1.d4,t1.d5,t1.d6,t1.d7,t1.d8,t1.d9,t1.d10,
            t1.d11,t1.d12,t1.d13,t1.d14,t1.d15,t1.d16,t1.d17,t1.d18,t1.d19,t1.d20,
            t1.d21,t1.d22,t1.d23,t1.d24,t1.d25,t1.d26,t1.d27,t1.d28,t1.d29,t1.d30,t1.d31,
            t1.e1,t1.e2,t1.e3,t1.e4,t1.e5,t1.e6,t1.e7,t1.e8,t1.e9,t1.e10,
            t1.e11,t1.e12,t1.e13,t1.e14,t1.e15,t1.e16,t1.e17,t1.e18,t1.e19,t1.e20,
            t1.e21,t1.e22,t1.e23,t1.e24,t1.e25,t1.e26,t1.e27,t1.e28,t1.e29,t1.e30,t1.e31
      from ind_crdsugad t1 join ind_cabecera t2
      on t1.indcbrcodi = t2.indcbrcodi
      where t2.emprcodi = {0} and t2.ipericodi = {1} and t2.indcbrtipo = {2}
      order by t1.crdsgdcodi
    </query>
  </Sql>

  <Sql>
    <key>ListCumplimientoDiario</key>
    <query>
      select
      t1.crdsgdcodi,
      t2.indcbrfeccreacion,
      to_char(t2.indcbrfeccreacion, 'DD/MM/YYYY') as indcbrfecha,
      t2.indcbrusucreacion,
      t1.indcbrcodi,
      t2.emprcodi,
      trim(emp.emprnomb) as emprnomb,
      t2.ipericodi,
      t2.indcbrtipo,
      t1.equicodicentral,
      trim(eqp.equinomb) as equinombcentral,
      t1.equicodiunidad,
      trim(equ.equinomb) as equinombunidad,
      t1.grupocodi,
      t1.famcodi,
      t1.crdsgdtipo,
      t1.e1,t1.e2,t1.e3,t1.e4,t1.e5,t1.e6,t1.e7,t1.e8,t1.e9,t1.e10,
      t1.e11,t1.e12,t1.e13,t1.e14,t1.e15,t1.e16,t1.e17,t1.e18,t1.e19,t1.e20,
      t1.e21,t1.e22,t1.e23,t1.e24,t1.e25,t1.e26,t1.e27,t1.e28,t1.e29,t1.e30,t1.e31,
      '' as Cumplimiento,
      0 as Porcentaje
      from ind_crdsugad t1 join ind_cabecera t2 on t1.indcbrcodi = t2.indcbrcodi
      inner join si_empresa emp on t2.emprcodi = emp.emprcodi
      inner join eq_equipo eqp on t1.equicodicentral = eqp.equicodi
      inner join eq_equipo equ on t1.equicodiunidad = equ.equicodi
      where t2.emprcodi = {0} and t2.ipericodi = {1} and t2.indcbrtipo = {2}
      order by t1.crdsgdcodi
    </query>
  </Sql>
</Sqls>