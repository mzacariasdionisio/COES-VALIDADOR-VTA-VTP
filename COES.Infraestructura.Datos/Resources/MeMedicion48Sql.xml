<?xml version="1.0" encoding="utf-8" ?>
<Sqls>


  <Sql>
    <key>Save</key>
    <query>
      insert into me_medicion48(
      lastuser,
      lastdate,
      lectcodi,
      medifecha,
      tipoinfocodi,
      ptomedicodi,
      h1,
      meditotal,
      mediestado,
      h2,
      h3,
      h4,
      h5,
      h6,
      h7,
      h8,
      h9,
      h10,
      h11,
      h12,
      h13,
      h14,
      h15,
      h16,
      h17,
      h18,
      h19,
      h20,
      h21,
      h22,
      h23,
      h24,
      h25,
      h26,
      h27,
      h28,
      h29,
      h30,
      h31,
      h32,
      h33,
      h34,
      h35,
      h36,
      h37,
      h38,
      h39,
      h40,
      h41,
      h42,
      h43,
      h44,
      h45,
      h46,
      h47,
      h48,
      emprcodi
      )
      values(
      :lastuser,
      :lastdate,
      :lectcodi,
      :medifecha,
      :tipoinfocodi,
      :ptomedicodi,
      :h1,
      :meditotal,
      :mediestado,
      :h2,
      :h3,
      :h4,
      :h5,
      :h6,
      :h7,
      :h8,
      :h9,
      :h10,
      :h11,
      :h12,
      :h13,
      :h14,
      :h15,
      :h16,
      :h17,
      :h18,
      :h19,
      :h20,
      :h21,
      :h22,
      :h23,
      :h24,
      :h25,
      :h26,
      :h27,
      :h28,
      :h29,
      :h30,
      :h31,
      :h32,
      :h33,
      :h34,
      :h35,
      :h36,
      :h37,
      :h38,
      :h39,
      :h40,
      :h41,
      :h42,
      :h43,
      :h44,
      :h45,
      :h46,
      :h47,
      :h48,
      :emprcodi
      )
    </query>
  </Sql>

  <Sql>
    <key>Update</key>
    <query>
      update me_medicion48
      set
      lastuser = :lastuser,
      lastdate = :lastdate,
      meditotal = :meditotal,
      mediestado = :mediestado,
      h1 = :h1,
      h2 = :h2,
      h3 = :h3,
      h4 = :h4,
      h5 = :h5,
      h6 = :h6,
      h7 = :h7,
      h8 = :h8,
      h9 = :h9,
      h10 = :h10,
      h11 = :h11,
      h12 = :h12,
      h13 = :h13,
      h14 = :h14,
      h15 = :h15,
      h16 = :h16,
      h17 = :h17,
      h18 = :h18,
      h19 = :h19,
      h20 = :h20,
      h21 = :h21,
      h22 = :h22,
      h23 = :h23,
      h24 = :h24,
      h25 = :h25,
      h26 = :h26,
      h27 = :h27,
      h28 = :h28,
      h29 = :h29,
      h30 = :h30,
      h31 = :h31,
      h32 = :h32,
      h33 = :h33,
      h34 = :h34,
      h35 = :h35,
      h36 = :h36,
      h37 = :h37,
      h38 = :h38,
      h39 = :h39,
      h40 = :h40,
      h41 = :h41,
      h42 = :h42,
      h43 = :h43,
      h44 = :h44,
      h45 = :h45,
      h46 = :h46,
      h47 = :h47,
      h48 = :h48
      where
      lectcodi = :lectcodi and
      medifecha = :medifecha and
      tipoinfocodi = :tipoinfocodi and
      ptomedicodi = :ptomedicodi
    </query>
  </Sql>

  <Sql>
    <key>Delete</key>
    <query>
      delete from me_medicion48
      where
      lectcodi = :lectcodi and
      medifecha = :medifecha and
      tipoinfocodi = :tipoinfocodi and
      ptomedicodi = :ptomedicodi
    </query>
  </Sql>

  <Sql>
    <key>GetById</key>
    <query>
      select
      *
      from
      me_medicion48
      where
      lectcodi = :lectcodi and
      medifecha = :medifecha and
      tipoinfocodi = :tipoinfocodi and
      ptomedicodi = :ptomedicodi
    </query>
  </Sql>

  <Sql>
    <key>List</key>
    <query>
      select
      *
      from
      me_medicion48
    </query>
  </Sql>

  <Sql>
    <key>GetByCriteria</key>
    <query>
      select
      *
      from
      me_medicion48
    </query>
  </Sql>

  <Sql>
    <key>DemandaDiariaxAreas</key>
    <query>
      SELECT me_ptomedicion.ptomedidesc,me_ptomedicion.ptomedicodi,m.medifecha, m.H1, m.H2,m.H3, m.H4,m.H5, m.H6,m.H7, m.H8,m.H9, m.H10,
      m.H11, m.H12,m.H13, m.H14,m.H15, m.H16,m.H17, m.H18,m.H19, m.H20,
      m.H21, m.H22,m.H23, m.H24,m.H25, m.H26,m.H27, m.H28,m.H29, m.H30,
      m.H31, m.H32,m.H33, m.H34,m.H35, m.H36,m.H37, m.H38,m.H39, m.H40,
      m.H41, m.H42,m.H43, m.H44,m.H45, m.H46,m.H47, m.H48
      FROM ME_MEDICION48 m inner join me_ptomedicion on (me_ptomedicion.ptomedicodi=m.PTOMEDICODI)
      WHERE  m.PTOMEDICODI in (3004,3005,3006,3009) AND m.LECTCODI = 27 AND m.TIPOINFOCODI = 1 AND m.MEDIFECHA =  TO_DATE('{0}','YYYY-MM-DD')
    </query>
  </Sql>

  <Sql>
    <key>GetGeneracionRER</key>
    <query>
      select * from me_medicion48
      where lectcodi = {0}
      and (medifecha >= to_date('{1} 00:00:00','yyyy-MM-dd HH24:MI:SS') and medifecha &lt;= to_date('{2} 23:59:59','yyyy-MM-dd HH24:MI:SS'))
      and ptomedicodi in (
      select
      rer.ptomedicodi
      from
      wb_generacionrer rer
      inner join me_ptomedicion pto on rer.ptomedicodi = pto.ptomedicodi
      where (pto.emprcodi = {3} or {3} = 0) and rer.estado = 'A')
      order by medifecha asc
    </query>
  </Sql>

  <Sql>
    <key>ObtenerGeneracionRERPorPunto</key>
    <query>
      select count(*) from me_medicion48
      where lectcodi = {1}
      and (medifecha >= to_date('{2} 00:00:00','yyyy-MM-dd HH24:MI:SS') and medifecha &lt;= to_date('{3} 23:59:59','yyyy-MM-dd HH24:MI:SS'))
      and ptomedicodi in ({0})
    </query>
  </Sql>

  <Sql>
    <key>DeleteGeneracionRERPorPunto</key>
    <query>
      delete from me_medicion48
      where lectcodi = {1}
      and (medifecha >= to_date('{2} 00:00:00','yyyy-MM-dd HH24:MI:SS') and medifecha &lt;= to_date('{3} 23:59:59','yyyy-MM-dd HH24:MI:SS'))
      and ptomedicodi in ({0})
    </query>
  </Sql>

  <Sql>
    <key>ObtenerEmpresaPtoMedicion</key>
    <query>
      select emprcodi from me_ptomedicion where ptomedicodi = {0}
    </query>
  </Sql>

  <Sql>
    <key>ObtenerNroRegistrosEjecutado</key>
    <query>
      select count(*)
      from me_medicion48 me
      inner join me_ptomedicion pto on me.ptomedicodi = pto.ptomedicodi
      inner join pr_grupo pg on pto.grupocodi = pg.grupocodi
      inner join eq_equipo eq on pto.equicodi = eq.equicodi
      inner join si_empresa emp on emp.emprcodi = (case when coalesce(me.EMPRCODI, -1) > 0 then me.EMPRCODI else pto.emprcodi end)
      inner join si_fuenteenergia fe on pg.fenergcodi = fe.fenergcodi
      inner join si_tipogeneracion tg on fe.tgenercodi = tg.tgenercodi
      where
      me.tipoinfocodi = 1
      and me.lectcodi = 6
      and (emp.emprcodi in ({0}) or '{0}' = '-1')
      and (tg.tgenercodi in ({1}) or '{1}' = '-1')
      and (me.medifecha >= to_date('{2} 00:00:00','YYYY-MM-DD HH24:MI:SS')
      and me.medifecha &lt;= to_date('{3} 23:59:59','YYYY-MM-DD HH24:MI:SS'))
    </query>
  </Sql>

  <Sql>
    <key>ObtenerConsultaEjecutado</key>
    <query>
      select * from (
      select emp.emprcodi, me.*,
      eq.equipadre, eq.equicodi,
      (select case when x.equicodi = 0 then eq.equinomb  when x.equicodi > 0 then x.equinomb end from eq_equipo x where x.equicodi = eq.equipadre) as central,
      eq.equinomb as equinomb, emp.emprnomb,
      (row_number() over (order by me.medifecha asc, emp.emprnomb asc)) as r
      from me_medicion48 me
      inner join me_ptomedicion pto on me.ptomedicodi = pto.ptomedicodi
      inner join pr_grupo pg on pto.grupocodi = pg.grupocodi
      inner join eq_equipo eq on pto.equicodi = eq.equicodi
      inner join si_empresa emp on emp.emprcodi = (case when coalesce(me.EMPRCODI, -1) > 0 then me.EMPRCODI else pto.emprcodi end)
      inner join si_fuenteenergia fe on pg.fenergcodi = fe.fenergcodi
      inner join si_tipogeneracion tg on fe.tgenercodi = tg.tgenercodi
      where
      me.tipoinfocodi = 1
      and me.lectcodi = 6
      and (emp.emprcodi in ({0}) or '{0}' = '-1')
      and (tg.tgenercodi in ({1}) or '{1}' = '-1')
      and (me.medifecha >= to_date('{2} 00:00:00','YYYY-MM-DD HH24:MI:SS') and me.medifecha &lt;= to_date('{3} 23:59:59','YYYY-MM-DD HH24:MI:SS'))
      order by me.medifecha asc, emp.emprnomb asc
      )
      where r >= ((({4}-1) * {5}) + 1) and r &lt; (({4} * {5}) + 1 )
      order by medifecha asc, emprnomb asc
    </query>
  </Sql>

  <Sql>
    <key>ObtenerTotalConsultaEjecutado</key>
    <query>
      select sum(meditotal) as meditotal,
      sum(h1) as h1, sum(h2) as h2, sum(h3) as h3, sum(h4) as h4,
      sum(h5) as h5, sum(h6) as h6, sum(h7) as h7, sum(h8) as h8,
      sum(h9) as h9, sum(h10) as h10, sum(h11) as h11, sum(h12) as h12,
      sum(h13) as h13, sum(h14) as h14, sum(h15) as h15, sum(h16) as h16,
      sum(h17) as h17, sum(h18) as h18, sum(h19) as h19, sum(h20) as h20,
      sum(h21) as h21, sum(h22) as h22, sum(h23) as h23, sum(h24) as h24,
      sum(h25) as h25, sum(h26) as h26, sum(h27) as h27, sum(h28) as h28,
      sum(h29) as h29, sum(h30) as h30, sum(h31) as h31, sum(h32) as h32,
      sum(h33) as h33, sum(h34) as h34, sum(h35) as h35, sum(h36) as h36,
      sum(h37) as h37, sum(h38) as h38, sum(h39) as h39, sum(h40) as h40,
      sum(h41) as h41, sum(h42) as h42, sum(h43) as h43, sum(h44) as h44,
      sum(h45) as h45, sum(h46) as h46, sum(h47) as h47, sum(h48) as h48
      from me_medicion48 me
      inner join me_ptomedicion pto on me.ptomedicodi = pto.ptomedicodi
      inner join pr_grupo pg on pto.grupocodi = pg.grupocodi
      inner join eq_equipo eq on pto.equicodi = eq.equicodi
      inner join si_empresa emp on emp.emprcodi = (case when coalesce(me.EMPRCODI, -1) > 0 then me.EMPRCODI else pto.emprcodi end)
      inner join si_fuenteenergia fe on pg.fenergcodi = fe.fenergcodi
      inner join si_tipogeneracion tg on fe.tgenercodi = tg.tgenercodi
      where
      me.tipoinfocodi = 1
      and me.lectcodi = 6
      and (emp.emprcodi in ({0}) or '{0}' = '-1')
      and (tg.tgenercodi in ({1}) or '{1}' = '-1')
      and (me.medifecha >= to_date('{2} 00:00:00','YYYY-MM-DD HH24:MI:SS')
      and me.medifecha &lt;= to_date('{3} 23:59:59','YYYY-MM-DD HH24:MI:SS'))
    </query>
  </Sql>

  <Sql>
    <key>ObtenerExportacionConsultaEjecutado</key>
    <query>
      select emp.emprcodi, me.*,
      eq.equipadre, eq.equicodi,eq.grupocodi,
      (select case when x.equicodi = 0 then eq.equinomb  when x.equicodi > 0 then x.equinomb end from eq_equipo x where x.equicodi = eq.equipadre) as central,
      eq.equinomb as equinomb, emp.emprnomb,
      (row_number() over (order by me.medifecha asc, emp.emprnomb asc)) as r
      from me_medicion48 me
      inner join me_ptomedicion pto on me.ptomedicodi = pto.ptomedicodi
      inner join pr_grupo pg on pto.grupocodi = pg.grupocodi
      inner join eq_equipo eq on pto.equicodi = eq.equicodi
      inner join si_empresa emp on emp.emprcodi = (case when coalesce(me.EMPRCODI, -1) > 0 then me.EMPRCODI else pto.emprcodi end)
      inner join si_fuenteenergia fe on pg.fenergcodi = fe.fenergcodi
      inner join si_tipogeneracion tg on fe.tgenercodi = tg.tgenercodi
      where
      me.tipoinfocodi = 1
      and me.lectcodi = 6
      and (emp.emprcodi in ({0}) or '{0}' = '-1')
      and (tg.tgenercodi in ({1}) or '{1}' = '-1')
      and (me.medifecha >= to_date('{2} 00:00:00','YYYY-MM-DD HH24:MI:SS') and me.medifecha &lt;= to_date('{3} 23:59:59','YYYY-MM-DD HH24:MI:SS'))
      order by me.medifecha asc, emp.emprnomb asc
    </query>
  </Sql>

  <Sql>
    <key>ObtenerEjecutadoConsolidado</key>
    <query>
      select emp.emprcodi, me.*,
      eq.equipadre, eq.equicodi,
      (select case when x.equicodi = 0 then eq.equinomb  when x.equicodi > 0 then x.equinomb end from eq_equipo x where x.equicodi = eq.equipadre) as central,
      eq.equinomb as equinomb, emp.emprnomb,
      fe.fenergcodi, fe.fenergnomb, fe.fenergabrev, tg.tgenernomb, tg.tgenercodi
      from me_medicion48 me
      inner join me_ptomedicion pto on me.ptomedicodi = pto.ptomedicodi
      inner join pr_grupo pg on pto.grupocodi = pg.grupocodi
      inner join eq_equipo eq on pto.equicodi = eq.equicodi
      inner join si_empresa emp on emp.emprcodi = (case when coalesce(me.EMPRCODI, -1) > 0 then me.EMPRCODI else pto.emprcodi end)
      inner join si_fuenteenergia fe on pg.fenergcodi = fe.fenergcodi
      inner join si_tipogeneracion tg on fe.tgenercodi = tg.tgenercodi
      where
      me.tipoinfocodi = 1
      and me.lectcodi = 6
      and (emp.emprcodi in ({0}) or '{0}' = '-1')
      and (fe.fenergcodi in ({1}) or '{1}' = '-1')
      and (me.medifecha >= to_date('{2} 00:00:00','YYYY-MM-DD HH24:MI:SS')
      and me.medifecha &lt;= to_date('{3} 23:59:59','YYYY-MM-DD HH24:MI:SS'))
      order by me.medifecha asc
    </query>
  </Sql>

  <Sql>
    <key>ObtenerCmgRealPorArea</key>
    <query>
      select
      case when m.ptomedicodi = 1197 then 'Centro'
      when m.ptomedicodi = 1201 then 'Cmgcp'
      when m.ptomedicodi = 1230 then 'Norte'
      when m.ptomedicodi = 1231 then 'Sur'
      else 'Nombre' end as descripcion,
      m.ptomedicodi,
      m.medifecha,
      m.tipoinfocodi,
      m.lectcodi,
      m.lastuser,
      m.lastdate,
      0 as meditotal,
      '' as mediestado,
      to_char(m.medifecha, 'YYYY/MM') as month,
      to_char(m.medifecha, 'YYYY') as year,
      m.h1, m.h2,m.h3, m.h4,m.h5, m.h6,m.h7, m.h8,m.h9, m.h10,
      m.h11, m.h12,m.h13, m.h14,m.h15, m.h16,m.h17, m.h18,m.h19, m.h20,
      m.h21, m.h22,m.h23, m.h24,m.h25, m.h26,m.h27, m.h28,m.h29, m.h30,
      m.h31, m.h32,m.h33, m.h34,m.h35, m.h36,m.h37, m.h38,m.h39, m.h40,
      m.h41, m.h42,m.h43, m.h44,m.h45, m.h46,m.h47, m.h48
      from me_medicion48 m
      inner join me_ptomedicion p on p.ptomedicodi = m.ptomedicodi
      where m.ptomedicodi in (1197, 1230, 1231) and m.lectcodi = 6 and m.tipoinfocodi = 7
      and m.medifecha between to_date('{0} 00:00:00', 'YYYY-MM-DD HH24:MI:SS')
      and to_date('{1} 23:59:59','YYYY-MM-DD HH24:MI:SS')
      order by 1, m.medifecha, m.ptomedicodi
    </query>
  </Sql>

  <Sql>
    <key>DeleteEnvioArchivo</key>
    <query>
      delete from me_medicion48 where lectcodi = {0} and medifecha >= to_date('{1}','YYYY-MM-DD') and
      medifecha &lt;= to_date('{2}','YYYY-MM-DD') and ('{4}'='-1' or emprcodi = {4}) and ptomedicodi in (
      --Puntos de medición de la empresa segun la fecha de inicio
      SELECT distinct ptomedicodi FROM
      (
      SELECT HP.HPTOCODI,vwpt.HPTDATFECHA ,hp.ptomedicodi, pto.PTOMEDIELENOMB
      , ROW_NUMBER() OVER(PARTITION BY HP.HPTOCODI ORDER BY HP.HPTOCODI,vwpt.HPTDATFECHA desc, vwpt.HPTDATPTOESTADO desc) AS NUM_VIEW
      ,vwpt.HPTDATPTOESTADO
      ,CASE WHEN vwpt.HPTDATPTOESTADO = 'F' THEN 0 ELSE HP.HPTOACTIVO END AS HPTOACTIVO
      from me_hojaptomed HP
      inner join ME_PTOMEDICION PTO ON PTO.PTOMEDICODI = HP.PTOMEDICODI
      inner join SI_HISEMPPTO_DATA vwpt on vwpt.HPTDATFECHA &lt;= TO_DATE('{1}','YYYY-MM-DD') and (vwpt.PTOMEDICODI = pto.PTOMEDICODI OR vwpt.PTOMEDICODIOLD = pto.PTOMEDICODI)
      WHERE hp.formatcodi = {3} and ('{4}'='-1' or vwpt.EMPRCODI = {4})
      )rview
      WHERE NUM_VIEW = 1
      )
    </query>
  </Sql>

  <Sql>
    <key>GetEnvioArchivo</key>
    <query>
      select (case when coalesce(me.EMPRCODI, -1) > 0 then me.EMPRCODI else pto.emprcodi end) as EMPRCODI, me.* from me_medicion48 me
      inner join me_hojaptomed hp on hp.ptomedicodi = me.ptomedicodi and hp.tipoinfocodi = me.tipoinfocodi
      inner join me_formato fh on fh.formatcodi = hp.formatcodi and (case when {4} > 0 then {4} else fh.lectcodi end) = me.lectcodi
      inner join me_ptomedicion pto on pto.ptomedicodi = hp.ptomedicodi
      inner join eq_equipo eq on eq.equicodi = pto.equicodi
      where hp.formatcodi = {0} and ( (case when coalesce(me.EMPRCODI, -1) > 0 then me.EMPRCODI else pto.emprcodi end) in ({1}) or '{1}' = '-1') and medifecha >= to_date('{2}','YYYY-MM-DD') AND
      medifecha &lt;= to_date('{3}','YYYY-MM-DD')
      order by hp.hptoorden asc
    </query>
  </Sql>

  <Sql>
    <key>GetEnvioArchivo2</key>
    <query>
      select me.*,hp.hojacodi from me_medicion48 me
      inner join(
      --Puntos de medición de la empresa segun la fecha de inicio
      SELECT distinct HPTOCODI, ptomedicodi, tipoinfocodi, formatcodi, lectcodi, hojacodi FROM
      (
      SELECT HP.HPTOCODI,vwpt.HPTDATFECHA ,hp.ptomedicodi, pto.PTOMEDIELENOMB, hp.tipoinfocodi,hoja.formatcodi,hoja.lectcodi,hoja.hojacodi
      , ROW_NUMBER() OVER(PARTITION BY HP.HPTOCODI ORDER BY HP.HPTOCODI,vwpt.HPTDATFECHA desc, vwpt.HPTDATPTOESTADO desc) AS NUM_VIEW
      ,vwpt.HPTDATPTOESTADO
      ,CASE WHEN vwpt.HPTDATPTOESTADO = 'F' THEN 0 ELSE HP.HPTOACTIVO END AS HPTOACTIVO
      from me_hojaptomed HP
      inner join me_hoja hoja on hoja.hojacodi = hp.hojacodi
      inner join ME_PTOMEDICION PTO ON PTO.PTOMEDICODI = HP.PTOMEDICODI
      inner join SI_HISEMPPTO_DATA vwpt on vwpt.HPTDATFECHA &lt;= TO_DATE('{3}','YYYY-MM-DD') and (vwpt.PTOMEDICODI = pto.PTOMEDICODI OR vwpt.PTOMEDICODIOLD = pto.PTOMEDICODI)
      WHERE hp.formatcodi = {0} and ( vwpt.emprcodi in ({1}) or '{1}' = '-1')
      )rview
      WHERE NUM_VIEW = 1
      )hp on hp.lectcodi = me.lectcodi and hp.ptomedicodi = me.ptomedicodi and hp.tipoinfocodi = me.tipoinfocodi
      where me.medifecha >= to_date('{2}','YYYY-MM-DD') AND me.medifecha &lt;= to_date('{3}','YYYY-MM-DD')
    </query>
  </Sql>

  <Sql>
    <key>GetByPtoMedicion</key>
    <query>
      select
      *
      from
      me_medicion48
      where
      ptomedicodi = {0}
    </query>
  </Sql>

  <Sql>
    <key>GetInterconexiones</key>
    <query>
      select
      empr.emprcodi, m48.*, tpto.tptomedinomb,eq.equinomb,ti.tipoinfoabrev,pto.codref barrcodi
      from
      me_medicion48 m48
      inner join me_ptomedicion pto on pto.ptomedicodi = m48.ptomedicodi
      inner join eq_equipo eq on eq.equicodi = pto.equicodi
      inner join me_tipoptomedicion tpto on tpto.tptomedicodi = pto.tptomedicodi
      inner join si_tipoinformacion ti on ti.tipoinfocodi = m48.tipoinfocodi
      inner join si_empresa empr on empr.emprcodi = (case when coalesce(m48.EMPRCODI, -1) > 0 then m48.EMPRCODI else pto.emprcodi end)
      where m48.lectcodi = {0} and pto.origlectcodi ={1} and
      pto.ptomedicodi in ({2}) and
      m48.medifecha >= to_date('{3}','YYYY-MM-DD') AND
      m48.medifecha &lt;= to_date('{4}','YYYY-MM-DD')
      ORDER BY m48.medifecha asc
    </query>
  </Sql>

  <Sql>
    <key>ObtenerGeneracionPorEmpresa</key>
    <query>
      select
      empresa.emprnomb,
      medicion.medifecha,
      round(sum(medicion.meditotal)/2,2) as meditotal
      from me_medicion48 medicion
      inner join me_ptomedicion punto on medicion.ptomedicodi = punto.ptomedicodi
      inner join pr_grupo grupo on punto.codref = grupo.grupocodi
      inner join si_empresa empresa on empresa.emprcodi = (case when coalesce(medicion.EMPRCODI, -1) > 0 then medicion.EMPRCODI else punto.emprcodi end)
      where
      medicion.lectcodi = 6 and
      medicion.tipoinfocodi = 1 and
      empresa.emprcodi not in (0,-1) and
      medicion.medifecha between to_date('{0}','YYYY-MM-DD') and to_date('{1}','YYYY-MM-DD')
      group by empresa.emprnomb, medicion.medifecha
      order by 3 desc
    </query>
  </Sql>

  <Sql>
    <key>ObtenerGeneracionPorEmpresaTipoGeneracion</key>
    <query>
		select
		empresa.emprcodi,
		empresa.emprabrev,
		empresa.emprnomb,
		tipo.TGENERCOLOR as TGENERCOLOR,
		tipo.tgenernomb as tgenernomb,
		medicion.medifecha,
		round(sum(medicion.meditotal)/2,2) as meditotal
		from me_medicion48 medicion
		inner join me_ptomedicion punto on medicion.ptomedicodi = punto.ptomedicodi
		inner join pr_grupo grupo on punto.codref = grupo.grupocodi
		inner join si_empresa empresa on empresa.emprcodi = (case when coalesce(medicion.EMPRCODI, -1) > 0 then medicion.EMPRCODI else punto.emprcodi end)
		inner join si_fuenteenergia fuente on grupo.fenergcodi = fuente.fenergcodi
		inner join si_tipogeneracion tipo on fuente.tgenercodi = tipo.tgenercodi
		where
		medicion.lectcodi = 6 and
		medicion.tipoinfocodi = 1 and
		empresa.emprcodi not in (0, -1) and
		medicion.medifecha between to_date('{0}','YYYY-MM-DD') and to_date('{1}','YYYY-MM-DD')
		group by
		empresa.emprcodi, empresa.emprabrev, empresa.emprnomb,tipo.TGENERCOLOR,
		tipo.tgenernomb, medicion.medifecha
		order by empresa.emprnomb
	</query>
  </Sql>

  <Sql>
    <key>ObtenerGeneracionPorEmpresaTipoGeneracionMovil</key>
    <query>
		select
		empresa.emprcodi,
		empresa.emprabrev,
		empresa.emprnomb,
		tipo.TGENERCOLOR as TGENERCOLOR,
		tipo.tgenernomb as tgenernomb,
		tipo.tgenercodi as tgenercodi,
		fuente.fenergcodi,
		fuente.fenergnomb,
		fuente.fenercolor,
		grupo.tipogenerrer,
		medicion.medifecha,
		round(sum(medicion.meditotal)/2,2) as meditotal
		from me_medicion48 medicion
		inner join me_ptomedicion punto on medicion.ptomedicodi = punto.ptomedicodi
		inner join pr_grupo grupo on punto.codref = grupo.grupocodi
		inner join si_empresa empresa on empresa.emprcodi = (case when coalesce(medicion.EMPRCODI, -1) > 0 then medicion.EMPRCODI else punto.emprcodi end)
		inner join si_fuenteenergia fuente on grupo.fenergcodi = fuente.fenergcodi
		inner join si_tipogeneracion tipo on fuente.tgenercodi = tipo.tgenercodi
		where
		medicion.lectcodi = 6 and
		medicion.tipoinfocodi = 1 and
		empresa.emprcodi not in (0, -1) and
		medicion.medifecha between to_date('{0}','YYYY-MM-DD') and to_date('{1}','YYYY-MM-DD') and
		grupo.grupointegrante = 'S'
		group by
		empresa.emprcodi, empresa.emprabrev, empresa.emprnomb,tipo.TGENERCOLOR,
		tipo.tgenernomb, tipo.tgenercodi,fuente.fenergcodi,fuente.fenergnomb,fuente.fenercolor ,grupo.tipogenerrer, medicion.medifecha
		order by empresa.emprnomb
	</query>
  </Sql>

  <Sql>
    <key>ObtenerGeneracionAcumuladaAnual</key>
    <query>
      select
      sum(medicion.meditotal) as meditotal
      from me_medicion48 medicion
      inner join me_ptomedicion punto on medicion.ptomedicodi = punto.ptomedicodi
      inner join pr_grupo grupo on punto.codref = grupo.grupocodi
      inner join si_empresa empresa on empresa.emprcodi = (case when coalesce(medicion.EMPRCODI, -1) > 0 then medicion.EMPRCODI else punto.emprcodi end)
      where
      medicion.lectcodi = 6 and
      medicion.tipoinfocodi = 1 and
      medicion.medifecha >= to_date('{0}-01-01 00:00:00','YYYY-MM-DD HH24:MI:SS') and
      medicion.medifecha &lt;= to_date('{1} 23:59:59','YYYY-MM-DD HH24:MI:SS')
    </query>
  </Sql>

  <Sql>
    <key>DemandaProgramadaxAreas</key>
    <query>
      select me_ptomedicion.ptomedidesc,me_ptomedicion.ptomedicodi,m.medifecha, m.H1, m.H2,m.H3, m.H4,m.H5, m.H6,m.H7, m.H8,m.H9, m.H10,
      m.H11, m.H12,m.H13, m.H14,m.H15, m.H16,m.H17, m.H18,m.H19, m.H20,
      m.H21, m.H22,m.H23, m.H24,m.H25, m.H26,m.H27, m.H28,m.H29, m.H30,
      m.H31, m.H32,m.H33, m.H34,m.H35, m.H36,m.H37, m.H38,m.H39, m.H40,
      m.H41, m.H42,m.H43, m.H44,m.H45, m.H46,m.H47, m.H48
      from me_medicion48 m inner join me_ptomedicion on (me_ptomedicion.ptomedicodi=m.PTOMEDICODI)
      where m.ptomedicodi in (1210,1211,1212,1213,1214) and m.lectcodi=4 and m.tipoinfocodi=20 and m.MEDIFECHA =  TO_DATE('{0}','YYYY-MM-DD')
    </query>
  </Sql>

  <Sql>
    <key>LeerMedidoresHidrologia</key>
    <query>
      select a.ptomedicodi,a.tipoinfocodi,a.h1,a.h2,a.h3,a.h4,a.h5,a.h6,a.h7,a.h8,a.h9,a.h10,a.h11,a.h12,a.h13,a.h14,a.h15,a.h16,a.h17,a.h18,a.h19,a.h20,a.h21,a.h22,a.h23,a.h24,a.h25,a.h26,a.h27,a.h28,a.h29,a.h30,a.h31,a.h32,a.h33,a.h34,a.h35,a.h36,a.h37,a.h38,a.h39,a.h40,a.h41,a.h42,a.h43,a.h44,a.h45,a.h46,a.h47,a.h48
      from me_medicion48 a, me_ptomedicion b
      where a.ptomedicodi = b.ptomedicodi and a.tipoinfocodi in (11,13,19) and a.lectcodi = 6 and a.medifecha = TO_DATE('{0}','YYYY-MM-DD') and b.origlectcodi = 2 and b.tipoinfocodi in (11,13,19)
      order by a.ptomedicodi asc,a.tipoinfocodi asc
    </query>
  </Sql>

  

  <Sql>
    <key>LeerDemandaAreas</key>
    <query>    

      select a.medifecha,a.ptomedicodi,a.h1,a.h2,a.h3,a.h4,a.h5,a.h6,a.h7,a.h8,a.h9,a.h10,a.h11,a.h12,a.h13,a.h14,a.h15,a.h16,a.h17,a.h18,a.h19,a.h20,a.h21,a.h22,a.h23,a.h24,a.h25,a.h26,a.h27,a.h28,a.h29,a.h30,a.h31,a.h32,a.h33,a.h34,a.h35,a.h36,a.h37,a.h38,a.h39,a.h40,a.h41,a.h42,a.h43,a.h44,a.h45,a.h46,a.h47,a.h48
      from me_medicion48 a
      where a.ptomedicodi in (3004,3005,3006) and a.medifecha = TO_DATE('{0}','YYYY-MM-DD')
      order by a.ptomedicodi asc
    </query>
  </Sql>

  <Sql>
    <key>DemandaProgramadaDiariaCOES</key>
    <query>
      SELECT
      me_ptomedicion.ptomedidesc,me_ptomedicion.ptomedicodi,m.medifecha, m.H1, m.H2,m.H3, m.H4,m.H5, m.H6,m.H7, m.H8,m.H9, m.H10,
      m.H11, m.H12,m.H13, m.H14,m.H15, m.H16,m.H17, m.H18,m.H19, m.H20,
      m.H21, m.H22,m.H23, m.H24,m.H25, m.H26,m.H27, m.H28,m.H29, m.H30,
      m.H31, m.H32,m.H33, m.H34,m.H35, m.H36,m.H37, m.H38,m.H39, m.H40,
      m.H41, m.H42,m.H43, m.H44,m.H45, m.H46,m.H47, m.H48
      FROM
      ME_MEDICION48 m,
      ME_PTOMEDICION,
      PR_GRUPO
      WHERE LECTCODI=4 AND
      MEDIFECHA = TO_DATE('{0}','YYYY-MM-DD') AND
      m.Ptomedicodi=ME_PTOMEDICION.PTOMEDICODI AND
      ME_PTOMEDICION.ORIGLECTCODI=2 AND
      PR_GRUPO.GRUPOCODI=ME_PTOMEDICION.GRUPOCODI AND
      m.TIPOINFOCODI IN (1) and
      PR_GRUPO.Tipogrupocodi not in (10)
      ORDER BY m.MEDIFECHA,m.PTOMEDICODI
    </query>
  </Sql>

  <Sql>
    <key>ObtenerConsultaWebReporte</key>
    <query>
      select
      medicion.medifecha,
      empresa.emprcodi,
      empresa.emprnomb,
      grupo.grupocodi,
      grupo.gruponomb,
      tipo.tgenercodi,
      tipo.tgenernomb,
      fuente.fenergcodi,
      fuente.fenergnomb,
      round(sum(medicion.meditotal)/2,2) as meditotal
      from me_medicion48 medicion
      inner join me_ptomedicion punto on medicion.ptomedicodi = punto.ptomedicodi
      inner join pr_grupo grupo on punto.codref = grupo.grupocodi
      inner join si_empresa empresa on empresa.emprcodi = (case when coalesce(medicion.EMPRCODI, -1) > 0 then medicion.EMPRCODI else punto.emprcodi end)
      inner join si_fuenteenergia fuente on grupo.fenergcodi = fuente.fenergcodi
      inner join si_tipogeneracion tipo on fuente.tgenercodi = tipo.tgenercodi
      where
      medicion.medifecha between to_date('{0}','YYYY-MM-DD') and to_date('{1}','YYYY-MM-DD') and
      medicion.lectcodi = 6 and
      medicion.tipoinfocodi = 1 and
      empresa.emprcodi not in (0, -1)
      group by
      medicion.medifecha,
      empresa.emprcodi,
      empresa.emprnomb,
      grupo.grupocodi,
      grupo.gruponomb,
      tipo.tgenercodi,
      tipo.tgenernomb,
      fuente.fenergcodi,
      fuente.fenergnomb
      order by
      medicion.medifecha asc,
      empresa.emprnomb asc,
      grupo.gruponomb asc,
      tipo.tgenernomb asc,
      fuente.fenergnomb asc
    </query>
  </Sql>

  <Sql>
    <key>DemandaDespachoOfertaNCP</key>
    <query>
      select
      me.medifecha,
      me.lectcodi,
      sum(meditotal) as meditotal,
      sum(h1) as h1, sum(h2) as h2, sum(h3) as h3, sum(h4) as h4,
      sum(h5) as h5, sum(h6) as h6, sum(h7) as h7, sum(h8) as h8,
      sum(h9) as h9, sum(h10) as h10, sum(h11) as h11, sum(h12) as h12,
      sum(h13) as h13, sum(h14) as h14, sum(h15) as h15, sum(h16) as h16,
      sum(h17) as h17, sum(h18) as h18, sum(h19) as h19, sum(h20) as h20,
      sum(h21) as h21, sum(h22) as h22, sum(h23) as h23, sum(h24) as h24,
      sum(h25) as h25, sum(h26) as h26, sum(h27) as h27, sum(h28) as h28,
      sum(h29) as h29, sum(h30) as h30, sum(h31) as h31, sum(h32) as h32,
      sum(h33) as h33, sum(h34) as h34, sum(h35) as h35, sum(h36) as h36,
      sum(h37) as h37, sum(h38) as h38, sum(h39) as h39, sum(h40) as h40,
      sum(h41) as h41, sum(h42) as h42, sum(h43) as h43, sum(h44) as h44,
      sum(h45) as h45, sum(h46) as h46, sum(h47) as h47, sum(h48) as h48
      from me_medicion48 me
      inner join me_ptomedicion pto on me.ptomedicodi = pto.ptomedicodi
      inner join pr_grupo gr on pto.grupocodi = gr.grupocodi
      where
      me.medifecha >= to_date('{0}','YYYY-MM-DD') and
      me.medifecha &lt;= to_date('{1}','YYYY-MM-DD') and
		me.tipoinfocodi = 1 and
		me.lectcodi in (3,4, 5,6) and
		pto.origlectcodi = 2 and
		(gr.catecodi = 3 or gr.catecodi = 5 or gr.catecodi = 15 or gr.catecodi = 17) --and
		--gr.grupoactivo = 'S' and
		--gr.tipogrupocodi != 10
		--gr.grupointegrante !='N'
		group by me.medifecha, me.lectcodi
		order by me.medifecha asc
	</query>
  </Sql>

  <Sql>
    <key>ObtenerDemandaPortalWebTipo</key>
    <query>
      select
      me.medifecha,
      me.lectcodi,
      tg.TGENERCODI,
      tg.TGENERNOMB,
      sum(meditotal) as meditotal,
      sum(h1) as h1, sum(h2) as h2, sum(h3) as h3, sum(h4) as h4,
      sum(h5) as h5, sum(h6) as h6, sum(h7) as h7, sum(h8) as h8,
      sum(h9) as h9, sum(h10) as h10, sum(h11) as h11, sum(h12) as h12,
      sum(h13) as h13, sum(h14) as h14, sum(h15) as h15, sum(h16) as h16,
      sum(h17) as h17, sum(h18) as h18, sum(h19) as h19, sum(h20) as h20,
      sum(h21) as h21, sum(h22) as h22, sum(h23) as h23, sum(h24) as h24,
      sum(h25) as h25, sum(h26) as h26, sum(h27) as h27, sum(h28) as h28,
      sum(h29) as h29, sum(h30) as h30, sum(h31) as h31, sum(h32) as h32,
      sum(h33) as h33, sum(h34) as h34, sum(h35) as h35, sum(h36) as h36,
      sum(h37) as h37, sum(h38) as h38, sum(h39) as h39, sum(h40) as h40,
      sum(h41) as h41, sum(h42) as h42, sum(h43) as h43, sum(h44) as h44,
      sum(h45) as h45, sum(h46) as h46, sum(h47) as h47, sum(h48) as h48
      from me_medicion48 me
      inner join me_ptomedicion pto on me.ptomedicodi = pto.ptomedicodi
      inner join pr_grupo gr on pto.grupocodi = gr.grupocodi
      inner join si_fuenteenergia fe on gr.fenergcodi = fe.fenergcodi
      inner join si_tipogeneracion tg on fe.tgenercodi = tg.tgenercodi
      where
      me.medifecha >= to_date('{1}','YYYY-MM-DD') and
      me.medifecha &lt;= to_date('{2}','YYYY-MM-DD') and
      me.tipoinfocodi = 1 and
      me.lectcodi = {0} and
      pto.origlectcodi = 2 and
      (gr.catecodi = 3 or gr.catecodi = 5)
      group by me.medifecha, me.lectcodi, tg.tgenercodi, tg.tgenernomb
      order by me.medifecha asc
    </query>
  </Sql>

  <Sql>
    <key>ObtenerDemandaPicoDiaAnterior</key>
    <query>
      select
      me.medifecha,
      me.lectcodi,
      greatest (
      sum(h1)  , sum(h2)  , sum(h3)  , sum(h4) ,
      sum(h5)  , sum(h6)  , sum(h7)  , sum(h8) ,
      sum(h9)  , sum(h10) , sum(h11) , sum(h12),
      sum(h13) , sum(h14) , sum(h15) , sum(h16),
      sum(h17) , sum(h18) , sum(h19) , sum(h20),
      sum(h21) , sum(h22) , sum(h23) , sum(h24),
      sum(h25) , sum(h26) , sum(h27) , sum(h28),
      sum(h29) , sum(h30) , sum(h31) , sum(h32),
      sum(h33) , sum(h34) , sum(h35) , sum(h36),
      sum(h37) , sum(h38) , sum(h39) , sum(h40),
      sum(h41) , sum(h42) , sum(h43) , sum(h44),
      sum(h45) , sum(h46) , sum(h47) , sum(h48) ) as h1
      from me_medicion48 me
      inner join me_ptomedicion pto on me.ptomedicodi = pto.ptomedicodi
      inner join pr_grupo gr on pto.grupocodi = gr.grupocodi
      where
      me.medifecha >= to_date('{0}','YYYY-MM-DD') and
      me.medifecha &lt;= to_date('{1}','YYYY-MM-DD') and
      me.tipoinfocodi = 1 and
      me.lectcodi = 6 and
      pto.origlectcodi = 2 and
      (gr.catecodi = 3 or gr.catecodi = 5) --and
      --gr.grupoactivo = 'S' and
      --gr.tipogrupocodi != 10
      group by me.medifecha, me.lectcodi
      order by me.medifecha asc
    </query>
  </Sql>

  <Sql>
    <key>ObtenerConsultaDemandaBarras</key>
    <query>
      select
      empresa.emprcodi,
      medicion.*,
      punto.ptomedicodi,
      equipo.equicodi,
      equipo.equinomb,
      barra.equitension,
      equipo.areacodi,
      empresa.emprnomb,
      (select area.areanomb from eq_area area where area.areacodi = equipo.areacodi) as areanomb
      from
      me_medicion48 medicion
      inner join me_ptomedicion punto on medicion.ptomedicodi = punto.ptomedicodi
      inner join eq_equipo equipo on punto.equicodi = equipo.equicodi
      inner join si_empresa empresa on empresa.emprcodi = (case when coalesce(medicion.EMPRCODI, -1) > 0 then medicion.EMPRCODI else punto.emprcodi end)
      inner join eq_equipo barra on barra.equicodi = punto.codref
      where punto.origlectcodi = 6
      and medicion.lectcodi = {0}
      and medicion.tipoinfocodi &lt;> 2
      --and punto.ptomedicodi > 20000
      and (empresa.emprcodi in ({1}) or '{1}' = '-1')
      and medifecha between to_date('{2} 00:00:00','YYYY-MM-DD HH24:MI:SS') and to_date('{3} 23:59:59','YYYY-MM-DD HH24:MI:SS')
    </query>
  </Sql>

  <Sql>
    <key>ObtenerDatosHidrologiaPortal</key>
    <query>
      select e.emprcodi, pto.ptomedicodi,
      pto.ptomedielenomb as ptomedinomb,
      pto.ptomedidesc,
      e.emprnomb,
      ti.tipoinfodesc,
      m48.*
      from me_medicion48 m48
      inner join me_ptomedicion pto on pto.ptomedicodi = m48.ptomedicodi
      inner join si_empresa e on e.emprcodi = (case when coalesce(m48.EMPRCODI, -1) > 0 then m48.EMPRCODI else pto.emprcodi end)
      inner join si_tipoinformacion ti on ti.tipoinfocodi = pto.tipoinfocodi
      where
      m48.lectcodi = 6 and
      m48.medifecha >= to_date('{0}','YYYY-MM-DD') and
      m48.medifecha &lt;= to_date('{1}','YYYY-MM-DD') and
      m48.ptomedicodi in (2001,2003,2012,2021,2022,2027,2028,2029,2030,2031,2040,2041,2047,2054,2059,2064,2067,2069,2070)
      order by m48.ptomedicodi
    </query>
  </Sql>

  <Sql>
    <key>ObtenerDatosEjecutado</key>
    <query>
      SELECT pg.Gruponomb, pg.Grupocodi,m48.* FROM ME_MEDICION48 m48
      inner join me_ptomedicion pto on m48.ptomedicodi = pto.ptomedicodi
      inner join pr_grupo pg on pg.grupocodi = pto.grupocodi
      WHERE medifecha = to_date('{0}','YYYY-MM-DD') and lectcodi = 6 and m48.tipoinfocodi = 1
    </query>
  </Sql>
  <!--pr16.JDEL - Inicio 07/09/2016: Cambio para atender el requerimiento.-->
  <Sql>
    <key>ListReporteInformacion30min</key>
    <query>
      <!--- 	
	      + Nombre: 
		      Consulta para obtener la información a nive de detalle de 30 minutos. 
	      + Descripción:
		      Esta consulta atiende el requerimiento de información del reporte "Reporte de Información de medidores de energía de Usuarios y Empresas 
	      de distribución" cuyo objetivo es informar al usuario interno del COES sobre la información cargada agrupando las mediciones cada 30 minutos.
	      La consulta atiende las opciones para los Usuarios Libres y para las Empresas de Distribución.
	
	      + Caso especial:
		      La consulta debe asegurar que se muestre el detalle de la información por cada mes. En caso la empresa no hubiese remitido información alguna
	      para un mes determinado se tiene:
	
	      a) Para las Empresas de Distribución. 
	         Se debe buscar la información anterior más reciente remitida por la empresa. 
	      b) Para los Usuarios Libres:
	         Se debe buscar la información anterior más reciente obtenida a través del Osinergmin (Proyecto Alpha). 
      -->
      SELECT exte.*
      FROM (
      SELECT ROWNUM AS ITEM, inte.*
      FROM (
      SELECT pees.PERIODO AS PERIODO
      , CASE
      WHEN medi.MEDIFECHA IS NULL THEN
      CASE
      WHEN tiem.TIPOEMPRCODI = 2 THEN
      CASE
      WHEN median.MEDIFECHA IS NULL THEN
      '[Sin datos PR16]'
      ELSE
      'PR16: ' || TO_CHAR(median.MEDIFECHA, 'MM YYYY')
      END
      WHEN tiem.TIPOEMPRCODI = 4 THEN
      CASE
      WHEN median.MEDIFECHA IS NULL THEN
      '[Sin datos Sicli ' || pesic.PSICLIANIOMESPERREM || ']'
      ELSE
      'Sicli ' || pesic.PSICLIANIOMESPERREM || ': ' || TO_CHAR(median.MEDIFECHA, 'MM YYYY')
      END
      ELSE
      NULL
      END
      ELSE
      pees.PERIODO
      END AS FUENTE
      , pees.FECHA_FILA
      , CASE
      WHEN ulenv.ENVIOFECHA_MAX BETWEEN pees.INI_REMISION AND pees.FIN_REMISION THEN
      '1'
      WHEN ulenv.ENVIOFECHA_MAX > pees.FIN_REMISION THEN
      '2'
      WHEN pees.INI_REMISION > ulenv.ENVIOFECHA_MAX THEN
      '3'
      WHEN ulenv.ENVIOFECHA_MAX IS NULL THEN
      '4'
      ELSE
      '5'
      END AS CUMPLIMIENTO
      , eqp.OSINERGCODI AS CODIGO_CLIENTE
      , NVL(mrem.EMPRRAZSOCIAL, ' - SIN RAZON SOCIAL - ') AS SUMINISTRADOR
      , empr.EMPRCODI
      , empr.EMPRRUC AS RUC_EMPRESA
      , NVL(empr.EMPRRAZSOCIAL, ' - SIN RAZON SOCIAL - ') AS NOMBRE_EMPRESA
      ,CASE empr.TIPOEMPRCODI
      WHEN 2 THEN
      'ED - SEIN'
      WHEN 4 THEN
      ara.AREANOMB
      END AS SUBESTACION
      , CASE empr.TIPOEMPRCODI
      WHEN 2 THEN
      'ED - SEIN'
      WHEN 4 THEN
      TRIM(TO_CHAR(eqp.EQUITENSION, '99,999.99'))
      END AS TENSION
      , CASE
      WHEN medi.MEDIFECHA IS NULL THEN NVL(median.H1, 0) + NVL(median.H2, 0)
      ELSE NVL(medi.H1, 0) + NVL(medi.H2, 0)
      END AS H1
      , CASE
      WHEN medi.MEDIFECHA IS NULL THEN NVL(median.H3, 0) + NVL(median.H4, 0)
      ELSE NVL(medi.H3, 0) + NVL(medi.H4, 0)
      END AS H2
      , CASE
      WHEN medi.MEDIFECHA IS NULL THEN NVL(median.H5, 0) + NVL(median.H6, 0)
      ELSE NVL(medi.H5, 0) + NVL(medi.H6, 0)
      END AS H3
      , CASE
      WHEN medi.MEDIFECHA IS NULL THEN NVL(median.H7, 0) + NVL(median.H8, 0)
      ELSE NVL(medi.H7, 0) + NVL(medi.H8, 0)
      END AS H4
      , CASE
      WHEN medi.MEDIFECHA IS NULL THEN NVL(median.H9, 0) + NVL(median.H10, 0)
      ELSE NVL(medi.H9, 0) + NVL(medi.H10, 0)
      END AS H5
      , CASE
      WHEN medi.MEDIFECHA IS NULL THEN NVL(median.H11, 0) + NVL(median.H12, 0)
      ELSE NVL(medi.H11, 0) + NVL(medi.H12, 0)
      END AS H6
      , CASE
      WHEN medi.MEDIFECHA IS NULL THEN NVL(median.H13, 0) + NVL(median.H14, 0)
      ELSE NVL(medi.H13, 0) + NVL(medi.H14, 0)
      END AS H7
      , CASE
      WHEN medi.MEDIFECHA IS NULL THEN NVL(median.H15, 0) + NVL(median.H16, 0)
      ELSE NVL(medi.H15, 0) + NVL(medi.H16, 0)
      END AS H8
      , CASE
      WHEN medi.MEDIFECHA IS NULL THEN NVL(median.H17, 0) + NVL(median.H18, 0)
      ELSE NVL(medi.H17, 0) + NVL(medi.H18, 0)
      END AS H9
      , CASE
      WHEN medi.MEDIFECHA IS NULL THEN NVL(median.H19, 0) + NVL(median.H20, 0)
      ELSE NVL(medi.H19, 0) + NVL(medi.H20, 0)
      END AS H10
      , CASE
      WHEN medi.MEDIFECHA IS NULL THEN NVL(median.H21, 0) + NVL(median.H22, 0)
      ELSE NVL(medi.H21, 0) + NVL(medi.H22, 0)
      END AS H11
      , CASE
      WHEN medi.MEDIFECHA IS NULL THEN NVL(median.H23, 0) + NVL(median.H24, 0)
      ELSE NVL(medi.H23, 0) + NVL(medi.H24, 0)
      END AS H12
      , CASE
      WHEN medi.MEDIFECHA IS NULL THEN NVL(median.H25, 0) + NVL(median.H26, 0)
      ELSE NVL(medi.H25, 0) + NVL(medi.H26, 0)
      END AS H13
      , CASE
      WHEN medi.MEDIFECHA IS NULL THEN NVL(median.H27, 0) + NVL(median.H28, 0)
      ELSE NVL(medi.H27, 0) + NVL(medi.H28, 0)
      END AS H14
      , CASE
      WHEN medi.MEDIFECHA IS NULL THEN NVL(median.H29, 0) + NVL(median.H30, 0)
      ELSE NVL(medi.H29, 0) + NVL(medi.H30, 0)
      END AS H15
      , CASE
      WHEN medi.MEDIFECHA IS NULL THEN NVL(median.H31, 0) + NVL(median.H32, 0)
      ELSE NVL(medi.H31, 0) + NVL(medi.H32, 0)
      END AS H16
      , CASE
      WHEN medi.MEDIFECHA IS NULL THEN NVL(median.H33, 0) + NVL(median.H34, 0)
      ELSE NVL(medi.H33, 0) + NVL(medi.H34, 0)
      END AS H17
      , CASE
      WHEN medi.MEDIFECHA IS NULL THEN NVL(median.H35, 0) + NVL(median.H36, 0)
      ELSE NVL(medi.H35, 0) + NVL(medi.H36, 0)
      END AS H18
      , CASE
      WHEN medi.MEDIFECHA IS NULL THEN NVL(median.H37, 0) + NVL(median.H38, 0)
      ELSE NVL(medi.H37, 0) + NVL(medi.H38, 0)
      END AS H19
      , CASE
      WHEN medi.MEDIFECHA IS NULL THEN NVL(median.H39, 0) + NVL(median.H40, 0)
      ELSE NVL(medi.H39, 0) + NVL(medi.H40, 0)
      END AS H20
      , CASE
      WHEN medi.MEDIFECHA IS NULL THEN NVL(median.H41, 0) + NVL(median.H42, 0)
      ELSE NVL(medi.H41, 0) + NVL(medi.H42, 0)
      END AS H21
      , CASE
      WHEN medi.MEDIFECHA IS NULL THEN NVL(median.H43, 0) + NVL(median.H44, 0)
      ELSE NVL(medi.H43, 0) + NVL(medi.H44, 0)
      END AS H22
      , CASE
      WHEN medi.MEDIFECHA IS NULL THEN NVL(median.H45, 0) + NVL(median.H46, 0)
      ELSE NVL(medi.H45, 0) + NVL(medi.H46, 0)
      END AS H23
      , CASE
      WHEN medi.MEDIFECHA IS NULL THEN NVL(median.H47, 0) + NVL(median.H48, 0)
      ELSE NVL(medi.H47, 0) + NVL(medi.H48, 0)
      END AS H24
      , CASE
      WHEN medi.MEDIFECHA IS NULL THEN NVL(median.H49, 0) + NVL(median.H50, 0)
      ELSE NVL(medi.H49, 0) + NVL(medi.H50, 0)
      END AS H25
      , CASE
      WHEN medi.MEDIFECHA IS NULL THEN NVL(median.H51, 0) + NVL(median.H52, 0)
      ELSE NVL(medi.H51, 0) + NVL(medi.H52, 0)
      END AS H26
      , CASE
      WHEN medi.MEDIFECHA IS NULL THEN NVL(median.H53, 0) + NVL(median.H54, 0)
      ELSE NVL(medi.H53, 0) + NVL(medi.H54, 0)
      END AS H27
      , CASE
      WHEN medi.MEDIFECHA IS NULL THEN NVL(median.H55, 0) + NVL(median.H56, 0)
      ELSE NVL(medi.H55, 0) + NVL(medi.H56, 0)
      END AS H28
      , CASE
      WHEN medi.MEDIFECHA IS NULL THEN NVL(median.H57, 0) + NVL(median.H58, 0)
      ELSE NVL(medi.H57, 0) + NVL(medi.H58, 0)
      END AS H29
      , CASE
      WHEN medi.MEDIFECHA IS NULL THEN NVL(median.H59, 0) + NVL(median.H60, 0)
      ELSE NVL(medi.H59, 0) + NVL(medi.H60, 0)
      END AS H30
      , CASE
      WHEN medi.MEDIFECHA IS NULL THEN NVL(median.H61, 0) + NVL(median.H62, 0)
      ELSE NVL(medi.H61, 0) + NVL(medi.H62, 0)
      END AS H31
      , CASE
      WHEN medi.MEDIFECHA IS NULL THEN NVL(median.H63, 0) + NVL(median.H64, 0)
      ELSE NVL(medi.H63, 0) + NVL(medi.H64, 0)
      END AS H32
      , CASE
      WHEN medi.MEDIFECHA IS NULL THEN NVL(median.H65, 0) + NVL(median.H66, 0)
      ELSE NVL(medi.H65, 0) + NVL(medi.H66, 0)
      END AS H33
      , CASE
      WHEN medi.MEDIFECHA IS NULL THEN NVL(median.H67, 0) + NVL(median.H68, 0)
      ELSE NVL(medi.H67, 0) + NVL(medi.H68, 0)
      END AS H34
      , CASE
      WHEN medi.MEDIFECHA IS NULL THEN NVL(median.H69, 0) + NVL(median.H70, 0)
      ELSE NVL(medi.H69, 0) + NVL(medi.H70, 0)
      END AS H35
      , CASE
      WHEN medi.MEDIFECHA IS NULL THEN NVL(median.H71, 0) + NVL(median.H72, 0)
      ELSE NVL(medi.H71, 0) + NVL(medi.H72, 0)
      END AS H36
      , CASE
      WHEN medi.MEDIFECHA IS NULL THEN NVL(median.H73, 0) + NVL(median.H74, 0)
      ELSE NVL(medi.H73, 0) + NVL(medi.H74, 0)
      END AS H37
      , CASE
      WHEN medi.MEDIFECHA IS NULL THEN NVL(median.H75, 0) + NVL(median.H76, 0)
      ELSE NVL(medi.H75, 0) + NVL(medi.H76, 0)
      END AS H38
      , CASE
      WHEN medi.MEDIFECHA IS NULL THEN NVL(median.H77, 0) + NVL(median.H78, 0)
      ELSE NVL(medi.H77, 0) + NVL(medi.H78, 0)
      END AS H39
      , CASE
      WHEN medi.MEDIFECHA IS NULL THEN NVL(median.H79, 0) + NVL(median.H80, 0)
      ELSE NVL(medi.H79, 0) + NVL(medi.H80, 0)
      END AS H40
      , CASE
      WHEN medi.MEDIFECHA IS NULL THEN NVL(median.H81, 0) + NVL(median.H82, 0)
      ELSE NVL(medi.H81, 0) + NVL(medi.H82, 0)
      END AS H41
      , CASE
      WHEN medi.MEDIFECHA IS NULL THEN NVL(median.H83, 0) + NVL(median.H84, 0)
      ELSE NVL(medi.H83, 0) + NVL(medi.H84, 0)
      END AS H42
      , CASE
      WHEN medi.MEDIFECHA IS NULL THEN NVL(median.H85, 0) + NVL(median.H86, 0)
      ELSE NVL(medi.H85, 0) + NVL(medi.H86, 0)
      END AS H43
      , CASE
      WHEN medi.MEDIFECHA IS NULL THEN NVL(median.H87, 0) + NVL(median.H88, 0)
      ELSE NVL(medi.H87, 0) + NVL(medi.H88, 0)
      END AS H44
      , CASE
      WHEN medi.MEDIFECHA IS NULL THEN NVL(median.H89, 0) + NVL(median.H90, 0)
      ELSE NVL(medi.H89, 0) + NVL(medi.H90, 0)
      END AS H45
      , CASE
      WHEN medi.MEDIFECHA IS NULL THEN NVL(median.H91, 0) + NVL(median.H92, 0)
      ELSE NVL(medi.H91, 0) + NVL(medi.H92, 0)
      END AS H46
      , CASE
      WHEN medi.MEDIFECHA IS NULL THEN NVL(median.H93, 0) + NVL(median.H94, 0)
      ELSE NVL(medi.H93, 0) + NVL(medi.H94, 0)
      END AS H47
      , CASE
      WHEN medi.MEDIFECHA IS NULL THEN NVL(median.H95, 0) + NVL(median.H96, 0)
      ELSE NVL(medi.H95, 0) + NVL(medi.H96, 0)
      END AS H48
      , ulenv.ENVIOCODI_CONT AS NRO_ENVIOS
      , ulenv.ENVIOFECHA_MIN AS FECHA_PRIMER_ENVIO
      , ulenv.ENVIOFECHA_MAX AS FECHA_ULTIMO_ENVIO
      , pees.INI_REMISION
      , pees.FIN_REMISION
      , pees.INI_PERIODO
      FROM (

      SELECT TO_CHAR(P.FECHA,'MM YYYY') AS PERIODO, TO_DATE('{5}','DD/MM/YYYY') AS INI_PERIODO
      ,ADD_MONTHS(TO_DATE('{5}','DD/MM/YYYY'),F.FORMATMESPLAZO)+F.FORMATDIAPLAZO+F.FORMATMINPLAZO/(24*60) AS INI_REMISION
      ,ADD_MONTHS(TO_DATE('{5}','DD/MM/YYYY'),F.FORMATMESFINPLAZO)+F.FORMATDIAFINPLAZO+F.FORMATMINFINPLAZO/(24*60) AS FIN_REMISION
      ,P.FECHA AS FECHA_FILA
      FROM ME_FORMATO F ,(SELECT TO_DATE('{5}','DD/MM/YYYY')+ROWNUM-1 AS FECHA
      FROM DUAL
      CONNECT BY LEVEL &#60;= (SELECT LAST_DAY(TO_DATE('{5}','DD/MM/YYYY'))- TO_DATE('{5}','DD/MM/YYYY') FROM DUAL) +1
      )  P
      WHERE F.FORMATCODI = {0}
      ORDER BY 5) pees
      INNER JOIN ME_FORMATO form ON (form.FORMATCODI = {0})
      INNER JOIN ME_PTOMEDICION ptme ON (ptme.ORIGLECTCODI = 19)
      INNER JOIN SI_EMPRESA empr ON (ptme.EMPRCODI = empr.EMPRCODI
      AND empr.TIPOEMPRCODI IN (2, 4)
      )
      INNER JOIN SI_TIPOEMPRESA tiem ON (empr.TIPOEMPRCODI = tiem.TIPOEMPRCODI)
      INNER JOIN (SELECT pesici.PSICLICODI
      , pesici.PSICLIANIOMESPERREM
      FROM IIO_PERIODO_SICLI pesici
      WHERE pesici.PSICLICODI = {6}
      UNION ALL
      SELECT 0 PSICLICODI
      , 'AAAA MM' PSICLIANIOMESPERREM
      FROM dual dua
      WHERE 2 = {9}) pesic ON (1 = 1)
      LEFT JOIN (
      SELECT r1.PTOMEDICODI
      , r1.PTOSUFECHAINICIO
      , r2.PTOSUFECHAINICIO AS PTOSUFECHAFIN
      , r1.EMPRCODI
      FROM (SELECT ROWNUM SEC, T.*
      FROM (SELECT PTOMEDICODI
      , PTOSUFECHAINICIO
      , EMPRCODI
      FROM VW_PTOSUMINISTRADOR
      ORDER BY 1,2) T) r1
      LEFT JOIN (SELECT ROWNUM SEC, T.*
      FROM (SELECT PTOMEDICODI
      , PTOSUFECHAINICIO
      , EMPRCODI
      FROM VW_PTOSUMINISTRADOR
      ORDER BY 1,2) T) r2 ON (r1.PTOMEDICODI = r2.PTOMEDICODI
      AND (r1.SEC + 1) = r2.SEC)
      ) mrsu ON (ptme.PTOMEDICODI = mrsu.PTOMEDICODI
      AND pees.INI_PERIODO >= mrsu.PTOSUFECHAINICIO
      AND pees.INI_PERIODO &lt; NVL(mrsu.PTOSUFECHAFIN, SYSDATE)
      )
      LEFT JOIN SI_EMPRESA mrem ON (mrsu.EMPRCODI = mrem.EMPRCODI)
      LEFT JOIN (SELECT enul.FORMATCODI
      , enul.EMPRCODI
      , enul.ENVIOCODI_MAX
      , enul.ENVIOCODI_CONT
      , TRUNC(enpri.ENVIOFECHA) AS ENVIOFECHA_MIN
      , TRUNC(enuld.ENVIOFECHA) AS ENVIOFECHA_MAX
      , enuld.ENVIOFECHAPERIODO
      , enuld.ENVIOFECHAINI
      , enuld.ENVIOFECHAFIN
      FROM (SELECT envi.FORMATCODI
      , envi.EMPRCODI
      , envi.ENVIOFECHAPERIODO
      , MIN(envi.ENVIOCODI) AS ENVIOCODI_MIN
      , MAX(envi.ENVIOCODI) AS ENVIOCODI_MAX
      , COUNT(envi.ENVIOCODI) AS ENVIOCODI_CONT
      FROM ME_ENVIO envi
      WHERE envi.FORMATCODI = {0}
      GROUP BY envi.FORMATCODI
      , envi.EMPRCODI
      , envi.ENVIOFECHAPERIODO) enul
      INNER JOIN ME_ENVIO enpri ON (enul.ENVIOCODI_MIN = enpri.ENVIOCODI)
      INNER JOIN ME_ENVIO enuld ON (enul.ENVIOCODI_MAX = enuld.ENVIOCODI)
      ) ulenv ON (form.FORMATCODI = ulenv.FORMATCODI
      AND empr.EMPRCODI = ulenv.EMPRCODI
      AND pees.INI_PERIODO = TRUNC(ulenv.ENVIOFECHAPERIODO, 'MM'))
      LEFT JOIN ME_MEDICION96 medi ON (medi.LECTCODI = {2}
      AND TRUNC(pees.FECHA_FILA) = TRUNC(medi.MEDIFECHA)
      AND ptme.PTOMEDICODI = medi.PTOMEDICODI
      )
      LEFT JOIN ME_MEDICION96 median ON (median.LECTCODI = CASE
      WHEN tiem.TIPOEMPRCODI = 2 THEN
      {2}
      WHEN tiem.TIPOEMPRCODI = 4 THEN
      {7}
      ELSE
      NULL
      END
      AND TRUNC(median.MEDIFECHA) = FN_ME_FECHAMEDSICLI(ptme.PTOMEDICODI
      , tiem.TIPOEMPRCODI
      , pees.FECHA_FILA
      , medi.MEDIFECHA
      , pesic.PSICLICODI
      , {7})
      AND ptme.PTOMEDICODI = median.PTOMEDICODI
      )
      LEFT JOIN EQ_EQUIPO eqp ON (ptme.EQUICODI = eqp.EQUICODI)
      LEFT JOIN EQ_AREA ara ON (eqp.AREACODI = ara.AREACODI)
      WHERE {3}
      {4}
      AND TRUNC(pees.INI_PERIODO) = TO_DATE('{5}', 'dd/mm/yyyy')
      AND (
      EXISTS (
      SELECT 1
      FROM ME_MEDICION96 mpr16
      WHERE mpr16.LECTCODI = {2}
      AND TRUNC(mpr16.MEDIFECHA) = TRUNC(pees.FECHA_FILA)
      AND mpr16.PTOMEDICODI = ptme.PTOMEDICODI
      )
      OR EXISTS (
      SELECT 1
      FROM EQ_EQUIPO eqpsi
      , IIO_FACTURA factu
      WHERE eqpsi.EQUICODI = ptme.EQUICODI
      AND eqpsi.EQUICODI = factu.EQUICODI
      AND factu.PSICLICODI = pesic.PSICLICODI
      AND CASE
      WHEN tiem.TIPOEMPRCODI = 2 THEN
      0 -- No considerar los puntos de medición cuando el tipo de empresa es Distribución.
      WHEN tiem.TIPOEMPRCODI = 4 THEN
      1
      END = 1
      )
      )
      ORDER BY pees.INI_PERIODO
      , empr.EMPRNOMB
      , ptme.PTOMEDICODI
      , pees.FECHA_FILA
      , medi.MEDIFECHA
      ) inte) exte
      {8}
    </query>
  </Sql>

  <Sql>
    <key>ListReporteInformacion30minCount</key>
    <query>
      <!--- 	
	      + Nombre: 
		      Consulta para obtener la información a nive de detalle de 30 minutos. 
	      + Descripción:
		      Esta consulta atiende el requerimiento de información del reporte "Reporte de Información de medidores de energía de Usuarios y Empresas 
	      de distribución" cuyo objetivo es informar al usuario interno del COES sobre la información cargada agrupando las mediciones cada 30 minutos.
	      La consulta atiende las opciones para los Usuarios Libres y para las Empresas de Distribución.
	
	      + Caso especial:
		      La consulta debe asegurar que se muestre el detalle de la información por cada mes. En caso la empresa no hubiese remitido información alguna
	      para un mes determinado se tiene:
	
	      a) Para las Empresas de Distribución. 
	         Se debe buscar la información anterior más reciente remitida por la empresa. 
	      b) Para los Usuarios Libres:
	         Se debe buscar la información anterior más reciente obtenida a través del Osinergmin (Proyecto Alpha). 
      -->
      SELECT count(1) AS Q_REGISTROS
      FROM (
      SELECT 1
      FROM (SELECT TO_CHAR(TO_DATE(td.FECHA_FINAL + 1 - ROWNUM), 'MM YYYY') AS PERIODO
      , TRUNC(TO_DATE(td.FECHA_FINAL + 1 - ROWNUM), 'MM') AS INI_PERIODO
      , ADD_MONTHS(TRUNC(TO_DATE(td.FECHA_FINAL + 1 - ROWNUM), 'MM'), 1) AS INI_REMISION
      , ADD_MONTHS(
      TO_DATE(
      (SELECT fori.FORMATDIAPLAZO
      FROM ME_FORMATO fori
      WHERE fori.FORMATCODI = {0}
      )
      || '/' || TO_CHAR(TO_DATE(td.FECHA_FINAL + 1 - ROWNUM), 'mm/yyyy'), 'dd/mm/yyyy')
      , 1) AS FIN_REMISION
      , TO_DATE(td.FECHA_FINAL + 1 - ROWNUM) AS FECHA_FILA
      FROM ALL_OBJECTS
      , (SELECT TO_DATE('{5}', 'dd/mm/yyyy') AS FECHA_INICIAL
      , LAST_DAY(TO_DATE('{5}', 'dd/mm/yyyy')) AS FECHA_FINAL
      FROM DUAL) td
      WHERE TRUNC(td.FECHA_FINAL + 1 - ROWNUM, 'MM') >= TRUNC(td.FECHA_INICIAL,'MM')
      ORDER BY 5) pees
      INNER JOIN ME_FORMATO form ON (form.FORMATCODI = {0})
      INNER JOIN ME_PTOMEDICION ptme ON (ptme.ORIGLECTCODI = 19)
      INNER JOIN SI_EMPRESA empr ON (ptme.EMPRCODI = empr.EMPRCODI
      AND empr.TIPOEMPRCODI IN (2, 4)
      )
      INNER JOIN SI_TIPOEMPRESA tiem ON (empr.TIPOEMPRCODI = tiem.TIPOEMPRCODI)
      INNER JOIN (SELECT pesici.PSICLICODI
      , pesici.PSICLIANIOMESPERREM
      FROM IIO_PERIODO_SICLI pesici
      WHERE pesici.PSICLICODI = {6}
      UNION ALL
      SELECT 0 PSICLICODI
      , 'AAAA MM' PSICLIANIOMESPERREM
      FROM dual dua
      WHERE 2 = {8}) pesic ON (1 = 1)
      LEFT JOIN (
      SELECT r1.PTOMEDICODI
      , r1.PTOSUFECHAINICIO
      , r2.PTOSUFECHAINICIO AS PTOSUFECHAFIN
      , r1.EMPRCODI
      FROM (SELECT ROWNUM SEC, T.*
      FROM (SELECT PTOMEDICODI
      , PTOSUFECHAINICIO
      , EMPRCODI
      FROM VW_PTOSUMINISTRADOR
      ORDER BY 1,2) T) r1
      LEFT JOIN (SELECT ROWNUM SEC, T.*
      FROM (SELECT PTOMEDICODI
      , PTOSUFECHAINICIO
      , EMPRCODI
      FROM VW_PTOSUMINISTRADOR
      ORDER BY 1,2) T) r2 ON (r1.PTOMEDICODI = r2.PTOMEDICODI
      AND (r1.SEC + 1) = r2.SEC)
      ) mrsu ON (ptme.PTOMEDICODI = mrsu.PTOMEDICODI
      AND pees.INI_PERIODO >= mrsu.PTOSUFECHAINICIO
      AND pees.INI_PERIODO &lt; NVL(mrsu.PTOSUFECHAFIN, SYSDATE)
      )
      LEFT JOIN SI_EMPRESA mrem ON (mrsu.EMPRCODI = mrem.EMPRCODI)
      LEFT JOIN (SELECT enul.FORMATCODI
      , enul.EMPRCODI
      , enul.ENVIOCODI_MAX
      , enul.ENVIOCODI_CONT
      , TRUNC(enpri.ENVIOFECHA) AS ENVIOFECHA_MIN
      , TRUNC(enuld.ENVIOFECHA) AS ENVIOFECHA_MAX
      , enuld.ENVIOFECHAPERIODO
      , enuld.ENVIOFECHAINI
      , enuld.ENVIOFECHAFIN
      FROM (SELECT envi.FORMATCODI
      , envi.EMPRCODI
      , envi.ENVIOFECHAPERIODO
      , MIN(envi.ENVIOCODI) AS ENVIOCODI_MIN
      , MAX(envi.ENVIOCODI) AS ENVIOCODI_MAX
      , COUNT(envi.ENVIOCODI) AS ENVIOCODI_CONT
      FROM ME_ENVIO envi
      WHERE envi.FORMATCODI = {0}
      GROUP BY envi.FORMATCODI
      , envi.EMPRCODI
      , envi.ENVIOFECHAPERIODO) enul
      INNER JOIN ME_ENVIO enpri ON (enul.ENVIOCODI_MIN = enpri.ENVIOCODI)
      INNER JOIN ME_ENVIO enuld ON (enul.ENVIOCODI_MAX = enuld.ENVIOCODI)
      ) ulenv ON (form.FORMATCODI = ulenv.FORMATCODI
      AND empr.EMPRCODI = ulenv.EMPRCODI
      AND pees.INI_PERIODO = TRUNC(ulenv.ENVIOFECHAPERIODO, 'MM'))
      LEFT JOIN ME_MEDICION96 medi ON (medi.LECTCODI = {2}
      AND TRUNC(pees.FECHA_FILA) = TRUNC(medi.MEDIFECHA)
      AND ptme.PTOMEDICODI = medi.PTOMEDICODI
      )
      LEFT JOIN ME_MEDICION96 median ON (median.LECTCODI = CASE
      WHEN tiem.TIPOEMPRCODI = 2 THEN
      {2}
      WHEN tiem.TIPOEMPRCODI = 4 THEN
      {7}
      ELSE
      NULL
      END
      AND TRUNC(median.MEDIFECHA) = FN_ME_FECHAMEDSICLI(ptme.PTOMEDICODI
      , tiem.TIPOEMPRCODI
      , pees.FECHA_FILA
      , medi.MEDIFECHA
      , pesic.PSICLICODI
      , {7})
      AND ptme.PTOMEDICODI = median.PTOMEDICODI
      )
      LEFT JOIN EQ_EQUIPO eqp ON (ptme.EQUICODI = eqp.EQUICODI)
      LEFT JOIN EQ_AREA ara ON (eqp.AREACODI = ara.AREACODI)
      WHERE {3}
      {4}
      AND TRUNC(pees.INI_PERIODO) = TO_DATE('{5}', 'dd/mm/yyyy')
      AND (
      EXISTS (
      SELECT 1
      FROM ME_MEDICION96 mpr16
      WHERE mpr16.LECTCODI = {2}
      AND TRUNC(mpr16.MEDIFECHA) = TRUNC(pees.FECHA_FILA)
      AND mpr16.PTOMEDICODI = ptme.PTOMEDICODI
      )
      OR EXISTS (
      SELECT 1
      FROM EQ_EQUIPO eqpsi
      , IIO_FACTURA factu
      WHERE eqpsi.EQUICODI = ptme.EQUICODI
      AND eqpsi.EQUICODI = factu.EQUICODI
      AND factu.PSICLICODI = pesic.PSICLICODI
      AND CASE
      WHEN tiem.TIPOEMPRCODI = 2 THEN
      0 -- No considerar los puntos de medición cuando el tipo de empresa es Distribución.
      WHEN tiem.TIPOEMPRCODI = 4 THEN
      1
      END = 1
      )
      )
      ORDER BY pees.INI_PERIODO
      , empr.EMPRNOMB
      , ptme.PTOMEDICODI
      , pees.FECHA_FILA
      , medi.MEDIFECHA
      ) inte
    </query>
  </Sql>

  <Sql>
    <key>ObtenerDatosPtoMedicionLectura</key>
    <query>
      select
      f.medifecha,max(b.grupotipo) grupotipo,
      sum(h1) as h1,sum(h2) as h2,sum(h3) as h3,sum(h4) as h4,sum(h5) as h5,sum(h6) as h6,sum(h7) as h7,sum(h8) as h8,sum(h9) as h9,sum(h10) as h10,
      sum(h11) as h11,sum(h12) as h12,sum(h13) as h13,sum(h14) as h14,sum(h15) as h15,sum(h16) as h16,sum(h17) as h17,sum(h18) as h18,sum(h19) as h19,sum(h20) as h20,
      sum(h21) as h21,sum(h22) as h22,sum(h23) as h23,sum(h24) as h24,sum(h25) as h25,sum(h26) as h26,sum(h27) as h27,sum(h28) as h28,sum(h29) as h29,sum(h30) as h30,
      sum(h31) as h31,sum(h32) as h32,sum(h33) as h33,sum(h34) as h34,sum(h35) as h35,sum(h36) as h36,sum(h37) as h37,sum(h38) as h38,sum(h39) as h39,sum(h40) as h40,
      sum(h41) as h41,sum(h42) as h42,sum(h43) as h43,sum(h44) as h44,sum(h45) as h45,sum(h46) as h46,sum(h47) as h47,sum(h48) as h48
      from
      me_ptomedicion a,  pr_grupo b, si_empresa c,
      eq_area d , eq_equipo e, me_medicion48 f
      where
      a.grupocodi = b.grupocodi and
      c.emprcodi = (case when coalesce(f.EMPRCODI, -1) > 0 then f.EMPRCODI else a.emprcodi end) and
      b.emprcodi > 0 and
      a.origlectcodi = 2 and
      e.equicodi=a.equicodi and
      e.areacodi=d.areacodi and
      a.ptomedicodi=f.ptomedicodi
      and b.grupoactivo='S'
      and a.ptomedicodi in ({0})
      and lectcodi= {1} and f.tipoinfocodi=1
      and medifecha=to_date('{2}','dd/mm/yyyy')
      group by f.medifecha
    </query>
  </Sql>
  <Sql>
    <key>GetDespachoProgramado</key>
    <query>
      select eq.equipadre,eq.equicodi,eq.equinomb,eq.equiabrev,m48.* from me_medicion48 m48
      inner join me_ptomedicion pto on pto.ptomedicodi = m48.ptomedicodi
      inner join eq_equipo eq on eq.equicodi = pto.equicodi
      where m48.lectcodi = {0}
      and (medifecha >= to_date('{1} 00:00:00','yyyy-MM-dd HH24:MI:SS') and medifecha &lt;= to_date('{2} 23:59:59','yyyy-MM-dd HH24:MI:SS'))
      order by eq.equinomb asc
    </query>
  </Sql>
  <!-- INICIO - COSTO OPORTUNIDAD -->
  <Sql>
    <key>GetReservaProgramado</key>
    <query>
      select gr.grupourspadre,
      sum(h1) as h1, sum(h2) as h2,
      sum(h3) as h3, sum(h4) as h4,
      sum(h5) as h5, sum(h6) as h6,
      sum(h7) as h7, sum(h8) as h8,
      sum(h9) as h9, sum(h10) as h10,
      sum(h11) as h11, sum(h12) as h12,
      sum(h13) as h13, sum(h14) as h14,
      sum(h15) as h15, sum(h16) as h16,
      sum(h17) as h17, sum(h18) as h18,
      sum(h19) as h19, sum(h20) as h20,
      sum(h21) as h21, sum(h22) as h22,
      sum(h23) as h23, sum(h24) as h24,
      sum(h25) as h25, sum(h26) as h26,
      sum(h27) as h27, sum(h28) as h28,
      sum(h29) as h29, sum(h30) as h30,
      sum(h31) as h31, sum(h32) as h32,
      sum(h33) as h33, sum(h34) as h34,
      sum(h35) as h35, sum(h36) as h36,
      sum(h37) as h37, sum(h38) as h38,
      sum(h39) as h39, sum(h40) as h40,
      sum(h41) as h41, sum(h42) as h42,
      sum(h43) as h43, sum(h44) as h44,
      sum(h45) as h45, sum(h46) as h46,
      sum(h47) as h47, sum(h48) as h48
      from me_medicion48 m48
      inner join me_ptomedicion pto on pto.ptomedicodi = m48.ptomedicodi
      inner join pr_grupo gr on gr.grupocodi = pto.grupocodi
      where m48.lectcodi = {0} and gr.grupourspadre > 0
      and (medifecha >= to_date('{1} 00:00:00','yyyy-MM-dd HH24:MI:SS') and medifecha &lt;= to_date('{2} 23:59:59','yyyy-MM-dd HH24:MI:SS'))
      group by gr.grupourspadre

    </query>
  </Sql>

  <Sql>
    <key>GetListadoReserva</key>
    <query>
      select pto.grupocodi, m48.* from me_medicion48 m48
      inner join me_ptomedicion pto on pto.ptomedicodi = m48.ptomedicodi
      where m48.lectcodi = {0}
      and (medifecha >= to_date('{1} 00:00:00','yyyy-MM-dd HH24:MI:SS') and medifecha &lt;= to_date('{2} 23:59:59','yyyy-MM-dd HH24:MI:SS'))
      and pto.ptomedicodi in (
      select pto.ptomedicodi
      from pr_grupo g
      inner join me_ptomedicion pto on pto.grupocodi = g.grupocodi
      where g.GRUPOURSPADRE > 0 AND g.GRUPOACTIVO = 'S'
      )
    </query>
  </Sql>
  <!-- FIN - COSTO OPORTUNIDAD -->
  <Sql>
    <key>ObtenerMedicion48</key>
    <query>
      SELECT pt.equicodi,
              me.lectcodi, 
              me.medifecha, 
              me.tipoinfocodi, 
              me.ptomedicodi, 
              me.mediestado, 
              h1, 
              h2, 
              h3, 
              h4, 
              h5, 
              h6, 
              h7, 
              h8, 
              h9, 
              h10, 
              h11, 
              h12, 
              h13, 
              h14, 
              h15, 
              h16, 
              h17, 
              h18, 
              h19, 
              h20, 
              h21, 
              h22, 
              h23, 
              h24, 
              h25, 
              h26, 
              h27, 
              h28, 
              h29, 
              h30, 
              h31, 
              h32, 
              h33, 
              h34, 
              h35, 
              h36, 
              h37, 
              h38, 
              h39, 
              h40, 
              h41, 
              h42, 
              h43, 
              h44, 
              h45, 
              h46, 
              h47, 
              h48, 
              me.emprcodi, 
              me.lastuser, 
              me.lastdate,
              pt.osicodi, 
              ( COALESCE(h1, 0) + COALESCE(h2, 0) + COALESCE(h3, 0) + COALESCE(h4, 0) 
              + COALESCE(h5, 0) + COALESCE(h6, 0) + COALESCE(h7, 0) + COALESCE(h8, 0) 
              + COALESCE(h9, 0) + COALESCE(h10, 0) + COALESCE(h11, 0) + COALESCE(h12, 0) 
              + COALESCE(h13, 0) + COALESCE(h14, 0) + COALESCE(h15, 0) + COALESCE(h16, 0) 
              + COALESCE(h17, 0) + COALESCE(h18, 0) + COALESCE(h19, 0) + COALESCE(h20, 0) 
              + COALESCE(h21, 0) + COALESCE(h22, 0) + COALESCE(h23, 0) + COALESCE(h24, 0) 
              + COALESCE(h25, 0) + COALESCE(h26, 0) + COALESCE(h27, 0) + COALESCE(h28, 0) 
              + COALESCE(h29, 0) + COALESCE(h29, 0) + COALESCE(h30, 0) + COALESCE(h31, 0) 
              + COALESCE(h32, 0) + COALESCE(h33, 0) + COALESCE(h34, 0) + COALESCE(h35, 0) 
              + COALESCE(h36, 0) + COALESCE(h37, 0) + COALESCE(h38, 0) + COALESCE(h39, 0) 
              + COALESCE(h40, 0) + COALESCE(h41, 0) + COALESCE(h42, 0) + COALESCE(h43, 0) 
              + COALESCE(h44, 0) + COALESCE(h45, 0) + COALESCE(h46, 0) + COALESCE(h47, 0) 
              + COALESCE(h48, 0) ) AS meditotal, 
              Greatest(COALESCE(h1, 0) , COALESCE(h2, 0) , COALESCE(h3, 0) , COALESCE(h4, 0) 
              , COALESCE(h5, 0) , COALESCE(h6, 0) , COALESCE(h7, 0) , COALESCE(h8, 0) 
              , COALESCE(h9, 0) , COALESCE(h10, 0) , COALESCE(h11, 0) , COALESCE(h12, 0) 
              , COALESCE(h13, 0) , COALESCE(h14, 0) , COALESCE(h15, 0) , COALESCE(h16, 0) 
              , COALESCE(h17, 0) , COALESCE(h18, 0) , COALESCE(h19, 0) , COALESCE(h20, 0) 
              , COALESCE(h21, 0) , COALESCE(h22, 0) , COALESCE(h23, 0) , COALESCE(h24, 0) 
              , COALESCE(h25, 0) , COALESCE(h26, 0) , COALESCE(h27, 0) , COALESCE(h28, 0) 
              , COALESCE(h29, 0) , COALESCE(h29, 0) , COALESCE(h30, 0) , COALESCE(h31, 0) 
              , COALESCE(h32, 0) , COALESCE(h33, 0) , COALESCE(h34, 0) , COALESCE(h35, 0) 
              , COALESCE(h36, 0) , COALESCE(h37, 0) , COALESCE(h38, 0) , COALESCE(h39, 0) 
              , COALESCE(h40, 0) , COALESCE(h41, 0) , COALESCE(h42, 0) , COALESCE(h43, 0) 
              , COALESCE(h44, 0) , COALESCE(h45, 0) , COALESCE(h46, 0) , COALESCE(h47, 0) 
              , COALESCE(h48, 0)) maxdemanda 
      FROM   me_medicion48 me 
      inner join me_ptomedicion pt on pt.ptomedicodi=me.ptomedicodi      
      WHERE  me.medifecha BETWEEN To_date('{0}', 'YYYY-MM-DD') AND To_date('{1}', 'YYYY-MM-DD') 
              AND ( me.lectcodi IN( {2} ) OR '-1' = '{2}' ) 
              AND ( me.tipoinfocodi = {3} OR '-1' = '{3}' ) 
              AND ( me.ptomedicodi IN ( {4} ) OR '-1' = '{4}' ) 
      ORDER  BY me.medifecha, me.ptomedicodi 
    </query>
  </Sql>

  <Sql>
    <key>ObtenerDatosPtoMedicionLecturaInfo</key>
    <query>
      select
      f.medifecha,max(b.grupotipo) grupotipo,
      sum(h1) as h1,sum(h2) as h2,sum(h3) as h3,sum(h4) as h4,sum(h5) as h5,sum(h6) as h6,sum(h7) as h7,sum(h8) as h8,sum(h9) as h9,sum(h10) as h10,
      sum(h11) as h11,sum(h12) as h12,sum(h13) as h13,sum(h14) as h14,sum(h15) as h15,sum(h16) as h16,sum(h17) as h17,sum(h18) as h18,sum(h19) as h19,sum(h20) as h20,
      sum(h21) as h21,sum(h22) as h22,sum(h23) as h23,sum(h24) as h24,sum(h25) as h25,sum(h26) as h26,sum(h27) as h27,sum(h28) as h28,sum(h29) as h29,sum(h30) as h30,
      sum(h31) as h31,sum(h32) as h32,sum(h33) as h33,sum(h34) as h34,sum(h35) as h35,sum(h36) as h36,sum(h37) as h37,sum(h38) as h38,sum(h39) as h39,sum(h40) as h40,
      sum(h41) as h41,sum(h42) as h42,sum(h43) as h43,sum(h44) as h44,sum(h45) as h45,sum(h46) as h46,sum(h47) as h47,sum(h48) as h48
      from
      me_ptomedicion a,  pr_grupo b, si_empresa c,
      eq_area d , eq_equipo e, me_medicion48 f
      where
      a.grupocodi = b.grupocodi and
      c.emprcodi = (case when coalesce(f.EMPRCODI, -1) > 0 then f.EMPRCODI else a.emprcodi end) and
      b.emprcodi > 0 and
      e.equicodi=a.equicodi and
      e.areacodi=d.areacodi and
      a.ptomedicodi=f.ptomedicodi
      and b.grupoactivo='S'
      and a.ptomedicodi in ({0})
      and lectcodi= {1} and f.tipoinfocodi={2}
      and medifecha=to_date('{3}','dd/mm/yyyy')
      group by f.medifecha
    </query>
  </Sql>

  <Sql>
    <key>ObtenerListado</key>
    <query>
      select
      *
      from (
      select b.lectcodi,b.lectnomb,a.medifecha,c.tipoinfocodi,c.tipoinfoabrev,d.ptomedicodi,d.ptomedidesc,a.h1,a.meditotal,a.mediestado,a.h2,a.h3,a.h4,a.h5,
      a.h6,a.h7,a.h8,a.h9,a.h10,a.h11,a.h12,a.h13,a.h14,a.h15,a.h16,a.h17,a.h18,a.h19,a.h20,a.h21,a.h22,a.h23,a.h24,a.h25,a.h26,a.h27,a.h28,a.h29,a.h30,a.h31,a.h32,
      a.h33,a.h34,a.h35,a.h36,a.h37,a.h38,a.h39,a.h40,a.h41,a.h42,a.h43,a.h44,a.h45,a.h46,a.h47,a.h48,a.lastuser,a.lastdate,
      (row_number() over (order by a.medifecha desc)) as r from me_medicion48 a, me_lectura b, si_tipoinformacion c, me_ptomedicion
      d where (b.lectcodi= a.lectcodi) and (a.lectcodi={0} or {0} = 0) and (c.tipoinfocodi= a.tipoinfocodi) and (a.tipoinfocodi={1} or
      {1} = 0) and (d.ptomedicodi= a.ptomedicodi) and (a.ptomedicodi={2} or {2} = 0)
      and
      (
      (a.medifecha >= to_date('{3} 00:00:00','YYYY-MM-DD HH24:MI:SS') and a.medifecha &lt; to_date('{4} 00:00:00','YYYY-MM-DD HH24:MI:SS')+1)
      )
      order by a.medifecha desc
      )
      where (r >= ((({5}-1) * {6}) + 1) and r &lt; (({5} * {6}) + 1 )) or ({5} = -1 and {6} = -1)
    </query>
  </Sql>

  <Sql>
    <key>TotalRegistros</key>
    <query>
      select count(*) from me_medicion48 a,me_lectura b,si_tipoinformacion c,me_ptomedicion d where (b.lectcodi= a.lectcodi) and (a.lectcodi={0} or {0} = 0) and
      (c.tipoinfocodi= a.tipoinfocodi) and (a.tipoinfocodi={1} or {1} = 0) and (d.ptomedicodi= a.ptomedicodi) and (a.ptomedicodi={2} or {2} = 0)
      and
      (
      (a.medifecha >= to_date('{3} 00:00:00','YYYY-MM-DD HH24:MI:SS') and a.lastdate &lt; to_date('{4} 00:00:00','YYYY-MM-DD HH24:MI:SS')+1)
      )
    </query>
  </Sql>

    <Sql>
	    <key>ListarDetalleGeneracion48</key>
	    <query>
			SELECT
			EMPRCODI2 as EMPRCODI,a.*
			FROM
			(
			select
			COALESCE(d.GRUPOINTEGRANTE,'N') GRUPOINTEGRANTE,
			COALESCE(d.TIPOGENERRER,'N') TIPOGENERRER,
			COALESCE(d.GRUPOTIPOCOGEN,'N') GRUPOTIPOCOGEN,
			d.tipogrupocodi, d.grupocodi, d.grupopadre, d.grupoabrev,d.gruponomb,d.grupoorden,
			emp.emprabrev, emp.emprnomb, emp.EMPRCODI as EMPRCODI2, emp.emprorden,
			case when eq.famcodi in (4,5,37,39) then eq.equicodi else eqp.equicodi end as equipadre,
			case when eq.famcodi in (4,5,37,39) then eq.equinomb else eqp.equinomb end as central,
			case when eq.famcodi in (4,5,37,39) then eq.osinergcodi else eqp.osinergcodi end as osinergcodi,
			eqp.equinomb as central2,
			eq.equicodi,eq.equinomb as equinomb,eq.equiabrev, eq.famcodi,p.Ptomedielenomb as PTOMEDINOMB,
			fe.fenergcodi, fe.fenergnomb, fe.fenergabrev, fe.FENERCOLOR, tg.tgenernomb, tg.tgenercodi, me.*

			from me_medicion48 me
			inner join  me_ptomedicion p on p.PTOMEDICODI = me.PTOMEDICODI
			left join eq_equipo eq on eq.famcodi  &lt;> 40 and eq.EQUICODI = p.EQUICODI
			left join eq_equipo eqp on eqp.EQUICODI = coalesce(eq.EQUIPADRE, -1)
			left join pr_grupo d on  d.grupocodi = (case when coalesce(p.grupocodi,-1)>0 then p.grupocodi else (case when coalesce(eq.GRUPOCODI,-1)>0 then eq.grupocodi else eqp.grupocodi end) end )
			left join si_empresa emp on emp.EMPRCODI = (case when coalesce(me.EMPRCODI, -1) > 0 then me.EMPRCODI else p.emprcodi end)
			left join si_fuenteenergia fe on fe.FENERGCODI = d.FENERGCODI
			left join si_tipogeneracion tg on tg.TGENERCODI = fe.TGENERCODI

			where me.LECTCODI = {5} and ('-1'='{6}' or me.tipoinfocodi = {6}) and ('-1'='{7}' or p.tptomedicodi = {7})
			--and p.origlectcodi = 21
			and (me.medifecha between to_date('{2}','YYYY-MM-DD') and to_date('{3}','YYYY-MM-DD'))
			and ('-1'='{4}' or emp.EMPRCODI in ({4}))
			and ('-1'='{1}' or tg.TGENERCODI  in ({1}))
			and ('3' &lt;>'{0}' or('3'='{0}' and TIPOGENERRER = 'S'))
			)a
		</query>
    </Sql>
	
  <Sql>
    <key>ListaProduccionxTipoGeneracion</key>
    <query>
      select
      tg.TGENERCODI, tg.TGENERNOMB,emp.emprcoes,
      sum(me.h1) as h1 ,sum(me.h2) as h2 ,sum(me.h3) as h3,sum(me.h4) as h4 ,sum(me.h5) as h5 ,sum(me.h6) as h6 ,sum(me.h7) as h7 ,sum(me.h8) as h8
      ,sum(me.h9) as h9,sum(me.h10) as h10 ,sum(me.h11) as h11,sum(me.h12) as h12  ,sum(me.h13) as h13 ,sum(me.h14) as h14 ,sum(me.h15) as h15 ,sum(me.h16) as h16
      ,sum(me.h17) as h17 ,sum(me.h18) as h18 ,sum(me.h19) as h19 ,sum(me.h20) as h20 ,sum(me.h21) as h21 ,sum(me.h22) as h22 ,sum(me.h23) as h23 ,sum(me.h24) as h24
      ,sum(me.h25) as h25 ,sum(me.h26) as h26  ,sum(me.h27) as h27 ,sum(me.h28) as h28 ,sum(me.h29) as h29 ,sum(me.h30) as h30  ,sum(me.h31) as h31
      ,sum(me.h32) as h32  ,sum(me.h33) as h33 ,sum(me.h34) as h34  ,sum(me.h35) as h35  ,sum(me.h36) as h36  ,sum(me.h37) as h37  ,sum(me.h38) as h38
      ,sum(me.h39) as h39 ,sum(me.h40) as h40  ,sum(me.h41) as h41  ,sum(me.h42) as h42  ,sum(me.h43) as h43 ,sum(me.h44) as h44  ,sum(me.h45) as h45
      ,sum(me.h46) as h46 ,sum(me.h47) as h47 ,sum(me.h48) as h48,
      sum(coalesce(h1,0) + coalesce(h2,0) + coalesce(h3,0) + coalesce(h4,0) + coalesce(h5,0) + coalesce(h6,0) + coalesce(h7,0) + coalesce(h8,0) + coalesce(h9,0) + coalesce(h10,0) + coalesce(h11,0) + coalesce(h12,0) +
      coalesce(h13,0) + coalesce(h14,0) + coalesce(h15,0) + coalesce(h16,0) + coalesce(h17,0) + coalesce(h18,0) + coalesce(h19,0) + coalesce(h20,0) + coalesce(h21,0) + coalesce(h22,0) + coalesce(h23,0) + coalesce(h24,0) +
      coalesce(h25,0) + coalesce(h26,0) + coalesce(h27,0) + coalesce(h28,0) + coalesce(h29,0) + coalesce(h29,0) + coalesce(h30,0) + coalesce(h31,0) +  coalesce(h32,0) + coalesce(h33,0) + coalesce(h34,0)  + coalesce(h35,0) + coalesce(h36,0) +
      coalesce(h37,0) + coalesce(h38,0) + coalesce(h39,0) + coalesce(h40,0) + coalesce(h41,0) +  coalesce(h42,0) + coalesce(h43,0) + coalesce(h44,0)  + coalesce(h45,0) + coalesce(h46,0) +  coalesce(h47,0) + coalesce(h48,0)
      ) as MEDITOTAL
      from me_medicion48 me
      inner join me_ptomedicion pto on me.ptomedicodi = pto.ptomedicodi
      inner join eq_equipo eq on eq.equicodi = pto.equicodi
      inner join eq_equipo eqp on eqp.EQUICODI = eq.EQUIPADRE
      inner join pr_grupo pg on eq.grupocodi = pg.grupocodi
      inner join SI_FUENTEENERGIA fe on fe.FENERGCODI = pg.FENERGCODI
      inner join si_tipogeneracion tg on tg.tgenercodi = fe.tgenercodi
      inner join si_empresa emp on emp.emprcodi = (case when coalesce(me.EMPRCODI, -1) > 0 then me.EMPRCODI else pto.emprcodi end)
      inner join eq_familia fam on fam.famcodi = eq.famcodi
      where
      me.tipoinfocodi = 1 and
      (me.medifecha >= to_date('{0}','YYYY-MM-DD HH24:MI:SS') and
      me.medifecha &lt;= to_date('{1}','YYYY-MM-DD HH24:MI:SS')) and
      tg.TGENERCODI in ({2})  and
      me.lectcodi in ({3}) and emp.emprcoes = '{4}'
      GROUP BY  tg.TGENERCODI, tg.TGENERNOMB,emp.emprcoes
    </query>
  </Sql>

  <Sql>
    <key>ListarMeMedicion48ByFiltro</key>
    <query>
      SELECT (case when coalesce(me.EMPRCODI, -1) > 0 then me.EMPRCODI else pto.emprcodi end) emprcodi,pto.TPTOMEDICODI,
      me.lectcodi,me.medifecha,me.tipoinfocodi,me.ptomedicodi,me.meditotal,me.mediestado,
      me.h1,me.h2,me.h3,me.h4,me.h5,me.h6,me.h7,me.h8,me.h9,me.h10,me.h11,me.h12,me.h13,me.h14,me.h15,me.h16,me.h17,me.h18,me.h19,me.h20,me.h21,me.h22,me.h23,me.h24,me.h25,me.h26,me.h27,me.h28,me.h29,me.h30,me.h31,me.h32,me.h33,me.h34,me.h35,me.h36,me.h37,me.h38,me.h39,me.h40,me.h41,me.h42,me.h43,me.h44,me.h45,me.h46,me.h47,me.h48,
      e1,e2,e3,e4,e5,e6,e7,e8,e9,e10,e11,e12,e13,e14,e15,e16,e17,e18,e19,e20,e21,e22,e23,e24,e25,e26,e27,e28,e29,e30,e31,e32,e33,e34,e35,e36,e37,e38,e39,e40,e41,e42,e43,e44,e45,e46,e47,e48,
      me.lastuser,me.lastdate
      FROM ME_MEDICION48 me
      inner join me_ptomedicion pto on pto.ptomedicodi = me.ptomedicodi
      WHERE (me.lectcodi in ({0}) or '-1'='{0}')
      and (me.tipoinfocodi in ({4}) or '-1'='{4}')
      and me.medifecha between to_date('{1}','YYYY-MM-DD') and to_date('{2}','YYYY-MM-DD')
      and (me.ptomedicodi in ({3}) or '-1' = '{3}')
    </query>
  </Sql>

  <!--INICIO SIOSEIN-->

  <Sql>
    <key>GetCostosMarginalesProgPorRangoFechaStaRosa</key>
    <query>
      select M.MEDIFECHA,'B0016' as Osinergcodi,
      M.H1,M.H2,M.H3,M.H4,M.H5,M.H6,M.H7,M.H8,M.H9,M.H10,M.H11,M.H12,M.H13,M.H14,M.H15,M.H16,M.H17,
      M.H18,M.H19,M.H20,M.H21,M.H22,M.H23,M.H24,M.H25,M.H26,M.H27,M.H28,M.H29,M.H30,M.H31,M.H32,M.H33,
      M.H34,M.H35,M.H36,M.H37,M.H38,M.H39,M.H40,M.H41,M.H42,M.H43,M.H44,M.H45,M.H46,M.H47,M.H48,
      (select formuladat from pr_grupodat where concepcodi=1 and deleted = 0 and fechadat = (select max(fechadat) from pr_grupodat where fechadat &lt;= M.MEDIFECHA and concepcodi=1 and deleted = 0)) as tcambio
      from me_medicion48 M
      where ptomedicodi = 1226 and lectcodi = {0}
      and M.medifecha >= to_date('{1}','YYYY-MM-DD') and M.medifecha &lt;= to_date('{2} 00:00:00','YYYY-MM-DD HH24:MI:SS')
      order by M.medifecha asc
    </query>
  </Sql>
  
  <!--FIN SIOSEIN-->
  
  <!--INICIO MigracionSGOCOES-GrupoB-->
  <Sql>
    <key>DeleteMasivo</key>
    <query>
      delete from me_medicion48
      where lectcodi = {0} and medifecha = to_date('{1}','YYYY-MM-DD')
      and ('{2}' = '-2147483647' or ptomedicodi in ({2}) )
      and ('{3}' = '-2147483647' or tipoinfocodi in ({3}) )
    </query>
  </Sql>

  <Sql>
    <key>GetListaMedicion48xlectcodi</key>
    <query>
      select distinct ptomedicodi from me_medicion48 where lectcodi = {0}
    </query>
  </Sql>
  
  <Sql>
    <key>RptCmgCortoPlazo</key>
    <query>
      SELECT
      CASE WHEN m.ptomedicodi = 1197 THEN 'CENTRO' WHEN m.ptomedicodi = 1201 THEN 'CmgCP' WHEN m.ptomedicodi = 1230 THEN 'NORTE' WHEN m.ptomedicodi = 1231 THEN 'SUR' ELSE 'NOMBRE' END as ptomedinomb,
      m.*
      FROM ME_MEDICION48 m
      INNER JOIN ME_PTOMEDICION p ON p.ptomedicodi = m.ptomedicodi
      WHERE (m.ptomedicodi = {2} or '-1' = '{2}') AND m.lectcodi = {0} AND m.tipoinfocodi = {1}
      and m.medifecha between to_date('{3}','YYYY-MM-DD') and to_date('{4}','YYYY-MM-DD')
    </query>
  </Sql>

  <Sql>
    <key>GetListaDemandaBarras</key>
    <query>
      select (case when coalesce(me.EMPRCODI, -1) > 0 then me.EMPRCODI else p.emprcodi end) emprcodi,me.*
      from  ME_MEDICION48 me
      inner join me_ptomedicion p on p.ptomedicodi = me.ptomedicodi
      where me.medifecha between  to_date('{2}','YYYY-MM-DD')  and to_date('{3}','YYYY-MM-DD')
      and me.tipoinfocodi in (1,20) and me.lectcodi =  {1} and me.ptomedicodi in ({0})
      order by me.medifecha
    </query>
  </Sql>

  <!--FIN MigracionSGOCOES-GrupoB-->

  <Sql>
    <key>ObtenerDatosEquipoLectura</key>
    <query>
      SELECT
      f.medifecha,max(b.grupotipo) grupotipo,
      sum(h1) as h1,sum(h2) as h2,sum(h3) as h3,sum(h4) as h4,sum(h5) as h5,sum(h6) as h6,sum(h7) as h7,sum(h8) as h8,sum(h9) as h9,sum(h10) as h10,
      sum(h11) as h11,sum(h12) as h12,sum(h13) as h13,sum(h14) as h14,sum(h15) as h15,sum(h16) as h16,sum(h17) as h17,sum(h18) as h18,sum(h19) as h19,sum(h20) as h20,
      sum(h21) as h21,sum(h22) as h22,sum(h23) as h23,sum(h24) as h24,sum(h25) as h25,sum(h26) as h26,sum(h27) as h27,sum(h28) as h28,sum(h29) as h29,sum(h30) as h30,
      sum(h31) as h31,sum(h32) as h32,sum(h33) as h33,sum(h34) as h34,sum(h35) as h35,sum(h36) as h36,sum(h37) as h37,sum(h38) as h38,sum(h39) as h39,sum(h40) as h40,
      sum(h41) as h41,sum(h42) as h42,sum(h43) as h43,sum(h44) as h44,sum(h45) as h45,sum(h46) as h46,sum(h47) as h47,sum(h48) as h48
      FROM
      me_ptomedicion A,
      pr_grupo B,
      si_empresa C,
      EQ_AREA D ,
      EQ_EQUIPO E,
      me_medicion48 f
      where
      A.grupocodi = B.grupocodi AND
      C.emprcodi = (case when coalesce(f.EMPRCODI, -1) > 0 then f.EMPRCODI else B.emprcodi end) AND
      B.emprcodi > 0 AND
      A.origlectcodi = 2 AND
      E.EQUICODI=A.EQUICODI AND
      E.AREACODI=D.AREACODI and
      a.ptomedicodi=f.ptomedicodi
      AND B.GRUPOACTIVO='S'
      AND A.EQUICODI=  {0}
      and lectcodi= {1} and f.tipoinfocodi=1
      and medifecha=to_date('{2}','dd/mm/yyyy')
      group by f.medifecha
    </query>
  </Sql>


  <!--INICIO SGOCOES-GrupoA Soporte-->

  <Sql>
    <key>DeleteSCOActualizacion</key>
    <query>
      delete from me_medicion48
      where
      lectcodi = 6 and
      trunc(medifecha) = trunc(sysdate) and
      tipoinfocodi = 1
    </query>
  </Sql>

  <!--FIN MigracionSGOCOES-GrupoA Soporte-->

  <Sql>
    <key>ObtenerListaMedicion48Ptomedicion</key>
    <query>
      select m48.* from me_medicion48 m48 inner join ME_PTOMEDICION pm on pm.ptomedicodi = m48.ptomedicodi
      where m48.medifecha between to_date('{0}','YYYY-MM-DD') and to_date('{1}','YYYY-MM-DD')
      and (m48.tipoinfocodi in({2}) or '-1'='{2}' ) and (m48.lectcodi in({3}) or '-1'='{3}')
      and ( (case when coalesce(m48.EMPRCODI, -1) > 0 then m48.EMPRCODI else pm.emprcodi end) in({4}) or '-1'='{4}')
    </query>
  </Sql>

  <Sql>
    <key>ObtenerProgramaReProgramaDia</key>
    <query>
      select
      me.medifecha,
      gr.grupocodi,
      h1,h2,h3,h4,h5,h6,h7,h8,h9,h10,
      h11,h12,h13,h14,h15,h16,h17,h18,h19,h20,
      h21,h22,h23,h24,h25,h26,h27,h28,h29,h30,
      h31,h32,h33,h34,h35,h36,h37,h38,h39,h40,
      h41,h42,h43,h44,h45,h46,h47,h48
      from me_medicion48 me
      inner join me_ptomedicion pto on me.ptomedicodi = pto.ptomedicodi
      inner join pr_grupo gr on pto.grupocodi = gr.grupocodi
      where
      (me.medifecha >= to_date('{0} 00:00:00','YYYY-MM-DD HH24:MI:SS') and me.medifecha &lt; to_date('{0} 00:00:00','YYYY-MM-DD HH24:MI:SS')+1) and
      me.tipoinfocodi = 1 and
      me.lectcodi in ({1}) and
      pto.origlectcodi = 2
      order by gr.grupocodi asc
    </query>
  </Sql>

  <!--INICIO Valorizaciones -->

  <!--Consulta para Obtener energia entregada-->
  <Sql>
    <key>GetEmpresaEnergiaEntregada</key>
    <query>
      select
      emp.emprcodi EMPRCODI,
      SUM(
      NVL(FN_VTD_CALCULARMONTOENTREGA(h1,TO_DATE('@date 00:00','YYYY/MM/DD HH24:MI'),ba.barrcodi),0)
      + NVL(FN_VTD_CALCULARMONTOENTREGA(h2,TO_DATE('@date 00:30' ,'YYYY/MM/DD HH24:MI'),ba.barrcodi),0)
      + NVL(FN_VTD_CALCULARMONTOENTREGA(h3,TO_DATE('@date 01:00' ,'YYYY/MM/DD HH24:MI'),ba.barrcodi),0)
      + NVL(FN_VTD_CALCULARMONTOENTREGA(h4,TO_DATE('@date 01:30' ,'YYYY/MM/DD HH24:MI'),ba.barrcodi),0)
      + NVL(FN_VTD_CALCULARMONTOENTREGA(h5,TO_DATE('@date 02:00' ,'YYYY/MM/DD HH24:MI'),ba.barrcodi),0)
      + NVL(FN_VTD_CALCULARMONTOENTREGA(h6,TO_DATE('@date 02:30' ,'YYYY/MM/DD HH24:MI'),ba.barrcodi),0)
      + NVL(FN_VTD_CALCULARMONTOENTREGA(h7,TO_DATE('@date 03:00' ,'YYYY/MM/DD HH24:MI'),ba.barrcodi),0)
      + NVL(FN_VTD_CALCULARMONTOENTREGA(h8,TO_DATE('@date 03:30' ,'YYYY/MM/DD HH24:MI'),ba.barrcodi),0)
      + NVL(FN_VTD_CALCULARMONTOENTREGA(h9,TO_DATE('@date 04:00' ,'YYYY/MM/DD HH24:MI'),ba.barrcodi),0)
      + NVL(FN_VTD_CALCULARMONTOENTREGA(h10,TO_DATE('@date 04:30' ,'YYYY/MM/DD HH24:MI'),ba.barrcodi),0)
      + NVL(FN_VTD_CALCULARMONTOENTREGA(h11,TO_DATE('@date 05:00' ,'YYYY/MM/DD HH24:MI'),ba.barrcodi),0)
      + NVL(FN_VTD_CALCULARMONTOENTREGA(h12,TO_DATE('@date 05:30' ,'YYYY/MM/DD HH24:MI'),ba.barrcodi),0)
      + NVL(FN_VTD_CALCULARMONTOENTREGA(h13,TO_DATE('@date 06:00' ,'YYYY/MM/DD HH24:MI'),ba.barrcodi),0)
      + NVL(FN_VTD_CALCULARMONTOENTREGA(h14,TO_DATE('@date 06:30' ,'YYYY/MM/DD HH24:MI'),ba.barrcodi),0)
      + NVL(FN_VTD_CALCULARMONTOENTREGA(h15,TO_DATE('@date 07:00' ,'YYYY/MM/DD HH24:MI'),ba.barrcodi),0)
      + NVL(FN_VTD_CALCULARMONTOENTREGA(h16,TO_DATE('@date 07:30' ,'YYYY/MM/DD HH24:MI'),ba.barrcodi),0)
      + NVL(FN_VTD_CALCULARMONTOENTREGA(h17,TO_DATE('@date 08:00' ,'YYYY/MM/DD HH24:MI'),ba.barrcodi),0)
      + NVL(FN_VTD_CALCULARMONTOENTREGA(h18,TO_DATE('@date 08:30' ,'YYYY/MM/DD HH24:MI'),ba.barrcodi),0)
      + NVL(FN_VTD_CALCULARMONTOENTREGA(h19,TO_DATE('@date 09:00' ,'YYYY/MM/DD HH24:MI'),ba.barrcodi),0)
      + NVL(FN_VTD_CALCULARMONTOENTREGA(h20,TO_DATE('@date 09:30' ,'YYYY/MM/DD HH24:MI'),ba.barrcodi),0)
      + NVL(FN_VTD_CALCULARMONTOENTREGA(h21,TO_DATE('@date 10:00' ,'YYYY/MM/DD HH24:MI'),ba.barrcodi),0)
      + NVL(FN_VTD_CALCULARMONTOENTREGA(h22,TO_DATE('@date 10:30' ,'YYYY/MM/DD HH24:MI'),ba.barrcodi),0)
      + NVL(FN_VTD_CALCULARMONTOENTREGA(h23,TO_DATE('@date 11:00' ,'YYYY/MM/DD HH24:MI'),ba.barrcodi),0)
      + NVL(FN_VTD_CALCULARMONTOENTREGA(h24,TO_DATE('@date 11:30' ,'YYYY/MM/DD HH24:MI'),ba.barrcodi),0)
      + NVL(FN_VTD_CALCULARMONTOENTREGA(h25,TO_DATE('@date 12:00' ,'YYYY/MM/DD HH24:MI'),ba.barrcodi),0)
      + NVL(FN_VTD_CALCULARMONTOENTREGA(h26,TO_DATE('@date 12:30' ,'YYYY/MM/DD HH24:MI'),ba.barrcodi),0)
      + NVL(FN_VTD_CALCULARMONTOENTREGA(h27,TO_DATE('@date 13:00' ,'YYYY/MM/DD HH24:MI'),ba.barrcodi),0)
      + NVL(FN_VTD_CALCULARMONTOENTREGA(h28,TO_DATE('@date 13:30' ,'YYYY/MM/DD HH24:MI'),ba.barrcodi),0)
      + NVL(FN_VTD_CALCULARMONTOENTREGA(h29,TO_DATE('@date 14:00' ,'YYYY/MM/DD HH24:MI'),ba.barrcodi),0)
      + NVL(FN_VTD_CALCULARMONTOENTREGA(h30,TO_DATE('@date 14:30' ,'YYYY/MM/DD HH24:MI'),ba.barrcodi),0)
      + NVL(FN_VTD_CALCULARMONTOENTREGA(h31,TO_DATE('@date 15:00' ,'YYYY/MM/DD HH24:MI'),ba.barrcodi),0)
      + NVL(FN_VTD_CALCULARMONTOENTREGA(h32,TO_DATE('@date 15:30' ,'YYYY/MM/DD HH24:MI'),ba.barrcodi),0)
      + NVL(FN_VTD_CALCULARMONTOENTREGA(h33,TO_DATE('@date 16:00' ,'YYYY/MM/DD HH24:MI'),ba.barrcodi),0)
      + NVL(FN_VTD_CALCULARMONTOENTREGA(h34,TO_DATE('@date 16:30' ,'YYYY/MM/DD HH24:MI'),ba.barrcodi),0)
      + NVL(FN_VTD_CALCULARMONTOENTREGA(h35,TO_DATE('@date 17:00' ,'YYYY/MM/DD HH24:MI'),ba.barrcodi),0)
      + NVL(FN_VTD_CALCULARMONTOENTREGA(h36,TO_DATE('@date 17:30' ,'YYYY/MM/DD HH24:MI'),ba.barrcodi),0)
      + NVL(FN_VTD_CALCULARMONTOENTREGA(h37,TO_DATE('@date 18:00' ,'YYYY/MM/DD HH24:MI'),ba.barrcodi),0)
      + NVL(FN_VTD_CALCULARMONTOENTREGA(h38,TO_DATE('@date 18:30' ,'YYYY/MM/DD HH24:MI'),ba.barrcodi),0)
      + NVL(FN_VTD_CALCULARMONTOENTREGA(h39,TO_DATE('@date 19:00' ,'YYYY/MM/DD HH24:MI'),ba.barrcodi),0)
      + NVL(FN_VTD_CALCULARMONTOENTREGA(h40,TO_DATE('@date 19:30' ,'YYYY/MM/DD HH24:MI'),ba.barrcodi),0)
      + NVL(FN_VTD_CALCULARMONTOENTREGA(h41,TO_DATE('@date 20:00' ,'YYYY/MM/DD HH24:MI'),ba.barrcodi),0)
      + NVL(FN_VTD_CALCULARMONTOENTREGA(h42,TO_DATE('@date 20:30' ,'YYYY/MM/DD HH24:MI'),ba.barrcodi),0)
      + NVL(FN_VTD_CALCULARMONTOENTREGA(h43,TO_DATE('@date 21:00' ,'YYYY/MM/DD HH24:MI'),ba.barrcodi),0)
      + NVL(FN_VTD_CALCULARMONTOENTREGA(h44,TO_DATE('@date 21:30' ,'YYYY/MM/DD HH24:MI'),ba.barrcodi),0)
      + NVL(FN_VTD_CALCULARMONTOENTREGA(h45,TO_DATE('@date 22:00' ,'YYYY/MM/DD HH24:MI'),ba.barrcodi),0)
      + NVL(FN_VTD_CALCULARMONTOENTREGA(h46,TO_DATE('@date 22:30' ,'YYYY/MM/DD HH24:MI'),ba.barrcodi),0)
      + NVL(FN_VTD_CALCULARMONTOENTREGA(h47,TO_DATE('@date 23:00' ,'YYYY/MM/DD HH24:MI'),ba.barrcodi),0)
      + NVL(FN_VTD_CALCULARMONTOENTREGA(h48,TO_DATE('@date 23:30' ,'YYYY/MM/DD HH24:MI'),ba.barrcodi),0)
      ) as VALDENTREGA
      from me_medicion48 m48
      inner join me_ptomedicion pm on pm.ptomedicodi = m48.ptomedicodi
      inner join pr_grupo gr on gr.grupocodi = pm.grupocodi
      inner join eq_equipo eq on eq.grupocodi = gr.grupocodi
      inner join trn_codigo_entrega ce on eq.equipadre = ce.equicodi or eq.equicodi = ce.equicodi
      inner join si_empresa emp on emp.emprcodi = (case when coalesce(m48.EMPRCODI, -1) > 0 then m48.EMPRCODI else gr.emprcodi end)
      inner join trn_barra ba on ba.barrcodi = ce.barrcodi
      where m48.MEDIFECHA = to_date('{0}', 'YYYY-MM-DD') and
      m48.TIPOINFOCODI = 1 and m48.LECTCODI = 6
      group by emp.emprcodi
    </query>
  </Sql>

  <Sql>
    <key>GetEnergiaEntregadabyEmpresas_BKP_202208_ASSETEC</key>
    <query>

      select
      distinct
      emp.emprcodi EMPRCODI, ba.barrcodi,
      (NVL(FN_VTD_CALCULARMONTOENTREGA(h1,TO_DATE('@date','YYYY/MM/DD'),ba.barrcodi,1),0)
      + NVL(FN_VTD_CALCULARMONTOENTREGA(h2,TO_DATE('@date' ,'YYYY/MM/DD'),ba.barrcodi,2),0)
      + NVL(FN_VTD_CALCULARMONTOENTREGA(h3,TO_DATE('@date' ,'YYYY/MM/DD'),ba.barrcodi,3),0)
      + NVL(FN_VTD_CALCULARMONTOENTREGA(h4,TO_DATE('@date' ,'YYYY/MM/DD'),ba.barrcodi,4),0)
      + NVL(FN_VTD_CALCULARMONTOENTREGA(h5,TO_DATE('@date' ,'YYYY/MM/DD'),ba.barrcodi,5),0)
      + NVL(FN_VTD_CALCULARMONTOENTREGA(h6,TO_DATE('@date' ,'YYYY/MM/DD'),ba.barrcodi,6),0)
      + NVL(FN_VTD_CALCULARMONTOENTREGA(h7,TO_DATE('@date' ,'YYYY/MM/DD'),ba.barrcodi,7),0)
      + NVL(FN_VTD_CALCULARMONTOENTREGA(h8,TO_DATE('@date' ,'YYYY/MM/DD'),ba.barrcodi,8),0)
      + NVL(FN_VTD_CALCULARMONTOENTREGA(h9,TO_DATE('@date' ,'YYYY/MM/DD'),ba.barrcodi,9),0)
      + NVL(FN_VTD_CALCULARMONTOENTREGA(h10,TO_DATE('@date' ,'YYYY/MM/DD'),ba.barrcodi,10),0)
      + NVL(FN_VTD_CALCULARMONTOENTREGA(h11,TO_DATE('@date' ,'YYYY/MM/DD'),ba.barrcodi,11),0)
      + NVL(FN_VTD_CALCULARMONTOENTREGA(h12,TO_DATE('@date' ,'YYYY/MM/DD'),ba.barrcodi,12),0)
      + NVL(FN_VTD_CALCULARMONTOENTREGA(h13,TO_DATE('@date' ,'YYYY/MM/DD'),ba.barrcodi,13),0)
      + NVL(FN_VTD_CALCULARMONTOENTREGA(h14,TO_DATE('@date' ,'YYYY/MM/DD'),ba.barrcodi,14),0)
      + NVL(FN_VTD_CALCULARMONTOENTREGA(h15,TO_DATE('@date' ,'YYYY/MM/DD'),ba.barrcodi,15),0)
      + NVL(FN_VTD_CALCULARMONTOENTREGA(h16,TO_DATE('@date' ,'YYYY/MM/DD'),ba.barrcodi,16),0)
      + NVL(FN_VTD_CALCULARMONTOENTREGA(h17,TO_DATE('@date' ,'YYYY/MM/DD'),ba.barrcodi,17),0)
      + NVL(FN_VTD_CALCULARMONTOENTREGA(h18,TO_DATE('@date' ,'YYYY/MM/DD'),ba.barrcodi,18),0)
      + NVL(FN_VTD_CALCULARMONTOENTREGA(h19,TO_DATE('@date' ,'YYYY/MM/DD'),ba.barrcodi,19),0)
      + NVL(FN_VTD_CALCULARMONTOENTREGA(h20,TO_DATE('@date' ,'YYYY/MM/DD'),ba.barrcodi,20),0)
      + NVL(FN_VTD_CALCULARMONTOENTREGA(h21,TO_DATE('@date' ,'YYYY/MM/DD'),ba.barrcodi,21),0)
      + NVL(FN_VTD_CALCULARMONTOENTREGA(h22,TO_DATE('@date' ,'YYYY/MM/DD'),ba.barrcodi,22),0)
      + NVL(FN_VTD_CALCULARMONTOENTREGA(h23,TO_DATE('@date' ,'YYYY/MM/DD'),ba.barrcodi,23),0)
      + NVL(FN_VTD_CALCULARMONTOENTREGA(h24,TO_DATE('@date' ,'YYYY/MM/DD'),ba.barrcodi,24),0)
      + NVL(FN_VTD_CALCULARMONTOENTREGA(h25,TO_DATE('@date' ,'YYYY/MM/DD'),ba.barrcodi,25),0)
      + NVL(FN_VTD_CALCULARMONTOENTREGA(h26,TO_DATE('@date' ,'YYYY/MM/DD'),ba.barrcodi,26),0)
      + NVL(FN_VTD_CALCULARMONTOENTREGA(h27,TO_DATE('@date' ,'YYYY/MM/DD'),ba.barrcodi,27),0)
      + NVL(FN_VTD_CALCULARMONTOENTREGA(h28,TO_DATE('@date' ,'YYYY/MM/DD'),ba.barrcodi,28),0)
      + NVL(FN_VTD_CALCULARMONTOENTREGA(h29,TO_DATE('@date' ,'YYYY/MM/DD'),ba.barrcodi,29),0)
      + NVL(FN_VTD_CALCULARMONTOENTREGA(h30,TO_DATE('@date' ,'YYYY/MM/DD'),ba.barrcodi,30),0)
      + NVL(FN_VTD_CALCULARMONTOENTREGA(h31,TO_DATE('@date' ,'YYYY/MM/DD'),ba.barrcodi,31),0)
      + NVL(FN_VTD_CALCULARMONTOENTREGA(h32,TO_DATE('@date' ,'YYYY/MM/DD'),ba.barrcodi,32),0)
      + NVL(FN_VTD_CALCULARMONTOENTREGA(h33,TO_DATE('@date' ,'YYYY/MM/DD'),ba.barrcodi,33),0)
      + NVL(FN_VTD_CALCULARMONTOENTREGA(h34,TO_DATE('@date' ,'YYYY/MM/DD'),ba.barrcodi,34),0)
      + NVL(FN_VTD_CALCULARMONTOENTREGA(h35,TO_DATE('@date' ,'YYYY/MM/DD'),ba.barrcodi,35),0)
      + NVL(FN_VTD_CALCULARMONTOENTREGA(h36,TO_DATE('@date' ,'YYYY/MM/DD'),ba.barrcodi,36),0)
      + NVL(FN_VTD_CALCULARMONTOENTREGA(h37,TO_DATE('@date' ,'YYYY/MM/DD'),ba.barrcodi,37),0)
      + NVL(FN_VTD_CALCULARMONTOENTREGA(h38,TO_DATE('@date' ,'YYYY/MM/DD'),ba.barrcodi,38),0)
      + NVL(FN_VTD_CALCULARMONTOENTREGA(h39,TO_DATE('@date' ,'YYYY/MM/DD'),ba.barrcodi,39),0)
      + NVL(FN_VTD_CALCULARMONTOENTREGA(h40,TO_DATE('@date' ,'YYYY/MM/DD'),ba.barrcodi,40),0)
      + NVL(FN_VTD_CALCULARMONTOENTREGA(h41,TO_DATE('@date' ,'YYYY/MM/DD'),ba.barrcodi,41),0)
      + NVL(FN_VTD_CALCULARMONTOENTREGA(h42,TO_DATE('@date' ,'YYYY/MM/DD'),ba.barrcodi,42),0)
      + NVL(FN_VTD_CALCULARMONTOENTREGA(h43,TO_DATE('@date' ,'YYYY/MM/DD'),ba.barrcodi,43),0)
      + NVL(FN_VTD_CALCULARMONTOENTREGA(h44,TO_DATE('@date' ,'YYYY/MM/DD'),ba.barrcodi,44),0)
      + NVL(FN_VTD_CALCULARMONTOENTREGA(h45,TO_DATE('@date' ,'YYYY/MM/DD'),ba.barrcodi,45),0)
      + NVL(FN_VTD_CALCULARMONTOENTREGA(h46,TO_DATE('@date' ,'YYYY/MM/DD'),ba.barrcodi,46),0)
      + NVL(FN_VTD_CALCULARMONTOENTREGA(h47,TO_DATE('@date' ,'YYYY/MM/DD'),ba.barrcodi,47),0)
      + NVL(FN_VTD_CALCULARMONTOENTREGA(h48,TO_DATE('@date' ,'YYYY/MM/DD'),ba.barrcodi,48),0)
      ) as VALDENTREGA
      from me_medicion48 m48
      inner join me_ptomedicion pm on pm.ptomedicodi = m48.ptomedicodi
      inner join pr_grupo gr on gr.grupocodi = pm.grupocodi and (gr.catecodi = 3 or gr.catecodi = 5)
      inner join si_empresa emp on emp.emprcodi = (case when coalesce(m48.EMPRCODI, -1) > 0 then m48.EMPRCODI else gr.emprcodi end) and emp.emprcodi in ({1})
      inner join eq_equipo eq on eq.grupocodi = gr.grupocodi
      inner join trn_codigo_entrega ce on eq.equipadre = ce.equicodi or eq.equicodi = ce.equicodi
      inner join trn_barra ba on ba.barrcodi = ce.barrcodi
      where m48.MEDIFECHA = to_date('{0}', 'YYYY-MM-DD') and
      m48.TIPOINFOCODI = 1 and m48.LECTCODI = 6
    </query>
  </Sql>

  <Sql>
    <key>GetEnergiaEntregadabyEmpresas</key>
    <query>
      select t.EMPRCODI, t.barrcodi, sum(t.VALDENTREGA) as VALDENTREGA
      from (
          select
          distinct
          emp.emprcodi EMPRCODI, ba.barrcodi,
          (NVL(FN_VTD_CALCULARMONTOENTREGA(h1,TO_DATE('@date','YYYY/MM/DD'),ba.barrcodi,1),0)
          + NVL(FN_VTD_CALCULARMONTOENTREGA(h2,TO_DATE('@date' ,'YYYY/MM/DD'),ba.barrcodi,2),0)
          + NVL(FN_VTD_CALCULARMONTOENTREGA(h3,TO_DATE('@date' ,'YYYY/MM/DD'),ba.barrcodi,3),0)
          + NVL(FN_VTD_CALCULARMONTOENTREGA(h4,TO_DATE('@date' ,'YYYY/MM/DD'),ba.barrcodi,4),0)
          + NVL(FN_VTD_CALCULARMONTOENTREGA(h5,TO_DATE('@date' ,'YYYY/MM/DD'),ba.barrcodi,5),0)
          + NVL(FN_VTD_CALCULARMONTOENTREGA(h6,TO_DATE('@date' ,'YYYY/MM/DD'),ba.barrcodi,6),0)
          + NVL(FN_VTD_CALCULARMONTOENTREGA(h7,TO_DATE('@date' ,'YYYY/MM/DD'),ba.barrcodi,7),0)
          + NVL(FN_VTD_CALCULARMONTOENTREGA(h8,TO_DATE('@date' ,'YYYY/MM/DD'),ba.barrcodi,8),0)
          + NVL(FN_VTD_CALCULARMONTOENTREGA(h9,TO_DATE('@date' ,'YYYY/MM/DD'),ba.barrcodi,9),0)
          + NVL(FN_VTD_CALCULARMONTOENTREGA(h10,TO_DATE('@date' ,'YYYY/MM/DD'),ba.barrcodi,10),0)
          + NVL(FN_VTD_CALCULARMONTOENTREGA(h11,TO_DATE('@date' ,'YYYY/MM/DD'),ba.barrcodi,11),0)
          + NVL(FN_VTD_CALCULARMONTOENTREGA(h12,TO_DATE('@date' ,'YYYY/MM/DD'),ba.barrcodi,12),0)
          + NVL(FN_VTD_CALCULARMONTOENTREGA(h13,TO_DATE('@date' ,'YYYY/MM/DD'),ba.barrcodi,13),0)
          + NVL(FN_VTD_CALCULARMONTOENTREGA(h14,TO_DATE('@date' ,'YYYY/MM/DD'),ba.barrcodi,14),0)
          + NVL(FN_VTD_CALCULARMONTOENTREGA(h15,TO_DATE('@date' ,'YYYY/MM/DD'),ba.barrcodi,15),0)
          + NVL(FN_VTD_CALCULARMONTOENTREGA(h16,TO_DATE('@date' ,'YYYY/MM/DD'),ba.barrcodi,16),0)
          + NVL(FN_VTD_CALCULARMONTOENTREGA(h17,TO_DATE('@date' ,'YYYY/MM/DD'),ba.barrcodi,17),0)
          + NVL(FN_VTD_CALCULARMONTOENTREGA(h18,TO_DATE('@date' ,'YYYY/MM/DD'),ba.barrcodi,18),0)
          + NVL(FN_VTD_CALCULARMONTOENTREGA(h19,TO_DATE('@date' ,'YYYY/MM/DD'),ba.barrcodi,19),0)
          + NVL(FN_VTD_CALCULARMONTOENTREGA(h20,TO_DATE('@date' ,'YYYY/MM/DD'),ba.barrcodi,20),0)
          + NVL(FN_VTD_CALCULARMONTOENTREGA(h21,TO_DATE('@date' ,'YYYY/MM/DD'),ba.barrcodi,21),0)
          + NVL(FN_VTD_CALCULARMONTOENTREGA(h22,TO_DATE('@date' ,'YYYY/MM/DD'),ba.barrcodi,22),0)
          + NVL(FN_VTD_CALCULARMONTOENTREGA(h23,TO_DATE('@date' ,'YYYY/MM/DD'),ba.barrcodi,23),0)
          + NVL(FN_VTD_CALCULARMONTOENTREGA(h24,TO_DATE('@date' ,'YYYY/MM/DD'),ba.barrcodi,24),0)
          + NVL(FN_VTD_CALCULARMONTOENTREGA(h25,TO_DATE('@date' ,'YYYY/MM/DD'),ba.barrcodi,25),0)
          + NVL(FN_VTD_CALCULARMONTOENTREGA(h26,TO_DATE('@date' ,'YYYY/MM/DD'),ba.barrcodi,26),0)
          + NVL(FN_VTD_CALCULARMONTOENTREGA(h27,TO_DATE('@date' ,'YYYY/MM/DD'),ba.barrcodi,27),0)
          + NVL(FN_VTD_CALCULARMONTOENTREGA(h28,TO_DATE('@date' ,'YYYY/MM/DD'),ba.barrcodi,28),0)
          + NVL(FN_VTD_CALCULARMONTOENTREGA(h29,TO_DATE('@date' ,'YYYY/MM/DD'),ba.barrcodi,29),0)
          + NVL(FN_VTD_CALCULARMONTOENTREGA(h30,TO_DATE('@date' ,'YYYY/MM/DD'),ba.barrcodi,30),0)
          + NVL(FN_VTD_CALCULARMONTOENTREGA(h31,TO_DATE('@date' ,'YYYY/MM/DD'),ba.barrcodi,31),0)
          + NVL(FN_VTD_CALCULARMONTOENTREGA(h32,TO_DATE('@date' ,'YYYY/MM/DD'),ba.barrcodi,32),0)
          + NVL(FN_VTD_CALCULARMONTOENTREGA(h33,TO_DATE('@date' ,'YYYY/MM/DD'),ba.barrcodi,33),0)
          + NVL(FN_VTD_CALCULARMONTOENTREGA(h34,TO_DATE('@date' ,'YYYY/MM/DD'),ba.barrcodi,34),0)
          + NVL(FN_VTD_CALCULARMONTOENTREGA(h35,TO_DATE('@date' ,'YYYY/MM/DD'),ba.barrcodi,35),0)
          + NVL(FN_VTD_CALCULARMONTOENTREGA(h36,TO_DATE('@date' ,'YYYY/MM/DD'),ba.barrcodi,36),0)
          + NVL(FN_VTD_CALCULARMONTOENTREGA(h37,TO_DATE('@date' ,'YYYY/MM/DD'),ba.barrcodi,37),0)
          + NVL(FN_VTD_CALCULARMONTOENTREGA(h38,TO_DATE('@date' ,'YYYY/MM/DD'),ba.barrcodi,38),0)
          + NVL(FN_VTD_CALCULARMONTOENTREGA(h39,TO_DATE('@date' ,'YYYY/MM/DD'),ba.barrcodi,39),0)
          + NVL(FN_VTD_CALCULARMONTOENTREGA(h40,TO_DATE('@date' ,'YYYY/MM/DD'),ba.barrcodi,40),0)
          + NVL(FN_VTD_CALCULARMONTOENTREGA(h41,TO_DATE('@date' ,'YYYY/MM/DD'),ba.barrcodi,41),0)
          + NVL(FN_VTD_CALCULARMONTOENTREGA(h42,TO_DATE('@date' ,'YYYY/MM/DD'),ba.barrcodi,42),0)
          + NVL(FN_VTD_CALCULARMONTOENTREGA(h43,TO_DATE('@date' ,'YYYY/MM/DD'),ba.barrcodi,43),0)
          + NVL(FN_VTD_CALCULARMONTOENTREGA(h44,TO_DATE('@date' ,'YYYY/MM/DD'),ba.barrcodi,44),0)
          + NVL(FN_VTD_CALCULARMONTOENTREGA(h45,TO_DATE('@date' ,'YYYY/MM/DD'),ba.barrcodi,45),0)
          + NVL(FN_VTD_CALCULARMONTOENTREGA(h46,TO_DATE('@date' ,'YYYY/MM/DD'),ba.barrcodi,46),0)
          + NVL(FN_VTD_CALCULARMONTOENTREGA(h47,TO_DATE('@date' ,'YYYY/MM/DD'),ba.barrcodi,47),0)
          + NVL(FN_VTD_CALCULARMONTOENTREGA(h48,TO_DATE('@date' ,'YYYY/MM/DD'),ba.barrcodi,48),0)
          ) as VALDENTREGA
          from me_medicion48 m48
          inner join me_ptomedicion pm on pm.ptomedicodi = m48.ptomedicodi
          inner join pr_grupo gr on gr.grupocodi = pm.grupocodi and (gr.catecodi = 3 or gr.catecodi = 5)
          inner join si_empresa emp on emp.emprcodi = (case when coalesce(m48.EMPRCODI, -1) > 0 then m48.EMPRCODI else gr.emprcodi end) and emp.emprcodi in ({1})
          inner join eq_equipo eq on eq.grupocodi = gr.grupocodi
          inner join trn_codigo_entrega ce on eq.equipadre = ce.equicodi or eq.equicodi = ce.equicodi
          inner join trn_barra ba on ba.barrcodi = ce.barrcodi
          where m48.MEDIFECHA = to_date('{0}', 'YYYY-MM-DD') and
          m48.TIPOINFOCODI = 1 and m48.LECTCODI = 93) t
      group by t.emprcodi, t.barrcodi
    </query>
  </Sql>


  <!--Consulta para Obtener Intervalo de punta del mes-->
  <Sql>
    <key>GetIntervaloPuntaMes</key>
    <query>
      select medifecha, '' as h1, '' as h2, '' as h3, '' as h4, '' as h5, '' as h6, '' as h7, '' as h8, '' as h9, '' as h10,
      '' as h11, '' as h12, '' as h13, '' as h14, '' as h15, '' as h16, '' as h17, '' as h18, '' as h19, '' as h20,
      '' as h21, '' as h22, '' as h23, '' as h24, '' as h25, '' as h26, '' as h27, '' as h28, '' as h29, '' as h30,
      '' as h31, '' as h32, '' as h33, sum(h34) as h34, sum(h35) as h35, sum(h36) as h36, sum(h37) as h37, sum(h38) as h38, sum(h39) as h39, sum(h40) as h40,
      sum(h41) as h41, sum(h42) as h42, sum(h43) as h43, sum(h44) as h44, sum(h45) as h45, sum(h46) as h46, '' as h47, '' as h48 from
      me_medicion48 medi48
      inner join me_ptomedicion pm on pm.ptomedicodi = medi48.ptomedicodi
      inner join pr_grupo gr on gr.grupocodi = pm.grupocodi and (gr.catecodi =3 or gr.catecodi =5)
      inner join si_empresa emp on emp.emprcodi = (case when coalesce(medi48.EMPRCODI, -1) > 0 then medi48.EMPRCODI else gr.emprcodi end)
      where
      medi48.lectcodi=6 and
      medi48.tipoinfocodi = 1 and
      medi48.medifecha = (
      select to_date(to_char(medifecha, 'YYYY-MM-DD'), 'YYYY-MM-DD') from (
      select
      medifecha,
      greatest (sum(h34), sum(h35), sum(h36), sum(h37), sum(h38), sum(h39), sum(h40),
      sum(h41), sum(h42), sum(h43), sum(h44), sum(h45), sum(h46)) as maximo
      from
      me_medicion48 medi48
      inner join me_ptomedicion pm on pm.ptomedicodi = medi48.ptomedicodi
      inner join pr_grupo gr on gr.grupocodi = pm.grupocodi and (gr.catecodi =3 or gr.catecodi =5)
      inner join si_empresa emp on emp.emprcodi = (case when coalesce(medi48.EMPRCODI, -1) > 0 then medi48.EMPRCODI else gr.emprcodi end)
      where
      medi48.lectcodi=6 and
      medi48.tipoinfocodi = 1 and
      medi48.medifecha >= to_date('{0} 00:00:00', 'YYYY-MM-DD HH24:MI:SS') and
      medi48.medifecha &lt;= to_date('{1} 23:59:59', 'YYYY-MM-DD HH24:MI:SS')
      group by medifecha
      order by 2 desc
      )
      where rownum = 1
      )group by medifecha, ''
    </query>
  </Sql>

  <!--FIN Valorizaciones-->

  <!--INICIO NUMERALES DATOS BASE-->

  <Sql>
    <key>ListaDatosBase_5_8_4</key>
    <query>
      select TO_CHAR(MEDIFECHA, 'DD') AS DIA, T.*
      from me_medicion48 t
      where ptomedicodi = 1226
      and lectcodi = 3
      and medifecha between to_date('{0}', 'DD-MM-YYYY') and
      to_date('{1} 23:59:59', 'DD-MM-YYYY HH24:MI:SS')
      order by medifecha asc
    </query>
  </Sql>

  <Sql>
    <key>ListaDatosBase_5_8_5</key>
    <query>
      select TO_CHAR(MEDIFECHA, 'DD') AS DIA, T.*
      from me_medicion48 t
      where ptomedicodi = 1226
      and lectcodi = 4
      and medifecha between to_date('{0}', 'DD-MM-YYYY') and
      to_date('{1} 23:59:59', 'DD-MM-YYYY HH24:MI:SS')
      order by medifecha asc
    </query>
  </Sql>

  <Sql>
    <key>ListaDatosBase_5_9_1</key>
    <query>
      select sum(meditotal * 0.5) as valor, to_char(medifecha, 'DD') as DIA
      from me_medicion48
      where medifecha between to_date('{0}', 'DD-MM-YYYY') and
      to_date('{1} 23:59:59', 'DD-MM-YYYY HH24:MI:SS')
      and tipoinfocodi = 1
      and lectcodi = 5
      group by to_char(medifecha, 'DD')
      order by 2
    </query>
  </Sql>

  <Sql>
    <key>ListaDatosBase_5_9_2</key>
    <query>
      select sum(meditotal * 0.5) as valor, to_char(medifecha, 'DD') as DIA
      from me_medicion48
      where medifecha between to_date('{0}', 'DD-MM-YYYY') and
      to_date('{1} 23:59:59', 'DD-MM-YYYY HH24:MI:SS')
      and tipoinfocodi = 1
      and lectcodi = 3
      group by to_char(medifecha, 'DD')
      order by 2
    </query>
  </Sql>

  <Sql>
    <key>ListaDatosBase_5_9_3</key>
    <query>
      select sum(meditotal * 0.5) as valor, to_char(medifecha, 'DD') as DIA
      from me_medicion48
      where medifecha between to_date('{0}', 'DD-MM-YYYY') and
      to_date('{1} 23:59:59', 'DD-MM-YYYY HH24:MI:SS')
      and tipoinfocodi = 1
      and lectcodi = 6
      group by to_char(medifecha, 'DD')
      order by 2
    </query>
  </Sql>

  <Sql>
    <key>ListaMedUsuariosLibres</key>
    <query>
      select
      t.ptomedicodi, to_char(t.medifecha, 'DD') as DIA, t.medifecha, t.lectcodi, t.meditotal, (case when coalesce(t.EMPRCODI, -1) > 0 then t.EMPRCODI else eq.emprcodi end) emprcodi,
      h1,h2,h3,h4,h5,h6,h7,h8,h9,h10,h11,h12,h13,h14,h15,h16,h17,h18,h19,h20,h21,h22,h23,h24,h25,h26,h27,h28,h29,h30,h31,h32,h33,h34,h35,h36,h37,h38,h39,h40,h41,h42,h43,h44,h45,h46,h47,h48
      from ME_MEDICION48 t
      inner join me_ptomedicion pto on pto.ptomedicodi = t.ptomedicodi
      inner join eq_equipo eq on eq.equicodi = pto.equicodi
      where
      t.medifecha >= to_date('{0}','YYYY-MM-DD') and t.medifecha &lt;= to_date('{1}','YYYY-MM-DD')
      and t.lectcodi in (110,103,102)
      and t.tipoinfocodi = 1
      order by t.ptomedicodi, t.medifecha, t.lectcodi
    </query>
  </Sql>

  <Sql>
    <key>ObtenerConsultaPorTipoGeneracion</key>
    <query>
      SELECT emp.emprnomb,GR.GRUPONOMB, me.* FROM ME_MEDICION48 me

      INNER JOIN ME_PTOMEDICION pm on pm.ptomedicodi = me.ptomedicodi

      INNER JOIN PR_GRUPO gr on gr.grupocodi = pm.grupocodi

      INNER JOIN SI_EMPRESA emp ON emp.emprcodi = gr.emprcodi

      where gr.grupointegrante ='N' and (me.medifecha between to_date('{0}','YYYY-MM-DD') and to_date('{1}','YYYY-MM-DD'))  and me.lectcodi=6 and me.tipoinfocodi=1

      order by gruponomb, medifecha
    </query>
  </Sql>

  <Sql>
    <key>NroRegistrosConsultasTipoGeneracion</key>
    <query>
      SELECT count(*)

      FROM ME_MEDICION48 me

      INNER JOIN ME_PTOMEDICION pm on pm.ptomedicodi = me.ptomedicodi

      INNER JOIN PR_GRUPO gr on gr.grupocodi = pm.grupocodi

      INNER JOIN SI_EMPRESA emp ON emp.emprcodi = gr.emprcodi

      where gr.grupointegrante ='N' and (me.medifecha between to_date('2019-12-01','YYYY-MM-DD') and to_date('2020-02-25','YYYY-MM-DD'))  and me.lectcodi=6 and me.tipoinfocodi=1

      order by gruponomb, medifecha
    </query>
  </Sql>

  <!--FIN NUMERALES DATOS BASE-->

  <Sql>
    <key>ObtenerDatosDespachoComparativo</key>
    <query>
      select
      medifecha,
      sum(h1) as h1,
      sum(h2) as h2,
      sum(h3) as h3,
      sum(h4) as h4,
      sum(h5) as h5,
      sum(h6) as h6,
      sum(h7) as h7,
      sum(h8) as h8,
      sum(h9) as h9,
      sum(h10) as h10,
      sum(h11) as h11,
      sum(h12) as h12,
      sum(h13) as h13,
      sum(h14) as h14,
      sum(h15) as h15,
      sum(h16) as h16,
      sum(h17) as h17,
      sum(h18) as h18,
      sum(h19) as h19,
      sum(h20) as h20,
      sum(h21) as h21,
      sum(h22) as h22,
      sum(h23) as h23,
      sum(h24) as h24,
      sum(h25) as h25,
      sum(h26) as h26,
      sum(h27) as h27,
      sum(h28) as h28,
      sum(h29) as h29,
      sum(h30) as h30,
      sum(h31) as h31,
      sum(h32) as h32,
      sum(h33) as h33,
      sum(h34) as h34,
      sum(h35) as h35,
      sum(h36) as h36,
      sum(h37) as h37,
      sum(h38) as h38,
      sum(h39) as h39,
      sum(h40) as h40,
      sum(h41) as h41,
      sum(h42) as h42,
      sum(h43) as h43,
      sum(h44) as h44,
      sum(h45) as h45,
      sum(h46) as h46,
      sum(h47) as h47,
      sum(h48) as h48
      from me_medicion48 med where
      (med.medifecha >= to_date('{0} 00:00:00','YYYY-MM-DD HH24:MI:SS') and med.medifecha
      &lt;= to_date('{1} 23:59:59','YYYY-MM-DD HH24:MI:SS')) and
      med.ptomedicodi in ({2}) and  med.lectcodi = {3} and med.tipoinfocodi = {4}
      --and p.origlectcodi = 1
      group by medifecha
      order by medifecha
    </query>
  </Sql>

	<!--INICIO Mejoras RDO-->
	<Sql>
		<key>SaveEjecutados</key>
		<query>
			insert into ME_MEDICION_EJECUTADOS48(
			enviocodi,
			lastuser,
			lastdate,
			lectcodi,
			medifecha,
			tipoinfocodi,
			ptomedicodi,
			meditotal,
			mediestado,
			h1,
			h2,
			h3,
			h4,
			h5,
			h6,
			h7,
			h8,
			h9,
			h10,
			h11,
			h12,
			h13,
			h14,
			h15,
			h16,
			h17,
			h18,
			h19,
			h20,
			h21,
			h22,
			h23,
			h24,
			h25,
			h26,
			h27,
			h28,
			h29,
			h30,
			h31,
			h32,
			h33,
			h34,
			h35,
			h36,
			h37,
			h38,
			h39,
			h40,
			h41,
			h42,
			h43,
			h44,
			h45,
			h46,
			h47,
			h48,
			E1,
			E2,
			E3,
			E4,
			E5,
			E6,
			E7,
			E8,
			E9,
			E10,
			E11,
			E12,
			E13,
			E14,
			E15,
			E16,
			E17,
			E18,
			E19,
			E20,
			E21,
			E22,
			E23,
			E24,
			E25,
			E26,
			E27,
			E28,
			E29,
			E30,
			E31,
			E32,
			E33,
			E34,
			E35,
			E36,
			E37,
			E38,
			E39,
			E40,
			E41,
			E42,
			E43,
			E44,
			E45,
			E46,
			E47,
			E48,
			emprcodi
			)
			values(
			:enviocodi,
			:lastuser,
			:lastdate,
			:lectcodi,
			:medifecha,
			:tipoinfocodi,
			:ptomedicodi,
			:meditotal,
			:mediestado,
			:h1,
			:h2,
			:h3,
			:h4,
			:h5,
			:h6,
			:h7,
			:h8,
			:h9,
			:h10,
			:h11,
			:h12,
			:h13,
			:h14,
			:h15,
			:h16,
			:h17,
			:h18,
			:h19,
			:h20,
			:h21,
			:h22,
			:h23,
			:h24,
			:h25,
			:h26,
			:h27,
			:h28,
			:h29,
			:h30,
			:h31,
			:h32,
			:h33,
			:h34,
			:h35,
			:h36,
			:h37,
			:h38,
			:h39,
			:h40,
			:h41,
			:h42,
			:h43,
			:h44,
			:h45,
			:h46,
			:h47,
			:h48,
			:E1,
			:E2,
			:E3,
			:E4,
			:E5,
			:E6,
			:E7,
			:E8,
			:E9,
			:E10,
			:E11,
			:E12,
			:E13,
			:E14,
			:E15,
			:E16,
			:E17,
			:E18,
			:E19,
			:E20,
			:E21,
			:E22,
			:E23,
			:E24,
			:E25,
			:E26,
			:E27,
			:E28,
			:E29,
			:E30,
			:E31,
			:E32,
			:E33,
			:E34,
			:E35,
			:E36,
			:E37,
			:E38,
			:E39,
			:E40,
			:E41,
			:E42,
			:E43,
			:E44,
			:E45,
			:E46,
			:E47,
			:E48,
			:emprcodi
			)
		</query>
	</Sql>

	<Sql>
		<key>GetGeneracionRERNC</key>
		<query>
			select * from me_medicion_ejecutados48
			where lectcodi = {0}
			and (medifecha >= to_date('{1} 00:00:00','yyyy-MM-dd HH24:MI:SS') and medifecha &lt;= to_date('{2} 23:59:59','yyyy-MM-dd HH24:MI:SS'))
			and ptomedicodi in (
			select
			rer.ptomedicodi
			from
			wb_generacionrer rer
			inner join me_ptomedicion pto on rer.ptomedicodi = pto.ptomedicodi
			where (pto.emprcodi = {3} or {3} = 0) and rer.estado = 'A')
			order by medifecha asc
		</query>
	</Sql>

  <Sql>
    <key>GetEnvioArchivoEjecutados</key>
    <query>
      SELECT (CASE WHEN COALESCE(ME.EMPRCODI, -1) > 0 THEN ME.EMPRCODI ELSE PTO.EMPRCODI END) AS EMPRCODI, ME.* FROM ME_MEDICION_EJECUTADOS48 ME
      INNER JOIN ME_HOJAPTOMED HP ON HP.PTOMEDICODI = ME.PTOMEDICODI AND HP.TIPOINFOCODI = ME.TIPOINFOCODI
      INNER JOIN ME_FORMATO FH ON FH.FORMATCODI = HP.FORMATCODI AND (CASE WHEN {4} > 0 THEN {4} ELSE FH.LECTCODI END) = ME.LECTCODI
      INNER JOIN ME_PTOMEDICION PTO ON PTO.PTOMEDICODI = HP.PTOMEDICODI
      INNER JOIN EQ_EQUIPO EQ ON EQ.EQUICODI = PTO.EQUICODI
      LEFT JOIN ME_ENVIO_HORARIO HOR ON ME.ENVIOCODI = HOR.ENVIOCODI
      WHERE HP.FORMATCODI = {0} AND ( (CASE WHEN COALESCE(ME.EMPRCODI, -1) > 0 THEN ME.EMPRCODI ELSE PTO.EMPRCODI END) IN ({1}) OR '{1}' = '-1')
      AND ME.MEDIFECHA >= TO_DATE('{2}','YYYY-MM-DD') AND ME.MEDIFECHA &lt;= TO_DATE('{3}','YYYY-MM-DD')
      AND (HOR.HORARIOCODI = {5} OR ('{5}' = '0'))
      AND ME.ENVIOCODI = (SELECT MAX(SME.ENVIOCODI) FROM ME_MEDICION_EJECUTADOS48 SME
      LEFT JOIN ME_ENVIO_HORARIO SHOR ON SME.ENVIOCODI = SHOR.ENVIOCODI WHERE SME.LECTCODI = ME.LECTCODI
      AND SME.PTOMEDICODI = ME.PTOMEDICODI AND SME.MEDIFECHA = ME.MEDIFECHA AND SME.EMPRCODI = ME.EMPRCODI AND SME.TIPOINFOCODI = ME.TIPOINFOCODI AND (SHOR.HORARIOCODI = {5} OR ('{5}' = '0')) AND SME.EMPRCODI = ME.EMPRCODI
      AND SME.MEDIFECHA >= TO_DATE('{2}','YYYY-MM-DD') AND SME.MEDIFECHA &lt;= TO_DATE('{3}','YYYY-MM-DD'))
      ORDER BY HP.HPTOORDEN ASC
    </query>
  </Sql>

	<Sql>
		<key>SaveIntranet</key>
		<query>
			insert into ME_MEDICION48_INTRANET(
			enviocodi,
			lastuser,
			lastdate,
			lectcodi,
			medifecha,
			tipoinfocodi,
			ptomedicodi,
			meditotal,
			mediestado,
			h1,
			h2,
			h3,
			h4,
			h5,
			h6,
			h7,
			h8,
			h9,
			h10,
			h11,
			h12,
			h13,
			h14,
			h15,
			h16,
			h17,
			h18,
			h19,
			h20,
			h21,
			h22,
			h23,
			h24,
			h25,
			h26,
			h27,
			h28,
			h29,
			h30,
			h31,
			h32,
			h33,
			h34,
			h35,
			h36,
			h37,
			h38,
			h39,
			h40,
			h41,
			h42,
			h43,
			h44,
			h45,
			h46,
			h47,
			h48,
			emprcodi
			)
			values(
			:enviocodi,
			:lastuser,
			:lastdate,
			:lectcodi,
			:medifecha,
			:tipoinfocodi,
			:ptomedicodi,
			:meditotal,
			:mediestado,
			:h1,
			:h2,
			:h3,
			:h4,
			:h5,
			:h6,
			:h7,
			:h8,
			:h9,
			:h10,
			:h11,
			:h12,
			:h13,
			:h14,
			:h15,
			:h16,
			:h17,
			:h18,
			:h19,
			:h20,
			:h21,
			:h22,
			:h23,
			:h24,
			:h25,
			:h26,
			:h27,
			:h28,
			:h29,
			:h30,
			:h31,
			:h32,
			:h33,
			:h34,
			:h35,
			:h36,
			:h37,
			:h38,
			:h39,
			:h40,
			:h41,
			:h42,
			:h43,
			:h44,
			:h45,
			:h46,
			:h47,
			:h48,
			:emprcodi
			)
		</query>
	</Sql>

	<Sql>
		<key>GetEnvioMeMedicion48Intranet</key>
		<query>
			select (case when coalesce(me.EMPRCODI, -1) > 0 then me.EMPRCODI else pto.emprcodi end) as EMPRCODI, me.* from ME_MEDICION48_INTRANET me
			inner join me_hojaptomed hp on hp.ptomedicodi = me.ptomedicodi and hp.tipoinfocodi = me.tipoinfocodi
			inner join me_formato fh on fh.formatcodi = hp.formatcodi and (case when {4} > 0 then {4} else fh.lectcodi end) = me.lectcodi
			inner join me_ptomedicion pto on pto.ptomedicodi = hp.ptomedicodi
			inner join eq_equipo eq on eq.equicodi = pto.equicodi
			where hp.formatcodi = {0} and ( (case when coalesce(me.EMPRCODI, -1) > 0 then me.EMPRCODI else pto.emprcodi end) in ({1}) or '{1}' = '-1') and medifecha >= to_date('{2}','YYYY-MM-DD') AND
			medifecha &lt;= to_date('{3}','YYYY-MM-DD') and enviocodi = (SELECT MAX(ENVIOCODI) FROM ME_MEDICION48_INTRANET WHERE LECTCODI = me.LECTCODI
			AND PTOMEDICODI = me.PTOMEDICODI AND MEDIFECHA = me.MEDIFECHA AND EMPRCODI = me.EMPRCODI AND TIPOINFOCODI = me.TIPOINFOCODI)
			order by hp.hptoorden asc
		</query>
	</Sql>
	<!--FIN Mejoras RDO-->

  <!--INICIO Yupana Continuo-->
  <Sql>
    <key>ObtenerAportesHidro</key>
    <query>
      select m.*, rpmed.recurcodi ,rpmed.recptok from me_medicion48 m
      inner join me_ptomedicion pto on pto.ptomedicodi = m.ptomedicodi
      inner join cp_recurptomed rpmed on rpmed.ptomedicodi = m.ptomedicodi and rpmed.topcodi = {2}
      inner join cp_recurso rec on rec.recurcodi = rpmed.recurcodi and rec.topcodi = {2}
      where
      m.medifecha >= to_date('{0}','YYYY-MM-DD') and
      m.medifecha &lt;= to_date('{1}','YYYY-MM-DD') and m.lectcodi = {3}
      order by m.ptomedicodi
    </query>
  </Sql>
  <!--FIN Yupana Continuo-->
  <!--INICIO Mejoras RDO-II-->
  <Sql>
    <key>GetEnvioArchivoUltimosEjecutados</key>
    <query>
      SELECT (CASE WHEN COALESCE(ME.EMPRCODI, -1) > 0 THEN ME.EMPRCODI ELSE PTO.EMPRCODI END) AS EMPRCODI, ME.* FROM ME_MEDICION_EJECUTADOS48 ME
      INNER JOIN ME_HOJAPTOMED HP ON HP.PTOMEDICODI = ME.PTOMEDICODI AND HP.TIPOINFOCODI = ME.TIPOINFOCODI
      INNER JOIN ME_FORMATO FH ON FH.FORMATCODI = HP.FORMATCODI AND (CASE WHEN {4} > 0 THEN {4} ELSE FH.LECTCODI END) = ME.LECTCODI
      INNER JOIN ME_PTOMEDICION PTO ON PTO.PTOMEDICODI = HP.PTOMEDICODI
      INNER JOIN EQ_EQUIPO EQ ON EQ.EQUICODI = PTO.EQUICODI
      INNER JOIN ME_ENVIO_HORARIO HOR ON ME.ENVIOCODI = HOR.ENVIOCODI
      WHERE HP.FORMATCODI = {0} AND ( (CASE WHEN COALESCE(ME.EMPRCODI, -1) > 0 THEN ME.EMPRCODI ELSE PTO.EMPRCODI END) IN ({1}) OR '{1}' = '-1')
      AND ME.MEDIFECHA >= TO_DATE('{2}','YYYY-MM-DD') AND ME.MEDIFECHA &lt;= TO_DATE('{3}','YYYY-MM-DD')
      AND ME.ENVIOCODI = (SELECT MAX(SME.ENVIOCODI) FROM ME_MEDICION_EJECUTADOS48 SME
      INNER JOIN ME_ENVIO_HORARIO SHOR ON SME.ENVIOCODI = SHOR.ENVIOCODI WHERE SME.LECTCODI = ME.LECTCODI
      AND SME.PTOMEDICODI = ME.PTOMEDICODI AND SME.MEDIFECHA = ME.MEDIFECHA AND SME.EMPRCODI = ME.EMPRCODI AND SME.TIPOINFOCODI = ME.TIPOINFOCODI AND SME.EMPRCODI = ME.EMPRCODI)
      ORDER BY HP.HPTOORDEN ASC
    </query>
  </Sql>
  <Sql>
    <key>GetEnvioArchivoEjecutadosIntranet</key>
    <query>
      SELECT (CASE WHEN COALESCE(ME.EMPRCODI, -1) > 0 THEN ME.EMPRCODI ELSE PTO.EMPRCODI END) AS EMPRCODI, ME.* FROM ME_MEDICION_EJECUTADOS48 ME
      INNER JOIN ME_HOJAPTOMED HP ON HP.PTOMEDICODI = ME.PTOMEDICODI AND HP.TIPOINFOCODI = ME.TIPOINFOCODI
      INNER JOIN ME_FORMATO FH ON FH.FORMATCODI = HP.FORMATCODI AND (CASE WHEN {3} > 0 THEN {3} ELSE FH.LECTCODI END) = ME.LECTCODI
      INNER JOIN ME_PTOMEDICION PTO ON PTO.PTOMEDICODI = HP.PTOMEDICODI
      INNER JOIN EQ_EQUIPO EQ ON EQ.EQUICODI = PTO.EQUICODI
      WHERE HP.FORMATCODI = {0}
      AND ME.MEDIFECHA >= TO_DATE('{1}','YYYY-MM-DD') AND ME.MEDIFECHA &lt;= TO_DATE('{2}','YYYY-MM-DD')
      ORDER BY HP.HPTOORDEN ASC
    </query>
  </Sql>
  <Sql>
    <key>GetEnvioArchivoEjecutadosxEnviocodi</key>
    <query>
      SELECT (CASE WHEN COALESCE(ME.EMPRCODI, -1) > 0 THEN ME.EMPRCODI ELSE PTO.EMPRCODI END) AS EMPRCODI, ME.* FROM ME_MEDICION_EJECUTADOS48 ME
      INNER JOIN ME_HOJAPTOMED HP ON HP.PTOMEDICODI = ME.PTOMEDICODI AND HP.TIPOINFOCODI = ME.TIPOINFOCODI
      INNER JOIN ME_FORMATO FH ON FH.FORMATCODI = HP.FORMATCODI AND (CASE WHEN {4} > 0 THEN {4} ELSE FH.LECTCODI END) = ME.LECTCODI
      INNER JOIN ME_PTOMEDICION PTO ON PTO.PTOMEDICODI = HP.PTOMEDICODI
      INNER JOIN EQ_EQUIPO EQ ON EQ.EQUICODI = PTO.EQUICODI
      LEFT JOIN ME_ENVIO_HORARIO HOR ON ME.ENVIOCODI = HOR.ENVIOCODI
      WHERE HP.FORMATCODI = {0} AND ( (CASE WHEN COALESCE(ME.EMPRCODI, -1) > 0 THEN ME.EMPRCODI ELSE PTO.EMPRCODI END) IN ({1}) OR '{1}' = '-1')
      AND ME.MEDIFECHA >= TO_DATE('{2}','YYYY-MM-DD') AND ME.MEDIFECHA &lt;= TO_DATE('{3}','YYYY-MM-DD')
      AND ME.ENVIOCODI = {5}
      ORDER BY HP.HPTOORDEN ASC
    </query>
  </Sql>
  <!--FIN Mejoras RDO-II-->

	<Sql>
		<key>ObtenerDatosPorReporte</key>
		<query>
			select med.* 
            from me_medicion48 med
            inner join me_reporptomed ptomed on med.ptomedicodi = ptomed.ptomedicodi and med.tipoinfocodi = {3}
            inner join me_reporte rpte on ptomed.reporcodi = rpte.reporcodi and med.lectcodi = rpte.lectcodi
            where rpte.reporcodi = {0} and 
			(med.medifecha >= to_date('{1} 00:00:00','YYYY-MM-DD HH24:MI:SS') and med.medifecha &lt;= to_date('{2} 23:59:59','YYYY-MM-DD HH24:MI:SS'))
		</query>
	</Sql>

	<Sql>
		<key>SaveInfoAdicional</key>
		<query>
			insert into me_medicion48(
			lastuser,
			lastdate,
			lectcodi,
			medifecha,
			tipoinfocodi,
			ptomedicodi,
			meditotal,
			mediestado,
			emprcodi,
			h1,
			h2,
			h3,
			h4,
			h5,
			h6,
			h7,
			h8,
			h9,
			h10,
			h11,
			h12,
			h13,
			h14,
			h15,
			h16,
			h17,
			h18,
			h19,
			h20,
			h21,
			h22,
			h23,
			h24,
			h25,
			h26,
			h27,
			h28,
			h29,
			h30,
			h31,
			h32,
			h33,
			h34,
			h35,
			h36,
			h37,
			h38,
			h39,
			h40,
			h41,
			h42,
			h43,
			h44,
			h45,
			h46,
			h47,
			h48,
			e1,
			e2,
			e3,
			e4,
			e5,
			e6,
			e7,
			e8,
			e9,
			e10,
			e11,
			e12,
			e13,
			e14,
			e15,
			e16,
			e17,
			e18,
			e19,
			e20,
			e21,
			e22,
			e23,
			e24,
			e25,
			e26,
			e27,
			e28,
			e29,
			e30,
			e31,
			e32,
			e33,
			e34,
			e35,
			e36,
			e37,
			e38,
			e39,
			e40,
			e41,
			e42,
			e43,
			e44,
			e45,
			e46,
			e47,
			e48
			)
			values(
			:lastuser,
			:lastdate,
			:lectcodi,
			:medifecha,
			:tipoinfocodi,
			:ptomedicodi,
			:meditotal,
			:mediestado,
			:emprcodi,
			:h1,
			:h2,
			:h3,
			:h4,
			:h5,
			:h6,
			:h7,
			:h8,
			:h9,
			:h10,
			:h11,
			:h12,
			:h13,
			:h14,
			:h15,
			:h16,
			:h17,
			:h18,
			:h19,
			:h20,
			:h21,
			:h22,
			:h23,
			:h24,
			:h25,
			:h26,
			:h27,
			:h28,
			:h29,
			:h30,
			:h31,
			:h32,
			:h33,
			:h34,
			:h35,
			:h36,
			:h37,
			:h38,
			:h39,
			:h40,
			:h41,
			:h42,
			:h43,
			:h44,
			:h45,
			:h46,
			:h47,
			:h48,
			:e1,
			:e2,
			:e3,
			:e4,
			:e5,
			:e6,
			:e7,
			:e8,
			:e9,
			:e10,
			:e11,
			:e12,
			:e13,
			:e14,
			:e15,
			:e16,
			:e17,
			:e18,
			:e19,
			:e20,
			:e21,
			:e22,
			:e23,
			:e24,
			:e25,
			:e26,
			:e27,
			:e28,
			:e29,
			:e30,
			:e31,
			:e32,
			:e33,
			:e34,
			:e35,
			:e36,
			:e37,
			:e38,
			:e39,
			:e40,
			:e41,
			:e42,
			:e43,
			:e44,
			:e45,
			:e46,
			:e47,
			:e48
			)
		</query>
	</Sql>
  
	<!--Inicio DEMANDAPO-->
	<Sql>
		<key>ObtenerDemandaGeneracionPO</key>
		<query>
			select
			ptomedicodi,
			medifecha,
			h1,
			h2,
			h3,
			h4,
			h5,
			h6,
			h7,
			h8,
			h9,
			h10,
			h11,
			h12,
			h13,
			h14,
			h15,
			h16,
			h17,
			h18,
			h19,
			h20,
			h21,
			h22,
			h23,
			h24,
			h25,
			h26,
			h27,
			h28,
			h29,
			h30,
			h31,
			h32,
			h33,
			h34,
			h35,
			h36,
			h37,
			h38,
			h39,
			h40,
			h41,
			h42,
			h43,
			h44,
			h45,
			h46,
			h47,
			h48
			from
			me_medicion48
			where
			lectcodi = 6 and
			tipoinfocodi = 1 and
			medifecha >= to_date('{1}','DD/MM/YYYY') and medifecha &lt;= to_date('{2}','DD/MM/YYYY') and
			ptomedicodi in ({0})
		</query>
	</Sql>
	<!--Fin DEMANDAPO-->


  <Sql>
    <key>GetConsolidadoMaximaDemanda</key>
    <query>
      SELECT
      EMPRCODI2 as EMPRCODI,a.*
      FROM
      (
      SELECT case when ((GRUPOINTEGRANTE2 = 'N' and flag = 'A' ) or (flag = 'N' )) then 'N' else 'S' end as GRUPOINTEGRANTE,
      case when FLAG = 'S' then 1 when FLAG = 'N' then 10 else TIPOGRUPOCODI2 end as TIPOGRUPOCODI, a.*  FROM(
      select a.* , ROW_NUMBER() OVER(PARTITION BY medifecha,grupocodi,equicodi  ORDER BY medifecha,grupocodi,equicodi,FECHADAT DESC) AS NUM
      from
      (
      select
      nvl(pdat1.flag,'A') flag,nvl(pdat1.FECHADAT,SYSDATE) FECHADAT,
      COALESCE(d.GRUPOINTEGRANTE,'N') GRUPOINTEGRANTE2,
      COALESCE(d.TIPOGENERRER,'N') TIPOGENERRER,
      COALESCE(d.GRUPOTIPOCOGEN,'N') GRUPOTIPOCOGEN,
      d.tipogrupocodi tipogrupocodi2, d.grupocodi, d.grupopadre, d.grupoabrev,d.gruponomb,d.grupoorden,
      emp.emprnomb, emp.EMPRCODI as EMPRCODI2, emp.emprorden,
      case when eq.famcodi in (4,5,37,39) then eq.equicodi else eqp.equicodi end as equipadre,
      case when eq.famcodi in (4,5,37,39) then eq.equinomb else eqp.equinomb end as central,
      eqp.equinomb as central2,
      eq.equicodi,eq.equinomb as equinomb, eq.famcodi,
      fe.fenergcodi, fe.fenergnomb, fe.fenergabrev, fe.FENERCOLOR, tg.tgenernomb, tg.tgenercodi, me.*
      from me_medicion48 me
      inner join  me_ptomedicion p on p.PTOMEDICODI = me.PTOMEDICODI
      inner join eq_equipo eq on eq.famcodi  &lt;> 40 and eq.EQUICODI = p.EQUICODI
      inner join eq_equipo eqp on eqp.EQUICODI = coalesce(eq.EQUIPADRE, -1)
      inner join pr_grupo d on  d.grupocodi = (case when coalesce(p.grupocodi,-1)>0 then p.grupocodi else (case when coalesce(eq.GRUPOCODI,-1)>0 then eq.grupocodi else eqp.grupocodi end) end )
      inner join si_empresa emp on emp.EMPRCODI = (case when coalesce(me.EMPRCODI, -1) > 0 then me.EMPRCODI else d.emprcodi end)
      inner join si_fuenteenergia fe on fe.FENERGCODI = d.FENERGCODI
      inner join si_tipogeneracion tg on tg.TGENERCODI = fe.TGENERCODI

      left join(
      SELECT p1.GRUPOCODI, p1.formuladat flag, p1.FECHADAT
      FROM PR_GRUPODAT p1
      WHERE p1.concepcodi = 258 and p1.formuladat in ('N','S')

      UNION ALL

      SELECT p1.GRUPOCODI,  (case when pR.GRUPOINTEGRANTE &lt;> 'N' then 'S' else 'N' end) as flag, to_date('1900-01-01','YYYY-MM-DD')
      FROM PR_GRUPODAT p1
      inner join pr_grupo pr on  p1.grupocodi = pr.grupocodi
      WHERE p1.concepcodi = 258 and p1.formuladat in ('N','S')
      ) pdat1 on pdat1.grupocodi = d.grupocodi and pdat1.FECHADAT &lt;= me.medifecha

      where me.LECTCODI = {5} and ('-1'='{6}' or me.tipoinfocodi = {6}) and ('-1'='{7}' or p.tptomedicodi = {7})
      --and p.origlectcodi = 21
      and (me.medifecha between to_date('{2}','YYYY-MM-DD') and to_date('{3}','YYYY-MM-DD'))
      and ('-1'='{4}' or emp.EMPRCODI in ({4}))
      and ('-1'='{1}' or tg.TGENERCODI  in ({1}))
      )a
      )a WHERE NUM = 1
      )a WHERE (('0'='{0}') --TODOS
      or ( '1'='{0}' and ((GRUPOINTEGRANTE2 &lt;> 'N' and flag = 'A') OR ( flag = 'S') )  )  --COES
      or ('10'='{0}' and ((GRUPOINTEGRANTE2 = 'N' and flag = 'A' ) or (flag = 'N' ) )  )  --NO COES
      or ( '3'='{0}' and TIPOGENERRER = 'S' ) --GENERACION RER
      )

      order by emprnomb,central,equinomb
    </query>
  </Sql>

  <Sql>
    <key>GetConsolidadoMaximaDemandaSinGrupoIntegrante1</key>
    <query>
      SELECT
      EMPRCODI2 as EMPRCODI,a.*
      FROM
      (
      select distinct
      COALESCE(d.GRUPOINTEGRANTE,'N') GRUPOINTEGRANTE,
      COALESCE(d.TIPOGENERRER,'N') TIPOGENERRER,
      COALESCE(d.GRUPOTIPOCOGEN,'N') GRUPOTIPOCOGEN,
      d.tipogrupocodi, d.grupocodi, d.grupopadre, d.grupoabrev,d.gruponomb,d.grupoorden,
      emp.emprabrev, emp.emprnomb, emp.EMPRCODI as EMPRCODI2, emp.emprorden,
      case when eq.famcodi in (4,5,37,39) then eq.equicodi else eqp.equicodi end as equipadre,
      case when eq.famcodi in (4,5,37,39) then eq.equinomb else eqp.equinomb end as central,
      case when eq.famcodi in (4,5,37,39) then eq.osinergcodi else eqp.osinergcodi end as osinergcodi,
      eqp.equinomb as central2,
      eq.equicodi,eq.equinomb as equinomb,eq.equiabrev, eq.famcodi,
      p.Ptomedielenomb as PTOMEDINOMB,
      fe.fenergcodi, fe.fenergnomb, fe.fenergabrev, fe.FENERCOLOR, tg.tgenernomb, tg.tgenercodi, me.lectcodi,
      me.medifecha, me.tipoinfocodi, p.ptomedicodi, me.h1, me.meditotal, me.mediestado,
      me.h2, me.h3, me.h4, me.h5, me.h6, me.h7, me.h8, me.h9, me.h10, me.h11,
      me.h12, me.h13,me.h14, me.h15, me.h16, me.h17, me.h18,  me.h19, me.h20, me.h21,
      me.h22, me.h23,me.h24, me.h25, me.h26, me.h27, me.h28,  me.h29, me.h30, me.h31,
      me.h32, me.h33,me.h34, me.h35, me.h36, me.h37, me.h38,  me.h39, me.h40, me.h41,
      me.h42, me.h43,me.h44, me.h45, me.h46, me.h47, me.h48,  me.lastuser, me.lastdate, me.emprcodi,
      ROW_NUMBER() OVER(PARTITION BY emp.EMPRCODI, grupointegrante,tipogenerrer,grupotipocogen, d.tipogrupocodi, d.grupocodi, d.grupopadre,me.medifecha ORDER BY emp.EMPRCODI, grupointegrante,tipogenerrer,grupotipocogen, d.tipogrupocodi, d.grupocodi, d.grupopadre, me.lectcodi,origlectcodi,me.medifecha asc) AS NUM_VIEW
      from pr_grupo d
      inner join si_empresa emp on emp.EMPRCODI = d.emprcodi
      inner join me_ptomedicion p on p.grupocodi = d.grupocodi and origlectcodi in (2,15) AND p.ptomediestado = 'A'
      left join me_medicion48 me on me.PTOMEDICODI = p.PTOMEDICODI  and (me.medifecha between to_date('{2}','YYYY-MM-DD') and to_date('{3}','YYYY-MM-DD')) and me.LECTCODI = {5}
      and ('-1'='{6}' or me.tipoinfocodi = {6}) and ('-1'='{7}' or p.tptomedicodi = {7})
      left join eq_equipo eq on eq.famcodi  &lt;> 40 and eq.EQUICODI = p.EQUICODI
      left join eq_equipo eqp on eqp.EQUICODI = coalesce(eq.EQUIPADRE, -1)
      inner join si_fuenteenergia fe on fe.FENERGCODI = d.FENERGCODI
      inner join si_tipogeneracion tg on tg.TGENERCODI = fe.TGENERCODI and ('-1'='{1}' or tg.TGENERCODI  in ({1}))
      where
      ('-1'='{4}' or d.EMPRCODI in ({4}))
      and grupoestado = 'A'
      --and grupovmax >= 0 and grupotipoc > 0 and tipogrupocodi > 0
      and ('3' &lt;>'{0}' or('3'='{0}' and TIPOGENERRER = 'S'))
      and p.codref is not NULL
      and p.ptomedicalculado is not null
      and p.tipoinfocodi != 0
      --order by emprnomb,central,equinomb
      )a where a.osinergcodi != '0' and NUM_VIEW = 1
    </query>
  </Sql>
  <Sql>
    <key>GetConsolidadoMaximaDemandaSinGrupoIntegrante</key>
    <query>
      SELECT
      EMPRCODI2 as EMPRCODI,a.*
      FROM
      (
      select
      COALESCE(d.GRUPOINTEGRANTE,'N') GRUPOINTEGRANTE,
      COALESCE(d.TIPOGENERRER,'N') TIPOGENERRER,
      COALESCE(d.GRUPOTIPOCOGEN,'N') GRUPOTIPOCOGEN,
      d.tipogrupocodi, d.grupocodi, d.grupopadre, d.grupoabrev,d.gruponomb,d.grupoorden,
      emp.emprabrev, emp.emprnomb, emp.EMPRCODI as EMPRCODI2, emp.emprorden,
      case when eq.famcodi in (4,5,37,39) then eq.equicodi else eqp.equicodi end as equipadre,
      case when eq.famcodi in (4,5,37,39) then eq.equinomb else eqp.equinomb end as central,
      case when eq.famcodi in (4,5,37,39) then eq.osinergcodi else eqp.osinergcodi end as osinergcodi,
      eqp.equinomb as central2,
      eq.equicodi,eq.equinomb as equinomb,eq.equiabrev, eq.famcodi,p.Ptomedielenomb as PTOMEDINOMB,
      fe.fenergcodi, fe.fenergnomb, fe.fenergabrev, fe.FENERCOLOR, tg.tgenernomb, tg.tgenercodi, me.*

      from me_medicion48 me
      inner join  me_ptomedicion p on p.PTOMEDICODI = me.PTOMEDICODI
      left join eq_equipo eq on eq.famcodi  &lt;> 40 and eq.EQUICODI = p.EQUICODI
      left join eq_equipo eqp on eqp.EQUICODI = coalesce(eq.EQUIPADRE, -1)
      left join pr_grupo d on  d.grupocodi = (case when coalesce(p.grupocodi,-1)>0 then p.grupocodi else (case when coalesce(eq.GRUPOCODI,-1)>0 then eq.grupocodi else eqp.grupocodi end) end )
      left join si_empresa emp on emp.EMPRCODI = (case when coalesce(me.EMPRCODI, -1) > 0 then me.EMPRCODI else d.emprcodi end)
      left join si_fuenteenergia fe on fe.FENERGCODI = d.FENERGCODI
      left join si_tipogeneracion tg on tg.TGENERCODI = fe.TGENERCODI

      where me.LECTCODI = {5} and ('-1'='{6}' or me.tipoinfocodi = {6}) and ('-1'='{7}' or p.tptomedicodi = {7})
      --and p.origlectcodi = 21
      and (me.medifecha between to_date('{2}','YYYY-MM-DD') and to_date('{3}','YYYY-MM-DD'))
      and ('-1'='{4}' or emp.EMPRCODI in ({4}))
      and ('-1'='{1}' or tg.TGENERCODI  in ({1}))
      and ('3' &lt;>'{0}' or('3'='{0}' and TIPOGENERRER = 'S'))
      )a
    </query>
  </Sql>

  <Sql>
    <key>GetConsolidadoMaximaDemandaSinGrupoIntegrante2</key>
    <query>
      select
      COALESCE(d.GRUPOINTEGRANTE,'N') GRUPOINTEGRANTE,
      COALESCE(d.TIPOGENERRER,'N') TIPOGENERRER,
      COALESCE(d.GRUPOTIPOCOGEN,'N') GRUPOTIPOCOGEN,
      d.tipogrupocodi, d.grupocodi, d.grupopadre, d.grupoabrev,d.gruponomb,d.grupoorden,
      emp.emprnomb, emp.EMPRCODI as EMPRCODI2, emp.emprorden,
      case when eq.famcodi in (4,5,37,39) then eq.equicodi else eqp.equicodi end as equipadre,
      case when eq.famcodi in (4,5,37,39) then eq.equinomb else eqp.equinomb end as central,
      eqp.equinomb as central2,
      eq.equicodi,eq.equinomb as equinomb, eq.famcodi,
      fe.fenergcodi, fe.fenergnomb, fe.fenergabrev, fe.FENERCOLOR, tg.tgenernomb, tg.tgenercodi, me.*

      from me_medicion48 me
      inner join  me_ptomedicion p on p.PTOMEDICODI = me.PTOMEDICODI
      inner join eq_equipo eq on eq.famcodi  &lt;> 40 and eq.EQUICODI = p.EQUICODI
      inner join eq_equipo eqp on eqp.EQUICODI = coalesce(eq.EQUIPADRE, -1)
      inner join pr_grupo d on  d.grupocodi = (case when coalesce(p.grupocodi,-1)>0 then p.grupocodi else (case when coalesce(eq.GRUPOCODI,-1)>0 then eq.grupocodi else eqp.grupocodi end) end )
      inner join si_empresa emp on emp.EMPRCODI = (case when coalesce(me.EMPRCODI, -1) > 0 then me.EMPRCODI else d.emprcodi end)
      inner join si_fuenteenergia fe on fe.FENERGCODI = d.FENERGCODI
      inner join si_tipogeneracion tg on tg.TGENERCODI = fe.TGENERCODI

      where me.LECTCODI = {5} and ('-1'='{6}' or me.tipoinfocodi = {6}) and ('-1'='{7}' or p.tptomedicodi = {7})
      --and p.origlectcodi = 21
      and (me.medifecha between to_date('{2}','YYYY-MM-DD') and to_date('{3}','YYYY-MM-DD'))
      and ('-1'='{4}' or emp.EMPRCODI in ({4}))
      and ('-1'='{1}' or tg.TGENERCODI  in ({1}))
      and ('3' &lt;>'{0}' or('3'='{0}' and TIPOGENERRER = 'S'))

      --order by emprnomb,central,equinomb
    </query>
  </Sql>

  <Sql>
    <key>ExisteRegistroMedicion48</key>
    <query>
      SELECT * FROM me_medicion48 me WHERE me.lectcodi = {0} and  me.tipoinfocodi = {1}
      and me.medifecha between to_date('{2}','YYYY-MM-DD') and to_date('{3}','YYYY-MM-DD') and ROWNUM = 1
    </query>
  </Sql>
  <Sql>
    <key>GetDemandaEjecutadaConEcuador</key>
    <query>
      SELECT MEDIFECHA,
      sum(h1) as h1,sum(h2) as h2,sum(h3) as h3,sum(h4) as h4,sum(h5) as h5,sum(h6) as h6,sum(h7) as h7,sum(h8) as h8,sum(h9) as h9,sum(h10) as h10, sum(h11) as h11,sum(h12) as h12,sum(h13) as h13,sum(h14) as h14,
      sum(h15) as h15,sum(h16) as h16,sum(h17) as h17,sum(h18) as h18,sum(h19) as h19,sum(h20) as h20, sum(h21) as h21,sum(h22) as h22,sum(h23) as h23,sum(h24) as h24,sum(h25) as h25,sum(h26) as h26,sum(h27) as h27,
      sum(h28) as h28,sum(h29) as h29,sum(h30) as h30, sum(h31) as h31,sum(h32) as h32,sum(h33) as h33,sum(h34) as h34,sum(h35) as h35,sum(h36) as h36,sum(h37) as h37,sum(h38) as h38,sum(h39) as h39,sum(h40) as h40,
      sum(h41) as h41,sum(h42) as h42,sum(h43) as h43,sum(h44) as h44,sum(h45) as h45,sum(h46) as h46,sum(h47) as h47,sum(h48) as h48
      FROM ( SELECT ME_MEDICION48.PTOMEDICODI,ME_MEDICION48.LECTCODI, ME_MEDICION48.TIPOINFOCODI, ME_MEDICION48.MEDIFECHA,
      h1,h2,h3,h4,h5,h6,h7,h8,h9,h10,h11,h12,h13,h14,h15,h16,h17,h18,h19,h20,h21,h22,h23,h24,h25,h26,h27,h28,h29,h30,h31,h32,h33,h34,h35,h36,h37,h38,h39,h40,h41,h42,h43,h44,h45,h46,h47,h48
      FROM me_medicion48, me_ptomedicion, pr_grupo
      WHERE ( me_medicion48.lectcodi = {0})
      AND ( me_medicion48.tipoinfocodi = {1} )
      AND ( me_medicion48.medifecha >= to_date('{2}','yyyy-mm-dd') )
      AND ( me_medicion48.medifecha &lt;= to_date('{3}','yyyy-mm-dd') )
      AND me_medicion48.ptomedicodi = me_ptomedicion.ptomedicodi
      AND me_ptomedicion.codref = pr_grupo.grupocodi
      and Pr_grupo.grupocodi not in ( select b.grupocodi from pr_grupodat b where b.concepcodi= 258  and Pr_grupo.grupocodi=b.grupocodi  and b.fechadat = (select max(fechadat) from pr_grupodat c where concepcodi= 258 and Pr_grupo.grupocodi=c.grupocodi) and b.fechadat &lt;= to_date('{2}', 'YYYY-MM-DD') and upper(trim(b.formuladat)) = 'N')
      UNION
      SELECT ME_MEDICION48.PTOMEDICODI,ME_MEDICION48.LECTCODI, ME_MEDICION48.TIPOINFOCODI, ME_MEDICION48.MEDIFECHA,
      -h1,-h2,-h3,-h4,-h5,-h6,-h7,-h8,-h9,-h10,-h11,-h12,-h13,-h14,-h15,-h16,-h17,-h18,-h19,-h20,-h21,-h22,-h23,-h24,-h25,-h26,-h27,-h28,-h29,-h30,-h31,-h32,-h33,-h34,-h35,-h36,-h37,-h38,-h39,-h40,-h41,-h42,-h43,-h44,-h45,-h46,-h47,-h48
      FROM me_medicion48
      WHERE ( me_medicion48.lectcodi = {4} )
      AND ( me_medicion48.tipoinfocodi = {1} )
      AND ( me_medicion48.medifecha >= to_date('{2}','yyyy-mm-dd') )
      AND ( me_medicion48.medifecha &lt;= to_date('{3}','yyyy-mm-dd') )
      AND me_medicion48.ptomedicodi = {5}
      ORDER BY MEDIFECHA )
      GROUP BY MEDIFECHA
      ORDER BY MEDIFECHA Asc
    </query>
  </Sql>
  <Sql>
    <key>GetDemandaCOESPtoMedicion48</key>
    <query>
      SELECT MEDIFECHA,sum(h1) as h1,sum(h2) as h2,sum(h3) as h3,sum(h4) as h4,sum(h5) as h5,sum(h6) as h6,sum(h7) as h7,sum(h8) as h8,sum(h9) as h9,sum(h10) as h10, sum(h11) as h11,
      sum(h12) as h12,sum(h13) as h13,sum(h14) as h14,sum(h15) as h15,sum(h16) as h16,sum(h17) as h17,sum(h18) as h18,sum(h19) as h19,sum(h20) as h20, sum(h21) as h21,sum(h22) as h22,
      sum(h23) as h23,sum(h24) as h24,sum(h25) as h25,sum(h26) as h26,sum(h27) as h27,sum(h28) as h28,sum(h29) as h29,sum(h30) as h30, sum(h31) as h31,sum(h32) as h32,sum(h33) as h33,
      sum(h34) as h34,sum(h35) as h35,sum(h36) as h36,sum(h37) as h37,sum(h38) as h38,sum(h39) as h39,sum(h40) as h40, sum(h41) as h41,sum(h42) as h42,sum(h43) as h43,sum(h44) as h44,
      sum(h45) as h45,sum(h46) as h46,sum(h47) as h47,sum(h48) as h48
      FROM
      (SELECT ME_MEDICION48.PTOMEDICODI,ME_MEDICION48.LECTCODI, ME_MEDICION48.TIPOINFOCODI, ME_MEDICION48.MEDIFECHA, h1,h2,h3,h4,h5,h6,h7,h8,h9,h10,h11,h12,h13,h14,h15,h16,h17,h18,h19,h20,h21,
      h22,h23,h24,h25,h26,h27,h28,h29,h30,h31,h32,h33,h34,h35,h36,h37,h38,h39,h40,h41,h42,h43,h44,h45,h46,h47,h48
      FROM me_medicion48, me_ptomedicion, pr_grupo
      WHERE ( me_medicion48.lectcodi = {0}) AND
      ( me_medicion48.tipoinfocodi = {1} ) AND
      ( me_medicion48.medifecha >= to_date('{2}','yyyy-mm-dd') ) AND
      ( me_medicion48.medifecha &lt;= to_date('{3}','yyyy-mm-dd') ) AND
      me_medicion48.ptomedicodi = me_ptomedicion.ptomedicodi AND me_ptomedicion.codref = pr_grupo.grupocodi AND
      pr_grupo.tipogrupocodi &lt;> 10
      and Pr_grupo.grupocodi not in ( select b.grupocodi from pr_grupodat b
      where b.concepcodi= 258  and Pr_grupo.grupocodi=b.grupocodi and
      b.fechadat = (select max(fechadat) from pr_grupodat c where concepcodi= 258 and Pr_grupo.grupocodi=c.grupocodi)
      and b.fechadat &lt;= to_date('{3}', 'YYYY-MM-DD')
      and upper(trim(b.formuladat)) = 'N')
      and pr_grupo.grupointegrante = 'S' ORDER BY MEDIFECHA
      )GROUP BY MEDIFECHA ORDER BY MEDIFECHA Asc
    </query>
  </Sql>
</Sqls>
