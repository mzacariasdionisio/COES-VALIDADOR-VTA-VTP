<?xml version="1.0" encoding="utf-8" ?>
<Sqls>


  <Sql>
    <key>Save</key>
    <query>
       insert into me_scada_sp7(
           canalcodi,
           medifecha,
           meditotal,
           mediestado,
           h1,
           h2,
           h3,
           h4,
           h5,
           h6,
           h7,
           h8,
           h9,
           h10,
           h11,
           h12,
           h13,
           h14,
           h15,
           h16,
           h17,
           h18,
           h19,
           h20,
           h21,
           h22,
           h23,
           h24,
           h25,
           h26,
           h27,
           h28,
           h29,
           h30,
           h31,
           h32,
           h33,
           h34,
           h35,
           h36,
           h37,
           h38,
           h39,
           h40,
           h41,
           h42,
           h43,
           h44,
           h45,
           h46,
           h47,
           h48,
           h49,
           h50,
           h51,
           h52,
           h53,
           h54,
           h55,
           h56,
           h57,
           h58,
           h59,
           h60,
           h61,
           h62,
           h63,
           h64,
           h65,
           h66,
           h67,
           h68,
           h69,
           h70,
           h71,
           h72,
           h73,
           h74,
           h75,
           h76,
           h77,
           h78,
           h79,
           h80,
           h81,
           h82,
           h83,
           h84,
           h85,
           h86,
           h87,
           h88,
           h89,
           h90,
           h91,
           h92,
           h93,
           h94,
           h95,
           h96,
           medicambio,
           medscdusucreacion,
           medscdfeccreacion,
           medscdusumodificacion,
           medscdfecmodificacion
       )
       values(
           :canalcodi,
           :medifecha,
           :meditotal,
           :mediestado,
           :h1,
           :h2,
           :h3,
           :h4,
           :h5,
           :h6,
           :h7,
           :h8,
           :h9,
           :h10,
           :h11,
           :h12,
           :h13,
           :h14,
           :h15,
           :h16,
           :h17,
           :h18,
           :h19,
           :h20,
           :h21,
           :h22,
           :h23,
           :h24,
           :h25,
           :h26,
           :h27,
           :h28,
           :h29,
           :h30,
           :h31,
           :h32,
           :h33,
           :h34,
           :h35,
           :h36,
           :h37,
           :h38,
           :h39,
           :h40,
           :h41,
           :h42,
           :h43,
           :h44,
           :h45,
           :h46,
           :h47,
           :h48,
           :h49,
           :h50,
           :h51,
           :h52,
           :h53,
           :h54,
           :h55,
           :h56,
           :h57,
           :h58,
           :h59,
           :h60,
           :h61,
           :h62,
           :h63,
           :h64,
           :h65,
           :h66,
           :h67,
           :h68,
           :h69,
           :h70,
           :h71,
           :h72,
           :h73,
           :h74,
           :h75,
           :h76,
           :h77,
           :h78,
           :h79,
           :h80,
           :h81,
           :h82,
           :h83,
           :h84,
           :h85,
           :h86,
           :h87,
           :h88,
           :h89,
           :h90,
           :h91,
           :h92,
           :h93,
           :h94,
           :h95,
           :h96,
           :medicambio,
           :medscdusucreacion,
           :medscdfeccreacion,
           :medscdusumodificacion,
           :medscdfecmodificacion
       )
    </query>
  </Sql>

  <Sql>
    <key>Update</key>
    <query>
       update me_scada_sp7
       set
           meditotal = :meditotal,
           mediestado = :mediestado,
           h1 = :h1,
           h2 = :h2,
           h3 = :h3,
           h4 = :h4,
           h5 = :h5,
           h6 = :h6,
           h7 = :h7,
           h8 = :h8,
           h9 = :h9,
           h10 = :h10,
           h11 = :h11,
           h12 = :h12,
           h13 = :h13,
           h14 = :h14,
           h15 = :h15,
           h16 = :h16,
           h17 = :h17,
           h18 = :h18,
           h19 = :h19,
           h20 = :h20,
           h21 = :h21,
           h22 = :h22,
           h23 = :h23,
           h24 = :h24,
           h25 = :h25,
           h26 = :h26,
           h27 = :h27,
           h28 = :h28,
           h29 = :h29,
           h30 = :h30,
           h31 = :h31,
           h32 = :h32,
           h33 = :h33,
           h34 = :h34,
           h35 = :h35,
           h36 = :h36,
           h37 = :h37,
           h38 = :h38,
           h39 = :h39,
           h40 = :h40,
           h41 = :h41,
           h42 = :h42,
           h43 = :h43,
           h44 = :h44,
           h45 = :h45,
           h46 = :h46,
           h47 = :h47,
           h48 = :h48,
           h49 = :h49,
           h50 = :h50,
           h51 = :h51,
           h52 = :h52,
           h53 = :h53,
           h54 = :h54,
           h55 = :h55,
           h56 = :h56,
           h57 = :h57,
           h58 = :h58,
           h59 = :h59,
           h60 = :h60,
           h61 = :h61,
           h62 = :h62,
           h63 = :h63,
           h64 = :h64,
           h65 = :h65,
           h66 = :h66,
           h67 = :h67,
           h68 = :h68,
           h69 = :h69,
           h70 = :h70,
           h71 = :h71,
           h72 = :h72,
           h73 = :h73,
           h74 = :h74,
           h75 = :h75,
           h76 = :h76,
           h77 = :h77,
           h78 = :h78,
           h79 = :h79,
           h80 = :h80,
           h81 = :h81,
           h82 = :h82,
           h83 = :h83,
           h84 = :h84,
           h85 = :h85,
           h86 = :h86,
           h87 = :h87,
           h88 = :h88,
           h89 = :h89,
           h90 = :h90,
           h91 = :h91,
           h92 = :h92,
           h93 = :h93,
           h94 = :h94,
           h95 = :h95,
           h96 = :h96,
           medicambio = :medicambio,
           medscdusucreacion = :medscdusucreacion,
           medscdfeccreacion = :medscdfeccreacion,
           medscdusumodificacion = :medscdusumodificacion,
           medscdfecmodificacion = :medscdfecmodificacion
       where
           canalcodi = :canalcodi and
           medifecha = :medifecha
    </query>
  </Sql>

  <Sql>
    <key>Delete</key>
    <query>
       delete from me_scada_sp7
       where
           canalcodi = :canalcodi and
           medifecha = :medifecha
    </query>
  </Sql>

  <Sql>
    <key>GetById</key>
    <query>
       select
           canalcodi,
           medifecha,
           meditotal,
           mediestado,
           h1,
           h2,
           h3,
           h4,
           h5,
           h6,
           h7,
           h8,
           h9,
           h10,
           h11,
           h12,
           h13,
           h14,
           h15,
           h16,
           h17,
           h18,
           h19,
           h20,
           h21,
           h22,
           h23,
           h24,
           h25,
           h26,
           h27,
           h28,
           h29,
           h30,
           h31,
           h32,
           h33,
           h34,
           h35,
           h36,
           h37,
           h38,
           h39,
           h40,
           h41,
           h42,
           h43,
           h44,
           h45,
           h46,
           h47,
           h48,
           h49,
           h50,
           h51,
           h52,
           h53,
           h54,
           h55,
           h56,
           h57,
           h58,
           h59,
           h60,
           h61,
           h62,
           h63,
           h64,
           h65,
           h66,
           h67,
           h68,
           h69,
           h70,
           h71,
           h72,
           h73,
           h74,
           h75,
           h76,
           h77,
           h78,
           h79,
           h80,
           h81,
           h82,
           h83,
           h84,
           h85,
           h86,
           h87,
           h88,
           h89,
           h90,
           h91,
           h92,
           h93,
           h94,
           h95,
           h96,
           medicambio,
           medscdusucreacion,
           medscdfeccreacion,
           medscdusumodificacion,
           medscdfecmodificacion
       from
           me_scada_sp7
       where
           canalcodi = :canalcodi and
           medifecha = :medifecha
    </query>
  </Sql>

  <Sql>
    <key>List</key>
    <query>
       select
           canalcodi,
           medifecha,
           meditotal,
           mediestado,
           h1,
           h2,
           h3,
           h4,
           h5,
           h6,
           h7,
           h8,
           h9,
           h10,
           h11,
           h12,
           h13,
           h14,
           h15,
           h16,
           h17,
           h18,
           h19,
           h20,
           h21,
           h22,
           h23,
           h24,
           h25,
           h26,
           h27,
           h28,
           h29,
           h30,
           h31,
           h32,
           h33,
           h34,
           h35,
           h36,
           h37,
           h38,
           h39,
           h40,
           h41,
           h42,
           h43,
           h44,
           h45,
           h46,
           h47,
           h48,
           h49,
           h50,
           h51,
           h52,
           h53,
           h54,
           h55,
           h56,
           h57,
           h58,
           h59,
           h60,
           h61,
           h62,
           h63,
           h64,
           h65,
           h66,
           h67,
           h68,
           h69,
           h70,
           h71,
           h72,
           h73,
           h74,
           h75,
           h76,
           h77,
           h78,
           h79,
           h80,
           h81,
           h82,
           h83,
           h84,
           h85,
           h86,
           h87,
           h88,
           h89,
           h90,
           h91,
           h92,
           h93,
           h94,
           h95,
           h96,
           medicambio,
           medscdusucreacion,
           medscdfeccreacion,
           medscdusumodificacion,
           medscdfecmodificacion
       from
           me_scada_sp7
    </query>
  </Sql>

  <Sql>
    <key>GetByCriteria</key>
    <query>
      select a.*,b.canalcalidad from me_scada_sp7 a
      inner join TR_CANAL_SP7 b on b.canalcodi = a.canalcodi
      where a.medifecha between to_date('{0} 00:00:00','YYYY-MM-DD HH24:MI:SS') and to_date('{1} 00:00:00','YYYY-MM-DD HH24:MI:SS')
      and a.canalcodi in ({2})
    </query>
  </Sql>

  
  
  <Sql>
    <key>ObtenerListadoSSEE</key>
    <query>
      select
      *
      from (
      select a.medifecha,b.zonanomb,c.canalnomb,c.canalunidad,c.canalcodi,
      h1,h2,h3,h4,h5,h6,h7,h8,h9,h10,
      h11,h12,h13,h14,h15,h16,h17,h18,h19,h20,
      h21,h22,h23,h24,h25,h26,h27,h28,h29,h30,
      h31,h32,h33,h34,h35,h36,h37,h38,h39,h40,
      h41,h42,h43,h44,h45,h46,h47,h48,h49,h50,
      h51,h52,h53,h54,h55,h56,h57,h58,h59,h60,
      h61,h62,h63,h64,h65,h66,h67,h68,h69,h70,
      h71,h72,h73,h74,h75,h76,h77,h78,h79,h80,
      h81,h82,h83,h84,h85,h86,h87,h88,h89,h90,
      h91,h92,h93,h94,h95,h96,
      (row_number() over (order by a.medifecha desc)) as r
      from
      me_scada_sp7 a,tr_zona_sp7 b,tr_canal_sp7 c
      where
      (a.canalcodi=c.canalcodi and b.zonacodi=c.zonacodi)
      and (b.zonacodi={0} or {0} = 0)
      and
      (
      (a.medifecha >= to_date('{1} 00:00:00','YYYY-MM-DD HH24:MI:SS') and a.medifecha &lt; to_date('{2} 00:00:00','YYYY-MM-DD HH24:MI:SS')+1)
      )
      order by b.zonanomb,c.canalnomb,c.canalunidad,a.medifecha
      )
      where (r >= ((({3}-1) * {4}) + 1) and r &lt; (({3} * {4}) + 1 )) or ({3} = -1 and {4} = -1)
    </query>

  </Sql>

  <Sql>
    <key>ObtenerListadoFiltro</key>
    <query>
      select
      *
      from (
      select a.medifecha,b.zonanomb,c.canalnomb,c.canalunidad,c.canalcodi,
      h1,h2,h3,h4,h5,h6,h7,h8,h9,h10,
      h11,h12,h13,h14,h15,h16,h17,h18,h19,h20,
      h21,h22,h23,h24,h25,h26,h27,h28,h29,h30,
      h31,h32,h33,h34,h35,h36,h37,h38,h39,h40,
      h41,h42,h43,h44,h45,h46,h47,h48,h49,h50,
      h51,h52,h53,h54,h55,h56,h57,h58,h59,h60,
      h61,h62,h63,h64,h65,h66,h67,h68,h69,h70,
      h71,h72,h73,h74,h75,h76,h77,h78,h79,h80,
      h81,h82,h83,h84,h85,h86,h87,h88,h89,h90,
      h91,h92,h93,h94,h95,h96,
      (row_number() over (order by a.medifecha desc)) as r
      from
      me_scada_sp7 a,tr_zona_sp7 b,tr_canal_sp7 c, me_scada_ptofiltro_sp7 d
      where
      (a.canalcodi=c.canalcodi and b.zonacodi=c.zonacodi and d.canalcodi=c.canalcodi)
      and (d.filtrocodi={0}
      or {0} = 0)
      and
      (
      (a.medifecha >= to_date('{1} 00:00:00','YYYY-MM-DD HH24:MI:SS') and a.medifecha &lt; to_date('{2} 00:00:00','YYYY-MM-DD HH24:MI:SS')+1)
      )
      order by b.zonanomb,c.canalnomb,c.canalunidad,a.medifecha
      )
      where (r >= ((({3}-1) * {4}) + 1) and r &lt; (({3} * {4}) + 1 )) or ({3} = -1 and {4} = -1)
    </query>

  </Sql>
  
  
  
  

  <Sql>
    <key>TotalRegistrosSSEE</key>
    <query>
      select count(*)
      from
      me_scada_sp7 a,tr_zona_sp7 b,tr_canal_sp7 c
      where
      (a.canalcodi=c.canalcodi and b.zonacodi=c.zonacodi)
      and (b.zonacodi={0} or {0} = 0)
      and
      (
      (a.medifecha >= to_date('{1} 00:00:00','YYYY-MM-DD HH24:MI:SS') and a.medifecha &lt; to_date('{2} 00:00:00','YYYY-MM-DD HH24:MI:SS')+1)
      )
    </query>
  </Sql>

  
  <Sql>
    <key>TotalRegistrosFiltro</key>
    <query>
      select count(*)
      from
      me_scada_sp7 a,tr_zona_sp7 b,tr_canal_sp7 c, me_scada_ptofiltro_sp7 d
      where
      (a.canalcodi=c.canalcodi and b.zonacodi=c.zonacodi and d.canalcodi=c.canalcodi)
      and (d.filtrocodi={0}
      or {0} = 0)
      and
      (
      (a.medifecha >= to_date('{1} 00:00:00','YYYY-MM-DD HH24:MI:SS') and a.medifecha &lt; to_date('{2} 00:00:00','YYYY-MM-DD HH24:MI:SS')+1)
      )     
    </query>
  </Sql>




  <Sql>
    <key>ObtenerListadoReporteSSEE</key>
    <query>      
      select a.medifecha,b.zonanomb,c.canalnomb,c.canalunidad,c.canalcodi,
      h1,h2,h3,h4,h5,h6,h7,h8,h9,h10,
      h11,h12,h13,h14,h15,h16,h17,h18,h19,h20,
      h21,h22,h23,h24,h25,h26,h27,h28,h29,h30,
      h31,h32,h33,h34,h35,h36,h37,h38,h39,h40,
      h41,h42,h43,h44,h45,h46,h47,h48,h49,h50,
      h51,h52,h53,h54,h55,h56,h57,h58,h59,h60,
      h61,h62,h63,h64,h65,h66,h67,h68,h69,h70,
      h71,h72,h73,h74,h75,h76,h77,h78,h79,h80,
      h81,h82,h83,h84,h85,h86,h87,h88,h89,h90,
      h91,h92,h93,h94,h95,h96,
      (row_number() over (order by a.medifecha desc)) as r
      from
      me_scada_sp7 a,tr_zona_sp7 b,tr_canal_sp7 c
      where
      (a.canalcodi=c.canalcodi and b.zonacodi=c.zonacodi)
      and (b.zonacodi={0} or {0} = 0)
      and
      (
      (a.medifecha >= to_date('{1} 00:00:00','YYYY-MM-DD HH24:MI:SS') and a.medifecha &lt; to_date('{2} 00:00:00','YYYY-MM-DD HH24:MI:SS')+1)
      )
      order by b.zonanomb,c.canalnomb,c.canalunidad,a.medifecha      
    </query>

  </Sql>

  <Sql>
    <key>ObtenerListadoReporteFiltro</key>
    <query>      
      select a.medifecha,b.zonanomb,c.canalnomb,c.canalunidad,c.canalcodi,
      h1,h2,h3,h4,h5,h6,h7,h8,h9,h10,
      h11,h12,h13,h14,h15,h16,h17,h18,h19,h20,
      h21,h22,h23,h24,h25,h26,h27,h28,h29,h30,
      h31,h32,h33,h34,h35,h36,h37,h38,h39,h40,
      h41,h42,h43,h44,h45,h46,h47,h48,h49,h50,
      h51,h52,h53,h54,h55,h56,h57,h58,h59,h60,
      h61,h62,h63,h64,h65,h66,h67,h68,h69,h70,
      h71,h72,h73,h74,h75,h76,h77,h78,h79,h80,
      h81,h82,h83,h84,h85,h86,h87,h88,h89,h90,
      h91,h92,h93,h94,h95,h96,
      (row_number() over (order by a.medifecha desc)) as r
      from
      me_scada_sp7 a,tr_zona_sp7 b,tr_canal_sp7 c, me_scada_ptofiltro_sp7 d
      where
      (a.canalcodi=c.canalcodi and b.zonacodi=c.zonacodi and d.canalcodi=c.canalcodi)
      and (d.filtrocodi={0}
      or {0} = 0)
      and
      (
      (a.medifecha >= to_date('{1} 00:00:00','YYYY-MM-DD HH24:MI:SS') and a.medifecha &lt; to_date('{2} 00:00:00','YYYY-MM-DD HH24:MI:SS')+1)
      )
      order by b.zonanomb,c.canalnomb,c.canalunidad,a.medifecha      
    </query>

  </Sql>

  <Sql>
    <key>GetDatosScadaAFormato</key>
    <query>
		select * from
		(
		select hp.ptomedicodi,hp.tipoinfocodi,emp.emprcodi,emp.emprnomb, eq.famcodi, eq.equicodi,eq.equinomb,eqp.equicodi equipadre,eqp.equinomb as central,eq.equiabrev, sc7.*
		,vwpt.HPTDATFECHA, vwpt.HPTDATPTOESTADO, ROW_NUMBER() OVER(PARTITION BY sc7.medifecha,sc7.canalcodi,pmc.ptomedicodi ORDER BY sc7.medifecha,sc7.canalcodi,vwpt.HPTDATFECHA desc, vwpt.HPTDATPTOESTADO desc) AS NUM_VIEW
		from me_scada_sp7 sc7
		inner join me_ptomedcanal pmc on pmc.canalcodi = sc7.canalcodi
		inner join me_hojaptomed hp on hp.ptomedicodi = pmc.ptomedicodi and hp.tipoinfocodi = pmc.tipoinfocodi
		inner join me_ptomedicion pto on pto.ptomedicodi = hp.ptomedicodi
		inner join SI_HISEMPPTO_DATA vwpt on vwpt.HPTDATFECHA &lt;= to_date('{3}','YYYY-MM-DD') and (vwpt.PTOMEDICODI = pto.PTOMEDICODI OR vwpt.PTOMEDICODIOLD = pto.PTOMEDICODI)
		inner join eq_equipo eq on eq.equicodi = pto.equicodi
		inner join eq_equipo eqp on eqp.EQUICODI = coalesce(eq.EQUIPADRE, -1)
		inner join si_empresa emp on emp.emprcodi = vwpt.emprcodi
		where ('{0}'='-1' or hp.formatcodi = {0})
    and ('-2' ='{1}' or emp.emprcodi = {1}) 
    and (trunc(sc7.medifecha) >= to_date('{2}','yyyy-MM-dd') and trunc(sc7.medifecha) &lt;= to_date('{3}','yyyy-MM-dd'))
      and ('-1' ='{4}' or eq.famcodi in ({4}) )
      and ('-1' ='{5}' or pmc.tipoinfocodi in ({5}) )
      and pmc.PCANESTADO = 'A'
      ) where NUM_VIEW = 1
    </query>
  </Sql>

  <Sql>
    <key>GetDatosScadaByEquipo</key>
    <query>
      select * from
      (
          select eqc.tipoinfocodi,emp.emprcodi,emp.emprnomb, eq.famcodi, eq.equicodi,eq.equinomb, sc7.*
          ,vweq.HEQDATFECHA, vweq.HEQDATESTADO, ROW_NUMBER() OVER(PARTITION BY sc7.medifecha,sc7.canalcodi,eqc.equicodi ORDER BY sc7.medifecha,sc7.canalcodi,vweq.HEQDATFECHA desc, vweq.HEQDATESTADO desc) AS NUM_VIEW
          from me_scada_sp7 sc7
          inner join EQ_EQUICANAL eqc on eqc.canalcodi = sc7.canalcodi
          inner join EQ_EQUIPO eq on eq.equicodi = eqc.equicodi
          inner join SI_HISEMPEQ_DATA vweq on vweq.HEQDATFECHA &lt;= to_date('{1}','YYYY-MM-DD') and (vweq.EQUICODI = eq.EQUICODI OR vweq.EQUICODIOLD = eq.EQUICODI)
          inner join si_empresa emp on emp.emprcodi = vweq.emprcodi
          where
          (sc7.medifecha >= to_date('{0}','yyyy-MM-dd') and medifecha &lt;= to_date('{1}','yyyy-MM-dd'))
          and ('-1' ='{2}' or emp.emprcodi in ({2}))
          and ('-1' ='{3}' or eq.equicodi in ({3}))
          and eqc.ECANESTADO = 'A'
      ) where NUM_VIEW = 1
    </query>
  </Sql>
  
  <Sql>
    <key>ObtenerScada</key>
    <query>
      select hp.ptomedicodi,hp.tipoinfocodi, sc7.* from me_scada_sp7 sc7
      inner join me_ptomedcanal pmc on pmc.canalcodi = sc7.canalcodi
      inner join me_hojaptomed hp on hp.ptomedicodi = pmc.ptomedicodi and hp.tipoinfocodi = pmc.tipoinfocodi
      inner join me_ptomedicion pto on pto.ptomedicodi = hp.ptomedicodi
      where hp.formatcodi = {0} and pmc.tipoinfocodi = {1} and pto.ptomedicodi = {2} and (sc7.medifecha >= to_date('{3}','yyyy-MM-dd') and medifecha &lt;= to_date('{4}','yyyy-MM-dd'))
    </query>
  </Sql>

  <Sql>
    <key>GetByCriteriaByPtoAndTipoinfocodi</key>
    <query>
      select pmc.PTOMEDICODI,pmc.TIPOINFOCODI, sc7.* from me_scada_sp7 sc7
      inner join me_ptomedcanal pmc on pmc.canalcodi = sc7.canalcodi
      inner join me_ptomedicion pto on pto.ptomedicodi = pmc.ptomedicodi
      where pmc.tipoinfocodi = {2} and pto.ptomedicodi = {3} and (sc7.medifecha >= to_date('{0}','yyyy-MM-dd') and medifecha &lt;= to_date('{1}','yyyy-MM-dd'))
    </query>
  </Sql>

  <Sql>
    <key>ObtenerDatosSupervisionDemanda</key>
    <query>
      select tabla.*, fuente.tgenercodi from (
      select
      grupocodi,
      sum(h1*f)  as h1, sum(h2*f) as h2, sum(h3*f) as h3,sum(h4*f) as h4,sum(h5*f) as h5,sum(h6*f) as h6,sum(h7*f) as h7,sum(h8*f) as h8,sum(h9*f) as h9,sum(h10*f) as h10,
      sum(h11*f) as h11,sum(h12*f) as h12,sum(h13*f) as h13,sum(h14*f) as h14,sum(h15*f) as h15,sum(h16*f) as h16,sum(h17*f) as h17,sum(h18*f) as h18,sum(h19*f) as h19,sum(h20*f) as h20,
      sum(h21*f) as h21,sum(h22*f) as h22,sum(h23*f) as h23,sum(h24*f) as h24,sum(h25*f) as h25,sum(h26*f) as h26,sum(h27*f) as h27,sum(h28*f) as h28,sum(h29*f) as h29,sum(h30*f) as h30,
      sum(h31*f) as h31,sum(h32*f) as h32,sum(h33*f) as h33,sum(h34*f) as h34,sum(h35*f) as h35,sum(h36*f) as h36,sum(h37*f) as h37,sum(h38*f) as h38,sum(h39*f) as h39,sum(h40*f) as h40,
      sum(h41*f) as h41,sum(h42*f) as h42,sum(h43*f) as h43,sum(h44*f) as h44,sum(h45*f) as h45,sum(h46*f) as h46,sum(h47*f) as h47,sum(h48*f) as h48,sum(h49*f) as h49,sum(h50*f) as h50,
      sum(h51*f) as h51,sum(h52*f) as h52,sum(h53*f) as h53,sum(h54*f) as h54,sum(h55*f) as h55,sum(h56*f) as h56,sum(h57*f) as h57,sum(h58*f) as h58,sum(h59*f) as h59,sum(h60*f) as h60,
      sum(h61*f) as h61,sum(h62*f) as h62,sum(h63*f) as h63,sum(h64*f) as h64,sum(h65*f) as h65,sum(h66*f) as h66,sum(h67*f) as h67,sum(h68*f) as h68,sum(h69*f) as h69,sum(h70*f) as h70,
      sum(h71*f) as h71,sum(h72*f) as h72,sum(h73*f) as h73,sum(h74*f) as h74,sum(h75*f) as h75,sum(h76*f) as h76,sum(h77*f) as h77,sum(h78*f) as h78,sum(h79*f) as h79,sum(h80*f) as h80,
      sum(h81*f) as h81,sum(h82*f) as h82,sum(h83*f) as h83,sum(h84*f) as h84,sum(h85*f) as h85,sum(h86*f) as h86,sum(h87*f) as h87,sum(h88*f) as h88,sum(h89*f) as h89,sum(h90*f) as h90,
      sum(h91*f) as h91,sum(h92*f) as h92,sum(h93*f) as h93,sum(h94*f) as h94,sum(h95*f) as h95,sum(h96*f) as h96
      from (
      select
      eq.grupocodi,
      h1,h2,h3,h4,h5,h6,h7,h8,h9,h10,
      h11,h12,h13,h14,h15,h16,h17,h18,h19,h20,
      h21,h22,h23,h24,h25,h26,h27,h28,h29,h30,
      h31,h32,h33,h34,h35,h36,h37,h38,h39,h40,
      h41,h42,h43,h44,h45,h46,h47,h48,h49,h50,
      h51,h52,h53,h54,h55,h56,h57,h58,h59,h60,
      h61,h62,h63,h64,h65,h66,h67,h68,h69,h70,
      h71,h72,h73,h74,h75,h76,h77,h78,h79,h80,
      h81,h82,h83,h84,h85,h86,h87,h88,h89,h90,
      h91,h92,h93,h94,h95,h96,
      case c.canalsigno when 'S' then -1 else 1 end as f
      from me_scada_sp7 a
      inner join tr_canal_sp7 b on a.canalcodi = b.canalcodi
      inner join eq_relacion c on ((b.canaliccp = c.canaliccp and c.canaluso = 'G') or (b.canaliccp = c.canaliccpint and c.canaluso = 'I'))
      inner join eq_equipo eq on c.equicodi = eq.equicodi
      where
      (a.medifecha >= to_date('{0} 00:00:00','YYYY-MM-DD HH24:MI:SS') and a.medifecha &lt; to_date('{0} 00:00:00','YYYY-MM-DD HH24:MI:SS')+1)
      and c.canaliccp is not null and c.indrvarte = 'S' and c.estadorvarte = 'A'
      )
      group by  grupocodi)
      tabla inner join pr_grupo grupo on tabla.grupocodi = grupo.grupocodi
      inner join si_fuenteenergia fuente on grupo.fenergcodi = fuente.fenergcodi
    </query>
  </Sql>

	<Sql>
		<key>ObtenerComparativoDemanda</key>
		<query>
			select formula.cnfbarcodi as canalcodi, scada.medifecha,
			sum(formula.cmbafosimbolo*scada.h2) as h2,
			sum(formula.cmbafosimbolo*scada.h4) as h4,
			sum(formula.cmbafosimbolo*scada.h6) as h6,
			sum(formula.cmbafosimbolo*scada.h8) as h8,
			sum(formula.cmbafosimbolo*scada.h10) as h10,
			sum(formula.cmbafosimbolo*scada.h12) as h12,
			sum(formula.cmbafosimbolo*scada.h14) as h14,
			sum(formula.cmbafosimbolo*scada.h16) as h16,
			sum(formula.cmbafosimbolo*scada.h18) as h18,
			sum(formula.cmbafosimbolo*scada.h20) as h20,
			sum(formula.cmbafosimbolo*scada.h22) as h22,
			sum(formula.cmbafosimbolo*scada.h24) as h24,
			sum(formula.cmbafosimbolo*scada.h26) as h26,
			sum(formula.cmbafosimbolo*scada.h28) as h28,
			sum(formula.cmbafosimbolo*scada.h30) as h30,
			sum(formula.cmbafosimbolo*scada.h32) as h32,
			sum(formula.cmbafosimbolo*scada.h34) as h34,
			sum(formula.cmbafosimbolo*scada.h36) as h36,
			sum(formula.cmbafosimbolo*scada.h38) as h38,
			sum(formula.cmbafosimbolo*scada.h40) as h40,
			sum(formula.cmbafosimbolo*scada.h42) as h42,
			sum(formula.cmbafosimbolo*scada.h44) as h44,
			sum(formula.cmbafosimbolo*scada.h46) as h46,
			sum(formula.cmbafosimbolo*scada.h48) as h48,
			sum(formula.cmbafosimbolo*scada.h50) as h50,
			sum(formula.cmbafosimbolo*scada.h52) as h52,
			sum(formula.cmbafosimbolo*scada.h54) as h54,
			sum(formula.cmbafosimbolo*scada.h56) as h56,
			sum(formula.cmbafosimbolo*scada.h58) as h58,
			sum(formula.cmbafosimbolo*scada.h60) as h60,
			sum(formula.cmbafosimbolo*scada.h62) as h62,
			sum(formula.cmbafosimbolo*scada.h64) as h64,
			sum(formula.cmbafosimbolo*scada.h66) as h66,
			sum(formula.cmbafosimbolo*scada.h68) as h68,
			sum(formula.cmbafosimbolo*scada.h70) as h70,
			sum(formula.cmbafosimbolo*scada.h72) as h72,
			sum(formula.cmbafosimbolo*scada.h74) as h74,
			sum(formula.cmbafosimbolo*scada.h76) as h76,
			sum(formula.cmbafosimbolo*scada.h78) as h78,
			sum(formula.cmbafosimbolo*scada.h80) as h80,
			sum(formula.cmbafosimbolo*scada.h82) as h82,
			sum(formula.cmbafosimbolo*scada.h84) as h84,
			sum(formula.cmbafosimbolo*scada.h86) as h86,
			sum(formula.cmbafosimbolo*scada.h88) as h88,
			sum(formula.cmbafosimbolo*scada.h90) as h90,
			sum(formula.cmbafosimbolo*scada.h92) as h92,
			sum(formula.cmbafosimbolo*scada.h94) as h94,
			sum(formula.cmbafosimbolo*scada.h96) as h96
			from me_scada_sp7 scada
			inner join cm_barra_formula formula on scada.canalcodi = formula.canalcodi
			where
			scada.medifecha >= to_date('{0} 00:00:00', 'YYYY-MM-DD HH24:MI:SS')
			and scada.medifecha &lt;= to_date('{1} 23:59:59', 'YYYY-MM-DD HH24:MI:SS')
			and (formula.cnfbarcodi = {2} or {2} = -1)
			group by formula.cnfbarcodi, scada.medifecha
		</query>
	</Sql>

	<Sql>
		<key>ObtenerDemandaPorInterconexion</key>
		<query>
			select * from me_scada_sp7 scada
			where
			scada.medifecha >= to_date('{0} 00:00:00', 'YYYY-MM-DD HH24:MI:SS')
			and scada.medifecha &lt;= to_date('{0} 23:59:59', 'YYYY-MM-DD HH24:MI:SS') and scada.canalcodi = {1}
		</query>
	</Sql>


	<Sql>
		<key>ObtenerDatosPorReporte</key>
		<query>
      select
      pto.ptomedicodi,
      NVL(SUM(scada.h2), SUM(scada.h1)) AS h1,
      NVL(SUM(scada.h4), SUM(scada.h3)) AS h2,
      NVL(SUM(scada.h6), SUM(scada.h5)) AS h3,
      NVL(SUM(scada.h8), SUM(scada.h7)) AS h4,
      NVL(SUM(scada.h10), SUM(scada.h9)) AS h5,
      NVL(SUM(scada.h12), SUM(scada.h11)) AS h6,
      NVL(SUM(scada.h14), SUM(scada.h13)) AS h7,
      NVL(SUM(scada.h16), SUM(scada.h15)) AS h8,
      NVL(SUM(scada.h18), SUM(scada.h17)) AS h9,
      NVL(SUM(scada.h20), SUM(scada.h19)) AS h10,
      NVL(SUM(scada.h22), SUM(scada.h21)) AS h11,
      NVL(SUM(scada.h24), SUM(scada.h23)) AS h12,
      NVL(SUM(scada.h26), SUM(scada.h25)) AS h13,
      NVL(SUM(scada.h28), SUM(scada.h27)) AS h14,
      NVL(SUM(scada.h30), SUM(scada.h29)) AS h15,
      NVL(SUM(scada.h32), SUM(scada.h31)) AS h16,
      NVL(SUM(scada.h34), SUM(scada.h33)) AS h17,
      NVL(SUM(scada.h36), SUM(scada.h35)) AS h18,
      NVL(SUM(scada.h38), SUM(scada.h37)) AS h19,
      NVL(SUM(scada.h40), SUM(scada.h39)) AS h20,
      NVL(SUM(scada.h42), SUM(scada.h41)) AS h21,
      NVL(SUM(scada.h44), SUM(scada.h43)) AS h22,
      NVL(SUM(scada.h46), SUM(scada.h45)) AS h23,
      NVL(SUM(scada.h48), SUM(scada.h47)) AS h24,
      NVL(SUM(scada.h50), SUM(scada.h49)) AS h25,
      NVL(SUM(scada.h52), SUM(scada.h51)) AS h26,
      NVL(SUM(scada.h54), SUM(scada.h53)) AS h27,
      NVL(SUM(scada.h56), SUM(scada.h55)) AS h28,
      NVL(SUM(scada.h58), SUM(scada.h57)) AS h29,
      NVL(SUM(scada.h60), SUM(scada.h59)) AS h30,
      NVL(SUM(scada.h62), SUM(scada.h61)) AS h31,
      NVL(SUM(scada.h64), SUM(scada.h63)) AS h32,
      NVL(SUM(scada.h66), SUM(scada.h65)) AS h33,
      NVL(SUM(scada.h68), SUM(scada.h67)) AS h34,
      NVL(SUM(scada.h70), SUM(scada.h69)) AS h35,
      NVL(SUM(scada.h72), SUM(scada.h71)) AS h36,
      NVL(SUM(scada.h74), SUM(scada.h73)) AS h37,
      NVL(SUM(scada.h76), SUM(scada.h75)) AS h38,
      NVL(SUM(scada.h78), SUM(scada.h77)) AS h39,
      NVL(SUM(scada.h80), SUM(scada.h79)) AS h40,
      NVL(SUM(scada.h82), SUM(scada.h81)) AS h41,
      NVL(SUM(scada.h84), SUM(scada.h83)) AS h42,
      NVL(SUM(scada.h86), SUM(scada.h85)) AS h43,
      NVL(SUM(scada.h88), SUM(scada.h87)) AS h44,
      NVL(SUM(scada.h90), SUM(scada.h89)) AS h45,
      NVL(SUM(scada.h92), SUM(scada.h91)) AS h46,
      NVL(SUM(scada.h94), SUM(scada.h93)) AS h47,
      NVL(SUM(scada.h96), SUM(scada.h95)) AS h48
      from me_scada_sp7 scada
      inner join me_ptomedcanal equivalencia on scada.canalcodi = equivalencia.canalcodi and equivalencia.tipoinfocodi = {2}
      inner join me_reporptomed pto on equivalencia.ptomedicodi = pto.ptomedicodi
      where pto.reporcodi = {0} and scada.medifecha = to_date('{1}', 'YYYY-MM-DD')
      group by pto.ptomedicodi
    </query>
	</Sql>

  <Sql>
    <key>SiExisteRegistroPorFechaYCanal</key>
    <query>
      select count(*) from ME_SCADA_SP7 where CANALCODI = {0} and medifecha=to_date('{1}','yyyy-MM-dd')
    </query>
  </Sql>

  <Sql>
    <key>AgregarRegistroPorFechaYBloque</key>
    <query>
      insert into ME_SCADA_SP7 (CANALCODI,MEDIFECHA,{0},MEDSCDUSUCREACION,MEDSCDFECCREACION)
      VALUES({1},to_date('{2}','yyyy-MM-dd'),{3},'{4}',SYSDATE)
    </query>
  </Sql>

  <Sql>
    <key>ActualizarRegistroPorFechaYBloque</key>
    <query>
      update ME_SCADA_SP7
      set {0} = {1}, MEDSCDUSUMODIFICACION = '{2}', MEDSCDFECMODIFICACION = SYSDATE
      where medifecha=to_date('{3}','yyyy-MM-dd') and canalcodi= {4}
    </query>
  </Sql>

  <Sql>
    <key>ActualizarRegistrosNulosPorFechaYBloque</key>
    <query>
      UPDATE ME_SCADA_SP7 SET {0} = 0 WHERE MEDIFECHA = to_date('{1}','yyyy-MM-dd') AND {2} IS NULL
    </query>
  </Sql>
</Sqls>
