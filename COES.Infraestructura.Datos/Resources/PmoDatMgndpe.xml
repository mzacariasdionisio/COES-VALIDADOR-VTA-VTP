<?xml version="1.0" encoding="utf-8" ?>
<Sqls>

<Sql>
    <key>List</key>
    <query>
      SELECT
      RE.PMMGNDCODI,
      RE.GRUPOCODI,
      RE.PMMGNDFECHA,
      --GR.GRUPOCODI AS CODCENTRAL,
      PTO.CODREF AS CODCENTRAL,
      --GR.GRUPONOMB AS NOMBCENTRAL,
      trim(PTO.PTOMEDIDESC) AS NOMBCENTRAL,
      --BR.GRUPOCODISDDP AS CODBARRA,
      --RE.PMMGNDGRUPOCODIBARRA,
      BR.GRUPOCODISDDP as PMMGNDGRUPOCODIBARRA,
      BR.GRUPONOMB AS NOMBBARRA,
      RE.PMMGNDTIPOPLANTA,
      RE.PMMGNDNROUNIDADES,
      RE.PMMGNDPOTINSTALADA,
      RE.PMMGNDFACTOROPE,
      RE.PMMGNDPROBFALLA,
      RE.PMMGNDCORTEOFALLA
      FROM PMO_DAT_MGND RE
      --JOIN PR_GRUPO GR ON RE.GRUPOCODI = GR.GRUPOCODI
      LEFT JOIN ME_PTOMEDICION PTO ON RE.GRUPOCODI=PTO.GRUPOCODI  AND PTOMEDIESTADO='A' AND PTO.TIPOINFOCODI=3  AND PTO.ORIGLECTCODI=22--AND TPTOMEDICODI in (66,67)
      LEFT JOIN PR_GRUPO BR ON RE.PMMGNDGRUPOCODIBARRA = BR.GRUPOCODI
      --ORDER BY GR.GRUPONOMB,RE.PMMGNDFECHA
      ORDER BY PTO.PTOMEDIDESC,PMMGNDFECHA
    </query>
  </Sql>
  
  <Sql>
    <key>GetBarra</key>
    <query>
      SELECT 
	  GRUPOCODI,
	  GRUPONOMB 
	  FROM PR_GRUPO 
	  WHERE CATECODI = 13 AND GRUPOACTIVO='S' 
	  ORDER BY GRUPONOMB
    </query>
  </Sql>
  
  <Sql>
    <key>GetById</key>
    <query>
      SELECT
      RE.PMMGNDCODI,
      RE.GRUPOCODI,
      RE.PMMGNDFECHA,
      --GR.GRUPOCODI AS CODCENTRAL,
      PTO.CODREF AS CODCENTRAL,
      --GR.GRUPONOMB AS NOMBCENTRAL,
      trim(PTO.PTOMEDIDESC) AS NOMBCENTRAL,
      RE.PMMGNDGRUPOCODIBARRA,
      BR.GRUPONOMB AS NOMBBARRA,
      RE.PMMGNDTIPOPLANTA,
      RE.PMMGNDNROUNIDADES,
      RE.PMMGNDPOTINSTALADA,
      RE.PMMGNDFACTOROPE,
      RE.PMMGNDPROBFALLA,
      RE.PMMGNDCORTEOFALLA
      FROM PMO_DAT_MGND RE
      --JOIN PR_GRUPO GR ON RE.GRUPOCODI = GR.GRUPOCODI
      LEFT JOIN ME_PTOMEDICION PTO ON RE.GRUPOCODI=PTO.GRUPOCODI  AND PTOMEDIESTADO='A' AND PTO.TIPOINFOCODI=3  AND PTO.ORIGLECTCODI=22--AND TPTOMEDICODI in (66,67)
      LEFT JOIN PR_GRUPO BR ON RE.PMMGNDGRUPOCODIBARRA = BR.GRUPOCODI
      WHERE RE.PMMGNDCODI = :PMMGNDCODI
      --ORDER BY GR.GRUPONOMB,RE.PMMGNDFECHA
      ORDER BY PTO.PTOMEDIDESC,PMMGNDFECHA
    </query>
  </Sql>
  
  
  <Sql>
    <key>Update</key>
    <query>
      update PMO_DAT_MGND
      set
      --GRUPOCODI = :GRUPOCODI,
      PMMGNDFECHA = :PMMGNDFECHA,
      PMMGNDTIPOPLANTA = :PMMGNDTIPOPLANTA,
      PMMGNDNROUNIDADES = :PMMGNDNROUNIDADES,
      PMMGNDFACTOROPE = :PMMGNDFACTOROPE,
      PMMGNDPROBFALLA = :PMMGNDPROBFALLA,
      PMMGNDPOTINSTALADA = :PMMGNDPOTINSTALADA,
      PMMGNDGRUPOCODIBARRA = :PMMGNDGRUPOCODIBARRA,
      PMMGNDCORTEOFALLA = :PMMGNDCORTEOFALLA
      where
      PMMGNDCODI = :PMMGNDCODI
    </query>
  </Sql>
  
  <Sql>
    <key>GetDat</key>
    <query>
      SELECT TO_CHAR(PMMGNDFECHA,'DD/MM/YYYY') AS "Fecha",
      --LPAD(GR.GRUPOCODISDDP,4,' ') AS "Num",
      LPAD(PTO.CODREF,4,' ') AS "Num",
      --RPAD(TRIM(SUBSTR(GR.GRUPONOMB,1,12)),12,' ') AS "Name",
      RPAD(TRIM(SUBSTR(PTO.PTOMEDIDESC,1,12)),12,' ') AS "Name",
      LPAD(BR.GRUPOCODISDDP,5,' ') AS "Bus",
      LPAD(RE.PMMGNDTIPOPLANTA,4,' ') AS "Tipo",
      LPAD(RE.PMMGNDNROUNIDADES,4,' ') as "Uni",
      LPAD(RE.PMMGNDPOTINSTALADA,7,' ') AS "PotIns",
      LPAD(RE.PMMGNDFACTOROPE,8,' ') AS "FatOpe",
      LPAD(RE.PMMGNDPROBFALLA,7,' ') AS "ProbFal",
      LPAD(RE.PMMGNDCORTEOFALLA,4,' ') AS "SFal",
      RE.PMMGNDPOTINSTALADA,RE.PMMGNDFACTOROPE,RE.PMMGNDPROBFALLA
      FROM PMO_DAT_MGND RE
      --JOIN PR_GRUPO GR ON RE.GRUPOCODI = GR.GRUPOCODI
      LEFT JOIN ME_PTOMEDICION PTO ON RE.GRUPOCODI=PTO.GRUPOCODI  AND PTOMEDIESTADO='A' AND PTO.TIPOINFOCODI=3  AND PTO.ORIGLECTCODI=22--AND TPTOMEDICODI in (66,67)
      LEFT JOIN PR_GRUPO BR ON RE.PMMGNDGRUPOCODIBARRA = BR.GRUPOCODI
      --ORDER BY GR.GRUPONOMB,PMMGNDFECHA
      ORDER BY PTO.PTOMEDIDESC,PMMGNDFECHA
    </query>
  </Sql>
  
  <Sql>
    <key>GetCount</key>
    <query>
        select count(*) as CANT from pmo_dat_mgnd
    </query>
  </Sql>
</Sqls>
