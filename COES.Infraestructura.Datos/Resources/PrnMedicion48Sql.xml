<?xml version="1.0" encoding="utf-8" ?>
<Sqls>
  <Sql>
    <key>Save</key>
    <query>
      insert into prn_medicion48(
      ptomedicodi,
      prnm48tipo,
      medifecha,
      prnm48estado,
      meditotal,
      h1,
      h2,
      h3,
      h4,
      h5,
      h6,
      h7,
      h8,
      h9,
      h10,
      h11,
      h12,
      h13,
      h14,
      h15,
      h16,
      h17,
      h18,
      h19,
      h20,
      h21,
      h22,
      h23,
      h24,
      h25,
      h26,
      h27,
      h28,
      h29,
      h30,
      h31,
      h32,
      h33,
      h34,
      h35,
      h36,
      h37,
      h38,
      h39,
      h40,
      h41,
      h42,
      h43,
      h44,
      h45,
      h46,
      h47,
      h48,
      prnm48usucreacion,
      prnm48feccreacion,
      prnm48usumodificacion,
      prnm48fecmodificacion
      )
      values(
      :ptomedicodi,
      :prnm48tipo,
      :medifecha,
      :prnm48estado,
      :meditotal,
      :h1,
      :h2,
      :h3,
      :h4,
      :h5,
      :h6,
      :h7,
      :h8,
      :h9,
      :h10,
      :h11,
      :h12,
      :h13,
      :h14,
      :h15,
      :h16,
      :h17,
      :h18,
      :h19,
      :h20,
      :h21,
      :h22,
      :h23,
      :h24,
      :h25,
      :h26,
      :h27,
      :h28,
      :h29,
      :h30,
      :h31,
      :h32,
      :h33,
      :h34,
      :h35,
      :h36,
      :h37,
      :h38,
      :h39,
      :h40,
      :h41,
      :h42,
      :h43,
      :h44,
      :h45,
      :h46,
      :h47,
      :h48,
      :prnm48usucreacion,
      :prnm48feccreacion,
      :prnm48usumodificacion,
      :prnm48fecmodificacion
      )
    </query>
  </Sql>
  
  <Sql>
    <key>Update</key>
    <query>
      update
      prn_medicion48
      set
      prnm48estado = :prnm48estado,
      meditotal = :meditotal,
      h1 = :h1,
      h2 = :h2,
      h3 = :h3,
      h4 = :h4,
      h5 = :h5,
      h6 = :h6,
      h7 = :h7,
      h8 = :h8,
      h9 = :h9,
      h10 = :h10,
      h11 = :h11,
      h12 = :h12,
      h13 = :h13,
      h14 = :h14,
      h15 = :h15,
      h16 = :h16,
      h17 = :h17,
      h18 = :h18,
      h19 = :h19,
      h20 = :h20,
      h21 = :h21,
      h22 = :h22,
      h23 = :h23,
      h24 = :h24,
      h25 = :h25,
      h26 = :h26,
      h27 = :h27,
      h28 = :h28,
      h29 = :h29,
      h30 = :h30,
      h31 = :h31,
      h32 = :h32,
      h33 = :h33,
      h34 = :h34,
      h35 = :h35,
      h36 = :h36,
      h37 = :h37,
      h38 = :h38,
      h39 = :h39,
      h40 = :h40,
      h41 = :h41,
      h42 = :h42,
      h43 = :h43,
      h44 = :h44,
      h45 = :h45,
      h46 = :h46,
      h47 = :h47,
      h48 = :h48,
      prnm48usumodificacion = :prnm48usumodificacion,
      prnm48fecmodificacion = :prnm48fecmodificacion
      where
      ptomedicodi = :ptomedicodi and
      prnm48tipo = :prnm48tipo and
      medifecha = :medifecha
    </query>
  </Sql>
  
  <Sql>
    <key>Delete</key>
    <query>
      delete from
      prn_medicion48
      where
      ptomedicodi = :ptomedicodi and
      prnm48tipo = :prnm48tipo and
      medifecha = :medifecha
    </query>
  </Sql>

  <Sql>
    <key>GetById</key>
    <query>
      select * from prn_medicion48
      where
      ptomedicodi = :ptomedicodi and
      prnm48tipo = :prnm48tipo and
      medifecha = :medifecha
    </query>
  </Sql>

  <Sql>
    <key>List</key>
    <query>
      select * from prn_medicion48
    </query>
  </Sql>

  <Sql>
    <key>ListById</key>
    <query>
      select * from prn_medicion48
      where
      ptomedicodi = :ptomedicodi and
      prnm48tipo = :prnm48tipo and
      medifecha between :fecini and :fecfin
    </query>
  </Sql>

  <!--Old - Inicio-->
  <Sql>
    <key>ListMeMed48Historicos</key>
    <query>
      select 
      ptomedicodi,
      lectcodi,
      medifecha,
      tipoinfocodi,
      meditotal,
      h1,
      h2,
      h3,
      h4,
      h5,
      h6,
      h7,
      h8,
      h9,
      h10,
      h11,
      h12,
      h13,
      h14,
      h15,
      h16,
      h17,
      h18,
      h19,
      h20,
      h21,
      h22,
      h23,
      h24,
      h25,
      h26,
      h27,
      h28,
      h29,
      h30,
      h31,
      h32,
      h33,
      h34,
      h35,
      h36,
      h37,
      h38,
      h39,
      h40,
      h41,
      h42,
      h43,
      h44,
      h45,
      h46,
      h47,
      h48,
      parptoporcerrormin,
      parptoporcerrormax,
      parptoporcmuestra,
      parptoporcdesvia,
      parptomagcargamin,
      parptomagcargamax,
      parptoferiado,
      parptoatipico,
      parptodepurauto,
      parptopatron,
      parptoveda,
      parptonumcoincidencia
      from(
      select
      med.*,
      dat.pmconpcodi,
      dat.pmedatvalor
      from
      me_medicion48 med
      join me_ptomedicion pm on med.ptomedicodi = pm.ptomedicodi
      join prn_ptomeddat dat on med.ptomedicodi = dat.ptomedicodi and (med.medifecha = dat.pmedatfecha)
      )
      pivot(
      max(pmedatvalor) for  pmconpcodi
      in (
      1 as parptoporcerrormin,
      2 as parptoporcerrormax,
      3 as parptoporcmuestra,
      4 as parptoporcdesvia,
      5 as parptomagcargamin,
      6 as parptomagcargamax,
      7 as parptoferiado,
      8 as parptoatipico,
      9 as parptodepurauto,
      10 as parptopatron,
      11 as parptoveda,
      12 as parptonumcoincidencia
      ))
      where
      ptomedicodi = :ptomedicodi and
      lectcodi = :lectcodi and
      tipoinfocodi = :tipoinfocodi and
      parptoferiado = :feriado and
      parptoatipico = :atipico and
      medifecha between :fecini and :fecfin
    </query>
  </Sql>

  <Sql>
    <key>ListPrnMed48Historicos</key>
    <query>
      select
      ptomedicodi,
      prnm48tipo,
      medifecha,
      prnm48estado,
      meditotal,
      h1,
      h2,
      h3,
      h4,
      h5,
      h6,
      h7,
      h8,
      h9,
      h10,
      h11,
      h12,
      h13,
      h14,
      h15,
      h16,
      h17,
      h18,
      h19,
      h20,
      h21,
      h22,
      h23,
      h24,
      h25,
      h26,
      h27,
      h28,
      h29,
      h30,
      h31,
      h32,
      h33,
      h34,
      h35,
      h36,
      h37,
      h38,
      h39,
      h40,
      h41,
      h42,
      h43,
      h44,
      h45,
      h46,
      h47,
      h48,
      parptoporcerrormin,
      parptoporcerrormax,
      parptoporcmuestra,
      parptoporcdesvia,
      parptomagcargamin,
      parptomagcargamax,
      parptoferiado,
      parptoatipico,
      parptodepurauto,
      parptopatron,
      parptoveda,
      parptonumcoincidencia
      from(
      select
      med.*,
      dat.pmconpcodi,
      dat.pmedatvalor
      from
      prn_medicion48 med
      join me_ptomedicion pm on med.ptomedicodi = pm.ptomedicodi
      join prn_ptomeddat dat on med.ptomedicodi = dat.ptomedicodi and (med.medifecha = dat.pmedatfecha)
      )
      pivot(
      max(pmedatvalor) for  pmconpcodi
      in (
      1 as parptoporcerrormin,
      2 as parptoporcerrormax,
      3 as parptoporcmuestra,
      4 as parptoporcdesvia,
      5 as parptomagcargamin,
      6 as parptomagcargamax,
      7 as parptoferiado,
      8 as parptoatipico,
      9 as parptodepurauto,
      10 as parptopatron,
      11 as parptoveda,
      12 as parptonumcoincidencia
      ))
      where
      ptomedicodi = :ptomedicodi and
      prnm48tipo = :prnm48tipo and
      parptoferiado = :feriado and
      parptoatipico = :atipico and
      medifecha between :fecini and :fecfin
    </query>
  </Sql>

  <Sql>
    <key>ListPrnMed48HistoricosNoConfig</key>
    <query>
      select
      ptomedicodi,
      prnm48tipo,
      medifecha,
      prnm48estado,
      meditotal,
      h1,
      h2,
      h3,
      h4,
      h5,
      h6,
      h7,
      h8,
      h9,
      h10,
      h11,
      h12,
      h13,
      h14,
      h15,
      h16,
      h17,
      h18,
      h19,
      h20,
      h21,
      h22,
      h23,
      h24,
      h25,
      h26,
      h27,
      h28,
      h29,
      h30,
      h31,
      h32,
      h33,
      h34,
      h35,
      h36,
      h37,
      h38,
      h39,
      h40,
      h41,
      h42,
      h43,
      h44,
      h45,
      h46,
      h47,
      h48
      from
      prn_medicion48
      where
      ptomedicodi = :ptomedicodi and
      prnm48tipo = :prnm48tipo and
      medifecha between :fecini and :fecfin
    </query>
  </Sql>

  <Sql>
    <key>ListDespachoAreaByFecha</key>
    <query>
      select
      meq.areacodi,
      meq.medifecha,
      nvl(sum(H1), 0) H1,
      nvl(sum(H2), 0) H2,
      nvl(sum(H3), 0) H3,
      nvl(sum(H4), 0) H4,
      nvl(sum(H5), 0) H5,
      nvl(sum(H6), 0) H6,
      nvl(sum(H7), 0) H7,
      nvl(sum(H8), 0) H8,
      nvl(sum(H9), 0) H9,
      nvl(sum(H10), 0) H10,
      nvl(sum(H11), 0) H11,
      nvl(sum(H12), 0) H12,
      nvl(sum(H13), 0) H13,
      nvl(sum(H14), 0) H14,
      nvl(sum(H15), 0) H15,
      nvl(sum(H16), 0) H16,
      nvl(sum(H17), 0) H17,
      nvl(sum(H18), 0) H18,
      nvl(sum(H19), 0) H19,
      nvl(sum(H20), 0) H20,
      nvl(sum(H21), 0) H21,
      nvl(sum(H22), 0) H22,
      nvl(sum(H23), 0) H23,
      nvl(sum(H24), 0) H24,
      nvl(sum(H25), 0) H25,
      nvl(sum(H26), 0) H26,
      nvl(sum(H27), 0) H27,
      nvl(sum(H28), 0) H28,
      nvl(sum(H29), 0) H29,
      nvl(sum(H30), 0) H30,
      nvl(sum(H31), 0) H31,
      nvl(sum(H32), 0) H32,
      nvl(sum(H33), 0) H33,
      nvl(sum(H34), 0) H34,
      nvl(sum(H35), 0) H35,
      nvl(sum(H36), 0) H36,
      nvl(sum(H37), 0) H37,
      nvl(sum(H38), 0) H38,
      nvl(sum(H39), 0) H39,
      nvl(sum(H40), 0) H40,
      nvl(sum(H41), 0) H41,
      nvl(sum(H42), 0) H42,
      nvl(sum(H43), 0) H43,
      nvl(sum(H44), 0) H44,
      nvl(sum(H45), 0) H45,
      nvl(sum(H46), 0) H46,
      nvl(sum(H47), 0) H47,
      nvl(sum(H48), 0) H48
      from
      prn_medicioneq meq
      where
      meq.areacodi in () and
      meq.medifecha = {1}
      group by meq.areacodi, meq.medifecha
    </query>
  </Sql>

  <Sql>
    <key>ListDespachoAreaULByFecha</key>
    <query>
      select distinct
      pe.valor,
      me48.medifecha,
      nvl(sum(MEDITOTAL), 0) MEDITOTAL,
      nvl(sum(H1), 0) H1,
      nvl(sum(H2), 0) H2,
      nvl(sum(H3), 0) H3,
      nvl(sum(H4), 0) H4,
      nvl(sum(H5), 0) H5,
      nvl(sum(H6), 0) H6,
      nvl(sum(H7), 0) H7,
      nvl(sum(H8), 0) H8,
      nvl(sum(H9), 0) H9,
      nvl(sum(H10), 0) H10,
      nvl(sum(H11), 0) H11,
      nvl(sum(H12), 0) H12,
      nvl(sum(H13), 0) H13,
      nvl(sum(H14), 0) H14,
      nvl(sum(H15), 0) H15,
      nvl(sum(H16), 0) H16,
      nvl(sum(H17), 0) H17,
      nvl(sum(H18), 0) H18,
      nvl(sum(H19), 0) H19,
      nvl(sum(H20), 0) H20,
      nvl(sum(H21), 0) H21,
      nvl(sum(H22), 0) H22,
      nvl(sum(H23), 0) H23,
      nvl(sum(H24), 0) H24,
      nvl(sum(H25), 0) H25,
      nvl(sum(H26), 0) H26,
      nvl(sum(H27), 0) H27,
      nvl(sum(H28), 0) H28,
      nvl(sum(H29), 0) H29,
      nvl(sum(H30), 0) H30,
      nvl(sum(H31), 0) H31,
      nvl(sum(H32), 0) H32,
      nvl(sum(H33), 0) H33,
      nvl(sum(H34), 0) H34,
      nvl(sum(H35), 0) H35,
      nvl(sum(H36), 0) H36,
      nvl(sum(H37), 0) H37,
      nvl(sum(H38), 0) H38,
      nvl(sum(H39), 0) H39,
      nvl(sum(H40), 0) H40,
      nvl(sum(H41), 0) H41,
      nvl(sum(H42), 0) H42,
      nvl(sum(H43), 0) H43,
      nvl(sum(H44), 0) H44,
      nvl(sum(H45), 0) H45,
      nvl(sum(H46), 0) H46,
      nvl(sum(H47), 0) H47,
      nvl(sum(H48), 0) H48
      from
      eq_propequi pe
      join eq_equipo eq on pe.equicodi = eq.equicodi
      and (pe.propcodi = 1064)
      and (fechapropequi = (select max(fechapropequi) from eq_propequi where propcodi = 1064 and equicodi = eq.equicodi))
      join eq_familia fam on eq.famcodi = fam.famcodi
      and (fam.famcodi = 32)
      join eq_area area on eq.areacodi = area.areacodi
      join eq_tipoarea tarea on area.tareacodi = tarea.tareacodi
      join si_empresa emp on eq.emprcodi = emp.emprcodi
      join si_tipoempresa te on emp.tipoemprcodi = te.tipoemprcodi
      and (te.tipoemprcodi = 4)
      join me_ptomedicion pto on eq.equicodi = pto.equicodi
      and (pto.origlectcodi = 6)
      join me_medicion48 me48 on pto.ptomedicodi = me48.ptomedicodi
      and (me48.lectcodi = 103)
      and (me48.tipoinfocodi = 1)
      where
      me48.medifecha = :medifecha
      group by pe.valor, me48.medifecha
    </query>
  </Sql>

  <Sql>
    <key>GetDespachoEjecutadoByArea</key>
    <query>
      select
      prn_medicioneq.areacodi,
      prn_medicioneq.medifecha,
      nvl(sum(H1), 0) H1,
      nvl(sum(H2), 0) H2,
      nvl(sum(H3), 0) H3,
      nvl(sum(H4), 0) H4,
      nvl(sum(H5), 0) H5,
      nvl(sum(H6), 0) H6,
      nvl(sum(H7), 0) H7,
      nvl(sum(H8), 0) H8,
      nvl(sum(H9), 0) H9,
      nvl(sum(H10), 0) H10,
      nvl(sum(H11), 0) H11,
      nvl(sum(H12), 0) H12,
      nvl(sum(H13), 0) H13,
      nvl(sum(H14), 0) H14,
      nvl(sum(H15), 0) H15,
      nvl(sum(H16), 0) H16,
      nvl(sum(H17), 0) H17,
      nvl(sum(H18), 0) H18,
      nvl(sum(H19), 0) H19,
      nvl(sum(H20), 0) H20,
      nvl(sum(H21), 0) H21,
      nvl(sum(H22), 0) H22,
      nvl(sum(H23), 0) H23,
      nvl(sum(H24), 0) H24,
      nvl(sum(H25), 0) H25,
      nvl(sum(H26), 0) H26,
      nvl(sum(H27), 0) H27,
      nvl(sum(H28), 0) H28,
      nvl(sum(H29), 0) H29,
      nvl(sum(H30), 0) H30,
      nvl(sum(H31), 0) H31,
      nvl(sum(H32), 0) H32,
      nvl(sum(H33), 0) H33,
      nvl(sum(H34), 0) H34,
      nvl(sum(H35), 0) H35,
      nvl(sum(H36), 0) H36,
      nvl(sum(H37), 0) H37,
      nvl(sum(H38), 0) H38,
      nvl(sum(H39), 0) H39,
      nvl(sum(H40), 0) H40,
      nvl(sum(H41), 0) H41,
      nvl(sum(H42), 0) H42,
      nvl(sum(H43), 0) H43,
      nvl(sum(H44), 0) H44,
      nvl(sum(H45), 0) H45,
      nvl(sum(H46), 0) H46,
      nvl(sum(H47), 0) H47,
      nvl(sum(H48), 0) H48
      from
      prn_medicioneq
      where
      prn_medicioneq.areacodi = :areacodi and
      prn_medicioneq.medifecha = :medifecha
      group by prn_medicioneq.areacodi, prn_medicioneq.medifecha
    </query>
  </Sql>

  <Sql>
    <key>GetMeMedicionesULByArea</key>
    <query>
      select
      pto.equicodi areapadre,
      m48.medifecha,
      nvl(sum(H1), 0) H1,
      nvl(sum(H2), 0) H2,
      nvl(sum(H3), 0) H3,
      nvl(sum(H4), 0) H4,
      nvl(sum(H5), 0) H5,
      nvl(sum(H6), 0) H6,
      nvl(sum(H7), 0) H7,
      nvl(sum(H8), 0) H8,
      nvl(sum(H9), 0) H9,
      nvl(sum(H10), 0) H10,
      nvl(sum(H11), 0) H11,
      nvl(sum(H12), 0) H12,
      nvl(sum(H13), 0) H13,
      nvl(sum(H14), 0) H14,
      nvl(sum(H15), 0) H15,
      nvl(sum(H16), 0) H16,
      nvl(sum(H17), 0) H17,
      nvl(sum(H18), 0) H18,
      nvl(sum(H19), 0) H19,
      nvl(sum(H20), 0) H20,
      nvl(sum(H21), 0) H21,
      nvl(sum(H22), 0) H22,
      nvl(sum(H23), 0) H23,
      nvl(sum(H24), 0) H24,
      nvl(sum(H25), 0) H25,
      nvl(sum(H26), 0) H26,
      nvl(sum(H27), 0) H27,
      nvl(sum(H28), 0) H28,
      nvl(sum(H29), 0) H29,
      nvl(sum(H30), 0) H30,
      nvl(sum(H31), 0) H31,
      nvl(sum(H32), 0) H32,
      nvl(sum(H33), 0) H33,
      nvl(sum(H34), 0) H34,
      nvl(sum(H35), 0) H35,
      nvl(sum(H36), 0) H36,
      nvl(sum(H37), 0) H37,
      nvl(sum(H38), 0) H38,
      nvl(sum(H39), 0) H39,
      nvl(sum(H40), 0) H40,
      nvl(sum(H41), 0) H41,
      nvl(sum(H42), 0) H42,
      nvl(sum(H43), 0) H43,
      nvl(sum(H44), 0) H44,
      nvl(sum(H45), 0) H45,
      nvl(sum(H46), 0) H46,
      nvl(sum(H47), 0) H47,
      nvl(sum(H48), 0) H48
      from
      prn_medicion48 m48
      join me_ptomedicion pto on m48.ptomedicodi = pto.ptomedicodi
      and(pto.origlectcodi = 33)
      and(pto.ptomediestado = 'A')
      join prn_puntoagrupacion ptogrp on pto.ptomedicodi = ptogrp.ptomedicodi
      and (to_date(ptogrp.ptogrpfechafin, 'dd/MM/yyyy') = to_date('31-DEC-99', 'dd/MM/yyyy'))
      where
      m48.prnm48tipo = :prnm48tipo and
      pto.equicodi = :equicodi and
      m48.medifecha = :medifecha
      group by pto.equicodi, m48.medifecha
    </query>
  </Sql>

  <Sql>
    <key>GetMeMedicionesULByAreaOld</key>
    <query>
      select
      arel.areapadre,
      med.medifecha,
      nvl(sum(H1), 0) H1,
      nvl(sum(H2), 0) H2,
      nvl(sum(H3), 0) H3,
      nvl(sum(H4), 0) H4,
      nvl(sum(H5), 0) H5,
      nvl(sum(H6), 0) H6,
      nvl(sum(H7), 0) H7,
      nvl(sum(H8), 0) H8,
      nvl(sum(H9), 0) H9,
      nvl(sum(H10), 0) H10,
      nvl(sum(H11), 0) H11,
      nvl(sum(H12), 0) H12,
      nvl(sum(H13), 0) H13,
      nvl(sum(H14), 0) H14,
      nvl(sum(H15), 0) H15,
      nvl(sum(H16), 0) H16,
      nvl(sum(H17), 0) H17,
      nvl(sum(H18), 0) H18,
      nvl(sum(H19), 0) H19,
      nvl(sum(H20), 0) H20,
      nvl(sum(H21), 0) H21,
      nvl(sum(H22), 0) H22,
      nvl(sum(H23), 0) H23,
      nvl(sum(H24), 0) H24,
      nvl(sum(H25), 0) H25,
      nvl(sum(H26), 0) H26,
      nvl(sum(H27), 0) H27,
      nvl(sum(H28), 0) H28,
      nvl(sum(H29), 0) H29,
      nvl(sum(H30), 0) H30,
      nvl(sum(H31), 0) H31,
      nvl(sum(H32), 0) H32,
      nvl(sum(H33), 0) H33,
      nvl(sum(H34), 0) H34,
      nvl(sum(H35), 0) H35,
      nvl(sum(H36), 0) H36,
      nvl(sum(H37), 0) H37,
      nvl(sum(H38), 0) H38,
      nvl(sum(H39), 0) H39,
      nvl(sum(H40), 0) H40,
      nvl(sum(H41), 0) H41,
      nvl(sum(H42), 0) H42,
      nvl(sum(H43), 0) H43,
      nvl(sum(H44), 0) H44,
      nvl(sum(H45), 0) H45,
      nvl(sum(H46), 0) H46,
      nvl(sum(H47), 0) H47,
      nvl(sum(H48), 0) H48
      from
      me_medicion48 med
      join me_ptomedicion pto on med.ptomedicodi = pto.ptomedicodi and (pto.origlectcodi = 6)
      join eq_equipo eq on pto.equicodi = eq.equicodi
      join si_empresa emp on eq.emprcodi = emp.emprcodi and (emp.tipoemprcodi = 4)
      join eq_area ar  on eq.areacodi = ar.areacodi
      join eq_arearel arel on ar.areacodi = arel.areacodi
      where
      med.lectcodi = :lectcodi and
      arel.areapadre = :areapadre and
      med.medifecha = :medifecha
      group by arel.areapadre, med.medifecha
    </query>
  </Sql>
  
  <!--prnm48estado se utiliza para listar a todos los puntos de medición de un mismo envio en la extranet-->
  <Sql>
    <key>ListByIdEnvio</key>
    <query>
      select pto.ptomedidesc || ' - ' ||pto.ptomedibarranomb as ptomedidesc, p48.*
      from prn_medicion48 p48, me_ptomedicion pto
      where p48.ptomedicodi = pto.ptomedicodi and p48.prnm48estado = :prnm48estado
    </query>
  </Sql>

  <!--agregado para reporte-->
  <Sql>
    <key>ObtenerConsultaPronostico48</key>
    <query>
      select
      medicion.*,
      punto.ptomedicodi,
      equipo.equicodi,
      equipo.equinomb,
      barra.equitension,
      equipo.areacodi,
      empresa.emprnomb,
      (select area.areanomb from eq_area area where area.areacodi = equipo.areacodi) as areanomb
      from
      prn_medicion48 medicion
      inner join me_ptomedicion punto on medicion.ptomedicodi = punto.ptomedicodi
      inner join eq_equipo equipo on punto.equicodi = equipo.equicodi
      inner join si_empresa empresa on punto.emprcodi = empresa.emprcodi
      inner join eq_equipo barra on barra.equicodi = punto.codref
      where punto.origlectcodi = {4}
      and medicion.prnm48tipo = {0}
      --and punto.ptomedicodi > 20000
      and (empresa.emprcodi in ({1}) or '{1}' = '-1')
      and medifecha between to_date('{2} 00:00:00','YYYY-MM-DD HH24:MI:SS') and to_date('{3} 23:59:59','YYYY-MM-DD HH24:MI:SS')
    </query>
  </Sql>

  <Sql>
    <key>DeleteRangoPrnMedicion48</key>
    <query>
      delete from
      prn_medicion48
      where
      ptomedicodi = :ptomedicodi and
      prnm48tipo = :prnm48tipo and
      medifecha between :fecini and :fecfin
    </query>
  </Sql>
  <!--Old - Fin-->

  <!--Obtención de datos para la formación del perfíl patrón segun proceso - INICIO-->
  
  <!--Ptomedicodi = {0}-->
  <!--Prnm48tipo = {1}-->
  <!--Medifecha Inicio = {2}-->
  <!--Medifecha Fin = {3}-->
  <!--Lectcodi = {4}-->
  <!--Tipoinfocodi = {5}-->
  <!--Prncfgflagveda = {6}-->
  <!--Prncfgflagferiado = {7}-->
  <!--Prncfgflagatipico = {8}-->
  <!--Defecto - Prncfgflagveda = {9}-->
  <!--Defecto - Prncfgflagferiado = {10}-->
  <!--Defecto - Prncfgflagatipico = {11}-->
  <Sql>
    <key>DataPatronDemandaPorPunto</key>
    <query>
      select * from
      (
      select
      med.ptomedicodi, med.medifecha,
      nvl(sum(med.meditotal), 0) MEDITOTAL,
      nvl(sum(med.H1), 0) H1, nvl(sum(med.H2), 0) H2,
      nvl(sum(med.H3), 0) H3, nvl(sum(med.H4), 0) H4,
      nvl(sum(med.H5), 0) H5, nvl(sum(med.H6), 0) H6,
      nvl(sum(med.H7), 0) H7, nvl(sum(med.H8), 0) H8,
      nvl(sum(med.H9), 0) H9, nvl(sum(med.H10), 0) H10,
      nvl(sum(med.H11), 0) H11, nvl(sum(med.H12), 0) H12,
      nvl(sum(med.H13), 0) H13, nvl(sum(med.H14), 0) H14,
      nvl(sum(med.H15), 0) H15, nvl(sum(med.H16), 0) H16,
      nvl(sum(med.H17), 0) H17, nvl(sum(med.H18), 0) H18,
      nvl(sum(med.H19), 0) H19, nvl(sum(med.H20), 0) H20,
      nvl(sum(med.H21), 0) H21, nvl(sum(med.H22), 0) H22,
      nvl(sum(med.H23), 0) H23, nvl(sum(med.H24), 0) H24,
      nvl(sum(med.H25), 0) H25, nvl(sum(med.H26), 0) H26,
      nvl(sum(med.H27), 0) H27, nvl(sum(med.H28), 0) H28,
      nvl(sum(med.H29), 0) H29, nvl(sum(med.H30), 0) H30,
      nvl(sum(med.H31), 0) H31, nvl(sum(med.H32), 0) H32,
      nvl(sum(med.H33), 0) H33, nvl(sum(med.H34), 0) H34,
      nvl(sum(med.H35), 0) H35, nvl(sum(med.H36), 0) H36,
      nvl(sum(med.H37), 0) H37, nvl(sum(med.H38), 0) H38,
      nvl(sum(med.H39), 0) H39, nvl(sum(med.H40), 0) H40,
      nvl(sum(med.H41), 0) H41, nvl(sum(med.H42), 0) H42,
      nvl(sum(med.H43), 0) H43, nvl(sum(med.H44), 0) H44,
      nvl(sum(med.H45), 0) H45, nvl(sum(med.H46), 0) H46,
      nvl(sum(med.H47), 0) H47, nvl(sum(med.H48), 0) H48,
      nvl(cfg.prncfgflagveda, '{9}') PRNCFGFLAGVEDA,
      nvl(cfg.prncfgflagferiado, '{10}') PRNCFGFLAGFERIADO,
      nvl(cfg.prncfgflagatipico, '{11}') PRNCFGFLAGATIPICO
      from (
      select
      ptomedicodi, medifecha, meditotal,
      H1, H2, H3, H4, H5, H6, H7, H8, H9, H10,
      H11, H12, H13, H14, H15, H16, H17, H18, H19, H20,
      H21, H22, H23, H24, H25, H26, H27, H28, H29, H30,
      H31, H32, H33, H34, H35, H36, H37, H38, H39, H40,
      H41, H42, H43, H44, H45, H46, H47, H48
      from
      me_medicion48
      where
      ptomedicodi = {0} and
      lectcodi = {4} and
      tipoinfocodi = {5} and
      medifecha between to_date('{2}', 'DD/MM/YYYY') and to_date('{3}', 'DD/MM/YYYY')
      union all
      select
      ptomedicodi, medifecha, meditotal,
      H1, H2, H3, H4, H5, H6, H7, H8, H9, H10,
      H11, H12, H13, H14, H15, H16, H17, H18, H19, H20,
      H21, H22, H23, H24, H25, H26, H27, H28, H29, H30,
      H31, H32, H33, H34, H35, H36, H37, H38, H39, H40,
      H41, H42, H43, H44, H45, H46, H47, H48
      from
      prn_medicion48
      where
      ptomedicodi = {0} and
      prnm48tipo in ({1}) and
      medifecha between to_date('{2}', 'DD/MM/YYYY') and to_date('{3}', 'DD/MM/YYYY')
      ) med left join prn_configuracion cfg
      on (med.ptomedicodi = cfg.ptomedicodi and med.medifecha = cfg.prncfgfecha)
      group by med.ptomedicodi, med.medifecha, cfg.prncfgflagveda, cfg.prncfgflagferiado, cfg.prncfgflagatipico
      order by med.medifecha desc
      )
      where
      prncfgflagveda = '{6}' and
      prncfgflagferiado = '{7}' and
      prncfgflagatipico = '{8}'
    </query>
  </Sql>

  <Sql>
    <key>DataPatronDemandaPorPuntoPorFecha</key>
    <query>
      select * from
      (
      select
      med.ptomedicodi, med.medifecha,
      nvl(sum(med.meditotal), 0) MEDITOTAL,
      nvl(sum(med.H1), 0) H1, nvl(sum(med.H2), 0) H2,
      nvl(sum(med.H3), 0) H3, nvl(sum(med.H4), 0) H4,
      nvl(sum(med.H5), 0) H5, nvl(sum(med.H6), 0) H6,
      nvl(sum(med.H7), 0) H7, nvl(sum(med.H8), 0) H8,
      nvl(sum(med.H9), 0) H9, nvl(sum(med.H10), 0) H10,
      nvl(sum(med.H11), 0) H11, nvl(sum(med.H12), 0) H12,
      nvl(sum(med.H13), 0) H13, nvl(sum(med.H14), 0) H14,
      nvl(sum(med.H15), 0) H15, nvl(sum(med.H16), 0) H16,
      nvl(sum(med.H17), 0) H17, nvl(sum(med.H18), 0) H18,
      nvl(sum(med.H19), 0) H19, nvl(sum(med.H20), 0) H20,
      nvl(sum(med.H21), 0) H21, nvl(sum(med.H22), 0) H22,
      nvl(sum(med.H23), 0) H23, nvl(sum(med.H24), 0) H24,
      nvl(sum(med.H25), 0) H25, nvl(sum(med.H26), 0) H26,
      nvl(sum(med.H27), 0) H27, nvl(sum(med.H28), 0) H28,
      nvl(sum(med.H29), 0) H29, nvl(sum(med.H30), 0) H30,
      nvl(sum(med.H31), 0) H31, nvl(sum(med.H32), 0) H32,
      nvl(sum(med.H33), 0) H33, nvl(sum(med.H34), 0) H34,
      nvl(sum(med.H35), 0) H35, nvl(sum(med.H36), 0) H36,
      nvl(sum(med.H37), 0) H37, nvl(sum(med.H38), 0) H38,
      nvl(sum(med.H39), 0) H39, nvl(sum(med.H40), 0) H40,
      nvl(sum(med.H41), 0) H41, nvl(sum(med.H42), 0) H42,
      nvl(sum(med.H43), 0) H43, nvl(sum(med.H44), 0) H44,
      nvl(sum(med.H45), 0) H45, nvl(sum(med.H46), 0) H46,
      nvl(sum(med.H47), 0) H47, nvl(sum(med.H48), 0) H48,
      nvl(cfg.prncfgflagveda, '{9}') PRNCFGFLAGVEDA,
      nvl(cfg.prncfgflagferiado, '{10}') PRNCFGFLAGFERIADO,
      nvl(cfg.prncfgflagatipico, '{11}') PRNCFGFLAGATIPICO
      from (
      select
      ptomedicodi, medifecha, meditotal,
      H1, H2, H3, H4, H5, H6, H7, H8, H9, H10,
      H11, H12, H13, H14, H15, H16, H17, H18, H19, H20,
      H21, H22, H23, H24, H25, H26, H27, H28, H29, H30,
      H31, H32, H33, H34, H35, H36, H37, H38, H39, H40,
      H41, H42, H43, H44, H45, H46, H47, H48
      from
      me_medicion48
      where
      ptomedicodi = {0} and
      lectcodi = {4} and
      tipoinfocodi = {5} and
      medifecha between to_date('{2}', 'DD/MM/YYYY') and to_date('{3}', 'DD/MM/YYYY')
      union all
      select
      ptomedicodi, medifecha, meditotal,
      H1, H2, H3, H4, H5, H6, H7, H8, H9, H10,
      H11, H12, H13, H14, H15, H16, H17, H18, H19, H20,
      H21, H22, H23, H24, H25, H26, H27, H28, H29, H30,
      H31, H32, H33, H34, H35, H36, H37, H38, H39, H40,
      H41, H42, H43, H44, H45, H46, H47, H48
      from
      prn_medicion48
      where
      ptomedicodi = {0} and
      prnm48tipo in ({1}) and
      medifecha between to_date('{2}', 'DD/MM/YYYY') and to_date('{3}', 'DD/MM/YYYY')
      ) med left join prn_configuracion cfg
      on (med.ptomedicodi = cfg.ptomedicodi and med.medifecha = cfg.prncfgfecha)
      group by med.ptomedicodi, med.medifecha, cfg.prncfgflagveda, cfg.prncfgflagferiado, cfg.prncfgflagatipico
      order by med.medifecha desc
      )
      where
      prncfgflagveda = '{6}' and
      prncfgflagferiado = '{7}' and
      prncfgflagatipico = '{8}'
    </query>
  </Sql>

  <!--
  {0} : Origlectcodi - Origen de lectura de una agrupación PRODEM
  {1} : Origlectcodi2 - Origen de lectura de un punto de medición PRODEM
  {2} : Lectcodi - Lectura de una medición enviada por un agente
  {3} : Tipoinfocodi - Tipo de información de un punto de medición PRODEM
  {4} : Medifecha Inicio - Rango inicial de busqueda de información
  {5} : Medifecha Fin - Rango final de busqueda de información
  {6} : Prnm48tipo - Tipo de información correspondiente a la "Depuración manual" y "Depuración automática"
  {7} : Prnm48tipo2 - Tipo de información correspondiente a la "Depuración manual de una agrupación"
  {8} : Ptomedicodi - Identificador del punto de medición a buscar
  -->
  <Sql>
    <key>DataPatronDemandaPorAgrupacion</key>
    <query>
      select
      ptomedicodi,
      medifecha,
      nvl(sum(H1), 0) H1, nvl(sum(H2), 0) H2,
      nvl(sum(H3), 0) H3, nvl(sum(H4), 0) H4,
      nvl(sum(H5), 0) H5, nvl(sum(H6), 0) H6,
      nvl(sum(H7), 0) H7, nvl(sum(H8), 0) H8,
      nvl(sum(H9), 0) H9, nvl(sum(H10), 0) H10,
      nvl(sum(H11), 0) H11, nvl(sum(H12), 0) H12,
      nvl(sum(H13), 0) H13, nvl(sum(H14), 0) H14,
      nvl(sum(H15), 0) H15, nvl(sum(H16), 0) H16,
      nvl(sum(H17), 0) H17, nvl(sum(H18), 0) H18,
      nvl(sum(H19), 0) H19, nvl(sum(H20), 0) H20,
      nvl(sum(H21), 0) H21, nvl(sum(H22), 0) H22,
      nvl(sum(H23), 0) H23, nvl(sum(H24), 0) H24,
      nvl(sum(H25), 0) H25, nvl(sum(H26), 0) H26,
      nvl(sum(H27), 0) H27, nvl(sum(H28), 0) H28,
      nvl(sum(H29), 0) H29, nvl(sum(H30), 0) H30,
      nvl(sum(H31), 0) H31, nvl(sum(H32), 0) H32,
      nvl(sum(H33), 0) H33, nvl(sum(H34), 0) H34,
      nvl(sum(H35), 0) H35, nvl(sum(H36), 0) H36,
      nvl(sum(H37), 0) H37, nvl(sum(H38), 0) H38,
      nvl(sum(H39), 0) H39, nvl(sum(H40), 0) H40,
      nvl(sum(H41), 0) H41, nvl(sum(H42), 0) H42,
      nvl(sum(H43), 0) H43, nvl(sum(H44), 0) H44,
      nvl(sum(H45), 0) H45, nvl(sum(H46), 0) H46,
      nvl(sum(H47), 0) H47, nvl(sum(H48), 0) H48
      from
      (
        select
        ptomedicodi,
        medifecha,
        nvl(sum(H1), 0) H1, nvl(sum(H2), 0) H2,
        nvl(sum(H3), 0) H3, nvl(sum(H4), 0) H4,
        nvl(sum(H5), 0) H5, nvl(sum(H6), 0) H6,
        nvl(sum(H7), 0) H7, nvl(sum(H8), 0) H8,
        nvl(sum(H9), 0) H9, nvl(sum(H10), 0) H10,
        nvl(sum(H11), 0) H11, nvl(sum(H12), 0) H12,
        nvl(sum(H13), 0) H13, nvl(sum(H14), 0) H14,
        nvl(sum(H15), 0) H15, nvl(sum(H16), 0) H16,
        nvl(sum(H17), 0) H17, nvl(sum(H18), 0) H18,
        nvl(sum(H19), 0) H19, nvl(sum(H20), 0) H20,
        nvl(sum(H21), 0) H21, nvl(sum(H22), 0) H22,
        nvl(sum(H23), 0) H23, nvl(sum(H24), 0) H24,
        nvl(sum(H25), 0) H25, nvl(sum(H26), 0) H26,
        nvl(sum(H27), 0) H27, nvl(sum(H28), 0) H28,
        nvl(sum(H29), 0) H29, nvl(sum(H30), 0) H30,
        nvl(sum(H31), 0) H31, nvl(sum(H32), 0) H32,
        nvl(sum(H33), 0) H33, nvl(sum(H34), 0) H34,
        nvl(sum(H35), 0) H35, nvl(sum(H36), 0) H36,
        nvl(sum(H37), 0) H37, nvl(sum(H38), 0) H38,
        nvl(sum(H39), 0) H39, nvl(sum(H40), 0) H40,
        nvl(sum(H41), 0) H41, nvl(sum(H42), 0) H42,
        nvl(sum(H43), 0) H43, nvl(sum(H44), 0) H44,
        nvl(sum(H45), 0) H45, nvl(sum(H46), 0) H46,
        nvl(sum(H47), 0) H47, nvl(sum(H48), 0) H48
        from
        (
          select
          pto.ptomedicodi, pto.ptomedidesc,
          dt.medifecha,
          grp.ptomedicodi PTOGRPHIJOCODI,
          H1, H2, H3, H4, H5, H6, H7, H8, H9, H10,
          H11, H12, H13, H14, H15, H16, H17, H18, H19, H20,
          H21, H22, H23, H24, H25, H26, H27, H28, H29, H30,
          H31, H32, H33, H34, H35, H36, H37, H38, H39, H40,
          H41, H42, H43, H44, H45, H46, H47, H48
          from
          me_ptomedicion pto
          join prn_puntoagrupacion ptogrp on pto.ptomedicodi = ptogrp.ptomedicodi
          and (pto.origlectcodi = {0} and pto.ptomediestado = 'A')
          and (ptogrp.ptogrpfechafin = to_date('31/12/9999', 'DD/MM/YYYY'))
          join prn_agrupacion grp on ptogrp.ptogrpcodi = grp.ptogrpcodi
          join (
            select
            ptomedicodi,
            medifecha,
            nvl(sum(H1), 0) H1, nvl(sum(H2), 0) H2,
            nvl(sum(H3), 0) H3, nvl(sum(H4), 0) H4,
            nvl(sum(H5), 0) H5, nvl(sum(H6), 0) H6,
            nvl(sum(H7), 0) H7, nvl(sum(H8), 0) H8,
            nvl(sum(H9), 0) H9, nvl(sum(H10), 0) H10,
            nvl(sum(H11), 0) H11, nvl(sum(H12), 0) H12,
            nvl(sum(H13), 0) H13, nvl(sum(H14), 0) H14,
            nvl(sum(H15), 0) H15, nvl(sum(H16), 0) H16,
            nvl(sum(H17), 0) H17, nvl(sum(H18), 0) H18,
            nvl(sum(H19), 0) H19, nvl(sum(H20), 0) H20,
            nvl(sum(H21), 0) H21, nvl(sum(H22), 0) H22,
            nvl(sum(H23), 0) H23, nvl(sum(H24), 0) H24,
            nvl(sum(H25), 0) H25, nvl(sum(H26), 0) H26,
            nvl(sum(H27), 0) H27, nvl(sum(H28), 0) H28,
            nvl(sum(H29), 0) H29, nvl(sum(H30), 0) H30,
            nvl(sum(H31), 0) H31, nvl(sum(H32), 0) H32,
            nvl(sum(H33), 0) H33, nvl(sum(H34), 0) H34,
            nvl(sum(H35), 0) H35, nvl(sum(H36), 0) H36,
            nvl(sum(H37), 0) H37, nvl(sum(H38), 0) H38,
            nvl(sum(H39), 0) H39, nvl(sum(H40), 0) H40,
            nvl(sum(H41), 0) H41, nvl(sum(H42), 0) H42,
            nvl(sum(H43), 0) H43, nvl(sum(H44), 0) H44,
            nvl(sum(H45), 0) H45, nvl(sum(H46), 0) H46,
            nvl(sum(H47), 0) H47, nvl(sum(H48), 0) H48
            from
            (
              select
              m48.ptomedicodi,
              m48.medifecha,
              H1, H2, H3, H4, H5, H6, H7, H8, H9, H10,
              H11, H12, H13, H14, H15, H16, H17, H18, H19, H20,
              H21, H22, H23, H24, H25, H26, H27, H28, H29, H30,
              H31, H32, H33, H34, H35, H36, H37, H38, H39, H40,
              H41, H42, H43, H44, H45, H46, H47, H48
              from
              me_medicion48 m48
              join me_ptomedicion pto on m48.ptomedicodi = pto.ptomedicodi
              and (pto.origlectcodi = {1})
              where
              m48.lectcodi = {2} and
              m48.tipoinfocodi = {3} and
              m48.medifecha between to_date('{4}', 'DD/MM/YYYY') and to_date('{5}', 'DD/MM/YYYY')
              union all
              select
              m48.ptomedicodi,
              m48.medifecha,
              H1, H2, H3, H4, H5, H6, H7, H8, H9, H10,
              H11, H12, H13, H14, H15, H16, H17, H18, H19, H20,
              H21, H22, H23, H24, H25, H26, H27, H28, H29, H30,
              H31, H32, H33, H34, H35, H36, H37, H38, H39, H40,
              H41, H42, H43, H44, H45, H46, H47, H48
              from
              prn_medicion48 m48
              join me_ptomedicion pto on m48.ptomedicodi = pto.ptomedicodi
              and (pto.origlectcodi = {1})
              where
              m48.prnm48tipo in ({6}) and
              m48.medifecha between to_date('{4}', 'DD/MM/YYYY') and to_date('{5}', 'DD/MM/YYYY')
            ) group by ptomedicodi, medifecha
          ) dt on grp.ptomedicodi = dt.ptomedicodi
          where
          pto.ptomedicodi = {8}
        )
        group by ptomedicodi, medifecha
        union all
        select
        ptomedicodi,
        medifecha,
        H1, H2, H3, H4, H5, H6, H7, H8, H9, H10,
        H11, H12, H13, H14, H15, H16, H17, H18, H19, H20,
        H21, H22, H23, H24, H25, H26, H27, H28, H29, H30,
        H31, H32, H33, H34, H35, H36, H37, H38, H39, H40,
        H41, H42, H43, H44, H45, H46, H47, H48
        from
        prn_medicion48
        where
        ptomedicodi = {8} and
        prnm48tipo = {7} and
        medifecha between to_date('{4}', 'DD/MM/YYYY') and to_date('{5}', 'DD/MM/YYYY')
      )
      group by ptomedicodi, medifecha
      order by ptomedicodi, medifecha
    </query>
  </Sql>

  <!--
  {0} : Ptomedicodi -Identificador de un área operativa en la tabla ME_PTOMEDICION
  {1} : Areacodi - Identificador de un área operativa en la tabla EQ_AREA
  {2} : Medifecha Inicio - Rango inicial de busqueda de información
  {3} : Medifecha Fin - Rango final de busqueda de información
  {4} : Prnm48tipo - Tipo de información correspondiente a los mantenimientos, fallas y ajustes
  -->
  <Sql>
    <key>DataPatronDemandaPorArea</key>
    <query>
      select
      ptomedicodi,
      medifecha,
      nvl(sum(H1), 0) H1, nvl(sum(H2), 0) H2,
      nvl(sum(H3), 0) H3, nvl(sum(H4), 0) H4,
      nvl(sum(H5), 0) H5, nvl(sum(H6), 0) H6,
      nvl(sum(H7), 0) H7, nvl(sum(H8), 0) H8,
      nvl(sum(H9), 0) H9, nvl(sum(H10), 0) H10,
      nvl(sum(H11), 0) H11, nvl(sum(H12), 0) H12,
      nvl(sum(H13), 0) H13, nvl(sum(H14), 0) H14,
      nvl(sum(H15), 0) H15, nvl(sum(H16), 0) H16,
      nvl(sum(H17), 0) H17, nvl(sum(H18), 0) H18,
      nvl(sum(H19), 0) H19, nvl(sum(H20), 0) H20,
      nvl(sum(H21), 0) H21, nvl(sum(H22), 0) H22,
      nvl(sum(H23), 0) H23, nvl(sum(H24), 0) H24,
      nvl(sum(H25), 0) H25, nvl(sum(H26), 0) H26,
      nvl(sum(H27), 0) H27, nvl(sum(H28), 0) H28,
      nvl(sum(H29), 0) H29, nvl(sum(H30), 0) H30,
      nvl(sum(H31), 0) H31, nvl(sum(H32), 0) H32,
      nvl(sum(H33), 0) H33, nvl(sum(H34), 0) H34,
      nvl(sum(H35), 0) H35, nvl(sum(H36), 0) H36,
      nvl(sum(H37), 0) H37, nvl(sum(H38), 0) H38,
      nvl(sum(H39), 0) H39, nvl(sum(H40), 0) H40,
      nvl(sum(H41), 0) H41, nvl(sum(H42), 0) H42,
      nvl(sum(H43), 0) H43, nvl(sum(H44), 0) H44,
      nvl(sum(H45), 0) H45, nvl(sum(H46), 0) H46,
      nvl(sum(H47), 0) H47, nvl(sum(H48), 0) H48
      from
      (
        select
        {0} PTOMEDICODI,
        1 PRNM48TIPO,
        eq.*
        from (
          select
          medifecha,
          nvl(sum(H1), 0) H1, nvl(sum(H2), 0) H2,
          nvl(sum(H3), 0) H3, nvl(sum(H4), 0) H4,
          nvl(sum(H5), 0) H5, nvl(sum(H6), 0) H6,
          nvl(sum(H7), 0) H7, nvl(sum(H8), 0) H8,
          nvl(sum(H9), 0) H9, nvl(sum(H10), 0) H10,
          nvl(sum(H11), 0) H11, nvl(sum(H12), 0) H12,
          nvl(sum(H13), 0) H13, nvl(sum(H14), 0) H14,
          nvl(sum(H15), 0) H15, nvl(sum(H16), 0) H16,
          nvl(sum(H17), 0) H17, nvl(sum(H18), 0) H18,
          nvl(sum(H19), 0) H19, nvl(sum(H20), 0) H20,
          nvl(sum(H21), 0) H21, nvl(sum(H22), 0) H22,
          nvl(sum(H23), 0) H23, nvl(sum(H24), 0) H24,
          nvl(sum(H25), 0) H25, nvl(sum(H26), 0) H26,
          nvl(sum(H27), 0) H27, nvl(sum(H28), 0) H28,
          nvl(sum(H29), 0) H29, nvl(sum(H30), 0) H30,
          nvl(sum(H31), 0) H31, nvl(sum(H32), 0) H32,
          nvl(sum(H33), 0) H33, nvl(sum(H34), 0) H34,
          nvl(sum(H35), 0) H35, nvl(sum(H36), 0) H36,
          nvl(sum(H37), 0) H37, nvl(sum(H38), 0) H38,
          nvl(sum(H39), 0) H39, nvl(sum(H40), 0) H40,
          nvl(sum(H41), 0) H41, nvl(sum(H42), 0) H42,
          nvl(sum(H43), 0) H43, nvl(sum(H44), 0) H44,
          nvl(sum(H45), 0) H45, nvl(sum(H46), 0) H46,
          nvl(sum(H47), 0) H47, nvl(sum(H48), 0) H48
          from
          prn_medicioneq
          where
          areacodi = {1} and
          medifecha between to_date('{2}', 'DD/MM/YYYY') and to_date('{3}', 'DD/MM/YYYY')
          group by medifecha
        ) eq
        union all
        select
        ptomedicodi,
        prnm48tipo,
        medifecha,
        H1, H2, H3, H4, H5, H6, H7, H8, H9, H10,
        H11, H12, H13, H14, H15, H16, H17, H18, H19, H20,
        H21, H22, H23, H24, H25, H26, H27, H28, H29, H30,
        H31, H32, H33, H34, H35, H36, H37, H38, H39, H40,
        H41, H42, H43, H44, H45, H46, H47, H48
        from
        prn_medicion48
        where
        ptomedicodi = {0} and
        medifecha between to_date('{2}', 'DD/MM/YYYY') and to_date('{3}', 'DD/MM/YYYY') and
        prnm48tipo in ({4})
      )
      group by ptomedicodi, medifecha
      order by medifecha desc
    </query>
  </Sql>
  <!--Obtención de datos para la formación del perfíl patrón segun proceso - FIN-->


  <!--
  {0} : Prnredbarrapm - Identificador de una barra PM
  {1} : Prnredgauss - Factor gauss de la barra PM
  {2} : Prnredperdida - Factor gauss de la barra PM
  {3} : Origlectcodi - Identificador del origen de lectura para un punto
  {4} : Tipoinfocodi - Identificador del tipo de información MW de demanda
  {5} : Lectcodi - Identificador del tipo de lectura para demanda ejecutada
  {6} : Fecha inicio - Fecha inicial de busqueda
  {7} : Fecha fin - Fecha final de busqueda
  {8} : Prnm48tipo - Identificador del tipo de información ajuste manual y automatico de la tabla PRN_MEDICION48 (Punto)
  -->
  <Sql>
    <key>DataHistoricaBarraPMDistr</key>
    <query>
      select
      {0} PTOMEDICODI, medifecha,
      nvl(sum(H1 * {1} * (1 + {2} / 100)), 0) H1,
      nvl(sum(H2 * {1} * (1 + {2} / 100)), 0) H2,
      nvl(sum(H3 * {1} * (1 + {2} / 100)), 0) H3,
      nvl(sum(H4 * {1} * (1 + {2} / 100)), 0) H4,
      nvl(sum(H5 * {1} * (1 + {2} / 100)), 0) H5,
      nvl(sum(H6 * {1} * (1 + {2} / 100)), 0) H6,
      nvl(sum(H7 * {1} * (1 + {2} / 100)), 0) H7,
      nvl(sum(H8 * {1} * (1 + {2} / 100)), 0) H8,
      nvl(sum(H9 * {1} * (1 + {2} / 100)), 0) H9,
      nvl(sum(H10 * {1} * (1 + {2} / 100)), 0) H10,
      nvl(sum(H11 * {1} * (1 + {2} / 100)), 0) H11,
      nvl(sum(H12 * {1} * (1 + {2} / 100)), 0) H12,
      nvl(sum(H13 * {1} * (1 + {2} / 100)), 0) H13,
      nvl(sum(H14 * {1} * (1 + {2} / 100)), 0) H14,
      nvl(sum(H15 * {1} * (1 + {2} / 100)), 0) H15,
      nvl(sum(H16 * {1} * (1 + {2} / 100)), 0) H16,
      nvl(sum(H17 * {1} * (1 + {2} / 100)), 0) H17,
      nvl(sum(H18 * {1} * (1 + {2} / 100)), 0) H18,
      nvl(sum(H19 * {1} * (1 + {2} / 100)), 0) H19,
      nvl(sum(H20 * {1} * (1 + {2} / 100)), 0) H20,
      nvl(sum(H21 * {1} * (1 + {2} / 100)), 0) H21,
      nvl(sum(H22 * {1} * (1 + {2} / 100)), 0) H22,
      nvl(sum(H23 * {1} * (1 + {2} / 100)), 0) H23,
      nvl(sum(H24 * {1} * (1 + {2} / 100)), 0) H24,
      nvl(sum(H25 * {1} * (1 + {2} / 100)), 0) H25,
      nvl(sum(H26 * {1} * (1 + {2} / 100)), 0) H26,
      nvl(sum(H27 * {1} * (1 + {2} / 100)), 0) H27,
      nvl(sum(H28 * {1} * (1 + {2} / 100)), 0) H28,
      nvl(sum(H29 * {1} * (1 + {2} / 100)), 0) H29,
      nvl(sum(H30 * {1} * (1 + {2} / 100)), 0) H30,
      nvl(sum(H31 * {1} * (1 + {2} / 100)), 0) H31,
      nvl(sum(H32 * {1} * (1 + {2} / 100)), 0) H32,
      nvl(sum(H33 * {1} * (1 + {2} / 100)), 0) H33,
      nvl(sum(H34 * {1} * (1 + {2} / 100)), 0) H34,
      nvl(sum(H35 * {1} * (1 + {2} / 100)), 0) H35,
      nvl(sum(H36 * {1} * (1 + {2} / 100)), 0) H36,
      nvl(sum(H37 * {1} * (1 + {2} / 100)), 0) H37,
      nvl(sum(H38 * {1} * (1 + {2} / 100)), 0) H38,
      nvl(sum(H39 * {1} * (1 + {2} / 100)), 0) H39,
      nvl(sum(H40 * {1} * (1 + {2} / 100)), 0) H40,
      nvl(sum(H41 * {1} * (1 + {2} / 100)), 0) H41,
      nvl(sum(H42 * {1} * (1 + {2} / 100)), 0) H42,
      nvl(sum(H43 * {1} * (1 + {2} / 100)), 0) H43,
      nvl(sum(H44 * {1} * (1 + {2} / 100)), 0) H44,
      nvl(sum(H45 * {1} * (1 + {2} / 100)), 0) H45,
      nvl(sum(H46 * {1} * (1 + {2} / 100)), 0) H46,
      nvl(sum(H47 * {1} * (1 + {2} / 100)), 0) H47,
      nvl(sum(H48 * {1} * (1 + {2} / 100)), 0) H48
      from
      (
          select
          pto.ptomedicodi,
          med.medifecha,
          nvl(sum(med.H1), 0) H1, nvl(sum(med.H2), 0) H2, nvl(sum(med.H3), 0) H3, nvl(sum(med.H4), 0) H4, nvl(sum(med.H5), 0) H5,
          nvl(sum(med.H6), 0) H6, nvl(sum(med.H7), 0) H7, nvl(sum(med.H8), 0) H8, nvl(sum(med.H9), 0) H9, nvl(sum(med.H10), 0) H10,
          nvl(sum(med.H11), 0) H11, nvl(sum(med.H12), 0) H12, nvl(sum(med.H13), 0) H13, nvl(sum(med.H14), 0) H14, nvl(sum(med.H15), 0) H15,
          nvl(sum(med.H16), 0) H16, nvl(sum(med.H17), 0) H17, nvl(sum(med.H18), 0) H18, nvl(sum(med.H19), 0) H19, nvl(sum(med.H20), 0) H20,
          nvl(sum(med.H21), 0) H21, nvl(sum(med.H22), 0) H22, nvl(sum(med.H23), 0) H23, nvl(sum(med.H24), 0) H24, nvl(sum(med.H25), 0) H25,
          nvl(sum(med.H26), 0) H26, nvl(sum(med.H27), 0) H27, nvl(sum(med.H28), 0) H28, nvl(sum(med.H29), 0) H29, nvl(sum(med.H30), 0) H30,
          nvl(sum(med.H31), 0) H31, nvl(sum(med.H32), 0) H32, nvl(sum(med.H33), 0) H33, nvl(sum(med.H34), 0) H34, nvl(sum(med.H35), 0) H35,
          nvl(sum(med.H36), 0) H36, nvl(sum(med.H37), 0) H37, nvl(sum(med.H38), 0) H38, nvl(sum(med.H39), 0) H39, nvl(sum(med.H40), 0) H40,
          nvl(sum(med.H41), 0) H41, nvl(sum(med.H42), 0) H42, nvl(sum(med.H43), 0) H43, nvl(sum(med.H44), 0) H44, nvl(sum(med.H45), 0) H45,
          nvl(sum(med.H46), 0) H46, nvl(sum(med.H47), 0) H47, nvl(sum(med.H48), 0) H48
          from
          me_ptomedicion pto 
          join si_empresa emp on pto.emprcodi = emp.emprcodi
          and (pto.ptomediestado = 'A')
          and (pto.origlectcodi = {3})
          and (pto.grupocodibarra = {0})
          and (emp.tipoemprcodi = 2)
          join
          (
              select
              ptomedicodi, medifecha,
              H1, H2, H3, H4, H5, H6, H7, H8, H9, H10, H11, H12, H13, H14, H15, H16, H17, H18, H19, H20,
              H21, H22, H23, H24, H25, H26, H27, H28, H29, H30, H31, H32, H33, H34, H35, H36, H37, H38, H39, H40,
              H41, H42, H43, H44, H45, H46, H47, H48
              from
              me_medicion48
              where
              tipoinfocodi = {4} and
              lectcodi = {5} and
              medifecha between to_date('{6}', 'DD/MM/YYYY') and to_date('{7}', 'DD/MM/YYYY')
              union all
              select
              ptomedicodi, medifecha,
              H1, H2, H3, H4, H5, H6, H7, H8, H9, H10, H11, H12, H13, H14, H15, H16, H17, H18, H19, H20,
              H21, H22, H23, H24, H25, H26, H27, H28, H29, H30, H31, H32, H33, H34, H35, H36, H37, H38, H39, H40,
              H41, H42, H43, H44, H45, H46, H47, H48
              from
              prn_medicion48
              where
              prnm48tipo in ({8}) and
              medifecha between to_date('{6}', 'DD/MM/YYYY') and to_date('{7}', 'DD/MM/YYYY')
          ) med
          on pto.ptomedicodi = med.ptomedicodi
          group by
          pto.ptomedicodi, med.medifecha
      )
      group by medifecha
      order by medifecha desc
    </query>
  </Sql>

  <!--
  NO ESTA EN USO
  
  {0} : Prnredbarracp -Identificador de una barra CP
  {1} : Prnredbarrapm - Identificador de una barra PM
  {2} : Origlectcodi - Identificador del origen de lectura para un punto perteneciente al PR03
  {3} : Tipoinfocodi - Identificador del tipo de información MW de demanda
  {4} : Lectcodi - Identificador del tipo de lectura para demanda ejecutada
  {5} : Fecha inicio - Fecha inicial de busqueda
  {6} : Fecha fin - Fecha final de busqueda
  {7} : Prnm48tipo - Identificador del tipo de información ajuste manual y automatico de la tabla PRN_MEDICION48 (Punto)
  {8} : Origlectcodi2 - Identificador del origen de lectura para una agrupación
  {9} : Prnm48tipo2 - Identificador del tipo de información ajuste manual de la tabla PRN_MEDICION48 (Agrupación)
  -->
  <Sql>
    <key>DataHistoricaBarraPMUlibre</key>
    <query>
      select
      prnredbarrapm PTOMEDICODI, medifecha,
      nvl(sum(H1 * prnredgauss * (1 + prnredperdida / 100)), 0) H1,
      nvl(sum(H2 * prnredgauss * (1 + prnredperdida / 100)), 0) H2,
      nvl(sum(H3 * prnredgauss * (1 + prnredperdida / 100)), 0) H3,
      nvl(sum(H4 * prnredgauss * (1 + prnredperdida / 100)), 0) H4,
      nvl(sum(H5 * prnredgauss * (1 + prnredperdida / 100)), 0) H5,
      nvl(sum(H6 * prnredgauss * (1 + prnredperdida / 100)), 0) H6,
      nvl(sum(H7 * prnredgauss * (1 + prnredperdida / 100)), 0) H7,
      nvl(sum(H8 * prnredgauss * (1 + prnredperdida / 100)), 0) H8,
      nvl(sum(H9 * prnredgauss * (1 + prnredperdida / 100)), 0) H9,
      nvl(sum(H10 * prnredgauss * (1 + prnredperdida / 100)), 0) H10,
      nvl(sum(H11 * prnredgauss * (1 + prnredperdida / 100)), 0) H11,
      nvl(sum(H12 * prnredgauss * (1 + prnredperdida / 100)), 0) H12,
      nvl(sum(H13 * prnredgauss * (1 + prnredperdida / 100)), 0) H13,
      nvl(sum(H14 * prnredgauss * (1 + prnredperdida / 100)), 0) H14,
      nvl(sum(H15 * prnredgauss * (1 + prnredperdida / 100)), 0) H15,
      nvl(sum(H16 * prnredgauss * (1 + prnredperdida / 100)), 0) H16,
      nvl(sum(H17 * prnredgauss * (1 + prnredperdida / 100)), 0) H17,
      nvl(sum(H18 * prnredgauss * (1 + prnredperdida / 100)), 0) H18,
      nvl(sum(H19 * prnredgauss * (1 + prnredperdida / 100)), 0) H19,
      nvl(sum(H20 * prnredgauss * (1 + prnredperdida / 100)), 0) H20,
      nvl(sum(H21 * prnredgauss * (1 + prnredperdida / 100)), 0) H21,
      nvl(sum(H22 * prnredgauss * (1 + prnredperdida / 100)), 0) H22,
      nvl(sum(H23 * prnredgauss * (1 + prnredperdida / 100)), 0) H23,
      nvl(sum(H24 * prnredgauss * (1 + prnredperdida / 100)), 0) H24,
      nvl(sum(H25 * prnredgauss * (1 + prnredperdida / 100)), 0) H25,
      nvl(sum(H26 * prnredgauss * (1 + prnredperdida / 100)), 0) H26,
      nvl(sum(H27 * prnredgauss * (1 + prnredperdida / 100)), 0) H27,
      nvl(sum(H28 * prnredgauss * (1 + prnredperdida / 100)), 0) H28,
      nvl(sum(H29 * prnredgauss * (1 + prnredperdida / 100)), 0) H29,
      nvl(sum(H30 * prnredgauss * (1 + prnredperdida / 100)), 0) H30,
      nvl(sum(H31 * prnredgauss * (1 + prnredperdida / 100)), 0) H31,
      nvl(sum(H32 * prnredgauss * (1 + prnredperdida / 100)), 0) H32,
      nvl(sum(H33 * prnredgauss * (1 + prnredperdida / 100)), 0) H33,
      nvl(sum(H34 * prnredgauss * (1 + prnredperdida / 100)), 0) H34,
      nvl(sum(H35 * prnredgauss * (1 + prnredperdida / 100)), 0) H35,
      nvl(sum(H36 * prnredgauss * (1 + prnredperdida / 100)), 0) H36,
      nvl(sum(H37 * prnredgauss * (1 + prnredperdida / 100)), 0) H37,
      nvl(sum(H38 * prnredgauss * (1 + prnredperdida / 100)), 0) H38,
      nvl(sum(H39 * prnredgauss * (1 + prnredperdida / 100)), 0) H39,
      nvl(sum(H40 * prnredgauss * (1 + prnredperdida / 100)), 0) H40,
      nvl(sum(H41 * prnredgauss * (1 + prnredperdida / 100)), 0) H41,
      nvl(sum(H42 * prnredgauss * (1 + prnredperdida / 100)), 0) H42,
      nvl(sum(H43 * prnredgauss * (1 + prnredperdida / 100)), 0) H43,
      nvl(sum(H44 * prnredgauss * (1 + prnredperdida / 100)), 0) H44,
      nvl(sum(H45 * prnredgauss * (1 + prnredperdida / 100)), 0) H45,
      nvl(sum(H46 * prnredgauss * (1 + prnredperdida / 100)), 0) H46,
      nvl(sum(H47 * prnredgauss * (1 + prnredperdida / 100)), 0) H47,
      nvl(sum(H48 * prnredgauss * (1 + prnredperdida / 100)), 0) H48
      from
      (
          select
          rr.prnredbarracp, rr.prnredbarrapm,
          rr.prnredgauss, rr.prnredperdida,
          pto.ptomedicodi,
          med.medifecha,
          nvl(sum(med.H1), 0) H1, nvl(sum(med.H2), 0) H2, nvl(sum(med.H3), 0) H3, nvl(sum(med.H4), 0) H4, nvl(sum(med.H5), 0) H5,
          nvl(sum(med.H6), 0) H6, nvl(sum(med.H7), 0) H7, nvl(sum(med.H8), 0) H8, nvl(sum(med.H9), 0) H9, nvl(sum(med.H10), 0) H10,
          nvl(sum(med.H11), 0) H11, nvl(sum(med.H12), 0) H12, nvl(sum(med.H13), 0) H13, nvl(sum(med.H14), 0) H14, nvl(sum(med.H15), 0) H15,
          nvl(sum(med.H16), 0) H16, nvl(sum(med.H17), 0) H17, nvl(sum(med.H18), 0) H18, nvl(sum(med.H19), 0) H19, nvl(sum(med.H20), 0) H20,
          nvl(sum(med.H21), 0) H21, nvl(sum(med.H22), 0) H22, nvl(sum(med.H23), 0) H23, nvl(sum(med.H24), 0) H24, nvl(sum(med.H25), 0) H25,
          nvl(sum(med.H26), 0) H26, nvl(sum(med.H27), 0) H27, nvl(sum(med.H28), 0) H28, nvl(sum(med.H29), 0) H29, nvl(sum(med.H30), 0) H30,
          nvl(sum(med.H31), 0) H31, nvl(sum(med.H32), 0) H32, nvl(sum(med.H33), 0) H33, nvl(sum(med.H34), 0) H34, nvl(sum(med.H35), 0) H35,
          nvl(sum(med.H36), 0) H36, nvl(sum(med.H37), 0) H37, nvl(sum(med.H38), 0) H38, nvl(sum(med.H39), 0) H39, nvl(sum(med.H40), 0) H40,
          nvl(sum(med.H41), 0) H41, nvl(sum(med.H42), 0) H42, nvl(sum(med.H43), 0) H43, nvl(sum(med.H44), 0) H44, nvl(sum(med.H45), 0) H45,
          nvl(sum(med.H46), 0) H46, nvl(sum(med.H47), 0) H47, nvl(sum(med.H48), 0) H48
          from
          prn_version vr
          join prn_reduccionred rr on vr.prnvercodi = rr.prnvercodi
          and (vr.prnverestado = 'A')
          and (rr.prnredbarracp = {0})
          and (rr.prnredbarrapm = {1})
          join me_ptomedicion pto on rr.prnredbarrapm = pto.grupocodibarra
          and (pto.ptomediestado = 'A')
          and (pto.origlectcodi = {2})
          join si_empresa emp on pto.emprcodi = emp.emprcodi
          and (emp.tipoemprcodi = 4)
          join
          (
              select
              ptomedicodi, medifecha,
              H1, H2, H3, H4, H5, H6, H7, H8, H9, H10, H11, H12, H13, H14, H15, H16, H17, H18, H19, H20,
              H21, H22, H23, H24, H25, H26, H27, H28, H29, H30, H31, H32, H33, H34, H35, H36, H37, H38, H39, H40,
              H41, H42, H43, H44, H45, H46, H47, H48
              from
              me_medicion48
              where
              tipoinfocodi = {3} and
              lectcodi = {4} and
              medifecha between to_date('{5}', 'DD/MM/YYYY') and to_date('{6}', 'DD/MM/YYYY')
              union all
              select
              ptomedicodi, medifecha,
              H1, H2, H3, H4, H5, H6, H7, H8, H9, H10, H11, H12, H13, H14, H15, H16, H17, H18, H19, H20,
              H21, H22, H23, H24, H25, H26, H27, H28, H29, H30, H31, H32, H33, H34, H35, H36, H37, H38, H39, H40,
              H41, H42, H43, H44, H45, H46, H47, H48
              from
              prn_medicion48
              where
              prnm48tipo in ({7}) and
              medifecha between to_date('{5}', 'DD/MM/YYYY') and to_date('{6}', 'DD/MM/YYYY')
          ) med
          on pto.ptomedicodi = med.ptomedicodi
          group by
          rr.prnredbarracp, rr.prnredbarrapm,
          rr.prnredgauss, rr.prnredperdida,
          pto.ptomedicodi, med.medifecha
          
          union all
          
          select
          rr.prnredbarracp, rr.prnredbarrapm,
          rr.prnredgauss, rr.prnredperdida,
          pto.ptomedicodi,
          med.medifecha,
          nvl(sum(med.H1), 0) H1, nvl(sum(med.H2), 0) H2, nvl(sum(med.H3), 0) H3, nvl(sum(med.H4), 0) H4, nvl(sum(med.H5), 0) H5,
          nvl(sum(med.H6), 0) H6, nvl(sum(med.H7), 0) H7, nvl(sum(med.H8), 0) H8, nvl(sum(med.H9), 0) H9, nvl(sum(med.H10), 0) H10,
          nvl(sum(med.H11), 0) H11, nvl(sum(med.H12), 0) H12, nvl(sum(med.H13), 0) H13, nvl(sum(med.H14), 0) H14, nvl(sum(med.H15), 0) H15,
          nvl(sum(med.H16), 0) H16, nvl(sum(med.H17), 0) H17, nvl(sum(med.H18), 0) H18, nvl(sum(med.H19), 0) H19, nvl(sum(med.H20), 0) H20,
          nvl(sum(med.H21), 0) H21, nvl(sum(med.H22), 0) H22, nvl(sum(med.H23), 0) H23, nvl(sum(med.H24), 0) H24, nvl(sum(med.H25), 0) H25,
          nvl(sum(med.H26), 0) H26, nvl(sum(med.H27), 0) H27, nvl(sum(med.H28), 0) H28, nvl(sum(med.H29), 0) H29, nvl(sum(med.H30), 0) H30,
          nvl(sum(med.H31), 0) H31, nvl(sum(med.H32), 0) H32, nvl(sum(med.H33), 0) H33, nvl(sum(med.H34), 0) H34, nvl(sum(med.H35), 0) H35,
          nvl(sum(med.H36), 0) H36, nvl(sum(med.H37), 0) H37, nvl(sum(med.H38), 0) H38, nvl(sum(med.H39), 0) H39, nvl(sum(med.H40), 0) H40,
          nvl(sum(med.H41), 0) H41, nvl(sum(med.H42), 0) H42, nvl(sum(med.H43), 0) H43, nvl(sum(med.H44), 0) H44, nvl(sum(med.H45), 0) H45,
          nvl(sum(med.H46), 0) H46, nvl(sum(med.H47), 0) H47, nvl(sum(med.H48), 0) H48
          from
          prn_version vr
          join prn_reduccionred rr on vr.prnvercodi = rr.prnvercodi
          and (vr.prnverestado = 'A')
          and (rr.prnredbarracp = {0})
          and (rr.prnredbarrapm = {1})
          join me_ptomedicion pto on rr.prnredbarrapm = pto.grupocodibarra
          and (pto.ptomediestado = 'A')
          and (pto.origlectcodi = {8})
          join
          (
              select
              ptomedicodi, medifecha,
              sum(H1) H1, sum(H2) H2, sum(H3) H3, sum(H4) H4, sum(H5) H5, sum(H6) H6, sum(H7) H7, sum(H8) H8, sum(H9) H9, sum(H10) H10,
              sum(H11) H11, sum(H12) H12, sum(H13) H13, sum(H14) H14, sum(H15) H15, sum(H16) H16, sum(H17) H17, sum(H18) H18, sum(H19) H19, sum(H20) H20,
              sum(H21) H21, sum(H22) H22, sum(H23) H23, sum(H24) H24, sum(H25) H25, sum(H26) H26, sum(H27) H27, sum(H28) H28, sum(H29) H29, sum(H30) H30,
              sum(H31) H31, sum(H32) H32, sum(H33) H33, sum(H34) H34, sum(H35) H35, sum(H36) H36, sum(H37) H37, sum(H38) H38, sum(H39) H39, sum(H40) H40,
              sum(H41) H41, sum(H42) H42, sum(H43) H43, sum(H44) H44, sum(H45) H45, sum(H46) H46, sum(H47) H47, sum(H48) H48
              from
              (
                  select
                  pgr.ptomedicodi, sb.medifecha,
                  nvl(sum(sb.H1), 0) H1, nvl(sum(sb.H2), 0) H2, nvl(sum(sb.H3), 0) H3, nvl(sum(sb.H4), 0) H4, nvl(sum(sb.H5), 0) H5,
                  nvl(sum(sb.H6), 0) H6, nvl(sum(sb.H7), 0) H7, nvl(sum(sb.H8), 0) H8, nvl(sum(sb.H9), 0) H9, nvl(sum(sb.H10), 0) H10,
                  nvl(sum(sb.H11), 0) H11, nvl(sum(sb.H12), 0) H12, nvl(sum(sb.H13), 0) H13, nvl(sum(sb.H14), 0) H14, nvl(sum(sb.H15), 0) H15,
                  nvl(sum(sb.H16), 0) H16, nvl(sum(sb.H17), 0) H17, nvl(sum(sb.H18), 0) H18, nvl(sum(sb.H19), 0) H19, nvl(sum(sb.H20), 0) H20,
                  nvl(sum(sb.H21), 0) H21, nvl(sum(sb.H22), 0) H22, nvl(sum(sb.H23), 0) H23, nvl(sum(sb.H24), 0) H24, nvl(sum(sb.H25), 0) H25,
                  nvl(sum(sb.H26), 0) H26, nvl(sum(sb.H27), 0) H27, nvl(sum(sb.H28), 0) H28, nvl(sum(sb.H29), 0) H29, nvl(sum(sb.H30), 0) H30,
                  nvl(sum(sb.H31), 0) H31, nvl(sum(sb.H32), 0) H32, nvl(sum(sb.H33), 0) H33, nvl(sum(sb.H34), 0) H34, nvl(sum(sb.H35), 0) H35,
                  nvl(sum(sb.H36), 0) H36, nvl(sum(sb.H37), 0) H37, nvl(sum(sb.H38), 0) H38, nvl(sum(sb.H39), 0) H39, nvl(sum(sb.H40), 0) H40,
                  nvl(sum(sb.H41), 0) H41, nvl(sum(sb.H42), 0) H42, nvl(sum(sb.H43), 0) H43, nvl(sum(sb.H44), 0) H44, nvl(sum(sb.H45), 0) H45,
                  nvl(sum(sb.H46), 0) H46, nvl(sum(sb.H47), 0) H47, nvl(sum(sb.H48), 0) H48
                  from
                  prn_puntoagrupacion pgr
                  join prn_agrupacion agr on pgr.ptogrpcodi = agr.ptogrpcodi
                  and (pgr.ptogrpfechafin = to_date('31/12/9999', 'DD/MM/YYYY'))
                  join
                  (
                      select
                      ptomedicodi, medifecha,
                      H1, H2, H3, H4, H5, H6, H7, H8, H9, H10, H11, H12, H13, H14, H15, H16, H17, H18, H19, H20,
                      H21, H22, H23, H24, H25, H26, H27, H28, H29, H30, H31, H32, H33, H34, H35, H36, H37, H38, H39, H40,
                      H41, H42, H43, H44, H45, H46, H47, H48
                      from
                      me_medicion48
                      where
                      tipoinfocodi = {3} and
                      lectcodi = {4} and
                      medifecha between to_date('{5}', 'DD/MM/YYYY') and to_date('{6}', 'DD/MM/YYYY')
                      union all
                      select
                      ptomedicodi, medifecha,
                      H1, H2, H3, H4, H5, H6, H7, H8, H9, H10, H11, H12, H13, H14, H15, H16, H17, H18, H19, H20,
                      H21, H22, H23, H24, H25, H26, H27, H28, H29, H30, H31, H32, H33, H34, H35, H36, H37, H38, H39, H40,
                      H41, H42, H43, H44, H45, H46, H47, H48
                      from
                      prn_medicion48
                      where
                      prnm48tipo in ({7}) and
                      medifecha between to_date('{5}', 'DD/MM/YYYY') and to_date('{6}', 'DD/MM/YYYY')
                  ) sb
                  on agr.ptomedicodi = sb.ptomedicodi
                  group by pgr.ptomedicodi, sb.medifecha
                  union all
                  select
                  pgr.ptomedicodi, p48.medifecha,
                  H1, H2, H3, H4, H5, H6, H7, H8, H9, H10, H11, H12, H13, H14, H15, H16, H17, H18, H19, H20,
                  H21, H22, H23, H24, H25, H26, H27, H28, H29, H30, H31, H32, H33, H34, H35, H36, H37, H38, H39, H40,
                  H41, H42, H43, H44, H45, H46, H47, H48
                  from
                  prn_puntoagrupacion pgr
                  join prn_agrupacion agr on pgr.ptogrpcodi = agr.ptogrpcodi
                  and (pgr.ptogrpfechafin = to_date('31/12/9999', 'DD/MM/YYYY'))
                  join prn_medicion48 p48 on pgr.ptomedicodi = p48.ptomedicodi
                  and (p48.prnm48tipo = {9})
                  where
                  medifecha between to_date('{5}', 'DD/MM/YYYY') and to_date('{6}', 'DD/MM/YYYY')
              )
              group by ptomedicodi, medifecha
          ) med
          on pto.ptomedicodi = med.ptomedicodi
          group by
          rr.prnredbarracp, rr.prnredbarrapm,
          rr.prnredgauss, rr.prnredperdida,
          pto.ptomedicodi, med.medifecha
      )
      group by
      prnredbarrapm,
      prnredgauss, prnredperdida, medifecha
    </query>
  </Sql>
  
  <!--
  {0} : Prnredbarrapm - Identificador de una barra PM
  {1} : Prnredgauss - Factor gauss de la barra PM
  {2} : Prnredperdida - Factor gauss de la barra PM
  {3} : Origlectcodi - Identificador del origen de lectura para un punto
  {4} : Tipoinfocodi - Identificador del tipo de información MW de demanda
  {5} : Lectcodi - Identificador del tipo de lectura para demanda ejecutada
  {6} : Medifecha - Fecha de busqueda del registro
  {7} : Prnm48tipo - Identificador del tipo de información ajuste manual y automatico de la tabla PRN_MEDICION48 (Punto)
  {8} : Origlectcodi2 - Identificador del origen de lectura para una agrupación
  {9} : Prnm48tipo2 - Identificador del tipo de información ajuste manual de la tabla PRN_MEDICION48 (Agrupación)
  -->
  <Sql>
    <key>DataBarraPMUlibrePorDia</key>
    <query>
      select
      {0} PTOMEDICODI, medifecha,
      nvl(sum(H1 * {1} * (1 + {2} / 100)), 0) H1,
      nvl(sum(H2 * {1} * (1 + {2} / 100)), 0) H2,
      nvl(sum(H3 * {1} * (1 + {2} / 100)), 0) H3,
      nvl(sum(H4 * {1} * (1 + {2} / 100)), 0) H4,
      nvl(sum(H5 * {1} * (1 + {2} / 100)), 0) H5,
      nvl(sum(H6 * {1} * (1 + {2} / 100)), 0) H6,
      nvl(sum(H7 * {1} * (1 + {2} / 100)), 0) H7,
      nvl(sum(H8 * {1} * (1 + {2} / 100)), 0) H8,
      nvl(sum(H9 * {1} * (1 + {2} / 100)), 0) H9,
      nvl(sum(H10 * {1} * (1 + {2} / 100)), 0) H10,
      nvl(sum(H11 * {1} * (1 + {2} / 100)), 0) H11,
      nvl(sum(H12 * {1} * (1 + {2} / 100)), 0) H12,
      nvl(sum(H13 * {1} * (1 + {2} / 100)), 0) H13,
      nvl(sum(H14 * {1} * (1 + {2} / 100)), 0) H14,
      nvl(sum(H15 * {1} * (1 + {2} / 100)), 0) H15,
      nvl(sum(H16 * {1} * (1 + {2} / 100)), 0) H16,
      nvl(sum(H17 * {1} * (1 + {2} / 100)), 0) H17,
      nvl(sum(H18 * {1} * (1 + {2} / 100)), 0) H18,
      nvl(sum(H19 * {1} * (1 + {2} / 100)), 0) H19,
      nvl(sum(H20 * {1} * (1 + {2} / 100)), 0) H20,
      nvl(sum(H21 * {1} * (1 + {2} / 100)), 0) H21,
      nvl(sum(H22 * {1} * (1 + {2} / 100)), 0) H22,
      nvl(sum(H23 * {1} * (1 + {2} / 100)), 0) H23,
      nvl(sum(H24 * {1} * (1 + {2} / 100)), 0) H24,
      nvl(sum(H25 * {1} * (1 + {2} / 100)), 0) H25,
      nvl(sum(H26 * {1} * (1 + {2} / 100)), 0) H26,
      nvl(sum(H27 * {1} * (1 + {2} / 100)), 0) H27,
      nvl(sum(H28 * {1} * (1 + {2} / 100)), 0) H28,
      nvl(sum(H29 * {1} * (1 + {2} / 100)), 0) H29,
      nvl(sum(H30 * {1} * (1 + {2} / 100)), 0) H30,
      nvl(sum(H31 * {1} * (1 + {2} / 100)), 0) H31,
      nvl(sum(H32 * {1} * (1 + {2} / 100)), 0) H32,
      nvl(sum(H33 * {1} * (1 + {2} / 100)), 0) H33,
      nvl(sum(H34 * {1} * (1 + {2} / 100)), 0) H34,
      nvl(sum(H35 * {1} * (1 + {2} / 100)), 0) H35,
      nvl(sum(H36 * {1} * (1 + {2} / 100)), 0) H36,
      nvl(sum(H37 * {1} * (1 + {2} / 100)), 0) H37,
      nvl(sum(H38 * {1} * (1 + {2} / 100)), 0) H38,
      nvl(sum(H39 * {1} * (1 + {2} / 100)), 0) H39,
      nvl(sum(H40 * {1} * (1 + {2} / 100)), 0) H40,
      nvl(sum(H41 * {1} * (1 + {2} / 100)), 0) H41,
      nvl(sum(H42 * {1} * (1 + {2} / 100)), 0) H42,
      nvl(sum(H43 * {1} * (1 + {2} / 100)), 0) H43,
      nvl(sum(H44 * {1} * (1 + {2} / 100)), 0) H44,
      nvl(sum(H45 * {1} * (1 + {2} / 100)), 0) H45,
      nvl(sum(H46 * {1} * (1 + {2} / 100)), 0) H46,
      nvl(sum(H47 * {1} * (1 + {2} / 100)), 0) H47,
      nvl(sum(H48 * {1} * (1 + {2} / 100)), 0) H48
      from
      (
          select
          pto.ptomedicodi,
          med.medifecha,
          nvl(sum(med.H1), 0) H1, nvl(sum(med.H2), 0) H2, nvl(sum(med.H3), 0) H3, nvl(sum(med.H4), 0) H4, nvl(sum(med.H5), 0) H5,
          nvl(sum(med.H6), 0) H6, nvl(sum(med.H7), 0) H7, nvl(sum(med.H8), 0) H8, nvl(sum(med.H9), 0) H9, nvl(sum(med.H10), 0) H10,
          nvl(sum(med.H11), 0) H11, nvl(sum(med.H12), 0) H12, nvl(sum(med.H13), 0) H13, nvl(sum(med.H14), 0) H14, nvl(sum(med.H15), 0) H15,
          nvl(sum(med.H16), 0) H16, nvl(sum(med.H17), 0) H17, nvl(sum(med.H18), 0) H18, nvl(sum(med.H19), 0) H19, nvl(sum(med.H20), 0) H20,
          nvl(sum(med.H21), 0) H21, nvl(sum(med.H22), 0) H22, nvl(sum(med.H23), 0) H23, nvl(sum(med.H24), 0) H24, nvl(sum(med.H25), 0) H25,
          nvl(sum(med.H26), 0) H26, nvl(sum(med.H27), 0) H27, nvl(sum(med.H28), 0) H28, nvl(sum(med.H29), 0) H29, nvl(sum(med.H30), 0) H30,
          nvl(sum(med.H31), 0) H31, nvl(sum(med.H32), 0) H32, nvl(sum(med.H33), 0) H33, nvl(sum(med.H34), 0) H34, nvl(sum(med.H35), 0) H35,
          nvl(sum(med.H36), 0) H36, nvl(sum(med.H37), 0) H37, nvl(sum(med.H38), 0) H38, nvl(sum(med.H39), 0) H39, nvl(sum(med.H40), 0) H40,
          nvl(sum(med.H41), 0) H41, nvl(sum(med.H42), 0) H42, nvl(sum(med.H43), 0) H43, nvl(sum(med.H44), 0) H44, nvl(sum(med.H45), 0) H45,
          nvl(sum(med.H46), 0) H46, nvl(sum(med.H47), 0) H47, nvl(sum(med.H48), 0) H48
          from
          me_ptomedicion pto 
          join si_empresa emp on pto.emprcodi = emp.emprcodi
          and (pto.ptomediestado = 'A')
          and (pto.origlectcodi = {3})
          and (pto.grupocodibarra = {0})
          and (emp.tipoemprcodi = 4)
          join
          (
              select
              ptomedicodi, medifecha,
              H1, H2, H3, H4, H5, H6, H7, H8, H9, H10, H11, H12, H13, H14, H15, H16, H17, H18, H19, H20,
              H21, H22, H23, H24, H25, H26, H27, H28, H29, H30, H31, H32, H33, H34, H35, H36, H37, H38, H39, H40,
              H41, H42, H43, H44, H45, H46, H47, H48
              from
              me_medicion48
              where
              tipoinfocodi = {4} and
              lectcodi = {5} and
              medifecha = to_date('{6}', 'DD/MM/YYYY')
              union all
              select
              ptomedicodi, medifecha,
              H1, H2, H3, H4, H5, H6, H7, H8, H9, H10, H11, H12, H13, H14, H15, H16, H17, H18, H19, H20,
              H21, H22, H23, H24, H25, H26, H27, H28, H29, H30, H31, H32, H33, H34, H35, H36, H37, H38, H39, H40,
              H41, H42, H43, H44, H45, H46, H47, H48
              from
              prn_medicion48
              where
              prnm48tipo in ({7}) and
              medifecha = to_date('{6}', 'DD/MM/YYYY')
          ) med
          on pto.ptomedicodi = med.ptomedicodi
          group by
          pto.ptomedicodi, med.medifecha
          
          union all
          
          select
          pto.ptomedicodi,
          med.medifecha,
          nvl(sum(med.H1), 0) H1, nvl(sum(med.H2), 0) H2, nvl(sum(med.H3), 0) H3, nvl(sum(med.H4), 0) H4, nvl(sum(med.H5), 0) H5,
          nvl(sum(med.H6), 0) H6, nvl(sum(med.H7), 0) H7, nvl(sum(med.H8), 0) H8, nvl(sum(med.H9), 0) H9, nvl(sum(med.H10), 0) H10,
          nvl(sum(med.H11), 0) H11, nvl(sum(med.H12), 0) H12, nvl(sum(med.H13), 0) H13, nvl(sum(med.H14), 0) H14, nvl(sum(med.H15), 0) H15,
          nvl(sum(med.H16), 0) H16, nvl(sum(med.H17), 0) H17, nvl(sum(med.H18), 0) H18, nvl(sum(med.H19), 0) H19, nvl(sum(med.H20), 0) H20,
          nvl(sum(med.H21), 0) H21, nvl(sum(med.H22), 0) H22, nvl(sum(med.H23), 0) H23, nvl(sum(med.H24), 0) H24, nvl(sum(med.H25), 0) H25,
          nvl(sum(med.H26), 0) H26, nvl(sum(med.H27), 0) H27, nvl(sum(med.H28), 0) H28, nvl(sum(med.H29), 0) H29, nvl(sum(med.H30), 0) H30,
          nvl(sum(med.H31), 0) H31, nvl(sum(med.H32), 0) H32, nvl(sum(med.H33), 0) H33, nvl(sum(med.H34), 0) H34, nvl(sum(med.H35), 0) H35,
          nvl(sum(med.H36), 0) H36, nvl(sum(med.H37), 0) H37, nvl(sum(med.H38), 0) H38, nvl(sum(med.H39), 0) H39, nvl(sum(med.H40), 0) H40,
          nvl(sum(med.H41), 0) H41, nvl(sum(med.H42), 0) H42, nvl(sum(med.H43), 0) H43, nvl(sum(med.H44), 0) H44, nvl(sum(med.H45), 0) H45,
          nvl(sum(med.H46), 0) H46, nvl(sum(med.H47), 0) H47, nvl(sum(med.H48), 0) H48
          from
          me_ptomedicion pto 
          join
          (
              select
              ptomedicodi, medifecha,
              sum(H1) H1, sum(H2) H2, sum(H3) H3, sum(H4) H4, sum(H5) H5, sum(H6) H6, sum(H7) H7, sum(H8) H8, sum(H9) H9, sum(H10) H10,
              sum(H11) H11, sum(H12) H12, sum(H13) H13, sum(H14) H14, sum(H15) H15, sum(H16) H16, sum(H17) H17, sum(H18) H18, sum(H19) H19, sum(H20) H20,
              sum(H21) H21, sum(H22) H22, sum(H23) H23, sum(H24) H24, sum(H25) H25, sum(H26) H26, sum(H27) H27, sum(H28) H28, sum(H29) H29, sum(H30) H30,
              sum(H31) H31, sum(H32) H32, sum(H33) H33, sum(H34) H34, sum(H35) H35, sum(H36) H36, sum(H37) H37, sum(H38) H38, sum(H39) H39, sum(H40) H40,
              sum(H41) H41, sum(H42) H42, sum(H43) H43, sum(H44) H44, sum(H45) H45, sum(H46) H46, sum(H47) H47, sum(H48) H48
              from
              (
                  select
                  pgr.ptomedicodi, sb.medifecha,
                  nvl(sum(sb.H1), 0) H1, nvl(sum(sb.H2), 0) H2, nvl(sum(sb.H3), 0) H3, nvl(sum(sb.H4), 0) H4, nvl(sum(sb.H5), 0) H5,
                  nvl(sum(sb.H6), 0) H6, nvl(sum(sb.H7), 0) H7, nvl(sum(sb.H8), 0) H8, nvl(sum(sb.H9), 0) H9, nvl(sum(sb.H10), 0) H10,
                  nvl(sum(sb.H11), 0) H11, nvl(sum(sb.H12), 0) H12, nvl(sum(sb.H13), 0) H13, nvl(sum(sb.H14), 0) H14, nvl(sum(sb.H15), 0) H15,
                  nvl(sum(sb.H16), 0) H16, nvl(sum(sb.H17), 0) H17, nvl(sum(sb.H18), 0) H18, nvl(sum(sb.H19), 0) H19, nvl(sum(sb.H20), 0) H20,
                  nvl(sum(sb.H21), 0) H21, nvl(sum(sb.H22), 0) H22, nvl(sum(sb.H23), 0) H23, nvl(sum(sb.H24), 0) H24, nvl(sum(sb.H25), 0) H25,
                  nvl(sum(sb.H26), 0) H26, nvl(sum(sb.H27), 0) H27, nvl(sum(sb.H28), 0) H28, nvl(sum(sb.H29), 0) H29, nvl(sum(sb.H30), 0) H30,
                  nvl(sum(sb.H31), 0) H31, nvl(sum(sb.H32), 0) H32, nvl(sum(sb.H33), 0) H33, nvl(sum(sb.H34), 0) H34, nvl(sum(sb.H35), 0) H35,
                  nvl(sum(sb.H36), 0) H36, nvl(sum(sb.H37), 0) H37, nvl(sum(sb.H38), 0) H38, nvl(sum(sb.H39), 0) H39, nvl(sum(sb.H40), 0) H40,
                  nvl(sum(sb.H41), 0) H41, nvl(sum(sb.H42), 0) H42, nvl(sum(sb.H43), 0) H43, nvl(sum(sb.H44), 0) H44, nvl(sum(sb.H45), 0) H45,
                  nvl(sum(sb.H46), 0) H46, nvl(sum(sb.H47), 0) H47, nvl(sum(sb.H48), 0) H48
                  from
                  prn_puntoagrupacion pgr
                  join prn_agrupacion agr on pgr.ptogrpcodi = agr.ptogrpcodi
                  and (pgr.ptogrpfechafin = to_date('31/12/9999', 'DD/MM/YYYY'))
                  join
                  (
                      select
                      ptomedicodi, medifecha,
                      H1, H2, H3, H4, H5, H6, H7, H8, H9, H10, H11, H12, H13, H14, H15, H16, H17, H18, H19, H20,
                      H21, H22, H23, H24, H25, H26, H27, H28, H29, H30, H31, H32, H33, H34, H35, H36, H37, H38, H39, H40,
                      H41, H42, H43, H44, H45, H46, H47, H48
                      from
                      me_medicion48
                      where
                      tipoinfocodi = {4} and
                      lectcodi = {5} and
                      medifecha = to_date('{6}', 'DD/MM/YYYY')
                      union all
                      select
                      ptomedicodi, medifecha,
                      H1, H2, H3, H4, H5, H6, H7, H8, H9, H10, H11, H12, H13, H14, H15, H16, H17, H18, H19, H20,
                      H21, H22, H23, H24, H25, H26, H27, H28, H29, H30, H31, H32, H33, H34, H35, H36, H37, H38, H39, H40,
                      H41, H42, H43, H44, H45, H46, H47, H48
                      from
                      prn_medicion48
                      where
                      prnm48tipo in ({7}) and
                      medifecha = to_date('{6}', 'DD/MM/YYYY')
                  ) sb
                  on agr.ptomedicodi = sb.ptomedicodi
                  group by pgr.ptomedicodi, sb.medifecha
                  union all
                  select
                  pgr.ptomedicodi, p48.medifecha,
                  H1, H2, H3, H4, H5, H6, H7, H8, H9, H10, H11, H12, H13, H14, H15, H16, H17, H18, H19, H20,
                  H21, H22, H23, H24, H25, H26, H27, H28, H29, H30, H31, H32, H33, H34, H35, H36, H37, H38, H39, H40,
                  H41, H42, H43, H44, H45, H46, H47, H48
                  from
                  prn_puntoagrupacion pgr
                  join prn_agrupacion agr on pgr.ptogrpcodi = agr.ptogrpcodi
                  and (pgr.ptogrpfechafin = to_date('31/12/9999', 'DD/MM/YYYY'))
                  join prn_medicion48 p48 on pgr.ptomedicodi = p48.ptomedicodi
                  and (p48.prnm48tipo = {9})
                  where
                  medifecha = to_date('{6}', 'DD/MM/YYYY')
              )
              group by ptomedicodi, medifecha
          ) med
          on pto.ptomedicodi = med.ptomedicodi
          and (pto.ptomediestado = 'A')
          and (pto.origlectcodi = {8})
          and (pto.grupocodibarra = {0})
          group by
          pto.ptomedicodi, med.medifecha
      )
      group by medifecha
    </query>
  </Sql>

  <!--
  {0} : Prnredbarrapm - Identificador de una barra PM
  {1} : Prnredgauss - Factor gauss de la barra PM
  {2} : Prnredperdida - Factor gauss de la barra PM
  {3} : Origlectcodi - Identificador del origen de lectura para un punto
  {4} : Medifecha - Fecha de busqueda del registro
  {5} : Prnm48tipo - Identificador del tipo de información patrón defecto de la tabla PRN_MEDICION48 (Punto)
  {6} : Origlectcodi2 - Identificador del origen de lectura para una agrupación
  -->
  <Sql>
    <key>DataPtrBarraPMUlibrePorDia</key>
    <query>
      select
      {0} PTOMEDICODI, medifecha,
      nvl(sum(H1 * {1} * (1 + {2} / 100)), 0) H1,
      nvl(sum(H2 * {1} * (1 + {2} / 100)), 0) H2,
      nvl(sum(H3 * {1} * (1 + {2} / 100)), 0) H3,
      nvl(sum(H4 * {1} * (1 + {2} / 100)), 0) H4,
      nvl(sum(H5 * {1} * (1 + {2} / 100)), 0) H5,
      nvl(sum(H6 * {1} * (1 + {2} / 100)), 0) H6,
      nvl(sum(H7 * {1} * (1 + {2} / 100)), 0) H7,
      nvl(sum(H8 * {1} * (1 + {2} / 100)), 0) H8,
      nvl(sum(H9 * {1} * (1 + {2} / 100)), 0) H9,
      nvl(sum(H10 * {1} * (1 + {2} / 100)), 0) H10,
      nvl(sum(H11 * {1} * (1 + {2} / 100)), 0) H11,
      nvl(sum(H12 * {1} * (1 + {2} / 100)), 0) H12,
      nvl(sum(H13 * {1} * (1 + {2} / 100)), 0) H13,
      nvl(sum(H14 * {1} * (1 + {2} / 100)), 0) H14,
      nvl(sum(H15 * {1} * (1 + {2} / 100)), 0) H15,
      nvl(sum(H16 * {1} * (1 + {2} / 100)), 0) H16,
      nvl(sum(H17 * {1} * (1 + {2} / 100)), 0) H17,
      nvl(sum(H18 * {1} * (1 + {2} / 100)), 0) H18,
      nvl(sum(H19 * {1} * (1 + {2} / 100)), 0) H19,
      nvl(sum(H20 * {1} * (1 + {2} / 100)), 0) H20,
      nvl(sum(H21 * {1} * (1 + {2} / 100)), 0) H21,
      nvl(sum(H22 * {1} * (1 + {2} / 100)), 0) H22,
      nvl(sum(H23 * {1} * (1 + {2} / 100)), 0) H23,
      nvl(sum(H24 * {1} * (1 + {2} / 100)), 0) H24,
      nvl(sum(H25 * {1} * (1 + {2} / 100)), 0) H25,
      nvl(sum(H26 * {1} * (1 + {2} / 100)), 0) H26,
      nvl(sum(H27 * {1} * (1 + {2} / 100)), 0) H27,
      nvl(sum(H28 * {1} * (1 + {2} / 100)), 0) H28,
      nvl(sum(H29 * {1} * (1 + {2} / 100)), 0) H29,
      nvl(sum(H30 * {1} * (1 + {2} / 100)), 0) H30,
      nvl(sum(H31 * {1} * (1 + {2} / 100)), 0) H31,
      nvl(sum(H32 * {1} * (1 + {2} / 100)), 0) H32,
      nvl(sum(H33 * {1} * (1 + {2} / 100)), 0) H33,
      nvl(sum(H34 * {1} * (1 + {2} / 100)), 0) H34,
      nvl(sum(H35 * {1} * (1 + {2} / 100)), 0) H35,
      nvl(sum(H36 * {1} * (1 + {2} / 100)), 0) H36,
      nvl(sum(H37 * {1} * (1 + {2} / 100)), 0) H37,
      nvl(sum(H38 * {1} * (1 + {2} / 100)), 0) H38,
      nvl(sum(H39 * {1} * (1 + {2} / 100)), 0) H39,
      nvl(sum(H40 * {1} * (1 + {2} / 100)), 0) H40,
      nvl(sum(H41 * {1} * (1 + {2} / 100)), 0) H41,
      nvl(sum(H42 * {1} * (1 + {2} / 100)), 0) H42,
      nvl(sum(H43 * {1} * (1 + {2} / 100)), 0) H43,
      nvl(sum(H44 * {1} * (1 + {2} / 100)), 0) H44,
      nvl(sum(H45 * {1} * (1 + {2} / 100)), 0) H45,
      nvl(sum(H46 * {1} * (1 + {2} / 100)), 0) H46,
      nvl(sum(H47 * {1} * (1 + {2} / 100)), 0) H47,
      nvl(sum(H48 * {1} * (1 + {2} / 100)), 0) H48
      from
      (
          select
          pto.ptomedicodi, 
          med.medifecha,
          nvl(sum(med.H1), 0) H1, nvl(sum(med.H2), 0) H2, nvl(sum(med.H3), 0) H3, nvl(sum(med.H4), 0) H4, nvl(sum(med.H5), 0) H5,
          nvl(sum(med.H6), 0) H6, nvl(sum(med.H7), 0) H7, nvl(sum(med.H8), 0) H8, nvl(sum(med.H9), 0) H9, nvl(sum(med.H10), 0) H10,
          nvl(sum(med.H11), 0) H11, nvl(sum(med.H12), 0) H12, nvl(sum(med.H13), 0) H13, nvl(sum(med.H14), 0) H14, nvl(sum(med.H15), 0) H15,
          nvl(sum(med.H16), 0) H16, nvl(sum(med.H17), 0) H17, nvl(sum(med.H18), 0) H18, nvl(sum(med.H19), 0) H19, nvl(sum(med.H20), 0) H20,
          nvl(sum(med.H21), 0) H21, nvl(sum(med.H22), 0) H22, nvl(sum(med.H23), 0) H23, nvl(sum(med.H24), 0) H24, nvl(sum(med.H25), 0) H25,
          nvl(sum(med.H26), 0) H26, nvl(sum(med.H27), 0) H27, nvl(sum(med.H28), 0) H28, nvl(sum(med.H29), 0) H29, nvl(sum(med.H30), 0) H30,
          nvl(sum(med.H31), 0) H31, nvl(sum(med.H32), 0) H32, nvl(sum(med.H33), 0) H33, nvl(sum(med.H34), 0) H34, nvl(sum(med.H35), 0) H35,
          nvl(sum(med.H36), 0) H36, nvl(sum(med.H37), 0) H37, nvl(sum(med.H38), 0) H38, nvl(sum(med.H39), 0) H39, nvl(sum(med.H40), 0) H40,
          nvl(sum(med.H41), 0) H41, nvl(sum(med.H42), 0) H42, nvl(sum(med.H43), 0) H43, nvl(sum(med.H44), 0) H44, nvl(sum(med.H45), 0) H45,
          nvl(sum(med.H46), 0) H46, nvl(sum(med.H47), 0) H47, nvl(sum(med.H48), 0) H48
          from
          me_ptomedicion pto 
          join si_empresa emp on pto.emprcodi = emp.emprcodi
          and (pto.ptomediestado = 'A')
          and (pto.origlectcodi = {3})
          and (pto.grupocodibarra = {0})
          and (emp.tipoemprcodi = 4)
          join prn_medicion48 med on pto.ptomedicodi = med.ptomedicodi
          and (med.prnm48tipo = {5})
          and (med.medifecha = to_date('{4}', 'DD/MM/YYYY'))
          group by
          pto.ptomedicodi, med.medifecha
          
          union all
          
          select
          pto.ptomedicodi,
          med.medifecha,
          nvl(sum(med.H1), 0) H1, nvl(sum(med.H2), 0) H2, nvl(sum(med.H3), 0) H3, nvl(sum(med.H4), 0) H4, nvl(sum(med.H5), 0) H5,
          nvl(sum(med.H6), 0) H6, nvl(sum(med.H7), 0) H7, nvl(sum(med.H8), 0) H8, nvl(sum(med.H9), 0) H9, nvl(sum(med.H10), 0) H10,
          nvl(sum(med.H11), 0) H11, nvl(sum(med.H12), 0) H12, nvl(sum(med.H13), 0) H13, nvl(sum(med.H14), 0) H14, nvl(sum(med.H15), 0) H15,
          nvl(sum(med.H16), 0) H16, nvl(sum(med.H17), 0) H17, nvl(sum(med.H18), 0) H18, nvl(sum(med.H19), 0) H19, nvl(sum(med.H20), 0) H20,
          nvl(sum(med.H21), 0) H21, nvl(sum(med.H22), 0) H22, nvl(sum(med.H23), 0) H23, nvl(sum(med.H24), 0) H24, nvl(sum(med.H25), 0) H25,
          nvl(sum(med.H26), 0) H26, nvl(sum(med.H27), 0) H27, nvl(sum(med.H28), 0) H28, nvl(sum(med.H29), 0) H29, nvl(sum(med.H30), 0) H30,
          nvl(sum(med.H31), 0) H31, nvl(sum(med.H32), 0) H32, nvl(sum(med.H33), 0) H33, nvl(sum(med.H34), 0) H34, nvl(sum(med.H35), 0) H35,
          nvl(sum(med.H36), 0) H36, nvl(sum(med.H37), 0) H37, nvl(sum(med.H38), 0) H38, nvl(sum(med.H39), 0) H39, nvl(sum(med.H40), 0) H40,
          nvl(sum(med.H41), 0) H41, nvl(sum(med.H42), 0) H42, nvl(sum(med.H43), 0) H43, nvl(sum(med.H44), 0) H44, nvl(sum(med.H45), 0) H45,
          nvl(sum(med.H46), 0) H46, nvl(sum(med.H47), 0) H47, nvl(sum(med.H48), 0) H48
          from
          me_ptomedicion pto
          join
          (
              select
              ptomedicodi, medifecha,
              sum(H1) H1, sum(H2) H2, sum(H3) H3, sum(H4) H4, sum(H5) H5, sum(H6) H6, sum(H7) H7, sum(H8) H8, sum(H9) H9, sum(H10) H10,
              sum(H11) H11, sum(H12) H12, sum(H13) H13, sum(H14) H14, sum(H15) H15, sum(H16) H16, sum(H17) H17, sum(H18) H18, sum(H19) H19, sum(H20) H20,
              sum(H21) H21, sum(H22) H22, sum(H23) H23, sum(H24) H24, sum(H25) H25, sum(H26) H26, sum(H27) H27, sum(H28) H28, sum(H29) H29, sum(H30) H30,
              sum(H31) H31, sum(H32) H32, sum(H33) H33, sum(H34) H34, sum(H35) H35, sum(H36) H36, sum(H37) H37, sum(H38) H38, sum(H39) H39, sum(H40) H40,
              sum(H41) H41, sum(H42) H42, sum(H43) H43, sum(H44) H44, sum(H45) H45, sum(H46) H46, sum(H47) H47, sum(H48) H48
              from
              (
                  select
                  pgr.ptomedicodi, sb.medifecha,
                  nvl(sum(sb.H1), 0) H1, nvl(sum(sb.H2), 0) H2, nvl(sum(sb.H3), 0) H3, nvl(sum(sb.H4), 0) H4, nvl(sum(sb.H5), 0) H5,
                  nvl(sum(sb.H6), 0) H6, nvl(sum(sb.H7), 0) H7, nvl(sum(sb.H8), 0) H8, nvl(sum(sb.H9), 0) H9, nvl(sum(sb.H10), 0) H10,
                  nvl(sum(sb.H11), 0) H11, nvl(sum(sb.H12), 0) H12, nvl(sum(sb.H13), 0) H13, nvl(sum(sb.H14), 0) H14, nvl(sum(sb.H15), 0) H15,
                  nvl(sum(sb.H16), 0) H16, nvl(sum(sb.H17), 0) H17, nvl(sum(sb.H18), 0) H18, nvl(sum(sb.H19), 0) H19, nvl(sum(sb.H20), 0) H20,
                  nvl(sum(sb.H21), 0) H21, nvl(sum(sb.H22), 0) H22, nvl(sum(sb.H23), 0) H23, nvl(sum(sb.H24), 0) H24, nvl(sum(sb.H25), 0) H25,
                  nvl(sum(sb.H26), 0) H26, nvl(sum(sb.H27), 0) H27, nvl(sum(sb.H28), 0) H28, nvl(sum(sb.H29), 0) H29, nvl(sum(sb.H30), 0) H30,
                  nvl(sum(sb.H31), 0) H31, nvl(sum(sb.H32), 0) H32, nvl(sum(sb.H33), 0) H33, nvl(sum(sb.H34), 0) H34, nvl(sum(sb.H35), 0) H35,
                  nvl(sum(sb.H36), 0) H36, nvl(sum(sb.H37), 0) H37, nvl(sum(sb.H38), 0) H38, nvl(sum(sb.H39), 0) H39, nvl(sum(sb.H40), 0) H40,
                  nvl(sum(sb.H41), 0) H41, nvl(sum(sb.H42), 0) H42, nvl(sum(sb.H43), 0) H43, nvl(sum(sb.H44), 0) H44, nvl(sum(sb.H45), 0) H45,
                  nvl(sum(sb.H46), 0) H46, nvl(sum(sb.H47), 0) H47, nvl(sum(sb.H48), 0) H48
                  from
                  prn_puntoagrupacion pgr
                  join prn_agrupacion agr on pgr.ptogrpcodi = agr.ptogrpcodi
                  and (pgr.ptogrpfechafin = to_date('31/12/9999', 'DD/MM/YYYY'))
                  join prn_medicion48 sb on agr.ptomedicodi = sb.ptomedicodi
                  and (sb.prnm48tipo = {5})
                  and (sb.medifecha = to_date('{4}', 'DD/MM/YYYY'))
                  group by pgr.ptomedicodi, sb.medifecha
              )
              group by ptomedicodi, medifecha
          ) med
          on pto.ptomedicodi = med.ptomedicodi
          and (pto.ptomediestado = 'A')
          and (pto.origlectcodi = {6})
          and (pto.grupocodibarra = {0})
          group by
          pto.ptomedicodi, med.medifecha
      )
      group by medifecha
    </query>
  </Sql>
  
  <Sql>
    <key>GetDemandaEjecutadaPorPunto</key>
    <query>
      select
      ptomedicodi, 1 PRNM48TIPO , medifecha,
      H1, H2, H3, H4, H5, H6, H7, H8, H9, H10,
      H11, H12, H13, H14, H15, H16, H17, H18, H19, H20,
      H21, H22, H23, H24, H25, H26, H27, H28, H29, H30,
      H31, H32, H33, H34, H35, H36, H37, H38, H39, H40,
      H41, H42, H43, H44, H45, H46, H47, H48
      from
      me_medicion48
      where
      ptomedicodi = {0} and
      lectcodi = {1} and
      tipoinfocodi = {5} and
      medifecha = to_date('{4}', 'DD/MM/YYYY')
      union all
      select
      ptomedicodi, 2 PRNM48TIPO, medifecha,
      H1, H2, H3, H4, H5, H6, H7, H8, H9, H10,
      H11, H12, H13, H14, H15, H16, H17, H18, H19, H20,
      H21, H22, H23, H24, H25, H26, H27, H28, H29, H30,
      H31, H32, H33, H34, H35, H36, H37, H38, H39, H40,
      H41, H42, H43, H44, H45, H46, H47, H48
      from
      prn_medicion48
      where
      ptomedicodi = {0} and
      prnm48tipo = {2} and
      medifecha = to_date('{4}', 'DD/MM/YYYY')
      union all
      select
      ptomedicodi, 3 PRNM48TIPO, medifecha,
      H1, H2, H3, H4, H5, H6, H7, H8, H9, H10,
      H11, H12, H13, H14, H15, H16, H17, H18, H19, H20,
      H21, H22, H23, H24, H25, H26, H27, H28, H29, H30,
      H31, H32, H33, H34, H35, H36, H37, H38, H39, H40,
      H41, H42, H43, H44, H45, H46, H47, H48
      from
      prn_medicion48
      where
      ptomedicodi = {0} and
      prnm48tipo = {3} and
      medifecha = to_date('{4}', 'DD/MM/YYYY')
    </query>
  </Sql>

  <Sql>
    <key>GetDemandaPorPunto</key>
    <query>
      select
      ptomedicodi, 1 PRNM48TIPO , medifecha,
      H1, H2, H3, H4, H5, H6, H7, H8, H9, H10,
      H11, H12, H13, H14, H15, H16, H17, H18, H19, H20,
      H21, H22, H23, H24, H25, H26, H27, H28, H29, H30,
      H31, H32, H33, H34, H35, H36, H37, H38, H39, H40,
      H41, H42, H43, H44, H45, H46, H47, H48
      from
      me_medicion48
      where
      ptomedicodi = {0} and
      lectcodi = {1} and
      tipoinfocodi = {5} and
      medifecha = to_date('{4}', 'DD/MM/YYYY')
      union all
      select
      ptomedicodi, 2 PRNM48TIPO, medifecha,
      H1, H2, H3, H4, H5, H6, H7, H8, H9, H10,
      H11, H12, H13, H14, H15, H16, H17, H18, H19, H20,
      H21, H22, H23, H24, H25, H26, H27, H28, H29, H30,
      H31, H32, H33, H34, H35, H36, H37, H38, H39, H40,
      H41, H42, H43, H44, H45, H46, H47, H48
      from
      prn_medicion48
      where
      ptomedicodi = {0} and
      prnm48tipo = {2} and
      medifecha = to_date('{4}', 'DD/MM/YYYY')
      union all
      select
      ptomedicodi, 3 PRNM48TIPO, medifecha,
      H1, H2, H3, H4, H5, H6, H7, H8, H9, H10,
      H11, H12, H13, H14, H15, H16, H17, H18, H19, H20,
      H21, H22, H23, H24, H25, H26, H27, H28, H29, H30,
      H31, H32, H33, H34, H35, H36, H37, H38, H39, H40,
      H41, H42, H43, H44, H45, H46, H47, H48
      from
      prn_medicion48
      where
      ptomedicodi = {0} and
      prnm48tipo = {3} and
      medifecha = to_date('{4}', 'DD/MM/YYYY')
    </query>
  </Sql>

  <!--
  {0} : Origlectcodi - Origen de lectura de una agrupación PRODEM
  {1} : Origlectcodi2 - Origen de lectura de un punto de medición PRODEM
  {2} : Lectcodi - Lectura de una medición enviada por un agente
  {3} : Tipoinfocodi - Tipo de información de un punto de medición PRODEM
  {4} : Medifecha - Fecha para la busqueda de información
  {5} : Prnm48tipo - Tipo de información correspondiente a la "Depuración manual" y "Depuración automática" de los puntos que conforman la agrupación
  {6} : Prnm48tipo2 - Tipo de información correspondiente a la "Depuración manual de una agrupación"
  {7} : Ptomedicodi - Identificador del punto de medición a buscar
  -->
  <Sql>
    <key>GetDemandaPorAgrupacion</key>
    <query>
      select
      ptomedicodi,
      prnm48tipo,
      medifecha,
      nvl(sum(H1), 0) H1, nvl(sum(H2), 0) H2,
      nvl(sum(H3), 0) H3, nvl(sum(H4), 0) H4,
      nvl(sum(H5), 0) H5, nvl(sum(H6), 0) H6,
      nvl(sum(H7), 0) H7, nvl(sum(H8), 0) H8,
      nvl(sum(H9), 0) H9, nvl(sum(H10), 0) H10,
      nvl(sum(H11), 0) H11, nvl(sum(H12), 0) H12,
      nvl(sum(H13), 0) H13, nvl(sum(H14), 0) H14,
      nvl(sum(H15), 0) H15, nvl(sum(H16), 0) H16,
      nvl(sum(H17), 0) H17, nvl(sum(H18), 0) H18,
      nvl(sum(H19), 0) H19, nvl(sum(H20), 0) H20,
      nvl(sum(H21), 0) H21, nvl(sum(H22), 0) H22,
      nvl(sum(H23), 0) H23, nvl(sum(H24), 0) H24,
      nvl(sum(H25), 0) H25, nvl(sum(H26), 0) H26,
      nvl(sum(H27), 0) H27, nvl(sum(H28), 0) H28,
      nvl(sum(H29), 0) H29, nvl(sum(H30), 0) H30,
      nvl(sum(H31), 0) H31, nvl(sum(H32), 0) H32,
      nvl(sum(H33), 0) H33, nvl(sum(H34), 0) H34,
      nvl(sum(H35), 0) H35, nvl(sum(H36), 0) H36,
      nvl(sum(H37), 0) H37, nvl(sum(H38), 0) H38,
      nvl(sum(H39), 0) H39, nvl(sum(H40), 0) H40,
      nvl(sum(H41), 0) H41, nvl(sum(H42), 0) H42,
      nvl(sum(H43), 0) H43, nvl(sum(H44), 0) H44,
      nvl(sum(H45), 0) H45, nvl(sum(H46), 0) H46,
      nvl(sum(H47), 0) H47, nvl(sum(H48), 0) H48
      from
      (
        select
        pto.ptomedicodi, pto.ptomedidesc,
        1 PRNM48TIPO,
        dt.medifecha,
        grp.ptomedicodi PTOGRPHIJOCODI,
        H1, H2, H3, H4, H5, H6, H7, H8, H9, H10,
        H11, H12, H13, H14, H15, H16, H17, H18, H19, H20,
        H21, H22, H23, H24, H25, H26, H27, H28, H29, H30,
        H31, H32, H33, H34, H35, H36, H37, H38, H39, H40,
        H41, H42, H43, H44, H45, H46, H47, H48
        from
        me_ptomedicion pto
        join prn_puntoagrupacion ptogrp on pto.ptomedicodi = ptogrp.ptomedicodi
        and (pto.origlectcodi = {0} and pto.ptomediestado = 'A')
        and (ptogrp.ptogrpfechafin = to_date('31/12/9999', 'DD/MM/YYYY'))
        join prn_agrupacion grp on ptogrp.ptogrpcodi = grp.ptogrpcodi
        join (
          select
          ptomedicodi,
          medifecha,
          nvl(sum(H1), 0) H1, nvl(sum(H2), 0) H2,
          nvl(sum(H3), 0) H3, nvl(sum(H4), 0) H4,
          nvl(sum(H5), 0) H5, nvl(sum(H6), 0) H6,
          nvl(sum(H7), 0) H7, nvl(sum(H8), 0) H8,
          nvl(sum(H9), 0) H9, nvl(sum(H10), 0) H10,
          nvl(sum(H11), 0) H11, nvl(sum(H12), 0) H12,
          nvl(sum(H13), 0) H13, nvl(sum(H14), 0) H14,
          nvl(sum(H15), 0) H15, nvl(sum(H16), 0) H16,
          nvl(sum(H17), 0) H17, nvl(sum(H18), 0) H18,
          nvl(sum(H19), 0) H19, nvl(sum(H20), 0) H20,
          nvl(sum(H21), 0) H21, nvl(sum(H22), 0) H22,
          nvl(sum(H23), 0) H23, nvl(sum(H24), 0) H24,
          nvl(sum(H25), 0) H25, nvl(sum(H26), 0) H26,
          nvl(sum(H27), 0) H27, nvl(sum(H28), 0) H28,
          nvl(sum(H29), 0) H29, nvl(sum(H30), 0) H30,
          nvl(sum(H31), 0) H31, nvl(sum(H32), 0) H32,
          nvl(sum(H33), 0) H33, nvl(sum(H34), 0) H34,
          nvl(sum(H35), 0) H35, nvl(sum(H36), 0) H36,
          nvl(sum(H37), 0) H37, nvl(sum(H38), 0) H38,
          nvl(sum(H39), 0) H39, nvl(sum(H40), 0) H40,
          nvl(sum(H41), 0) H41, nvl(sum(H42), 0) H42,
          nvl(sum(H43), 0) H43, nvl(sum(H44), 0) H44,
          nvl(sum(H45), 0) H45, nvl(sum(H46), 0) H46,
          nvl(sum(H47), 0) H47, nvl(sum(H48), 0) H48
          from
          (
            select
            m48.ptomedicodi,
            m48.medifecha,
            H1, H2, H3, H4, H5, H6, H7, H8, H9, H10,
            H11, H12, H13, H14, H15, H16, H17, H18, H19, H20,
            H21, H22, H23, H24, H25, H26, H27, H28, H29, H30,
            H31, H32, H33, H34, H35, H36, H37, H38, H39, H40,
            H41, H42, H43, H44, H45, H46, H47, H48
            from
            me_medicion48 m48
            join me_ptomedicion pto on m48.ptomedicodi = pto.ptomedicodi
            and (pto.origlectcodi = {1})
            where
            m48.lectcodi = {2} and
            m48.tipoinfocodi = {3} and
            m48.medifecha = to_date('{4}', 'DD/MM/YYYY')
            union all
            select
            m48.ptomedicodi,
            m48.medifecha,
            H1, H2, H3, H4, H5, H6, H7, H8, H9, H10,
            H11, H12, H13, H14, H15, H16, H17, H18, H19, H20,
            H21, H22, H23, H24, H25, H26, H27, H28, H29, H30,
            H31, H32, H33, H34, H35, H36, H37, H38, H39, H40,
            H41, H42, H43, H44, H45, H46, H47, H48
            from
            prn_medicion48 m48
            join me_ptomedicion pto on m48.ptomedicodi = pto.ptomedicodi
            and (pto.origlectcodi = {1})
            where
            m48.prnm48tipo in ({5}) and
            m48.medifecha = to_date('{4}', 'DD/MM/YYYY')
          ) group by ptomedicodi, medifecha
        ) dt on grp.ptomedicodi = dt.ptomedicodi
        where
        pto.ptomedicodi = {7}
      )
      group by ptomedicodi, prnm48tipo, medifecha
      union all
      select
      ptomedicodi,
      2 PRNM48TIPO,
      medifecha,
      H1, H2, H3, H4, H5, H6, H7, H8, H9, H10,
      H11, H12, H13, H14, H15, H16, H17, H18, H19, H20,
      H21, H22, H23, H24, H25, H26, H27, H28, H29, H30,
      H31, H32, H33, H34, H35, H36, H37, H38, H39, H40,
      H41, H42, H43, H44, H45, H46, H47, H48
      from
      prn_medicion48
      where
      ptomedicodi = {7} and
      prnm48tipo = {6} and
      medifecha = to_date('{4}', 'DD/MM/YYYY')
    </query>
  </Sql>
  
  <!--
  {0} : Origlectcodi - Origen de lectura de una agrupación PRODEM
  {1} : Origlectcodi2 - Origen de lectura de un punto de medición PRODEM
  {2} : Lectcodi - Lectura de una medición enviada por un agente
  {3} : Tipoinfocodi - Tipo de información de un punto de medición PRODEM
  {4} : Medifecha - Fecha para la busqueda de información
  {5} : Prnm48tipo - Tipo de información correspondiente a la "Depuración manual" y "Depuración automática" de los puntos que conforman la agrupación
  {6} : Prnm48tipo2 - Tipo de información correspondiente a la "Depuración manual de una agrupación"
  {7} : Ptomedicodi - Identificador del punto de medición a buscar
  -->
  <Sql>
    <key>GetDemandaEjecutadaPorAgrupacion</key>
    <query>
      select
      ptomedicodi,
      prnm48tipo,
      medifecha,
      nvl(sum(H1), 0) H1, nvl(sum(H2), 0) H2,
      nvl(sum(H3), 0) H3, nvl(sum(H4), 0) H4,
      nvl(sum(H5), 0) H5, nvl(sum(H6), 0) H6,
      nvl(sum(H7), 0) H7, nvl(sum(H8), 0) H8,
      nvl(sum(H9), 0) H9, nvl(sum(H10), 0) H10,
      nvl(sum(H11), 0) H11, nvl(sum(H12), 0) H12,
      nvl(sum(H13), 0) H13, nvl(sum(H14), 0) H14,
      nvl(sum(H15), 0) H15, nvl(sum(H16), 0) H16,
      nvl(sum(H17), 0) H17, nvl(sum(H18), 0) H18,
      nvl(sum(H19), 0) H19, nvl(sum(H20), 0) H20,
      nvl(sum(H21), 0) H21, nvl(sum(H22), 0) H22,
      nvl(sum(H23), 0) H23, nvl(sum(H24), 0) H24,
      nvl(sum(H25), 0) H25, nvl(sum(H26), 0) H26,
      nvl(sum(H27), 0) H27, nvl(sum(H28), 0) H28,
      nvl(sum(H29), 0) H29, nvl(sum(H30), 0) H30,
      nvl(sum(H31), 0) H31, nvl(sum(H32), 0) H32,
      nvl(sum(H33), 0) H33, nvl(sum(H34), 0) H34,
      nvl(sum(H35), 0) H35, nvl(sum(H36), 0) H36,
      nvl(sum(H37), 0) H37, nvl(sum(H38), 0) H38,
      nvl(sum(H39), 0) H39, nvl(sum(H40), 0) H40,
      nvl(sum(H41), 0) H41, nvl(sum(H42), 0) H42,
      nvl(sum(H43), 0) H43, nvl(sum(H44), 0) H44,
      nvl(sum(H45), 0) H45, nvl(sum(H46), 0) H46,
      nvl(sum(H47), 0) H47, nvl(sum(H48), 0) H48
      from
      (
        select
        pto.ptomedicodi, pto.ptomedidesc,
        1 PRNM48TIPO,
        dt.medifecha,
        grp.ptomedicodi PTOGRPHIJOCODI,
        H1, H2, H3, H4, H5, H6, H7, H8, H9, H10,
        H11, H12, H13, H14, H15, H16, H17, H18, H19, H20,
        H21, H22, H23, H24, H25, H26, H27, H28, H29, H30,
        H31, H32, H33, H34, H35, H36, H37, H38, H39, H40,
        H41, H42, H43, H44, H45, H46, H47, H48
        from
        me_ptomedicion pto
        join prn_puntoagrupacion ptogrp on pto.ptomedicodi = ptogrp.ptomedicodi
        and (pto.origlectcodi = {0} and pto.ptomediestado = 'A')
        and (ptogrp.ptogrpfechafin = to_date('31/12/9999', 'DD/MM/YYYY'))
        join prn_agrupacion grp on ptogrp.ptogrpcodi = grp.ptogrpcodi
        join (
          select
          ptomedicodi,
          medifecha,
          nvl(sum(H1), 0) H1, nvl(sum(H2), 0) H2,
          nvl(sum(H3), 0) H3, nvl(sum(H4), 0) H4,
          nvl(sum(H5), 0) H5, nvl(sum(H6), 0) H6,
          nvl(sum(H7), 0) H7, nvl(sum(H8), 0) H8,
          nvl(sum(H9), 0) H9, nvl(sum(H10), 0) H10,
          nvl(sum(H11), 0) H11, nvl(sum(H12), 0) H12,
          nvl(sum(H13), 0) H13, nvl(sum(H14), 0) H14,
          nvl(sum(H15), 0) H15, nvl(sum(H16), 0) H16,
          nvl(sum(H17), 0) H17, nvl(sum(H18), 0) H18,
          nvl(sum(H19), 0) H19, nvl(sum(H20), 0) H20,
          nvl(sum(H21), 0) H21, nvl(sum(H22), 0) H22,
          nvl(sum(H23), 0) H23, nvl(sum(H24), 0) H24,
          nvl(sum(H25), 0) H25, nvl(sum(H26), 0) H26,
          nvl(sum(H27), 0) H27, nvl(sum(H28), 0) H28,
          nvl(sum(H29), 0) H29, nvl(sum(H30), 0) H30,
          nvl(sum(H31), 0) H31, nvl(sum(H32), 0) H32,
          nvl(sum(H33), 0) H33, nvl(sum(H34), 0) H34,
          nvl(sum(H35), 0) H35, nvl(sum(H36), 0) H36,
          nvl(sum(H37), 0) H37, nvl(sum(H38), 0) H38,
          nvl(sum(H39), 0) H39, nvl(sum(H40), 0) H40,
          nvl(sum(H41), 0) H41, nvl(sum(H42), 0) H42,
          nvl(sum(H43), 0) H43, nvl(sum(H44), 0) H44,
          nvl(sum(H45), 0) H45, nvl(sum(H46), 0) H46,
          nvl(sum(H47), 0) H47, nvl(sum(H48), 0) H48
          from
          (
            select
            m48.ptomedicodi,
            m48.medifecha,
            H1, H2, H3, H4, H5, H6, H7, H8, H9, H10,
            H11, H12, H13, H14, H15, H16, H17, H18, H19, H20,
            H21, H22, H23, H24, H25, H26, H27, H28, H29, H30,
            H31, H32, H33, H34, H35, H36, H37, H38, H39, H40,
            H41, H42, H43, H44, H45, H46, H47, H48
            from
            me_medicion48 m48
            join me_ptomedicion pto on m48.ptomedicodi = pto.ptomedicodi
            and (pto.origlectcodi = {1})
            where
            m48.lectcodi = {2} and
            m48.tipoinfocodi = {3} and
            m48.medifecha = to_date('{4}', 'DD/MM/YYYY')
            union all
            select
            m48.ptomedicodi,
            m48.medifecha,
            H1, H2, H3, H4, H5, H6, H7, H8, H9, H10,
            H11, H12, H13, H14, H15, H16, H17, H18, H19, H20,
            H21, H22, H23, H24, H25, H26, H27, H28, H29, H30,
            H31, H32, H33, H34, H35, H36, H37, H38, H39, H40,
            H41, H42, H43, H44, H45, H46, H47, H48
            from
            prn_medicion48 m48
            join me_ptomedicion pto on m48.ptomedicodi = pto.ptomedicodi
            and (pto.origlectcodi = {1})
            where
            m48.prnm48tipo in ({5}) and
            m48.medifecha = to_date('{4}', 'DD/MM/YYYY')
          ) group by ptomedicodi, medifecha
        ) dt on grp.ptomedicodi = dt.ptomedicodi
        where
        pto.ptomedicodi = {7}
      )
      group by ptomedicodi, prnm48tipo, medifecha
      union all
      select
      ptomedicodi,
      2 PRNM48TIPO,
      medifecha,
      H1, H2, H3, H4, H5, H6, H7, H8, H9, H10,
      H11, H12, H13, H14, H15, H16, H17, H18, H19, H20,
      H21, H22, H23, H24, H25, H26, H27, H28, H29, H30,
      H31, H32, H33, H34, H35, H36, H37, H38, H39, H40,
      H41, H42, H43, H44, H45, H46, H47, H48
      from
      prn_medicion48
      where
      ptomedicodi = {7} and
      prnm48tipo = {6} and
      medifecha = to_date('{4}', 'DD/MM/YYYY')
    </query>
  </Sql>
  
  
  <Sql>
    <key>GetDemandaPrevistaPorPunto</key>
    <query>
      select
      ptomedicodi, 1 PRNM48TIPO , medifecha,
      H1, H2, H3, H4, H5, H6, H7, H8, H9, H10,
      H11, H12, H13, H14, H15, H16, H17, H18, H19, H20,
      H21, H22, H23, H24, H25, H26, H27, H28, H29, H30,
      H31, H32, H33, H34, H35, H36, H37, H38, H39, H40,
      H41, H42, H43, H44, H45, H46, H47, H48
      from
      me_medicion48
      where
      ptomedicodi = {0} and
      lectcodi = {1} and
      tipoinfocodi = {4} and
      medifecha = to_date('{3}', 'DD/MM/YYYY')
      union all
      select
      ptomedicodi, 2 PRNM48TIPO, medifecha,
      H1, H2, H3, H4, H5, H6, H7, H8, H9, H10,
      H11, H12, H13, H14, H15, H16, H17, H18, H19, H20,
      H21, H22, H23, H24, H25, H26, H27, H28, H29, H30,
      H31, H32, H33, H34, H35, H36, H37, H38, H39, H40,
      H41, H42, H43, H44, H45, H46, H47, H48
      from
      prn_medicion48
      where
      ptomedicodi = {0} and
      prnm48tipo = {2} and
      medifecha = to_date('{3}', 'DD/MM/YYYY')
    </query>
  </Sql>

  <!--
  {0} : Origlectcodi - Origen de lectura de una agrupación PRODEM
  {1} : Origlectcodi2 - Origen de lectura de un punto de medición PRODEM
  {2} : Lectcodi - Lectura de una medición enviada por un agente
  {3} : Tipoinfocodi - Tipo de información de un punto de medición PRODEM
  {4} : Medifecha - Fecha para la busqueda de información
  {5} : Prnm48tipo - Tipo de información correspondiente a la "Depuración manual" de los puntos que conforman la agrupación
  {6} : Prnm48tipo2 - Tipo de información correspondiente a la "Depuración manual de una agrupación"
  {7} : Ptomedicodi - Identificador del punto de medición a buscar
  -->
  <Sql>
    <key>GetDemandaPrevistaPorAgrupacion</key>
    <query>
      select
      ptomedicodi,
      prnm48tipo,
      medifecha,
      nvl(sum(H1), 0) H1, nvl(sum(H2), 0) H2,
      nvl(sum(H3), 0) H3, nvl(sum(H4), 0) H4,
      nvl(sum(H5), 0) H5, nvl(sum(H6), 0) H6,
      nvl(sum(H7), 0) H7, nvl(sum(H8), 0) H8,
      nvl(sum(H9), 0) H9, nvl(sum(H10), 0) H10,
      nvl(sum(H11), 0) H11, nvl(sum(H12), 0) H12,
      nvl(sum(H13), 0) H13, nvl(sum(H14), 0) H14,
      nvl(sum(H15), 0) H15, nvl(sum(H16), 0) H16,
      nvl(sum(H17), 0) H17, nvl(sum(H18), 0) H18,
      nvl(sum(H19), 0) H19, nvl(sum(H20), 0) H20,
      nvl(sum(H21), 0) H21, nvl(sum(H22), 0) H22,
      nvl(sum(H23), 0) H23, nvl(sum(H24), 0) H24,
      nvl(sum(H25), 0) H25, nvl(sum(H26), 0) H26,
      nvl(sum(H27), 0) H27, nvl(sum(H28), 0) H28,
      nvl(sum(H29), 0) H29, nvl(sum(H30), 0) H30,
      nvl(sum(H31), 0) H31, nvl(sum(H32), 0) H32,
      nvl(sum(H33), 0) H33, nvl(sum(H34), 0) H34,
      nvl(sum(H35), 0) H35, nvl(sum(H36), 0) H36,
      nvl(sum(H37), 0) H37, nvl(sum(H38), 0) H38,
      nvl(sum(H39), 0) H39, nvl(sum(H40), 0) H40,
      nvl(sum(H41), 0) H41, nvl(sum(H42), 0) H42,
      nvl(sum(H43), 0) H43, nvl(sum(H44), 0) H44,
      nvl(sum(H45), 0) H45, nvl(sum(H46), 0) H46,
      nvl(sum(H47), 0) H47, nvl(sum(H48), 0) H48
      from
      (
        select
        pto.ptomedicodi, pto.ptomedidesc,
        1 PRNM48TIPO,
        dt.medifecha,
        grp.ptomedicodi PTOGRPHIJOCODI,
        H1, H2, H3, H4, H5, H6, H7, H8, H9, H10,
        H11, H12, H13, H14, H15, H16, H17, H18, H19, H20,
        H21, H22, H23, H24, H25, H26, H27, H28, H29, H30,
        H31, H32, H33, H34, H35, H36, H37, H38, H39, H40,
        H41, H42, H43, H44, H45, H46, H47, H48
        from
        me_ptomedicion pto
        join prn_puntoagrupacion ptogrp on pto.ptomedicodi = ptogrp.ptomedicodi
        and (pto.origlectcodi = {0} and pto.ptomediestado = 'A')
        and (ptogrp.ptogrpfechafin = to_date('31/12/9999', 'DD/MM/YYYY'))
        join prn_agrupacion grp on ptogrp.ptogrpcodi = grp.ptogrpcodi
        join (
          select
          ptomedicodi,
          medifecha,
          nvl(sum(H1), 0) H1, nvl(sum(H2), 0) H2,
          nvl(sum(H3), 0) H3, nvl(sum(H4), 0) H4,
          nvl(sum(H5), 0) H5, nvl(sum(H6), 0) H6,
          nvl(sum(H7), 0) H7, nvl(sum(H8), 0) H8,
          nvl(sum(H9), 0) H9, nvl(sum(H10), 0) H10,
          nvl(sum(H11), 0) H11, nvl(sum(H12), 0) H12,
          nvl(sum(H13), 0) H13, nvl(sum(H14), 0) H14,
          nvl(sum(H15), 0) H15, nvl(sum(H16), 0) H16,
          nvl(sum(H17), 0) H17, nvl(sum(H18), 0) H18,
          nvl(sum(H19), 0) H19, nvl(sum(H20), 0) H20,
          nvl(sum(H21), 0) H21, nvl(sum(H22), 0) H22,
          nvl(sum(H23), 0) H23, nvl(sum(H24), 0) H24,
          nvl(sum(H25), 0) H25, nvl(sum(H26), 0) H26,
          nvl(sum(H27), 0) H27, nvl(sum(H28), 0) H28,
          nvl(sum(H29), 0) H29, nvl(sum(H30), 0) H30,
          nvl(sum(H31), 0) H31, nvl(sum(H32), 0) H32,
          nvl(sum(H33), 0) H33, nvl(sum(H34), 0) H34,
          nvl(sum(H35), 0) H35, nvl(sum(H36), 0) H36,
          nvl(sum(H37), 0) H37, nvl(sum(H38), 0) H38,
          nvl(sum(H39), 0) H39, nvl(sum(H40), 0) H40,
          nvl(sum(H41), 0) H41, nvl(sum(H42), 0) H42,
          nvl(sum(H43), 0) H43, nvl(sum(H44), 0) H44,
          nvl(sum(H45), 0) H45, nvl(sum(H46), 0) H46,
          nvl(sum(H47), 0) H47, nvl(sum(H48), 0) H48
          from
          (
            select
            m48.ptomedicodi,
            m48.medifecha,
            H1, H2, H3, H4, H5, H6, H7, H8, H9, H10,
            H11, H12, H13, H14, H15, H16, H17, H18, H19, H20,
            H21, H22, H23, H24, H25, H26, H27, H28, H29, H30,
            H31, H32, H33, H34, H35, H36, H37, H38, H39, H40,
            H41, H42, H43, H44, H45, H46, H47, H48
            from
            me_medicion48 m48
            join me_ptomedicion pto on m48.ptomedicodi = pto.ptomedicodi
            and (pto.origlectcodi = {1})
            where
            m48.lectcodi = {2} and
            m48.tipoinfocodi = {3} and
            m48.medifecha = to_date('{4}', 'DD/MM/YYYY')
            union all
            select
            m48.ptomedicodi,
            m48.medifecha,
            H1, H2, H3, H4, H5, H6, H7, H8, H9, H10,
            H11, H12, H13, H14, H15, H16, H17, H18, H19, H20,
            H21, H22, H23, H24, H25, H26, H27, H28, H29, H30,
            H31, H32, H33, H34, H35, H36, H37, H38, H39, H40,
            H41, H42, H43, H44, H45, H46, H47, H48
            from
            prn_medicion48 m48
            join me_ptomedicion pto on m48.ptomedicodi = pto.ptomedicodi
            and (pto.origlectcodi = {1})
            where
            m48.prnm48tipo = {5} and
            m48.medifecha = to_date('{4}', 'DD/MM/YYYY')
          ) group by ptomedicodi, medifecha
        ) dt on grp.ptomedicodi = dt.ptomedicodi
        where
        pto.ptomedicodi = {7}
      )
      group by ptomedicodi, prnm48tipo, medifecha
      union all
      select
      ptomedicodi,
      2 PRNM48TIPO,
      medifecha,
      H1, H2, H3, H4, H5, H6, H7, H8, H9, H10,
      H11, H12, H13, H14, H15, H16, H17, H18, H19, H20,
      H21, H22, H23, H24, H25, H26, H27, H28, H29, H30,
      H31, H32, H33, H34, H35, H36, H37, H38, H39, H40,
      H41, H42, H43, H44, H45, H46, H47, H48
      from
      prn_medicion48
      where
      ptomedicodi = {7} and
      prnm48tipo = {6} and
      medifecha = to_date('{4}', 'DD/MM/YYYY')
    </query>
  </Sql>

  <!--
  {0} : Ptomedicodi - Identificador del punto de medición a buscar
  {1} : Areacodi - Identificador del área a buscar
  {2} : Medifecha - Fecha para la busqueda de información
  {3} : Prnm48tipo - Tipo de información correspondiente a la "Mantenimiento, Falla y Ajustes" de un área operativa
  -->
  <Sql>
    <key>GetDespachoEjecutadoPorArea</key>
    <query>
      select
      {0} PTOMEDICODI,
      1 PRNM48TIPO,
      eq.*
      from (
        select
        medifecha,
        nvl(sum(H1), 0) H1, nvl(sum(H2), 0) H2,
        nvl(sum(H3), 0) H3, nvl(sum(H4), 0) H4,
        nvl(sum(H5), 0) H5, nvl(sum(H6), 0) H6,
        nvl(sum(H7), 0) H7, nvl(sum(H8), 0) H8,
        nvl(sum(H9), 0) H9, nvl(sum(H10), 0) H10,
        nvl(sum(H11), 0) H11, nvl(sum(H12), 0) H12,
        nvl(sum(H13), 0) H13, nvl(sum(H14), 0) H14,
        nvl(sum(H15), 0) H15, nvl(sum(H16), 0) H16,
        nvl(sum(H17), 0) H17, nvl(sum(H18), 0) H18,
        nvl(sum(H19), 0) H19, nvl(sum(H20), 0) H20,
        nvl(sum(H21), 0) H21, nvl(sum(H22), 0) H22,
        nvl(sum(H23), 0) H23, nvl(sum(H24), 0) H24,
        nvl(sum(H25), 0) H25, nvl(sum(H26), 0) H26,
        nvl(sum(H27), 0) H27, nvl(sum(H28), 0) H28,
        nvl(sum(H29), 0) H29, nvl(sum(H30), 0) H30,
        nvl(sum(H31), 0) H31, nvl(sum(H32), 0) H32,
        nvl(sum(H33), 0) H33, nvl(sum(H34), 0) H34,
        nvl(sum(H35), 0) H35, nvl(sum(H36), 0) H36,
        nvl(sum(H37), 0) H37, nvl(sum(H38), 0) H38,
        nvl(sum(H39), 0) H39, nvl(sum(H40), 0) H40,
        nvl(sum(H41), 0) H41, nvl(sum(H42), 0) H42,
        nvl(sum(H43), 0) H43, nvl(sum(H44), 0) H44,
        nvl(sum(H45), 0) H45, nvl(sum(H46), 0) H46,
        nvl(sum(H47), 0) H47, nvl(sum(H48), 0) H48
        from
        prn_medicioneq
        where
        areacodi = {1} and
        medifecha = to_date('{2}', 'DD/MM/YYYY')
        group by medifecha
      ) eq
      union all
      select
      ptomedicodi,
      prnm48tipo,
      medifecha,
      H1, H2, H3, H4, H5, H6, H7, H8, H9, H10,
      H11, H12, H13, H14, H15, H16, H17, H18, H19, H20,
      H21, H22, H23, H24, H25, H26, H27, H28, H29, H30,
      H31, H32, H33, H34, H35, H36, H37, H38, H39, H40,
      H41, H42, H43, H44, H45, H46, H47, H48
      from
      prn_medicion48
      where
      ptomedicodi = {0} and
      medifecha = to_date('{2}', 'DD/MM/YYYY') and
      prnm48tipo in ({3})
    </query>
  </Sql>

  <!--
  {0} : Ptomedicodi - Identificador del punto de medición a buscar
  {1} : Medifecha - Fecha para la busqueda de información
  {2} : Prnm48tipo - Tipo de información correspondiente a la "Ajustes" de un área operativa
  -->
  <Sql>
    <key>GetAjusteAlCentroPorTipo</key>
    <query>
      select
      ptomedicodi,
      prnm48tipo,
      medifecha,
      nvl(H1, 0) * -1 H1,
      nvl(H2, 0) * -1 H2,
      nvl(H3, 0) * -1 H3,
      nvl(H4, 0) * -1 H4,
      nvl(H5, 0) * -1 H5,
      nvl(H6, 0) * -1 H6,
      nvl(H7, 0) * -1 H7,
      nvl(H8, 0) * -1 H8,
      nvl(H9, 0) * -1 H9,
      nvl(H10, 0) * -1 H10,
      nvl(H11, 0) * -1 H11,
      nvl(H12, 0) * -1 H12,
      nvl(H13, 0) * -1 H13,
      nvl(H14, 0) * -1 H14,
      nvl(H15, 0) * -1 H15,
      nvl(H16, 0) * -1 H16,
      nvl(H17, 0) * -1 H17,
      nvl(H18, 0) * -1 H18,
      nvl(H19, 0) * -1 H19,
      nvl(H20, 0) * -1 H20,
      nvl(H21, 0) * -1 H21,
      nvl(H22, 0) * -1 H22,
      nvl(H23, 0) * -1 H23,
      nvl(H24, 0) * -1 H24,
      nvl(H25, 0) * -1 H25,
      nvl(H26, 0) * -1 H26,
      nvl(H27, 0) * -1 H27,
      nvl(H28, 0) * -1 H28,
      nvl(H29, 0) * -1 H29,
      nvl(H30, 0) * -1 H30,
      nvl(H31, 0) * -1 H31,
      nvl(H32, 0) * -1 H32,
      nvl(H33, 0) * -1 H33,
      nvl(H34, 0) * -1 H34,
      nvl(H35, 0) * -1 H35,
      nvl(H36, 0) * -1 H36,
      nvl(H37, 0) * -1 H37,
      nvl(H38, 0) * -1 H38,
      nvl(H39, 0) * -1 H39,
      nvl(H40, 0) * -1 H40,
      nvl(H41, 0) * -1 H41,
      nvl(H42, 0) * -1 H42,
      nvl(H43, 0) * -1 H43,
      nvl(H44, 0) * -1 H44,
      nvl(H45, 0) * -1 H45,
      nvl(H46, 0) * -1 H46,
      nvl(H47, 0) * -1 H47,
      nvl(H48, 0) * -1 H48
      from
      prn_medicion48
      where
      ptomedicodi in ({0}) and
      medifecha = to_date('{1}', 'DD/MM/YYYY') and
      prnm48tipo = {2}
    </query>
  </Sql>

  <!--Demanda de los usuarios libres agrupados-->
  <!--
  {0} : Origlectcodi - Origen de lectura de una agrupación PRODEM
  {1} : Origlectcodi2 - Origen de lectura de un punto de medición PRODEM
  {2} : Lectcodi - Lectura de una medición enviada por un agente de cada punto independiente (no agrupado)
  {3} : Tipoinfocodi - Tipo de información de un punto de medición PRODEM
  {4} : Medifecha - Fecha de envio de una medición
  {5} : Prnm48tipo - Tipo de información correspondiente al tipo de información de cada punto independiente (no agrupado)
  {6} : Areacodi - Filtro de busqueda por área operativa
  {7} : Ptogrppronostico - Filtro de busqueda por "Pertenece al pronóstico"
  {8} : Prnm48tipo2 - Tipo de información correspondiente a la "Depuración manual de una agrupación"
  -->
  <Sql>
    <key>GetDemandaULibresPorArea</key>
    <query>
      select
      areanomb PTOMEDIDESC,
      nvl(sum(H1), 0) H1, nvl(sum(H2), 0) H2,
      nvl(sum(H3), 0) H3, nvl(sum(H4), 0) H4,
      nvl(sum(H5), 0) H5, nvl(sum(H6), 0) H6,
      nvl(sum(H7), 0) H7, nvl(sum(H8), 0) H8,
      nvl(sum(H9), 0) H9, nvl(sum(H10), 0) H10,
      nvl(sum(H11), 0) H11, nvl(sum(H12), 0) H12,
      nvl(sum(H13), 0) H13, nvl(sum(H14), 0) H14,
      nvl(sum(H15), 0) H15, nvl(sum(H16), 0) H16,
      nvl(sum(H17), 0) H17, nvl(sum(H18), 0) H18,
      nvl(sum(H19), 0) H19, nvl(sum(H20), 0) H20,
      nvl(sum(H21), 0) H21, nvl(sum(H22), 0) H22,
      nvl(sum(H23), 0) H23, nvl(sum(H24), 0) H24,
      nvl(sum(H25), 0) H25, nvl(sum(H26), 0) H26,
      nvl(sum(H27), 0) H27, nvl(sum(H28), 0) H28,
      nvl(sum(H29), 0) H29, nvl(sum(H30), 0) H30,
      nvl(sum(H31), 0) H31, nvl(sum(H32), 0) H32,
      nvl(sum(H33), 0) H33, nvl(sum(H34), 0) H34,
      nvl(sum(H35), 0) H35, nvl(sum(H36), 0) H36,
      nvl(sum(H37), 0) H37, nvl(sum(H38), 0) H38,
      nvl(sum(H39), 0) H39, nvl(sum(H40), 0) H40,
      nvl(sum(H41), 0) H41, nvl(sum(H42), 0) H42,
      nvl(sum(H43), 0) H43, nvl(sum(H44), 0) H44,
      nvl(sum(H45), 0) H45, nvl(sum(H46), 0) H46,
      nvl(sum(H47), 0) H47, nvl(sum(H48), 0) H48
      from 
      (
        select
        area.areacodi, area.areanomb,
        H1, H2, H3, H4, H5, H6, H7, H8, H9, H10,
        H11, H12, H13, H14, H15, H16, H17, H18, H19, H20,
        H21, H22, H23, H24, H25, H26, H27, H28, H29, H30,
        H31, H32, H33, H34, H35, H36, H37, H38, H39, H40,
        H41, H42, H43, H44, H45, H46, H47, H48
        from
        me_ptomedicion pto
        join eq_area area on pto.equicodi = area.areacodi
        join prn_puntoagrupacion ptogrp on pto.ptomedicodi = ptogrp.ptomedicodi
        and (pto.origlectcodi = {0} and pto.ptomediestado = 'A')
        and (ptogrp.ptogrpfechafin = to_date('31/12/9999', 'DD/MM/YYYY'))
        join prn_agrupacion grp on ptogrp.ptogrpcodi = grp.ptogrpcodi
        join me_ptomedicion pto2 on grp.ptomedicodi = pto2.ptomedicodi
        left join 
        (
          select
          ptomedicodi,
          medifecha,
          nvl(sum(H1), 0) H1, nvl(sum(H2), 0) H2,
          nvl(sum(H3), 0) H3, nvl(sum(H4), 0) H4,
          nvl(sum(H5), 0) H5, nvl(sum(H6), 0) H6,
          nvl(sum(H7), 0) H7, nvl(sum(H8), 0) H8,
          nvl(sum(H9), 0) H9, nvl(sum(H10), 0) H10,
          nvl(sum(H11), 0) H11, nvl(sum(H12), 0) H12,
          nvl(sum(H13), 0) H13, nvl(sum(H14), 0) H14,
          nvl(sum(H15), 0) H15, nvl(sum(H16), 0) H16,
          nvl(sum(H17), 0) H17, nvl(sum(H18), 0) H18,
          nvl(sum(H19), 0) H19, nvl(sum(H20), 0) H20,
          nvl(sum(H21), 0) H21, nvl(sum(H22), 0) H22,
          nvl(sum(H23), 0) H23, nvl(sum(H24), 0) H24,
          nvl(sum(H25), 0) H25, nvl(sum(H26), 0) H26,
          nvl(sum(H27), 0) H27, nvl(sum(H28), 0) H28,
          nvl(sum(H29), 0) H29, nvl(sum(H30), 0) H30,
          nvl(sum(H31), 0) H31, nvl(sum(H32), 0) H32,
          nvl(sum(H33), 0) H33, nvl(sum(H34), 0) H34,
          nvl(sum(H35), 0) H35, nvl(sum(H36), 0) H36,
          nvl(sum(H37), 0) H37, nvl(sum(H38), 0) H38,
          nvl(sum(H39), 0) H39, nvl(sum(H40), 0) H40,
          nvl(sum(H41), 0) H41, nvl(sum(H42), 0) H42,
          nvl(sum(H43), 0) H43, nvl(sum(H44), 0) H44,
          nvl(sum(H45), 0) H45, nvl(sum(H46), 0) H46,
          nvl(sum(H47), 0) H47, nvl(sum(H48), 0) H48
          from
          (
            select
            m48.ptomedicodi,
            m48.medifecha,
            H1, H2, H3, H4, H5, H6, H7, H8, H9, H10,
            H11, H12, H13, H14, H15, H16, H17, H18, H19, H20,
            H21, H22, H23, H24, H25, H26, H27, H28, H29, H30,
            H31, H32, H33, H34, H35, H36, H37, H38, H39, H40,
            H41, H42, H43, H44, H45, H46, H47, H48
            from
            me_medicion48 m48
            join me_ptomedicion pto on m48.ptomedicodi = pto.ptomedicodi
            and (pto.origlectcodi = {1})
            where
            m48.lectcodi = {2} and
            m48.tipoinfocodi = {3} and
            m48.medifecha = to_date('{4}', 'DD/MM/YYYY')
            union all
            select
            m48.ptomedicodi,
            m48.medifecha,
            H1, H2, H3, H4, H5, H6, H7, H8, H9, H10,
            H11, H12, H13, H14, H15, H16, H17, H18, H19, H20,
            H21, H22, H23, H24, H25, H26, H27, H28, H29, H30,
            H31, H32, H33, H34, H35, H36, H37, H38, H39, H40,
            H41, H42, H43, H44, H45, H46, H47, H48
            from
            prn_medicion48 m48
            join me_ptomedicion pto on m48.ptomedicodi = pto.ptomedicodi
            and (pto.origlectcodi = {1})
            where
            m48.prnm48tipo in ({5}) and
            m48.medifecha = to_date('{4}', 'DD/MM/YYYY')
          ) group by ptomedicodi, medifecha
        ) dt on pto2.ptomedicodi = dt.ptomedicodi
        where
        area.areacodi = {6} and
        ptogrp.ptogrppronostico = {7}
        union all
        select
        area.areacodi, area.areanomb,
        H1, H2, H3, H4, H5, H6, H7, H8, H9, H10,
        H11, H12, H13, H14, H15, H16, H17, H18, H19, H20,
        H21, H22, H23, H24, H25, H26, H27, H28, H29, H30,
        H31, H32, H33, H34, H35, H36, H37, H38, H39, H40,
        H41, H42, H43, H44, H45, H46, H47, H48
        from
        me_ptomedicion pto
        join eq_area area on pto.equicodi = area.areacodi
        join prn_puntoagrupacion ptogrp on pto.ptomedicodi = ptogrp.ptomedicodi
        and (pto.origlectcodi = {0} and pto.ptomediestado = 'A')
        and (ptogrp.ptogrpfechafin = to_date('31/12/9999', 'DD/MM/YYYY'))
        join prn_medicion48 m48 on pto.ptomedicodi = m48.ptomedicodi
        and (m48.prnm48tipo = {8} and m48.medifecha = to_date('{4}', 'DD/MM/YYYY'))
        where
        area.areacodi = {6} and
        ptogrp.ptogrppronostico = {7}
      )
      group by areanomb
    </query>
  </Sql>
  
  <Sql>
    <key>GetNombrePtomedicion</key>
    <query>
      select areanomb || ' ' || ptomedidesc EQUINOMB
      from(
      select distinct
      tarea.tareaabrev,
      fam.famcodi, fam.famabrev famnomb,
      area.areacodi, area.areanomb,
      te.tipoemprcodi, te.tipoemprdesc,
      emp.emprcodi, emp.emprnomb,
      eq.equicodi, eq.equinomb,
      pto.ptomedicodi, pto.ptomedidesc
      from
      eq_propequi pe
      join eq_equipo eq on pe.equicodi = eq.equicodi
      and (pe.propcodi = 1064)
      and (fechapropequi = (select max(fechapropequi) from eq_propequi where propcodi = 1064 and equicodi = eq.equicodi))
      join eq_familia fam on eq.famcodi = fam.famcodi
      join eq_area area on eq.areacodi = area.areacodi
      join eq_tipoarea tarea on area.tareacodi = tarea.tareacodi
      join si_empresa emp on eq.emprcodi = emp.emprcodi
      join si_tipoempresa te on emp.tipoemprcodi = te.tipoemprcodi
      join me_ptomedicion pto on eq.equicodi = pto.equicodi
      and (pto.origlectcodi = 6)
      where
      pto.ptomedicodi = :ptomedicodi
      )
    </query>
  </Sql>
  
  <!--Parametos - Barra-->
  <Sql>
    <key>GetListBarraBy</key>
    <query>
      select
      gr.grupocodi, gr.gruponomb,
      med.H1, med.H2, med.H3, med.H4, med.H5, med.H6, med.H7, med.H8, med.H9, med.H10,
      med.H11, med.H12, med.H13, med.H14, med.H15, med.H16, med.H17, med.H18, med.H19, med.H20,
      med.H21, med.H22, med.H23, med.H24, med.H25, med.H26, med.H27, med.H28, med.H29, med.H30,
      med.H31, med.H32, med.H33, med.H34, med.H35, med.H36, med.H37, med.H38, med.H39, med.H40,
      med.H41, med.H42, med.H43, med.H44, med.H45, med.H46, med.H47, med.H48
      from
      (select grupocodi, gruponomb
      from
      (select distinct red.prnredbarrapm from prn_reduccionred red join prn_version ver on red.prnvercodi = ver.prnvercodi where ver.prnverestado = 'A' and (red.prnredbarracp in ({3}) or '0' = '{3}')) tb1
      left join
      (select grupocodi, gruponomb
      from pr_grupo
      where catecodi = 10) tb2 on tb1.prnredbarrapm = tb2.grupocodi) gr
      left join (
      select ptomedicodi, H1, H2, H3, H4, H5, H6, H7, H8, H9, H10,
      H11, H12, H13, H14, H15, H16, H17, H18, H19, H20,
      H21, H22, H23, H24, H25, H26, H27, H28, H29, H30,
      H31, H32, H33, H34, H35, H36, H37, H38, H39, H40,
      H41, H42, H43, H44, H45, H46, H47, H48
      from prn_medicion48 where prnm48tipo = {1}
      ) med on gr.grupocodi = med.ptomedicodi
      where
      (gr.grupocodi in ({0}) or '0' = '{0}')
    </query>
  </Sql>

  <Sql>
    <key>GetSqlDeleteSA</key>
    <query>
      delete from
      prn_medicion48
      where
      ptomedicodi = :ptomedicodi and
      prnm48tipo = :prnm48tipo 
    </query>
  </Sql>

  <Sql>
    <key>PR03Puntos</key>
    <query>
      select distinct
      pe.valor AREAOPERATIVA,
      tarea.tareaabrev,
      area.areacodi, area.areanomb,
      te.tipoemprcodi, te.tipoemprdesc,
      emp.emprcodi, emp.emprnomb,
      eq.equicodi, eq.equinomb,
      pto.ptomedicodi,
      pto.ptomedidesc || ' (' || pto.ptomedicodi || ')' PTOMEDIDESC,
      pto.grupocodibarra
      from
      eq_propequi pe
      join eq_equipo eq on pe.equicodi = eq.equicodi
      and (pe.propcodi = 1064)
      and (fechapropequi = (select max(fechapropequi) from eq_propequi where propcodi = 1064 and equicodi = eq.equicodi))
      join eq_familia fam on eq.famcodi = fam.famcodi
      join eq_area area on eq.areacodi = area.areacodi
      join eq_tipoarea tarea on area.tareacodi = tarea.tareacodi
      join si_empresa emp on eq.emprcodi = emp.emprcodi
      join si_tipoempresa te on emp.tipoemprcodi = te.tipoemprcodi
      join me_ptomedicion pto on eq.equicodi = pto.equicodi
      and (pto.origlectcodi = 6)
    </query>
  </Sql>

  <Sql>
    <key>PR03PuntosNoAgrupados</key>
    <query>
      select distinct
      pe.valor AREAOPERATIVA,
      tarea.tareaabrev,
      area.areacodi, area.areanomb,
      te.tipoemprcodi, te.tipoemprdesc,
      emp.emprcodi, emp.emprnomb,
      eq.equicodi, eq.equinomb,
      pto.ptomedicodi,
      pto.ptomedidesc || ' (' || pto.ptomedicodi || ')' PTOMEDIDESC,
      pto.grupocodibarra
      from
      eq_propequi pe
      join eq_equipo eq on pe.equicodi = eq.equicodi
      and (pe.propcodi = 1064)
      and (fechapropequi = (select max(fechapropequi) from eq_propequi where propcodi = 1064 and equicodi = eq.equicodi))
      join eq_familia fam on eq.famcodi = fam.famcodi
      join eq_area area on eq.areacodi = area.areacodi
      join eq_tipoarea tarea on area.tareacodi = tarea.tareacodi
      join si_empresa emp on eq.emprcodi = emp.emprcodi
      join si_tipoempresa te on emp.tipoemprcodi = te.tipoemprcodi
      join me_ptomedicion pto on eq.equicodi = pto.equicodi
      and (pto.origlectcodi = 6)
      left outer join
      (
      select
      grp.ptomedicodi
      from
      me_ptomedicion pto
      join prn_puntoagrupacion ptogrp on pto.ptomedicodi = ptogrp.ptomedicodi
      and (pto.origlectcodi = 33)
      and (pto.ptomediestado = 'A')
      and (ptogrp.ptogrpfechafin = to_date('31/12/9999', 'DD/MM/YYYY'))
      join prn_agrupacion grp on ptogrp.ptogrpcodi = grp.ptogrpcodi
      )sq
      on pto.ptomedicodi = sq.ptomedicodi
      where sq.ptomedicodi is null
    </query>
  </Sql>

  <Sql>
    <key>PR03Empresas</key>
    <query>
      select distinct
      te.tipoemprcodi,
      emp.emprcodi, emp.emprnomb
      from
      eq_propequi pe
      join eq_equipo eq on pe.equicodi = eq.equicodi
      and (pe.propcodi = 1064)
      and (fechapropequi = (select max(fechapropequi) from eq_propequi where propcodi = 1064 and equicodi = eq.equicodi))
      join eq_familia fam on eq.famcodi = fam.famcodi
      join eq_area area on eq.areacodi = area.areacodi
      join eq_tipoarea tarea on area.tareacodi = tarea.tareacodi
      join si_empresa emp on eq.emprcodi = emp.emprcodi
      join si_tipoempresa te on emp.tipoemprcodi = te.tipoemprcodi
      join me_ptomedicion pto on eq.equicodi = pto.equicodi
      and (pto.origlectcodi = 6)
    </query>
  </Sql>

  <Sql>
    <key>PR03Ubicaciones</key>
    <query>
      select distinct
      pe.valor AREAOPERATIVA,
      area.areacodi,
      tarea.tareaabrev || ' ' || area.areanomb AREANOMB
      from
      eq_propequi pe
      join eq_equipo eq on pe.equicodi = eq.equicodi
      and (pe.propcodi = 1064)
      and (fechapropequi = (select max(fechapropequi) from eq_propequi where propcodi = 1064 and equicodi = eq.equicodi))
      join eq_familia fam on eq.famcodi = fam.famcodi
      join eq_area area on eq.areacodi = area.areacodi
      join eq_tipoarea tarea on area.tareacodi = tarea.tareacodi
      join si_empresa emp on eq.emprcodi = emp.emprcodi
      join si_tipoempresa te on emp.tipoemprcodi = te.tipoemprcodi
      join me_ptomedicion pto on eq.equicodi = pto.equicodi
      and (pto.origlectcodi = 6)
    </query>
  </Sql>

  <Sql>
    <key>PR03PuntosPorBarrasCP</key>
    <query>
      select
      *
      from (
      select distinct
      re.areapadre AREACODI,
      tp.tipoemprcodi,
      es.emprcodi, es.emprnomb,
      pt.ptomedicodi, pt.ptomedidesc
      from
      prn_reduccionred rd
      join prn_version vr on rd.prnvercodi = vr.prnvercodi
      and (vr.prnverestado = 'A')
      join pr_grupo gr on rd.prnredbarracp = gr.grupocodi
      join eq_area ar on gr.areacodi = ar.areacodi
      and (ar.tareacodi = 1)
      join eq_arearel re on ar.areacodi = re.areacodi
      join me_ptomedicion pt on rd.prnredbarrapm = pt.grupocodibarra
      and (pt.origlectcodi = 6)
      join si_empresa es on pt.emprcodi = es.emprcodi
      join si_tipoempresa tp on es.tipoemprcodi = tp.tipoemprcodi
      where
      re.areapadre in ({0})
      union all
      select distinct
      re.areapadre AREACODI,
      tp.tipoemprcodi,
      es.emprcodi, es.emprnomb,
      agr.ptomedicodi, agr.ptomedidesc
      from
      prn_reduccionred rd
      join prn_version vr on rd.prnvercodi = vr.prnvercodi
      and (vr.prnverestado = 'A')
      join pr_grupo gr on rd.prnredbarracp = gr.grupocodi
      join eq_area ar on gr.areacodi = ar.areacodi
      and (ar.tareacodi = 1)
      join eq_arearel re on ar.areacodi = re.areacodi
      join me_ptomedicion pt on rd.prnredbarrapm = pt.grupocodibarra
      and (pt.origlectcodi = 33)
      join (
      select
      pto.ptomedicodi AGRUPCODI,
      grp.ptomedicodi,
      pto2.ptomedidesc,
      pto2.emprcodi
      from
      me_ptomedicion pto
      join prn_puntoagrupacion ptogrp on pto.ptomedicodi = ptogrp.ptomedicodi
      and (pto.origlectcodi = 33 and pto.ptomediestado = 'A')
      and (ptogrp.ptogrpfechafin = to_date('31/12/9999', 'DD/MM/YYYY'))
      join prn_agrupacion grp on ptogrp.ptogrpcodi = grp.ptogrpcodi
      join me_ptomedicion pto2 on grp.ptomedicodi = pto2.ptomedicodi
      ) agr on pt.ptomedicodi = agr.agrupcodi
      join si_empresa es on agr.emprcodi = es.emprcodi
      join si_tipoempresa tp on es.tipoemprcodi = tp.tipoemprcodi
      where
      re.areapadre in ({0})
      )
      order by areacodi, emprcodi, ptomedicodi
    </query>
  </Sql>

  <Sql>
    <key>PR03PuntosPorBarrasCPPronosticoDemanda</key>
    <query>
      select
      *
      from (
      select distinct
      re.areapadre AREACODI,
      tp.tipoemprcodi,
      es.emprcodi, es.emprnomb,
      pt.ptomedicodi, pt.ptomedidesc
      from
      prn_reduccionred rd
      join prn_version vr on rd.prnvercodi = vr.prnvercodi
      and (vr.prnverestado = 'A')
      join pr_grupo gr on rd.prnredbarracp = gr.grupocodi
      join eq_area ar on gr.areacodi = ar.areacodi
      and (ar.tareacodi = 1)
      join eq_arearel re on ar.areacodi = re.areacodi
      join me_ptomedicion pt on rd.prnredbarrapm = pt.grupocodibarra
      and (pt.origlectcodi = 6)
      join si_empresa es on pt.emprcodi = es.emprcodi
      join si_tipoempresa tp on es.tipoemprcodi = tp.tipoemprcodi
      where
      re.areapadre in ({0})
      union all
      select distinct
      re.areapadre AREACODI,
      tp.tipoemprcodi,
      es.emprcodi, es.emprnomb,
      agr.ptomedicodi, agr.ptomedidesc
      from
      prn_reduccionred rd
      join prn_version vr on rd.prnvercodi = vr.prnvercodi
      and (vr.prnverestado = 'A')
      join pr_grupo gr on rd.prnredbarracp = gr.grupocodi
      join eq_area ar on gr.areacodi = ar.areacodi
      and (ar.tareacodi = 1)
      join eq_arearel re on ar.areacodi = re.areacodi
      join me_ptomedicion pt on rd.prnredbarrapm = pt.grupocodibarra
      and (pt.origlectcodi = 33)
      join (
      select
      pto.ptomedicodi AGRUPCODI,
      grp.ptomedicodi,
      pto2.ptomedidesc,
      pto2.emprcodi
      from
      me_ptomedicion pto
      join prn_puntoagrupacion ptogrp on pto.ptomedicodi = ptogrp.ptomedicodi
      and (pto.origlectcodi = 33 and pto.ptomediestado = 'A')
      and (ptogrp.ptogrpfechafin = to_date('31/12/9999', 'DD/MM/YYYY'))
      join prn_agrupacion grp on ptogrp.ptogrpcodi = grp.ptogrpcodi
      join me_ptomedicion pto2 on grp.ptomedicodi = pto2.ptomedicodi
      ) agr on pt.ptomedicodi = agr.agrupcodi
      join si_empresa es on agr.emprcodi = es.emprcodi
      join si_tipoempresa tp on es.tipoemprcodi = tp.tipoemprcodi
      where
      re.areapadre in ({0})
      )
      order by areacodi, emprcodi, ptomedicodi
    </query>
  </Sql>

  <!--
  {0} : Prnm48tipo - Identificador del tipo de demanda (Auxiliar)
  {1} : Ptomedicodi - Lista de puntos de medición a buscar
  {2} : Lectcodi - Lectura de una medición enviada por un agente
  {3} : Prnm48tipo - Lista de identificadores del tipo de información a buscar (Depuración Auto y manual)
  {4} : Fecha Inicio - Fecha inicial del rango a buscar
  {5} : Fecha Fin - Fecha final del rango a buscar
  -->
  <Sql>
    <key>GetDemandaPorTipoPorRango</key>
    <query>
      select
      ptomedicodi, medifecha,
      {0} PRNM48TIPO,
      nvl(sum(h1), 0) H1, nvl(sum(h2), 0) H2, 
      nvl(sum(h3), 0) H3, nvl(sum(h4), 0) H4, 
      nvl(sum(h5), 0) H5, nvl(sum(h6), 0) H6, 
      nvl(sum(h7), 0) H7, nvl(sum(h8), 0) H8, 
      nvl(sum(h9), 0) H9, nvl(sum(h10), 0) H10,
      nvl(sum(h11), 0) H11, nvl(sum(h12), 0) H12, 
      nvl(sum(h13), 0) H13, nvl(sum(h14), 0) H14, 
      nvl(sum(h15), 0) H15, nvl(sum(h16), 0) H16, 
      nvl(sum(h17), 0) H17, nvl(sum(h18), 0) H18, 
      nvl(sum(h19), 0) H19, nvl(sum(h20), 0) H20,
      nvl(sum(h21), 0) H21, nvl(sum(h22), 0) H22, 
      nvl(sum(h23), 0) H23, nvl(sum(h24), 0) H24, 
      nvl(sum(h25), 0) H25, nvl(sum(h26), 0) H26, 
      nvl(sum(h27), 0) H27, nvl(sum(h28), 0) H28, 
      nvl(sum(h29), 0) H29, nvl(sum(h30), 0) H30,
      nvl(sum(h31), 0) H31, nvl(sum(h32), 0) H32, 
      nvl(sum(h33), 0) H33, nvl(sum(h34), 0) H34, 
      nvl(sum(h35), 0) H35, nvl(sum(h36), 0) H36, 
      nvl(sum(h37), 0) H37, nvl(sum(h38), 0) H38, 
      nvl(sum(h39), 0) H39, nvl(sum(h40), 0) H40,
      nvl(sum(h41), 0) H41, nvl(sum(h42), 0) H42, 
      nvl(sum(h43), 0) H43, nvl(sum(h44), 0) H44, 
      nvl(sum(h45), 0) H45, nvl(sum(h46), 0) H46, 
      nvl(sum(h47), 0) H47, nvl(sum(h48), 0) H48
      from (
          select
          ptomedicodi, medifecha,
          h1, h2, h3, h4, h5, h6, h7, h8, h9, h10,
          h11, h12, h13, h14, h15, h16, h17, h18, h19, h20,
          h21, h22, h23, h24, h25, h26, h27, h28, h29, h30,
          h31, h32, h33, h34, h35, h36, h37, h38, h39, h40,
          h41, h42, h43, h44, h45, h46, h47, h48
          from
          me_medicion48
          where
          ptomedicodi in ({1}) and
          tipoinfocodi = 1 and
          lectcodi = {2} and
          medifecha between to_date('{4}', 'DD/MM/YYYY') and to_date('{5}', 'DD/MM/YYYY')
          union all
          select
          ptomedicodi, medifecha,
          h1, h2, h3, h4, h5, h6, h7, h8, h9, h10,
          h11, h12, h13, h14, h15, h16, h17, h18, h19, h20,
          h21, h22, h23, h24, h25, h26, h27, h28, h29, h30,
          h31, h32, h33, h34, h35, h36, h37, h38, h39, h40,
          h41, h42, h43, h44, h45, h46, h47, h48
          from
          prn_medicion48
          where
          ptomedicodi in ({1}) and
          prnm48tipo in ({3}) and
          medifecha between to_date('{4}', 'DD/MM/YYYY') and to_date('{5}', 'DD/MM/YYYY')
      ) 
      group by ptomedicodi, medifecha 
      order by ptomedicodi, medifecha
    </query>
  </Sql>
  <Sql>
	  <key>ValidarEjecucionPronosticoPorAreas</key>
	  <query>
		  select count(ptomedicodi) ptomedicodi
		  from
		  prn_medicion48
		  where
		  prnm48tipo = 231 and
		  medifecha = to_date('{0}', 'DD/MM/YYYY')
	  </query>
  </Sql>
</Sqls>