<?xml version="1.0" encoding="utf-8" ?>
<Sqls>

  <Sql>
    <key>GetMaxId</key>
    <query>
      select nvl(max(rcdeulcodi), 0) + 1 from rca_demanda_usuario
    </query>
  </Sql>
  
  <Sql>
    <key>Save</key>
    <query>
      insert into rca_demanda_usuario( rcdeulcodi,rcdeulperiodo,emprcodi,equicodi,rcdeuldemandahp,rcdeuldemandahfp,rcdeulfuente,rcdeulfecmaxdem,osinergcodi,
      rcdeulusucreacion,rcdeulfeccreacion,rcdeulh96,rcdeulh95,rcdeulh94, rcdeulh93,rcdeulh92,rcdeulh91,rcdeulh90,rcdeulh89,rcdeulh88,rcdeulh87,rcdeulh86,rcdeulh85,rcdeulh84,rcdeulh83,
      rcdeulh82,rcdeulh81,rcdeulh80,rcdeulh79,rcdeulh78,rcdeulh77,rcdeulh76,rcdeulh75,rcdeulh74,rcdeulh73,rcdeulh72,rcdeulh71,rcdeulh70,
      rcdeulh69,rcdeulh68,rcdeulh67,rcdeulh66,rcdeulh65,rcdeulh64,rcdeulh63,rcdeulh62,rcdeulh61,rcdeulh60,rcdeulh59,rcdeulh58,rcdeulh57,
      rcdeulh56,rcdeulh55,rcdeulh54,rcdeulh53,rcdeulh52,rcdeulh51,rcdeulh50,rcdeulh49,rcdeulh48,rcdeulh47,rcdeulh46,rcdeulh45,rcdeulh44,
      rcdeulh43,rcdeulh42,rcdeulh41,rcdeulh40,rcdeulh39,rcdeulh38,rcdeulh37,rcdeulh36,rcdeulh35,rcdeulh34,rcdeulh33,rcdeulh32,rcdeulh31,
      rcdeulh30,rcdeulh29,rcdeulh28,rcdeulh27,rcdeulh26,rcdeulh25,rcdeulh24,rcdeulh23,rcdeulh22,rcdeulh21,rcdeulh20,rcdeulh19,rcdeulh18,
      rcdeulh17,rcdeulh16,rcdeulh15,rcdeulh14,rcdeulh13, rcdeulh12,rcdeulh11,rcdeulh10,rcdeulh9,rcdeulh8,rcdeulh7,rcdeulh6,rcdeulh5,
      rcdeulh4,rcdeulh3,rcdeulh2,rcdeulh1 )
      values(
      :rcdeulcodi,
      :rcdeulperiodo,
      :emprcodi,
      :equicodi,
      :rcdeuldemandahp,
      :rcdeuldemandahfp,
      :rcdeulfuente,
      to_date('{0}', 'dd/MM/yyyy'),
      :osinergcodi,
      :rcdeulusucreacion,
      :rcdeulfeccreacion,
      :rcdeulh96,
      :rcdeulh95,
      :rcdeulh94,
      :rcdeulh93,
      :rcdeulh92,
      :rcdeulh91,
      :rcdeulh90,
      :rcdeulh89,
      :rcdeulh88,
      :rcdeulh87,
      :rcdeulh86,
      :rcdeulh85,
      :rcdeulh84,
      :rcdeulh83,
      :rcdeulh82,
      :rcdeulh81,
      :rcdeulh80,
      :rcdeulh79,
      :rcdeulh78,
      :rcdeulh77,
      :rcdeulh76,
      :rcdeulh75,
      :rcdeulh74,
      :rcdeulh73,
      :rcdeulh72,
      :rcdeulh71,
      :rcdeulh70,
      :rcdeulh69,
      :rcdeulh68,
      :rcdeulh67,
      :rcdeulh66,
      :rcdeulh65,
      :rcdeulh64,
      :rcdeulh63,
      :rcdeulh62,
      :rcdeulh61,
      :rcdeulh60,
      :rcdeulh59,
      :rcdeulh58,
      :rcdeulh57,
      :rcdeulh56,
      :rcdeulh55,
      :rcdeulh54,
      :rcdeulh53,
      :rcdeulh52,
      :rcdeulh51,
      :rcdeulh50,
      :rcdeulh49,
      :rcdeulh48,
      :rcdeulh47,
      :rcdeulh46,
      :rcdeulh45,
      :rcdeulh44,
      :rcdeulh43,
      :rcdeulh42,
      :rcdeulh41,
      :rcdeulh40,
      :rcdeulh39,
      :rcdeulh38,
      :rcdeulh37,
      :rcdeulh36,
      :rcdeulh35,
      :rcdeulh34,
      :rcdeulh33,
      :rcdeulh32,
      :rcdeulh31,
      :rcdeulh30,
      :rcdeulh29,
      :rcdeulh28,
      :rcdeulh27,
      :rcdeulh26,
      :rcdeulh25,
      :rcdeulh24,
      :rcdeulh23,
      :rcdeulh22,
      :rcdeulh21,
      :rcdeulh20,
      :rcdeulh19,
      :rcdeulh18,
      :rcdeulh17,
      :rcdeulh16,
      :rcdeulh15,
      :rcdeulh14,
      :rcdeulh13,
      :rcdeulh12,
      :rcdeulh11,
      :rcdeulh10,
      :rcdeulh9,
      :rcdeulh8,
      :rcdeulh7,
      :rcdeulh6,
      :rcdeulh5,
      :rcdeulh4,
      :rcdeulh3,
      :rcdeulh2,
      :rcdeulh1
      )
    </query>
  </Sql>
  
  <Sql>
    <key>Delete</key>
    <query>
      delete from rca_demanda_usuario
      where
      rcdeulperiodo = :rcdeulperiodo 
    </query>
  </Sql>

  <Sql>
    <key>ObtenerListaPeriodoReporte</key>
    <query>
      SELECT  TO_DATE(TO_DATE(RCDEULPERIODO || '01', 'YYYYMMDD'),'dd/mm/yyyy') AS INI_REMISION,
      RCDEULPERIODO  AS PERIODO
      FROM VW_DEMANDA_USUARIO GROUP BY RCDEULPERIODO ORDER BY 1 DESC
    </query>
  </Sql>

  <Sql>
    <key>ObtenerReporteDemandaUsuario</key>
    <query>
      SELECT ext.* FROM (
      SELECT ROWNUM as item, QD.*
      FROM (
      SELECT CP.RCDEULCODI,CP.RCDEULPERIODO,CP.OSINERGCODI
      ,NVL(ES.EMPRRAZSOCIAL,ES.EMPRNOMB) AS SUMINISTRADOR,CL.EMPRRUC AS RUC
      ,NVL(CL.EMPRRAZSOCIAL,CL.EMPRABREV) AS EMPRRAZSOCIAL
      ,AR.AREANOMB AS SUBESTACION, EQ.EQUINOMB
      ,CP.RCDEULDEMANDAHP, CP.RCDEULDEMANDAHFP,AR.AREACODI
      ,RCDEULH1,RCDEULH2,RCDEULH3,RCDEULH4,RCDEULH5,RCDEULH6,RCDEULH7,RCDEULH8,
      RCDEULH9,RCDEULH10,RCDEULH11,RCDEULH12,RCDEULH13,RCDEULH14,RCDEULH15,RCDEULH16,
      RCDEULH17,RCDEULH18,RCDEULH19,RCDEULH20,RCDEULH21,RCDEULH22,RCDEULH23,RCDEULH24,
      RCDEULH25,RCDEULH26,RCDEULH27,RCDEULH28,RCDEULH29,RCDEULH30,RCDEULH31,RCDEULH32,
      RCDEULH33,RCDEULH34,RCDEULH35,RCDEULH36,RCDEULH37,RCDEULH38,RCDEULH39,RCDEULH40,
      RCDEULH41,RCDEULH42,RCDEULH43,RCDEULH44,RCDEULH45,RCDEULH46,RCDEULH47,RCDEULH48,
      RCDEULH49,RCDEULH50,RCDEULH51,RCDEULH52,RCDEULH53,RCDEULH54,RCDEULH55,RCDEULH56,
      RCDEULH57,RCDEULH58,RCDEULH59,RCDEULH60,RCDEULH61,RCDEULH62,RCDEULH63,RCDEULH64,
      RCDEULH65,RCDEULH66,RCDEULH67,RCDEULH68,RCDEULH69,RCDEULH70,RCDEULH71,RCDEULH72,
      RCDEULH73,RCDEULH74,RCDEULH75,RCDEULH76,RCDEULH77,RCDEULH78,RCDEULH79,RCDEULH80,
      RCDEULH81,RCDEULH82,RCDEULH83,RCDEULH84,RCDEULH85,RCDEULH86,RCDEULH87,RCDEULH88,
      RCDEULH89,RCDEULH90,RCDEULH91,RCDEULH92,RCDEULH93,RCDEULH94,RCDEULH95,RCDEULH96
      FROM VW_DEMANDA_USUARIO CP LEFT JOIN SI_EMPRESA ES ON CP.EMPRCODI = ES.EMPRCODI
      LEFT JOIN EQ_EQUIPO EQ ON CP.EQUICODI = EQ.EQUICODI
      LEFT JOIN SI_EMPRESA CL ON EQ.EMPRCODI = CL.EMPRCODI
      LEFT JOIN EQ_AREA AR ON EQ.AREACODI = AR.AREACODI
      {0}
      ORDER BY NVL(CL.EMPRRAZSOCIAL,CL.EMPRABREV)
      )QD
      WHERE ROWNUM &#60;= {1}
      ) ext
      WHERE ext.item >= {2}
    </query>
  </Sql>
  <Sql>
    <key>ObtenerReporteDemandaUsuarioCount</key>
    <query>
      SELECT  NVL(COUNT(CP.RCDEULCODI),0) AS Q_REGISTROS
      FROM VW_DEMANDA_USUARIO CP LEFT JOIN SI_EMPRESA ES ON CP.EMPRCODI = ES.EMPRCODI
      LEFT JOIN EQ_EQUIPO EQ ON CP.EQUICODI = EQ.EQUICODI
      LEFT JOIN SI_EMPRESA CL ON EQ.EMPRCODI = CL.EMPRCODI
      LEFT JOIN EQ_AREA AR ON EQ.AREACODI = AR.AREACODI
      {0}
    </query>
  </Sql>
  <Sql>
    <key>ObtenerEquipos</key>
    <query>
      SELECT eqp.EQUICODI, eqp.EMPRCODI
      , eqp.OSINERGCODI
      FROM EQ_EQUIPO eqp
      WHERE eqp.FAMCODI = 45      
      AND eqp.EQUIESTADO = 'A'
    </query>
  </Sql>

  <Sql>
    <key>ObtenerDemandaUsuarioErroresPag</key>
    <query>
      SELECT ext.* FROM (
      SELECT ROWNUM as item, QD.*
      FROM (
      SELECT * FROM (SELECT CP.RCDEULCODI,CP.RCDEULPERIODO,CP.OSINERGCODI
      ,NVL(ES.EMPRRAZSOCIAL,ES.EMPRNOMB) AS SUMINISTRADOR,CL.EMPRRUC AS RUC
      ,NVL(CL.EMPRRAZSOCIAL,CL.EMPRABREV) AS EMPRRAZSOCIAL
      ,AR.AREANOMB AS SUBESTACION, EQ.EQUINOMB
      ,CP.RCDEULDEMANDAHP, CP.RCDEULDEMANDAHFP,AR.AREACODI
      ,RCDEULH1,RCDEULH2,RCDEULH3,RCDEULH4,RCDEULH5,RCDEULH6,RCDEULH7,RCDEULH8,
      RCDEULH9,RCDEULH10,RCDEULH11,RCDEULH12,RCDEULH13,RCDEULH14,RCDEULH15,RCDEULH16,
      RCDEULH17,RCDEULH18,RCDEULH19,RCDEULH20,RCDEULH21,RCDEULH22,RCDEULH23,RCDEULH24,
      RCDEULH25,RCDEULH26,RCDEULH27,RCDEULH28,RCDEULH29,RCDEULH30,RCDEULH31,RCDEULH32,
      RCDEULH33,RCDEULH34,RCDEULH35,RCDEULH36,RCDEULH37,RCDEULH38,RCDEULH39,RCDEULH40,
      RCDEULH41,RCDEULH42,RCDEULH43,RCDEULH44,RCDEULH45,RCDEULH46,RCDEULH47,RCDEULH48,
      RCDEULH49,RCDEULH50,RCDEULH51,RCDEULH52,RCDEULH53,RCDEULH54,RCDEULH55,RCDEULH56,
      RCDEULH57,RCDEULH58,RCDEULH59,RCDEULH60,RCDEULH61,RCDEULH62,RCDEULH63,RCDEULH64,
      RCDEULH65,RCDEULH66,RCDEULH67,RCDEULH68,RCDEULH69,RCDEULH70,RCDEULH71,RCDEULH72,
      RCDEULH73,RCDEULH74,RCDEULH75,RCDEULH76,RCDEULH77,RCDEULH78,RCDEULH79,RCDEULH80,
      RCDEULH81,RCDEULH82,RCDEULH83,RCDEULH84,RCDEULH85,RCDEULH86,RCDEULH87,RCDEULH88,
      RCDEULH89,RCDEULH90,RCDEULH91,RCDEULH92,RCDEULH93,RCDEULH94,RCDEULH95,RCDEULH96
      FROM VW_DEMANDA_USUARIO CP LEFT JOIN SI_EMPRESA ES ON CP.EMPRCODI = ES.EMPRCODI
      LEFT JOIN EQ_EQUIPO EQ ON CP.EQUICODI = EQ.EQUICODI
      LEFT JOIN SI_EMPRESA CL ON EQ.EMPRCODI = CL.EMPRCODI
      LEFT JOIN EQ_AREA AR ON EQ.AREACODI = AR.AREACODI
      WHERE CP.RCDEULPERIODO =  '{0}'
      ORDER BY NVL(CL.EMPRRAZSOCIAL,CL.EMPRABREV)
      )
      WHERE (SUMINISTRADOR IS NULL OR SUMINISTRADOR='') OR (OSINERGCODI IS NULL OR OSINERGCODI='')
      OR (EMPRRAZSOCIAL IS NULL OR EMPRRAZSOCIAL='') OR (RUC IS NULL OR RUC='')
      )QD
      WHERE ROWNUM &#60;= {1}
      ) ext
      WHERE ext.item >= {2}
    </query>
  </Sql>

  <Sql>
    <key>ObtenerDemandaUsuarioErroresExcel</key>
    <query>
      SELECT * FROM (SELECT CP.RCDEULCODI,CP.RCDEULPERIODO,CP.OSINERGCODI
      ,NVL(ES.EMPRRAZSOCIAL,ES.EMPRNOMB) AS SUMINISTRADOR,CL.EMPRRUC AS RUC
      ,NVL(CL.EMPRRAZSOCIAL,CL.EMPRABREV) AS EMPRRAZSOCIAL
      ,AR.AREANOMB AS SUBESTACION, EQ.EQUINOMB
      ,CP.RCDEULDEMANDAHP, CP.RCDEULDEMANDAHFP,AR.AREACODI
      ,RCDEULH1,RCDEULH2,RCDEULH3,RCDEULH4,RCDEULH5,RCDEULH6,RCDEULH7,RCDEULH8,
      RCDEULH9,RCDEULH10,RCDEULH11,RCDEULH12,RCDEULH13,RCDEULH14,RCDEULH15,RCDEULH16,
      RCDEULH17,RCDEULH18,RCDEULH19,RCDEULH20,RCDEULH21,RCDEULH22,RCDEULH23,RCDEULH24,
      RCDEULH25,RCDEULH26,RCDEULH27,RCDEULH28,RCDEULH29,RCDEULH30,RCDEULH31,RCDEULH32,
      RCDEULH33,RCDEULH34,RCDEULH35,RCDEULH36,RCDEULH37,RCDEULH38,RCDEULH39,RCDEULH40,
      RCDEULH41,RCDEULH42,RCDEULH43,RCDEULH44,RCDEULH45,RCDEULH46,RCDEULH47,RCDEULH48,
      RCDEULH49,RCDEULH50,RCDEULH51,RCDEULH52,RCDEULH53,RCDEULH54,RCDEULH55,RCDEULH56,
      RCDEULH57,RCDEULH58,RCDEULH59,RCDEULH60,RCDEULH61,RCDEULH62,RCDEULH63,RCDEULH64,
      RCDEULH65,RCDEULH66,RCDEULH67,RCDEULH68,RCDEULH69,RCDEULH70,RCDEULH71,RCDEULH72,
      RCDEULH73,RCDEULH74,RCDEULH75,RCDEULH76,RCDEULH77,RCDEULH78,RCDEULH79,RCDEULH80,
      RCDEULH81,RCDEULH82,RCDEULH83,RCDEULH84,RCDEULH85,RCDEULH86,RCDEULH87,RCDEULH88,
      RCDEULH89,RCDEULH90,RCDEULH91,RCDEULH92,RCDEULH93,RCDEULH94,RCDEULH95,RCDEULH96
      FROM VW_DEMANDA_USUARIO CP LEFT JOIN SI_EMPRESA ES ON CP.EMPRCODI = ES.EMPRCODI
      LEFT JOIN EQ_EQUIPO EQ ON CP.EQUICODI = EQ.EQUICODI
      LEFT JOIN SI_EMPRESA CL ON EQ.EMPRCODI = CL.EMPRCODI
      LEFT JOIN EQ_AREA AR ON EQ.AREACODI = AR.AREACODI
      WHERE CP.RCDEULPERIODO =  '{0}'
      ORDER BY NVL(CL.EMPRRAZSOCIAL,CL.EMPRABREV)
      )
      WHERE (SUMINISTRADOR IS NULL OR SUMINISTRADOR='') OR (OSINERGCODI IS NULL OR OSINERGCODI='')
      OR (EMPRRAZSOCIAL IS NULL OR EMPRRAZSOCIAL='') OR (RUC IS NULL OR RUC='')
    </query>
  </Sql>

  <Sql>
    <key>ObtenerReporteDemandaUsuarioExcel</key>
    <query>
      SELECT CP.RCDEULCODI,CP.RCDEULPERIODO,CP.OSINERGCODI
      ,NVL(ES.EMPRRAZSOCIAL,ES.EMPRNOMB) AS SUMINISTRADOR,CL.EMPRRUC AS RUC
      ,NVL(CL.EMPRRAZSOCIAL,CL.EMPRABREV) AS EMPRRAZSOCIAL
      ,AR.AREANOMB AS SUBESTACION, EQ.EQUINOMB
      ,CP.RCDEULDEMANDAHP, CP.RCDEULDEMANDAHFP,AR.AREACODI
      ,RCDEULH1,RCDEULH2,RCDEULH3,RCDEULH4,RCDEULH5,RCDEULH6,RCDEULH7,RCDEULH8,
      RCDEULH9,RCDEULH10,RCDEULH11,RCDEULH12,RCDEULH13,RCDEULH14,RCDEULH15,RCDEULH16,
      RCDEULH17,RCDEULH18,RCDEULH19,RCDEULH20,RCDEULH21,RCDEULH22,RCDEULH23,RCDEULH24,
      RCDEULH25,RCDEULH26,RCDEULH27,RCDEULH28,RCDEULH29,RCDEULH30,RCDEULH31,RCDEULH32,
      RCDEULH33,RCDEULH34,RCDEULH35,RCDEULH36,RCDEULH37,RCDEULH38,RCDEULH39,RCDEULH40,
      RCDEULH41,RCDEULH42,RCDEULH43,RCDEULH44,RCDEULH45,RCDEULH46,RCDEULH47,RCDEULH48,
      RCDEULH49,RCDEULH50,RCDEULH51,RCDEULH52,RCDEULH53,RCDEULH54,RCDEULH55,RCDEULH56,
      RCDEULH57,RCDEULH58,RCDEULH59,RCDEULH60,RCDEULH61,RCDEULH62,RCDEULH63,RCDEULH64,
      RCDEULH65,RCDEULH66,RCDEULH67,RCDEULH68,RCDEULH69,RCDEULH70,RCDEULH71,RCDEULH72,
      RCDEULH73,RCDEULH74,RCDEULH75,RCDEULH76,RCDEULH77,RCDEULH78,RCDEULH79,RCDEULH80,
      RCDEULH81,RCDEULH82,RCDEULH83,RCDEULH84,RCDEULH85,RCDEULH86,RCDEULH87,RCDEULH88,
      RCDEULH89,RCDEULH90,RCDEULH91,RCDEULH92,RCDEULH93,RCDEULH94,RCDEULH95,RCDEULH96
      FROM VW_DEMANDA_USUARIO CP LEFT JOIN SI_EMPRESA ES ON CP.EMPRCODI = ES.EMPRCODI
      LEFT JOIN EQ_EQUIPO EQ ON CP.EQUICODI = EQ.EQUICODI
      LEFT JOIN SI_EMPRESA CL ON EQ.EMPRCODI = CL.EMPRCODI
      LEFT JOIN EQ_AREA AR ON EQ.AREACODI = AR.AREACODI
      {0}
      ORDER BY NVL(CL.EMPRRAZSOCIAL,CL.EMPRABREV)
    </query>
  </Sql>
</Sqls>
