<?xml version="1.0" encoding="utf-8" ?>
<Sqls>

  <Sql>
    <key>GetMaxId</key>
    <query>
      SELECT NVL(MAX(regedcodi), 0) + 1 FROM rer_gercsv_det
    </query>
  </Sql>

  <Sql>
    <key>Save</key>
    <query>
      INSERT INTO rer_gercsv_det
      (
      regedcodi,
      regercodi,

      emprcodi,
      equicodi,
      regedtipcsv,
      regedfecha,

      regedh1,
      regedh2,
      regedh3,
      regedh4,
      regedh5,
      regedh6,
      regedh7,
      regedh8,
      regedh9,
      regedh10,
      regedh11,
      regedh12,
      regedh13,
      regedh14,
      regedh15,
      regedh16,
      regedh17,
      regedh18,
      regedh19,
      regedh20,
      regedh21,
      regedh22,
      regedh23,
      regedh24,
      regedh25,
      regedh26,
      regedh27,
      regedh28,
      regedh29,
      regedh30,
      regedh31,
      regedh32,
      regedh33,
      regedh34,
      regedh35,
      regedh36,
      regedh37,
      regedh38,
      regedh39,
      regedh40,
      regedh41,
      regedh42,
      regedh43,
      regedh44,
      regedh45,
      regedh46,
      regedh47,
      regedh48,
      regedh49,
      regedh50,
      regedh51,
      regedh52,
      regedh53,
      regedh54,
      regedh55,
      regedh56,
      regedh57,
      regedh58,
      regedh59,
      regedh60,
      regedh61,
      regedh62,
      regedh63,
      regedh64,
      regedh65,
      regedh66,
      regedh67,
      regedh68,
      regedh69,
      regedh70,
      regedh71,
      regedh72,
      regedh73,
      regedh74,
      regedh75,
      regedh76,
      regedh77,
      regedh78,
      regedh79,
      regedh80,
      regedh81,
      regedh82,
      regedh83,
      regedh84,
      regedh85,
      regedh86,
      regedh87,
      regedh88,
      regedh89,
      regedh90,
      regedh91,
      regedh92,
      regedh93,
      regedh94,
      regedh95,
      regedh96,
      regedusucreacion,
      regedfeccreacion
      )
      VALUES
      (
      :regedcodi,
      :regercodi,
      
      :emprcodi,
      :equicodi,
      :regedtipcsv,
      :regedfecha,
      
      :regedh1,
      :regedh2,
      :regedh3,
      :regedh4,
      :regedh5,
      :regedh6,
      :regedh7,
      :regedh8,
      :regedh9,
      :regedh10,
      :regedh11,
      :regedh12,
      :regedh13,
      :regedh14,
      :regedh15,
      :regedh16,
      :regedh17,
      :regedh18,
      :regedh19,
      :regedh20,
      :regedh21,
      :regedh22,
      :regedh23,
      :regedh24,
      :regedh25,
      :regedh26,
      :regedh27,
      :regedh28,
      :regedh29,
      :regedh30,
      :regedh31,
      :regedh32,
      :regedh33,
      :regedh34,
      :regedh35,
      :regedh36,
      :regedh37,
      :regedh38,
      :regedh39,
      :regedh40,
      :regedh41,
      :regedh42,
      :regedh43,
      :regedh44,
      :regedh45,
      :regedh46,
      :regedh47,
      :regedh48,
      :regedh49,
      :regedh50,
      :regedh51,
      :regedh52,
      :regedh53,
      :regedh54,
      :regedh55,
      :regedh56,
      :regedh57,
      :regedh58,
      :regedh59,
      :regedh60,
      :regedh61,
      :regedh62,
      :regedh63,
      :regedh64,
      :regedh65,
      :regedh66,
      :regedh67,
      :regedh68,
      :regedh69,
      :regedh70,
      :regedh71,
      :regedh72,
      :regedh73,
      :regedh74,
      :regedh75,
      :regedh76,
      :regedh77,
      :regedh78,
      :regedh79,
      :regedh80,
      :regedh81,
      :regedh82,
      :regedh83,
      :regedh84,
      :regedh85,
      :regedh86,
      :regedh87,
      :regedh88,
      :regedh89,
      :regedh90,
      :regedh91,
      :regedh92,
      :regedh93,
      :regedh94,
      :regedh95,
      :regedh96,
      :regedusucreacion,
      :regedfeccreacion
      )
    </query>
  </Sql>

  <Sql>
    <key>Update</key>
    <query>
      UPDATE rer_gercsv_det
      SET
      regedcodi = :regedcodi,
      regercodi = :regercodi,

      emprcodi = :emprcodi,
      equicodi = :equicodi,
      regedtipcsv = :regedtipcsv,
      regedfecha = :regedfecha,

      regedh1 = :regedh1,
      regedh2 = :regedh2,
      regedh3 = :regedh3,
      regedh4 = :regedh4,
      regedh5 = :regedh5,
      regedh6 = :regedh6,
      regedh7 = :regedh7,
      regedh8 = :regedh8,
      regedh9 = :regedh9,
      regedh10 = :regedh10,
      regedh11 = :regedh11,
      regedh12 = :regedh12,
      regedh13 = :regedh13,
      regedh14 = :regedh14,
      regedh15 = :regedh15,
      regedh16 = :regedh16,
      regedh17 = :regedh17,
      regedh18 = :regedh18,
      regedh19 = :regedh19,
      regedh20 = :regedh20,
      regedh21 = :regedh21,
      regedh22 = :regedh22,
      regedh23 = :regedh23,
      regedh24 = :regedh24,
      regedh25 = :regedh25,
      regedh26 = :regedh26,
      regedh27 = :regedh27,
      regedh28 = :regedh28,
      regedh29 = :regedh29,
      regedh30 = :regedh30,
      regedh31 = :regedh31,
      regedh32 = :regedh32,
      regedh33 = :regedh33,
      regedh34 = :regedh34,
      regedh35 = :regedh35,
      regedh36 = :regedh36,
      regedh37 = :regedh37,
      regedh38 = :regedh38,
      regedh39 = :regedh39,
      regedh40 = :regedh40,
      regedh41 = :regedh41,
      regedh42 = :regedh42,
      regedh43 = :regedh43,
      regedh44 = :regedh44,
      regedh45 = :regedh45,
      regedh46 = :regedh46,
      regedh47 = :regedh47,
      regedh48 = :regedh48,
      regedh49 = :regedh49,
      regedh50 = :regedh50,
      regedh51 = :regedh51,
      regedh52 = :regedh52,
      regedh53 = :regedh53,
      regedh54 = :regedh54,
      regedh55 = :regedh55,
      regedh56 = :regedh56,
      regedh57 = :regedh57,
      regedh58 = :regedh58,
      regedh59 = :regedh59,
      regedh60 = :regedh60,
      regedh61 = :regedh61,
      regedh62 = :regedh62,
      regedh63 = :regedh63,
      regedh64 = :regedh64,
      regedh65 = :regedh65,
      regedh66 = :regedh66,
      regedh67 = :regedh67,
      regedh68 = :regedh68,
      regedh69 = :regedh69,
      regedh70 = :regedh70,
      regedh71 = :regedh71,
      regedh72 = :regedh72,
      regedh73 = :regedh73,
      regedh74 = :regedh74,
      regedh75 = :regedh75,
      regedh76 = :regedh76,
      regedh77 = :regedh77,
      regedh78 = :regedh78,
      regedh79 = :regedh79,
      regedh80 = :regedh80,
      regedh81 = :regedh81,
      regedh82 = :regedh82,
      regedh83 = :regedh83,
      regedh84 = :regedh84,
      regedh85 = :regedh85,
      regedh86 = :regedh86,
      regedh87 = :regedh87,
      regedh88 = :regedh88,
      regedh89 = :regedh89,
      regedh90 = :regedh90,
      regedh91 = :regedh91,
      regedh92 = :regedh92,
      regedh93 = :regedh93,
      regedh94 = :regedh94,
      regedh95 = :regedh95,
      regedh96 = :regedh96,
      regedusucreacion = :regedusucreacion,
      regedfeccreacion = :regedfeccreacion
      WHERE
      regedcodi = :regedcodi
    </query>
  </Sql>

  <Sql>
    <key>Delete</key>
    <query>
      DELETE FROM rer_gercsv_det WHERE regedcodi = :regedcodi
    </query>
  </Sql>

  <Sql>
    <key>List</key>
    <query>
      SELECT
      regedcodi,
      regercodi,
      emprcodi,
      equicodi,
      regedtipcsv,
      regedfecha,
      regedh1,
      regedh2,
      regedh3,
      regedh4,
      regedh5,
      regedh6,
      regedh7,
      regedh8,
      regedh9,
      regedh10,
      regedh11,
      regedh12,
      regedh13,
      regedh14,
      regedh15,
      regedh16,
      regedh17,
      regedh18,
      regedh19,
      regedh20,
      regedh21,
      regedh22,
      regedh23,
      regedh24,
      regedh25,
      regedh26,
      regedh27,
      regedh28,
      regedh29,
      regedh30,
      regedh31,
      regedh32,
      regedh33,
      regedh34,
      regedh35,
      regedh36,
      regedh37,
      regedh38,
      regedh39,
      regedh40,
      regedh41,
      regedh42,
      regedh43,
      regedh44,
      regedh45,
      regedh46,
      regedh47,
      regedh48,
      regedh49,
      regedh50,
      regedh51,
      regedh52,
      regedh53,
      regedh54,
      regedh55,
      regedh56,
      regedh57,
      regedh58,
      regedh59,
      regedh60,
      regedh61,
      regedh62,
      regedh63,
      regedh64,
      regedh65,
      regedh66,
      regedh67,
      regedh68,
      regedh69,
      regedh70,
      regedh71,
      regedh72,
      regedh73,
      regedh74,
      regedh75,
      regedh76,
      regedh77,
      regedh78,
      regedh79,
      regedh80,
      regedh81,
      regedh82,
      regedh83,
      regedh84,
      regedh85,
      regedh86,
      regedh87,
      regedh88,
      regedh89,
      regedh90,
      regedh91,
      regedh92,
      regedh93,
      regedh94,
      regedh95,
      regedh96,
      regedusucreacion,
      regedfeccreacion
      FROM rer_gercsv_det
    </query>
  </Sql>

  <Sql>
    <key>GetById</key>
    <query>
      SELECT
      regedcodi,
      regercodi,
      emprcodi,
      equicodi,
      regedtipcsv,
      regedfecha,
      regedh1,
      regedh2,
      regedh3,
      regedh4,
      regedh5,
      regedh6,
      regedh7,
      regedh8,
      regedh9,
      regedh10,
      regedh11,
      regedh12,
      regedh13,
      regedh14,
      regedh15,
      regedh16,
      regedh17,
      regedh18,
      regedh19,
      regedh20,
      regedh21,
      regedh22,
      regedh23,
      regedh24,
      regedh25,
      regedh26,
      regedh27,
      regedh28,
      regedh29,
      regedh30,
      regedh31,
      regedh32,
      regedh33,
      regedh34,
      regedh35,
      regedh36,
      regedh37,
      regedh38,
      regedh39,
      regedh40,
      regedh41,
      regedh42,
      regedh43,
      regedh44,
      regedh45,
      regedh46,
      regedh47,
      regedh48,
      regedh49,
      regedh50,
      regedh51,
      regedh52,
      regedh53,
      regedh54,
      regedh55,
      regedh56,
      regedh57,
      regedh58,
      regedh59,
      regedh60,
      regedh61,
      regedh62,
      regedh63,
      regedh64,
      regedh65,
      regedh66,
      regedh67,
      regedh68,
      regedh69,
      regedh70,
      regedh71,
      regedh72,
      regedh73,
      regedh74,
      regedh75,
      regedh76,
      regedh77,
      regedh78,
      regedh79,
      regedh80,
      regedh81,
      regedh82,
      regedh83,
      regedh84,
      regedh85,
      regedh86,
      regedh87,
      regedh88,
      regedh89,
      regedh90,
      regedh91,
      regedh92,
      regedh93,
      regedh94,
      regedh95,
      regedh96,
      regedusucreacion,
      regedfeccreacion
      FROM rer_gercsv_det
      WHERE
      regedcodi = :regedcodi
    </query>
  </Sql>

  <Sql>
    <key>GetByCriteria</key>
    <query>
      SELECT
      regedcodi,
      regercodi,
      emprcodi,
      equicodi,
      regedtipcsv,
      regedfecha,
      regedh1,
      regedh2,
      regedh3,
      regedh4,
      regedh5,
      regedh6,
      regedh7,
      regedh8,
      regedh9,
      regedh10,
      regedh11,
      regedh12,
      regedh13,
      regedh14,
      regedh15,
      regedh16,
      regedh17,
      regedh18,
      regedh19,
      regedh20,
      regedh21,
      regedh22,
      regedh23,
      regedh24,
      regedh25,
      regedh26,
      regedh27,
      regedh28,
      regedh29,
      regedh30,
      regedh31,
      regedh32,
      regedh33,
      regedh34,
      regedh35,
      regedh36,
      regedh37,
      regedh38,
      regedh39,
      regedh40,
      regedh41,
      regedh42,
      regedh43,
      regedh44,
      regedh45,
      regedh46,
      regedh47,
      regedh48,
      regedh49,
      regedh50,
      regedh51,
      regedh52,
      regedh53,
      regedh54,
      regedh55,
      regedh56,
      regedh57,
      regedh58,
      regedh59,
      regedh60,
      regedh61,
      regedh62,
      regedh63,
      regedh64,
      regedh65,
      regedh66,
      regedh67,
      regedh68,
      regedh69,
      regedh70,
      regedh71,
      regedh72,
      regedh73,
      regedh74,
      regedh75,
      regedh76,
      regedh77,
      regedh78,
      regedh79,
      regedh80,
      regedh81,
      regedh82,
      regedh83,
      regedh84,
      regedh85,
      regedh86,
      regedh87,
      regedh88,
      regedh89,
      regedh90,
      regedh91,
      regedh92,
      regedh93,
      regedh94,
      regedh95,
      regedh96,
      regedusucreacion,
      regedfeccreacion
      FROM rer_gercsv_det
      where
      (-1 = {0} or regedcodi = {0})
    </query>
  </Sql>
	
  <Sql>
    <key>ListByEmprcodiEquicodiTipo</key>
    <query>
      SELECT rer.*, e.equinomb, se.emprnomb 
	  FROM rer_gercsv_det rer
      inner join si_empresa se on rer.emprcodi = se.emprcodi
	  inner join eq_equipo e on rer.equicodi = e.equicodi
      where
      (-1 = {0} or rer.emprcodi = {0}) and 
	  (-1 = {1} or rer.equicodi = {1}) and 
	  ('-1' = '{2}' or rer.regedtipcsv = '{2}') and 
      (-1 = {3} or
          (
              (EXTRACT(YEAR FROM rer.regedfecha) = {3} AND EXTRACT(MONTH FROM rer.regedfecha) &gt;= 5)
              OR (EXTRACT(YEAR FROM rer.regedfecha) = {3} + 1 AND EXTRACT(MONTH FROM rer.regedfecha) &lt;= 4)
          )
      )
	  order by regedfecha
    </query>
  </Sql>

  <Sql>
    <key>ListByEquipo</key>
    <query>
      SELECT regercodi, emprcodi, equicodi, regedfecha,
      sum(regedh1) as regedh1,
      sum(regedh2) as regedh2,
      sum(regedh3) as regedh3,
      sum(regedh4) as regedh4,
      sum(regedh5) as regedh5,
      sum(regedh6) as regedh6,
      sum(regedh7) as regedh7,
      sum(regedh8) as regedh8,
      sum(regedh9) as regedh9,
      sum(regedh10) as regedh10,
      sum(regedh11) as regedh11,
      sum(regedh12) as regedh12,
      sum(regedh13) as regedh13,
      sum(regedh14) as regedh14,
      sum(regedh15) as regedh15,
      sum(regedh16) as regedh16,
      sum(regedh17) as regedh17,
      sum(regedh18) as regedh18,
      sum(regedh19) as regedh19,
      sum(regedh20) as regedh20,
      sum(regedh21) as regedh21,
      sum(regedh22) as regedh22,
      sum(regedh23) as regedh23,
      sum(regedh24) as regedh24,
      sum(regedh25) as regedh25,
      sum(regedh26) as regedh26,
      sum(regedh27) as regedh27,
      sum(regedh28) as regedh28,
      sum(regedh29) as regedh29,
      sum(regedh30) as regedh30,
      sum(regedh31) as regedh31,
      sum(regedh32) as regedh32,
      sum(regedh33) as regedh33,
      sum(regedh34) as regedh34,
      sum(regedh35) as regedh35,
      sum(regedh36) as regedh36,
      sum(regedh37) as regedh37,
      sum(regedh38) as regedh38,
      sum(regedh39) as regedh39,
      sum(regedh40) as regedh40,
      sum(regedh41) as regedh41,
      sum(regedh42) as regedh42,
      sum(regedh43) as regedh43,
      sum(regedh44) as regedh44,
      sum(regedh45) as regedh45,
      sum(regedh46) as regedh46,
      sum(regedh47) as regedh47,
      sum(regedh48) as regedh48,
      sum(regedh49) as regedh49,
      sum(regedh50) as regedh50,
      sum(regedh51) as regedh51,
      sum(regedh52) as regedh52,
      sum(regedh53) as regedh53,
      sum(regedh54) as regedh54,
      sum(regedh55) as regedh55,
      sum(regedh56) as regedh56,
      sum(regedh57) as regedh57,
      sum(regedh58) as regedh58,
      sum(regedh59) as regedh59,
      sum(regedh60) as regedh60,
      sum(regedh61) as regedh61,
      sum(regedh62) as regedh62,
      sum(regedh63) as regedh63,
      sum(regedh64) as regedh64,
      sum(regedh65) as regedh65,
      sum(regedh66) as regedh66,
      sum(regedh67) as regedh67,
      sum(regedh68) as regedh68,
      sum(regedh69) as regedh69,
      sum(regedh70) as regedh70,
      sum(regedh71) as regedh71,
      sum(regedh72) as regedh72,
      sum(regedh73) as regedh73,
      sum(regedh74) as regedh74,
      sum(regedh75) as regedh75,
      sum(regedh76) as regedh76,
      sum(regedh77) as regedh77,
      sum(regedh78) as regedh78,
      sum(regedh79) as regedh79,
      sum(regedh80) as regedh80,
      sum(regedh81) as regedh81,
      sum(regedh82) as regedh82,
      sum(regedh83) as regedh83,
      sum(regedh84) as regedh84,
      sum(regedh85) as regedh85,
      sum(regedh86) as regedh86,
      sum(regedh87) as regedh87,
      sum(regedh88) as regedh88,
      sum(regedh89) as regedh89,
      sum(regedh90) as regedh90,
      sum(regedh91) as regedh91,
      sum(regedh92) as regedh92,
      sum(regedh93) as regedh93,
      sum(regedh94) as regedh94,
      sum(regedh95) as regedh95,
      sum(regedh96) as regedh96
      FROM rer_gercsv_det
      where equicodi = :equicodi and regedfecha between :regedfecha and :regedfecha
      group by regercodi, emprcodi, equicodi, regedfecha
      order by regedfecha
    </query>
  </Sql>
</Sqls>

