<?xml version="1.0" encoding="utf-8" ?>
<Sqls>

  <Sql>
    <key>GetMaxId</key>
    <query>
      SELECT NVL(MAX(RPECODI), 0) + 1 FROM RNT_REG_PUNTO_ENTREGA
    </query>
  </Sql>


  <Sql>
    <key>Save</key>
    <query>
      INSERT
      INTO
      RNT_REG_PUNTO_ENTREGA
      (
      RPEGRUPOENVIO,
      ENVIOCODI,
      RPECODI,
      RPEEMPGEN,
      RPECLIENTE,
      AREACODI,
      PERDCODI,
      RPENIVELTENSION,
      TIPINTCODI,
      RPEFECHAINICIO,
      RPEFECHAFIN,
      RPECOMPENSACION,
      RPECAUSAINTERRUPCION,
      RPETRAMFUERMAYOR,
      RPEESTADO,
      RPEUSUARIOCREACION,
      RPEFECHACREACION,
      RPENIVELTENSIONDESC,
      RPETIPOINTDESC,
      RPENI,
      RPEKI,
      RPEENERGSEM,
      RPEPRGFECHAINICIO,
      RPEPRGFECHAFIN,
      RPEEIE,
      BARRCODI,
      RPEINCREMENTO
      )
      VALUES
      (
      :RPEGRUPOENVIO,
      :ENVIOCODI,
      :RPECODI,
      :RPEEMPGEN,
      :RPECLIENTE,
      :AREACODI,
      :PERDCODI,
      :RPENIVELTENSION,
      :TIPINTCODI,
      :RPEFECHAINICIO,
      :RPEFECHAFIN,
      :RPECOMPENSACION,
      :RPECAUSAINTERRUPCION,
      :RPETRAMFUERMAYOR,
      :RPEESTADO,
      :RPEUSUARIOCREACION,
      sysdate,
      :RPENIVELTENSIONDESC,
      :RPETIPOINTDESC,
      :RPENI,
      :RPEKI,
      :RPEENERGSEM,
      :RPEPRGFECHAINICIO,
      :RPEPRGFECHAFIN,
      :RPEEIE,
      :BARRCODI,
      :RPEINCREMENTO
      )
    </query>
  </Sql>

  <Sql>
    <key>Update</key>
    <query>
      UPDATE RNT_REG_PUNTO_ENTREGA
      SET
      RPEESTADO = :RPEESTADO
      WHERE
      RPEEMPGEN = :RPEEMPGEN AND
      PERDCODI = :PERDCODI
    </query>
  </Sql>

  <Sql>
    <key>Delete</key>
    <query>
      UPDATE RNT_REG_PUNTO_ENTREGA SET RPEESTADO=2 WHERE RPECODI = :RPECODI
    </query>
  </Sql>

  <Sql>
    <key>GetById</key>
    <query>
      SELECT
      RPE.RpeGrupoEnvio,
      Enviocodi,
      RPE.RpeEnergSem,
      RPE.RpeIncremento,
      RPE.RpeNi,
      RPE.RpeKi,
      RPE.RpePrgFechaInicio,
      RPE.RpePrgFechaFin,
      RPE.RpeEiE,
      RPE.Barrcodi,
      RPE.RPENIVELTENSION,
      RPE.RPEFECHAINICIO,
      RPE.RPEFECHAFIN,
      RPE.RPECOMPENSACION,
      RPE.RPECAUSAINTERRUPCION,
      RPE.RPETRAMFUERMAYOR,
      RPE.RPEESTADO,
      RPE.RPEUSUARIOCREACION,
      RPE.RPEFECHACREACION,
      RPE.RPEUSUARIOUPDATE,
      RPE.RPEFECHAUPDATE,
      RPE.RPECODI,
      RPE.AREACODI,
      (SELECT AREANOMB FROM EQ_AREA WHERE RPE.AREACODI=AREACODI ) AS AREANOMB,
      RPE.PERDCODI,
      RPE.TIPINTCODI,
      (SELECT TIPINTNOMBRE FROM RNT_TIPO_INTERRUPCION WHERE RPE.TIPINTCODI=TIPINTCODI ) AS TIPOINTNOMBRE,
      RPE.RPEEMPGEN,
      (SELECT EMPRNOMB FROM SI_EMPRESA WHERE RPE.RPEEMPGEN=EMPRCODI) AS RPEEMPRGENNOMBRE,
      RPE.RPECLIENTE,
      (SELECT EMPRNOMB FROM SI_EMPRESA WHERE RPE.RPECLIENTE=EMPRCODI ) AS RPECLIENTENOMBRE
      FROM
      RNT_REG_PUNTO_ENTREGA RPE
      WHERE
      RPECODI = :RPECODI
    </query>
  </Sql>

  <Sql>
    <key>ListPaginado</key>
    <query>
      SELECT * FROM(
      SELECT
      RPE.RpeGrupoEnvio,
      Enviocodi,
      RPE.RpeEnergSem,
      RPE.RpeIncremento,
      RPE.RpeNi,
      RPE.RpeKi,
      RPE.RpePrgFechaInicio,
      RPE.RpePrgFechaFin,
      RPE.RpeEiE,
      RPE.Barrcodi,
      (SELECT BARRNOMBRE FROM TRN_BARRA TRN WHERE TRN.BARRCODI=RPE.BARRCODI ) AS BARRNOMBRE,
      RPE.RpeNivelTensionDesc,
      RPE.RPENIVELTENSION,
      RPE.RPEFECHAINICIO,
      RPE.RPEFECHAFIN,
      RPE.RPECOMPENSACION,
      RPE.RPECAUSAINTERRUPCION,
      RPE.RPETRAMFUERMAYOR,
      RPE.RPEESTADO,
      RPE.RPEUSUARIOCREACION,
      RPE.RPEFECHACREACION,
      RPE.RPEUSUARIOUPDATE,
      RPE.RPEFECHAUPDATE,
      RPE.RPECODI,
      RPE.RPEGRUPOENVIO AS AREACODI,
      (SELECT AREANOMB FROM EQ_AREA WHERE RPE.AREACODI=AREACODI ) AS AREANOMB,
      RPE.PERDCODI,
      RPE.TIPINTCODI,
      (SELECT TIPINTNOMBRE FROM RNT_TIPO_INTERRUPCION WHERE RPE.TIPINTCODI=TIPINTCODI ) AS TIPOINTNOMBRE,
      RPE.RPEEMPGEN,
      (SELECT EMPRNOMB FROM SI_EMPRESA WHERE RPE.RPEEMPGEN=EMPRCODI) AS RPEEMPRGENNOMBRE,
      RPE.RPECLIENTE,
      (SELECT EMPRNOMB FROM SI_EMPRESA WHERE RPE.RPECLIENTE=EMPRCODI ) AS RPECLIENTENOMBRE,
      (row_number() over (order by RPE.RPECODI desc)) as r
      FROM
      RNT_REG_PUNTO_ENTREGA RPE
      INNER JOIN RNT_PERIODO PER ON PER.PERDCODI=RPE.PERDCODI
      WHERE PER.PERDESTADO NOT IN('1','2') AND
      RPE.RPEESTADO NOT IN(1,2) AND
      RPE.RPEEMPGEN = DECODE(:RPEEMPGEN, 0, RPE.RPEEMPGEN,:RPEEMPGEN) AND
      RPE.PERDCODI = DECODE(:PERDCODI, 0,RPE.PERDCODI,:PERDCODI) AND
      RPE.RPECLIENTE = DECODE(:RPECLIENTE, 0,RPE.RPECLIENTE,:RPECLIENTE) AND
      RPE.Barrcodi = DECODE(:Barrcodi, 0,RPE.Barrcodi,:Barrcodi)
      ORDER BY RPEEMPRGENNOMBRE,RPECLIENTENOMBRE,AREANOMB,RPE.RPENIVELTENSION,RPE.TIPINTCODI,RPE.RPEFECHAINICIO ASC
      )
      where r >= (((:PageNumber-1) * :PageSize) + 1) and r &lt; ((:PageNumber * :PageSize) + 1 )
    </query>
  </Sql>

  <Sql>
    <key>List</key>
    <query>
      SELECT
      RPE.RpeGrupoEnvio,
      Enviocodi,
      RPE.RpeEnergSem,
      RPE.RpeIncremento,
      RPE.RpeNi,
      RPE.RpeKi,
      RPE.RpePrgFechaInicio,
      RPE.RpePrgFechaFin,
      RPE.RpeEiE,
      RPE.Barrcodi,
      (SELECT BARRNOMBRE FROM TRN_BARRA TRN WHERE TRN.BARRCODI=RPE.BARRCODI ) AS BARRNOMBRE,
      RPE.RpeNivelTensionDesc,
      RPE.RPENIVELTENSION,
      RPE.RPEFECHAINICIO,
      RPE.RPEFECHAFIN,
      RPE.RPECOMPENSACION,
      RPE.RPECAUSAINTERRUPCION,
      RPE.RPETRAMFUERMAYOR,
      RPE.RPEESTADO,
      RPE.RPEUSUARIOCREACION,
      RPE.RPEFECHACREACION,
      RPE.RPEUSUARIOUPDATE,
      RPE.RPEFECHAUPDATE,
      RPE.RPECODI,
      RPE.RPEGRUPOENVIO AS AREACODI,
      (SELECT AREANOMB FROM EQ_AREA WHERE RPE.AREACODI=AREACODI ) AS AREANOMB,
      RPE.PERDCODI,
      RPE.TIPINTCODI,
      (SELECT TIPINTNOMBRE FROM RNT_TIPO_INTERRUPCION WHERE RPE.TIPINTCODI=TIPINTCODI ) AS TIPOINTNOMBRE,
      RPE.RPEEMPGEN,
      (SELECT EMPRNOMB FROM SI_EMPRESA WHERE RPE.RPEEMPGEN=EMPRCODI) AS RPEEMPRGENNOMBRE,
      RPE.RPECLIENTE,
      (SELECT EMPRNOMB FROM SI_EMPRESA WHERE RPE.RPECLIENTE=EMPRCODI ) AS RPECLIENTENOMBRE,
      (row_number() over (order by RPE.RPECODI desc)) as r
      FROM
      RNT_REG_PUNTO_ENTREGA RPE
      INNER JOIN RNT_PERIODO PER ON PER.PERDCODI=RPE.PERDCODI
      WHERE PER.PERDESTADO NOT IN('1','2') AND
      RPE.RPEESTADO NOT IN(1,2) AND
      RPE.RPEEMPGEN = DECODE(:RPEEMPGEN, 0, RPE.RPEEMPGEN,:RPEEMPGEN) AND
      RPE.PERDCODI = DECODE(:PERDCODI, 0,RPE.PERDCODI,:PERDCODI) AND
      RPE.RPECLIENTE = DECODE(:RPECLIENTE, 0,RPE.RPECLIENTE,:RPECLIENTE) AND
      RPE.BARRCODI = DECODE(:BARRCODI, 0,RPE.BARRCODI,:BARRCODI)
      ORDER BY RPEEMPRGENNOMBRE,RPECLIENTENOMBRE,AREANOMB,RPE.RPENIVELTENSION,RPE.TIPINTCODI,RPE.RPEFECHAINICIO ASC
    </query>
  </Sql>

  <Sql>
    <key>ListReporteCarga</key>
    <query>
      SELECT
      distinct SIENV.Enviocodi,
      RPE.RPEUSUARIOCREACION,
      SIENV.ENVIOFECHA  as RPEFECHACREACION,
      RPE.PERDCODI,
      RPE.RPEEMPGEN,
      rpe.areacodi,
      sie.EMPRNOMB AS RPEEMPRGENNOMBRE
      FROM   RNT_REG_PUNTO_ENTREGA RPE, RNT_PERIODO PER, SI_EMPRESA SIE, ME_ENVIO SIENV
      WHERE
      PER.PERDCODI=RPE.PERDCODI AND
      RPE.RPEEMPGEN = SIE.EMPRCODI AND
      RPE.ENVIOCODI = SIENV.ENVIOCODI AND
      RPE.RPEEMPGEN =  DECODE(:RPEEMPGEN, 0,RPE.RPEEMPGEN,:RPEEMPGEN) AND
      RPE.PERDCODI = DECODE(:PERDCODI, 0,RPE.PERDCODI,:PERDCODI) AND
      AREACODI = DECODE(:AREACODI, 0,AREACODI,:AREACODI) AND
      SIENV.Enviocodi =  DECODE(:Enviocodi, 0,SIENV.ENVIOCODI,:Enviocodi)
      ORDER BY SIENV.ENVIOFECHA DESC

    </query>
  </Sql>

  <Sql>
    <key>ListReporteGrilla</key>
    <query>
      SELECT
      RPE.RpegrupoEnvio,
      RPE.RpeNivelTensionDesc,
      Enviocodi,
      RPE.RpeIncremento,
      RPE.RpeEnergSem,
      RPE.RpeNi,
      RPE.RpeKi,
      (SELECT BARRNOMBRE FROM TRN_BARRA TRN WHERE TRN.BARRCODI=RPE.BARRCODI ) AS BARRNOMBRE,
      RPE.RpePrgFechaInicio,
      RPE.RpePrgFechaFin,
      RPE.RpeEiE,
      RPE.Barrcodi,
      RPE.RPENIVELTENSION,
      RPE.RPEFECHAINICIO,
      RPE.RPEFECHAFIN,
      RPE.RPECOMPENSACION,
      RPE.RPECAUSAINTERRUPCION,
      RPE.RPETRAMFUERMAYOR,
      RPE.RPEESTADO,
      RPE.RPEUSUARIOCREACION,
      RPE.RPEFECHACREACION,
      RPE.RPEUSUARIOUPDATE,
      RPE.RPEFECHAUPDATE,
      RPE.RPECODI,
      RPE.AREACODI,
      (SELECT AREANOMB FROM EQ_AREA WHERE RPE.AREACODI=AREACODI ) AS AREANOMB,
      RPE.PERDCODI,
      RPE.TIPINTCODI,
      (SELECT TIPINTNOMBRE FROM RNT_TIPO_INTERRUPCION WHERE RPE.TIPINTCODI=TIPINTCODI ) AS TIPOINTNOMBRE,
      RPE.RPEEMPGEN,
      (SELECT EMPRNOMB FROM SI_EMPRESA WHERE RPE.RPEEMPGEN=EMPRCODI) AS RPEEMPRGENNOMBRE,
      RPE.RPECLIENTE,
      (SELECT EMPRNOMB FROM SI_EMPRESA WHERE RPE.RPECLIENTE=EMPRCODI ) AS RPECLIENTENOMBRE,
      (row_number() over (order by RPE.RPECODI desc)) as r
      FROM
      RNT_REG_PUNTO_ENTREGA RPE
      INNER JOIN RNT_PERIODO PER ON PER.PERDCODI=RPE.PERDCODI
      WHERE
      RPE.ENVIOCODI = :ENVIOCODI
      ORDER BY RpegrupoEnvio asc, RPE.RPEFECHAINICIO, RPE.RpePrgFechaInicio
    </query>
  </Sql>


  <Sql>
    <key>ListBarras</key>
    <query>
      SELECT
      BARRCODI,
      BARRNOMBRE
      FROM
      TRN_BARRA
      WHERE BARRESTADO = 'ACT' and UPPER(BARRNOMBRE) = UPPER(:BARRNOMBRE)
      ORDER BY BARRNOMBRE
    </query>
  </Sql>

  <Sql>
    <key>ListAllBarras</key>
    <query>
      SELECT
      BARRCODI,
      BARRNOMBRE
      FROM
      TRN_BARRA
      WHERE BARRESTADO = 'ACT'
      ORDER BY BARRNOMBRE
    </query>
  </Sql>


  <Sql>
    <key>ListReportePaginado</key>
    <query>
      SELECT * FROM(
      SELECT
      RPE.RpeGrupoEnvio,
      Enviocodi,
      RPE.RpeEnergSem,
      RPE.RpeIncremento,
      RPE.RpeNi,
      RPE.RpeKi,
      RPE.RpePrgFechaInicio,
      RPE.RpePrgFechaFin,
      RPE.RpeEiE,
      RPE.Barrcodi,
      (SELECT BARRNOMBRE FROM TRN_BARRA TRN WHERE TRN.BARRCODI=RPE.BARRCODI ) AS BARRNOMBRE,
      RPE.RpeNivelTensionDesc,
      RPE.RPENIVELTENSION,
      RPE.RPEFECHAINICIO,
      RPE.RPEFECHAFIN,
      RPE.RPECOMPENSACION,
      RPE.RPECAUSAINTERRUPCION,
      RPE.RPETRAMFUERMAYOR,
      RPE.RPEESTADO,
      RPE.RPEUSUARIOCREACION,
      RPE.RPEFECHACREACION,
      RPE.RPEUSUARIOUPDATE,
      RPE.RPEFECHAUPDATE,
      RPE.RPECODI,
      RPE.RPEGRUPOENVIO AS AREACODI,
      (SELECT AREANOMB FROM EQ_AREA WHERE RPE.AREACODI=AREACODI ) AS AREANOMB,
      RPE.PERDCODI,
      RPE.TIPINTCODI,
      (SELECT TIPINTNOMBRE FROM RNT_TIPO_INTERRUPCION WHERE RPE.TIPINTCODI=TIPINTCODI ) AS TIPOINTNOMBRE,
      RPE.RPEEMPGEN,
      (SELECT EMPRNOMB FROM SI_EMPRESA WHERE RPE.RPEEMPGEN=EMPRCODI) AS RPEEMPRGENNOMBRE,
      RPE.RPECLIENTE,
      (SELECT EMPRNOMB FROM SI_EMPRESA WHERE RPE.RPECLIENTE=EMPRCODI ) AS RPECLIENTENOMBRE,
      (row_number() over (order by RPE.RPECODI desc)) as r
      FROM
      RNT_REG_PUNTO_ENTREGA RPE
      WHERE RPE.RPEEMPGEN = DECODE(:RPEEMPGEN, 0,RPE.RPEEMPGEN,:RPEEMPGEN) AND
      RPE.RPEESTADO NOT IN (1,2) AND
      RPE.PERDCODI = DECODE(:PERDCODI, 0,RPE.PERDCODI,:PERDCODI) AND
      RPE.RPECLIENTE = DECODE(:RPECLIENTE, 0,RPE.RPECLIENTE,:RPECLIENTE) AND
      RPE.BARRCODI = DECODE(:BARRCODI, 0,RPE.BARRCODI,:BARRCODI)
      ORDER BY RPE.TIPINTCODI
      )
      where r >= (((:PageNumber-1) * :PageSize) + 1) and r &lt; ((:PageNumber * :PageSize) + 1 )
    </query>
  </Sql>

  <Sql>
    <key>ListReporte</key>
    <query>
      SELECT
      RPE.RpeGrupoEnvio,
      Enviocodi,
      RPE.RpeEnergSem,
      RPE.RpeIncremento,
      RPE.RpeNi,
      RPE.RpeKi,
      RPE.RpePrgFechaInicio,
      RPE.RpePrgFechaFin,
      RPE.RpeEiE,
      RPE.Barrcodi,
      (SELECT BARRNOMBRE FROM TRN_BARRA TRN WHERE TRN.BARRCODI=RPE.BARRCODI ) AS BARRNOMBRE,
      RPE.RpeNivelTensionDesc,
      RPE.RPENIVELTENSION,
      RPE.RPEFECHAINICIO,
      RPE.RPEFECHAFIN,
      RPE.RPECOMPENSACION,
      RPE.RPECAUSAINTERRUPCION,
      RPE.RPETRAMFUERMAYOR,
      RPE.RPEESTADO,
      RPE.RPEUSUARIOCREACION,
      RPE.RPEFECHACREACION,
      RPE.RPEUSUARIOUPDATE,
      RPE.RPEFECHAUPDATE,
      RPE.RPECODI,
      RPE.RPEGRUPOENVIO AS AREACODI,
      (SELECT AREANOMB FROM EQ_AREA WHERE RPE.AREACODI=AREACODI ) AS AREANOMB,
      RPE.PERDCODI,
      RPE.TIPINTCODI,
      (SELECT TIPINTNOMBRE FROM RNT_TIPO_INTERRUPCION WHERE RPE.TIPINTCODI=TIPINTCODI ) AS TIPOINTNOMBRE,
      RPE.RPEEMPGEN,
      (SELECT EMPRNOMB FROM SI_EMPRESA WHERE RPE.RPEEMPGEN=EMPRCODI) AS RPEEMPRGENNOMBRE,
      RPE.RPECLIENTE,
      (SELECT EMPRNOMB FROM SI_EMPRESA WHERE RPE.RPECLIENTE=EMPRCODI ) AS RPECLIENTENOMBRE,
      (row_number() over (order by RPE.RPECODI desc)) as r
      FROM
      RNT_REG_PUNTO_ENTREGA RPE
      WHERE RPE.RPEEMPGEN = DECODE(:RPEEMPGEN, 0,RPE.RPEEMPGEN,:RPEEMPGEN) AND
      RPE.RPEESTADO NOT IN (1,2) AND
      RPE.PERDCODI = DECODE(:PERDCODI, 0,RPE.PERDCODI,:PERDCODI) AND
      RPE.RPECLIENTE = DECODE(:RPECLIENTE, 0,RPE.RPECLIENTE,:RPECLIENTE) AND
      RPE.BARRCODI = DECODE(:BARRCODI, 0,RPE.BARRCODI,:BARRCODI)
      ORDER BY RPE.TIPINTCODI
    </query>
  </Sql>
  <Sql>
    <key>GetByCriteriaPaginado</key>
    <query>
      SELECT * FROM(
      SELECT
      RPE.RpeNivelTensionDesc,
      (SELECT BARRNOMBRE FROM TRN_BARRA TRN WHERE TRN.BARRCODI=RPE.BARRCODI ) AS BARRNOMBRE,
      RPE.RPENIVELTENSION,
      RPE.RPEFECHAINICIO,
      RPE.RPEFECHAFIN,
      RPE.RPECOMPENSACION,
      RPE.RPECAUSAINTERRUPCION,
      RPE.RPETRAMFUERMAYOR,
      RPE.RPEESTADO,
      RPE.RPEUSUARIOCREACION,
      RPE.RPEFECHACREACION,
      RPE.RPEUSUARIOUPDATE,
      RPE.RPEFECHAUPDATE,
      RPE.RPECODI,
      RPE.AREACODI,
      (SELECT AREANOMB FROM EQ_AREA WHERE RPE.AREACODI=AREACODI ) AS AREANOMB,
      RPE.PERDCODI,
      RPE.TIPINTCODI,
      (SELECT TIPINTNOMBRE FROM RNT_TIPO_INTERRUPCION WHERE RPE.TIPINTCODI=TIPINTCODI ) AS TIPOINTNOMBRE,
      RPE.RPEEMPGEN,
      (SELECT EMPRNOMB FROM SI_EMPRESA WHERE RPE.RPEEMPGEN=EMPRCODI) AS RPEEMPRGENNOMBRE,
      RPE.RPECLIENTE,
      (SELECT EMPRNOMB FROM SI_EMPRESA WHERE RPE.RPECLIENTE=EMPRCODI ) AS RPECLIENTENOMBRE,
      (row_number() over (order by RPE.RPECODI desc)) as r
      FROM
      RNT_REG_PUNTO_ENTREGA RPE
      WHERE RPE.RPEUSUARIOCREACION LIKE DECODE(:RPEUSUARIOCREACION, '0','%',:RPEUSUARIOCREACION) AND RPE.RPEEMPGEN LIKE DECODE(:RPEEMPGEN, 0,'%',:RPEEMPGEN) AND RPE.PERDCODI LIKE DECODE(:PERDCODI, 0,'%',:PERDCODI) AND RPE.RPECLIENTE LIKE DECODE(:RPECLIENTE, 0,'%',:RPECLIENTE) AND RPE.AREACODI LIKE DECODE(:AREACODI, 0,'%',:AREACODI) AND RPENIVELTENSION LIKE DECODE(:RPENIVELTENSION, 0,'%',:RPENIVELTENSION) AND RPE.RPEFECHAINICIO>=:RPEFECHAINICIO
      ORDER BY RPE.RPECODI ASC
      )
      where r >= (((:PageNumber-1) * :PageSize) + 1) and r &lt; ((:PageNumber * :PageSize) + 1 )
    </query>
  </Sql>
  <Sql>
    <key>GetByCriteria</key>
    <query>
      SELECT
      RPE.RpeNivelTensionDesc,
      (SELECT BARRNOMBRE FROM TRN_BARRA TRN WHERE TRN.BARRCODI=RPE.BARRCODI ) AS BARRNOMBRE,
      RPE.RPENIVELTENSION,
      RPE.RPEFECHAINICIO,
      RPE.RPEFECHAFIN,
      RPE.RPECOMPENSACION,
      RPE.RPECAUSAINTERRUPCION,
      RPE.RPETRAMFUERMAYOR,
      RPE.RPEESTADO,
      RPE.RPEUSUARIOCREACION,
      RPE.RPEFECHACREACION,
      RPE.RPEUSUARIOUPDATE,
      RPE.RPEFECHAUPDATE,
      RPE.RPECODI,
      RPE.AREACODI,
      (SELECT AREANOMB FROM EQ_AREA WHERE RPE.AREACODI=AREACODI ) AS AREANOMB,
      RPE.PERDCODI,
      RPE.TIPINTCODI,
      (SELECT TIPINTNOMBRE FROM RNT_TIPO_INTERRUPCION WHERE RPE.TIPINTCODI=TIPINTCODI ) AS TIPOINTNOMBRE,
      RPE.RPEEMPGEN,
      (SELECT EMPRNOMB FROM SI_EMPRESA WHERE RPE.RPEEMPGEN=EMPRCODI) AS RPEEMPRGENNOMBRE,
      RPE.RPECLIENTE,
      (SELECT EMPRNOMB FROM SI_EMPRESA WHERE RPE.RPECLIENTE=EMPRCODI ) AS RPECLIENTENOMBRE
      FROM
      RNT_REG_PUNTO_ENTREGA RPE
      WHERE RPE.RPEUSUARIOCREACION LIKE DECODE(:RPEUSUARIOCREACION, '0','%',:RPEUSUARIOCREACION) AND RPE.RPEEMPGEN LIKE DECODE(:RPEEMPGEN, 0,'%',:RPEEMPGEN) AND RPE.PERDCODI LIKE DECODE(:PERDCODI, 0,'%',:PERDCODI) AND RPE.RPECLIENTE LIKE DECODE(:RPECLIENTE, 0,'%',:RPECLIENTE) AND RPE.AREACODI LIKE DECODE(:AREACODI, 0,'%',:AREACODI) AND RPENIVELTENSION LIKE DECODE(:RPENIVELTENSION, 0,'%',:RPENIVELTENSION) AND RPE.RPEFECHAINICIO>=:RPEFECHAINICIO
      ORDER BY RPE.RPECODI ASC
    </query>
  </Sql>
  <Sql>
    <key>ListAuditoriaPuntoEntrega</key>
    <query>
      SELECT
      RPE.RpeNivelTensionDesc,
      (SELECT BARRNOMBRE FROM TRN_BARRA TRN WHERE TRN.BARRCODI=RPE.BARRCODI ) AS BARRNOMBRE,
      XMLTYPE(AUDITREGDET).EXTRACT('//Auditoria/RPECODI/text()').GETSTRINGVAL() AS RPECODI,
      XMLTYPE(AUDITREGDET).EXTRACT('//Auditoria/RPEEMPGEN/text()').GETSTRINGVAL() AS RPEEMPGEN,
      (SELECT EMPRNOMB FROM SI_EMPRESA WHERE EMPRCODI=XMLTYPE(AUDITREGDET).EXTRACT('//Auditoria/RPEEMPGEN/text()').GETSTRINGVAL()) AS RPEEMPRGENNOMBRE,
      XMLTYPE(AUDITREGDET).EXTRACT('//Auditoria/RPECLIENTE/text()').GETSTRINGVAL() AS RPECLIENTE,
      (SELECT EMPRNOMB FROM SI_EMPRESA WHERE EMPRCODI=XMLTYPE(AUDITREGDET).EXTRACT('//Auditoria/RPECLIENTE/text()').GETSTRINGVAL()) AS RPECLIENTENOMBRE,
      XMLTYPE(AUDITREGDET).EXTRACT('//Auditoria/AREACODI/text()').GETSTRINGVAL() AS AREACODI,
      (SELECT AREANOMB FROM EQ_AREA WHERE AREACODI=XMLTYPE(AUDITREGDET).EXTRACT('//Auditoria/AREACODI/text()').GETSTRINGVAL() ) AS AREANOMB,
      XMLTYPE(AUDITREGDET).EXTRACT('//Auditoria/PERDCODI/text()').GETSTRINGVAL() AS PERDCODI,
      XMLTYPE(AUDITREGDET).EXTRACT('//Auditoria/TIPINTCODI/text()').GETSTRINGVAL() AS TIPINTCODI,
      (SELECT TIPINTNOMBRE FROM RNT_TIPO_INTERRUPCION WHERE TIPINTCODI=XMLTYPE(AUDITREGDET).EXTRACT('//Auditoria/TIPINTCODI/text()').GETSTRINGVAL()) AS TIPOINTNOMBRE,
      XMLTYPE(AUDITREGDET).EXTRACT('//Auditoria/RPENIVELTENSION/text()').GETSTRINGVAL() AS RPENIVELTENSION,
      XMLTYPE(AUDITREGDET).EXTRACT('//Auditoria/RPEFECHAINICIO/text()').GETSTRINGVAL() AS RPEFECHAINICIO,
      XMLTYPE(AUDITREGDET).EXTRACT('//Auditoria/RPEFECHAFIN/text()').GETSTRINGVAL() AS RPEFECHAFIN,
      XMLTYPE(AUDITREGDET).EXTRACT('//Auditoria/RPECOMPENSACION/text()').GETSTRINGVAL() AS RPECOMPENSACION,
      XMLTYPE(AUDITREGDET).EXTRACT('//Auditoria/RPECAUSAINTERRUPCION/text()').GETSTRINGVAL() AS RPECAUSAINTERRUPCION,
      XMLTYPE(AUDITREGDET).EXTRACT('//Auditoria/RPETRAMFUERMAYOR/text()').GETSTRINGVAL() AS RPETRAMFUERMAYOR,
      XMLTYPE(AUDITREGDET).EXTRACT('//Auditoria/RPEESTADO/text()').GETSTRINGVAL() AS RPEESTADO,
      AUDITUSUARIOCREACION AS RPEUSUARIOCREACION,
      AUDITFECHACREACION AS RPEFECHACREACION,
      XMLTYPE(AUDITREGDET).EXTRACT('//Auditoria/ACCION/text()').GETSTRINGVAL() AS RPEUSUARIOUPDATE,
      AUDITFECHAUPDATE AS RPEFECHAUPDATE
      FROM SI_AUDITORIA_REGISTRO WHERE AUDITTABLACODI=:AUDITTABLACODI AND TAUDITCODI=:TAUDITCODI ORDER BY AUDITFECHACREACION ASC
    </query>
  </Sql>

  <Sql>
    <key>ListAllPuntoEntrega</key>
    <query>
      select DISTINCT RN.BARRCODI, TB.BARRNOMBRE from
      RNT_REG_PUNTO_ENTREGA rn , TRN_BARRA tb
      where
      RN.BARRCODI = TB.BARRCODI
    </query>
  </Sql>

  <Sql>
    <key>ListAllClientePE</key>
    <query>
      select DISTINCT pe.RPECLIENTE, SI.EMPRNOMB as RPECLIENTENOMBRE from RNT_REG_PUNTO_ENTREGA pe, SI_EMPRESA si where
      PE.RPECLIENTE = SI.EMPRCODI
    </query>
  </Sql>

  <Sql>
    <key>ListChangeClientePE</key>
    <query>
      select DISTINCT pe.BARRCODI, TB.BARRNOMBRE from
      RNT_REG_PUNTO_ENTREGA pe , TRN_BARRA tb
      where
      pe.BARRCODI = TB.BARRCODI and
      PE.RPECLIENTE = decode({0}, 0, PE.RPECLIENTE, {0})
    </query>
  </Sql>

</Sqls>
