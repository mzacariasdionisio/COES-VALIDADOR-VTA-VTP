<?xml version="1.0" encoding="utf-8" ?>
<Sqls>

  <Sql>
    <key>GetMaxId</key>
    <query>
       select nvl(max(srmreccodi), 0) + 1 from srm_recomendacion
    </query>
  </Sql>

  <Sql>
    <key>Save</key>
    <query>
       insert into srm_recomendacion(
           srmreccodi,
           evencodi,
           equicodi,
           srmcrtcodi,
           srmstdcodi,
           usercode,
           srmrecfecharecomend,
           srmrecfechavencim,
           srmrecdianotifplazo,
           srmrectitulo,
           srmrecrecomendacion,
           srmrecactivo,
           srmrecusucreacion,
           srmrecfeccreacion,
           srmrecusumodificacion,
           srmrecfecmodificacion,
           evenrcmctaf,
           afrrec
       )
       values(
           :srmreccodi,
           :evencodi,
           :equicodi,
           :srmcrtcodi,
           :srmstdcodi,
           :usercode,
           :srmrecfecharecomend,
           :srmrecfechavencim,
           :srmrecdianotifplazo,
           :srmrectitulo,
           :srmrecrecomendacion,
           :srmrecactivo,
           :srmrecusucreacion,
           :srmrecfeccreacion,
           :srmrecusumodificacion,
           :srmrecfecmodificacion,
           :evenrcmctaf,
           :afrrec
       )
    </query>
  </Sql>

  <Sql>
    <key>Update</key>
    <query>
       update srm_recomendacion
       set
           evencodi = :evencodi,
           equicodi = :equicodi,
           srmcrtcodi = :srmcrtcodi,
           srmstdcodi = :srmstdcodi,
           usercode = :usercode,
           srmrecfecharecomend = :srmrecfecharecomend,
           srmrecfechavencim = :srmrecfechavencim,
           srmrecdianotifplazo = :srmrecdianotifplazo,
           srmrectitulo = :srmrectitulo,
           srmrecrecomendacion = :srmrecrecomendacion,
           srmrecactivo = :srmrecactivo,
           srmrecusucreacion = :srmrecusucreacion,
           srmrecfeccreacion = :srmrecfeccreacion,
           srmrecusumodificacion = :srmrecusumodificacion,
           srmrecfecmodificacion = :srmrecfecmodificacion
       where
           srmreccodi = :srmreccodi
    </query>
  </Sql>

  <Sql>
    <key>Delete</key>
    <query>
       delete from srm_recomendacion
       where
           srmreccodi = :srmreccodi
    </query>
  </Sql>

  <Sql>
    <key>GetById</key>
    <query>
       select
           srmreccodi,
           evencodi,
           equicodi,
           srmcrtcodi,
           srmstdcodi,
           usercode,
           srmrecfecharecomend,
           srmrecfechavencim,
           srmrecdianotifplazo,
           srmrectitulo,
           srmrecrecomendacion,
           srmrecactivo,
           srmrecusucreacion,
           srmrecfeccreacion,
           srmrecusumodificacion,
           srmrecfecmodificacion
       from
           srm_recomendacion
       where
           srmreccodi = :srmreccodi
    </query>
  </Sql>

  <Sql>
    <key>List</key>
    <query>
       select
           srmreccodi,
           evencodi,
           equicodi,
           srmcrtcodi,
           srmstdcodi,
           usercode,
           srmrecfecharecomend,
           srmrecfechavencim,
           srmrecdianotifplazo,
           srmrectitulo,
           srmrecrecomendacion,
           srmrecactivo,
           srmrecusucreacion,
           srmrecfeccreacion,
           srmrecusumodificacion,
           srmrecfecmodificacion
       from
           srm_recomendacion
    </query>
  </Sql>

  <Sql>
    <key>GetByCriteria</key>
    <query>
       select
           srmreccodi,
           evencodi,
           equicodi,
           srmcrtcodi,
           srmstdcodi,
           usercode,
           srmrecfecharecomend,
           srmrecfechavencim,
           srmrecdianotifplazo,
           srmrectitulo,
           srmrecrecomendacion,
           srmrecactivo,
           srmrecusucreacion,
           srmrecfeccreacion,
           srmrecusumodificacion,
           srmrecfecmodificacion
       from
           srm_recomendacion
    </query>
  </Sql>

  <Sql>
    <key>ObtenerListado</key>
    <query>
      select
      *
      from (
      select a.srmreccodi,b.evencodi,b.evenini,c.equicodi,c.equiabrev,d.srmcrtcodi,d.srmcrtdescrip,e.srmstdcodi,e.srmstddescrip,f.usercode,f.username,a.srmrecfecharecomend,a.srmrecfechavencim,a.srmrecdianotifplazo,a.srmrectitulo,a.srmrecrecomendacion,a.srmrecactivo,a.srmrecusucreacion,a.srmrecfeccreacion,a.srmrecusumodificacion,a.srmrecfecmodificacion, (row_number() over (order by a.srmrecfecharecomend desc)) as r 
      from srm_recomendacion a, eve_evento b, eq_equipo c, srm_criticidad d, srm_estado e, fw_user f 
      where (b.evencodi= a.evencodi) and (a.evencodi={0} or {0} = 0) and 
      (c.equicodi= a.equicodi) and (a.equicodi={1} or {1} = 0) and 
      (d.srmcrtcodi= a.srmcrtcodi) and (a.srmcrtcodi={2} or {2} = 0) and (e.srmstdcodi= a.srmstdcodi) and 
      (a.srmstdcodi={3} or {3} = 0) and (f.usercode= a.usercode) and (a.usercode={4} or {4} = 0) and b.deleted='N' and
      (
      (a.srmrecfecharecomend >= to_date('{5} 00:00:00','YYYY-MM-DD HH24:MI:SS') and a.srmrecfechavencim &lt; to_date('{6} 00:00:00','YYYY-MM-DD HH24:MI:SS')+1)
      )
      order by a.srmrecfecharecomend desc
      )
      where (r >= ((({7}-1) * {8}) + 1) and r &lt; (({7} * {8}) + 1 )) or ({7} = -1 and {8} = -1)
    </query>

  </Sql>

  <Sql>
    <key>TotalRegistros</key>
    <query>
      select count(*) from srm_recomendacion a,eve_evento b,eq_equipo c,srm_criticidad d,srm_estado e,fw_user f where b.deleted='N' and (b.evencodi= a.evencodi) and (a.evencodi={0} or {0} = 0) and (c.equicodi= a.equicodi) and (a.equicodi={1} or {1} = 0) and (d.srmcrtcodi= a.srmcrtcodi) and (a.srmcrtcodi={2} or {2} = 0) and (e.srmstdcodi= a.srmstdcodi) and (a.srmstdcodi={3} or {3} = 0) and (f.usercode= a.usercode) and (a.usercode={4} or {4} = 0)
      and
      (
      (a.srmrecfecharecomend >= to_date('{5} 00:00:00','YYYY-MM-DD HH24:MI:SS') and a.srmrecfechavencim &lt; to_date('{6} 00:00:00','YYYY-MM-DD HH24:MI:SS')+1)
      )
    </query>
  </Sql>

  <Sql>
    <key>ObtenerListadoGestion</key>
    <query>
      select
      *
      from (
      select a.evencodi,
      case evenpreliminar when 'A' then 'EVENTO' ELSE 'EVENTO AO' END TIPO,
      b.emprnomb,
      e.tareaabrev||' '||c.areanomb areanomb,
      d.equiabrev,
      a.evenini,a.evenfin,
      a.evenasunto,
      f.srmrecfecharecomend,
      f.srmrecfechavencim,
      (select e.tareaabrev||' '||c.areanomb||' / '||dd.equiabrev
      from
      eq_area cc, eq_equipo dd, eq_tipoarea ee
      where cc.areacodi=dd.areacodi and cc.tareacodi=ee.tareacodi and dd.equicodi=f.equicodi
      ) equinomb,
      (case when (f.SRMRECFECHAVENCIM - to_date(to_char(sysdate,'dd/mm/yyyy'),'dd/mm/yyyy'))&lt;0 and f.srmstdcodi!=3 then -2 else g.srmstdcodi  end) srmstdcodi,
      (case when (f.SRMRECFECHAVENCIM - to_date(to_char(sysdate,'dd/mm/yyyy'),'dd/mm/yyyy'))&lt;0 and f.srmstdcodi!=3 then (select srmstddescrip from srm_estado where srmstdcodi = -2 ) else g.srmstddescrip  end) srmstddescrip,
      (case when (f.SRMRECFECHAVENCIM - to_date(to_char(sysdate,'dd/mm/yyyy'),'dd/mm/yyyy'))&lt;0 and f.srmstdcodi!=3 then (select srmstdcolor from srm_estado where srmstdcodi = -2 ) else g.srmstdcolor  end) srmstdcolor,
      h.srmcrtcodi, h.srmcrtdescrip,h.srmcrtcolor,
      (f.SRMRECFECHAVENCIM - to_date(to_char(sysdate,'dd/mm/yyyy'),'dd/mm/yyyy')) Srmrecdianotifplazo,
      (select case count(*) when 0 then 'NO' ELSE 'SI' END from srm_comentario z where z.srmreccodi=f.srmreccodi) CONCOMENTARIO,
      (row_number() over (order by a.evenini desc)) as r
      from eve_evento a, si_empresa b, eq_area c, eq_equipo d, eq_tipoarea e, srm_recomendacion f, srm_estado g, srm_criticidad h, eq_familia i, si_tipoempresa j
      where a.deleted='N' and 
      a.emprcodi=b.emprcodi and a.equicodi=d.equicodi and c.areacodi=d.areacodi and c.tareacodi=e.tareacodi and
      (a.evenasegoperacion='S' or a.evenpreliminar='A') and a.evencodi = f.evencodi and f.SRMSTDCODI= g.SRMSTDCODI and f.SRMCRTCODI = h.SRMCRTCODI and i.famcodi=d.famcodi
      and j.tipoemprcodi=b.tipoemprcodi
      and
      (
      ((f.SRMRECFECHAVENCIM - to_date(to_char(sysdate,'dd/mm/yyyy'),'dd/mm/yyyy'))&lt;0 and f.srmstdcodi!=3  and -2={6} ) or
      (((f.SRMRECFECHAVENCIM - to_date(to_char(sysdate,'dd/mm/yyyy'),'dd/mm/yyyy'))>=0 or  f.srmstdcodi=3 ) and f.srmstdcodi={6} ) or
      0={6}
      ) and      
      (a.evenini >= to_date('{0} 00:00:00','YYYY-MM-DD HH24:MI:SS') and (a.evenfin &lt; to_date('{1} 00:00:00','YYYY-MM-DD HH24:MI:SS')+1) or a.evenfin is null) and
      (d.famcodi={2} or 0={2}) and
      (upper(d.equiabrev) like upper('%{3}%') or 'x1x2x3'='{3}') and
      (b.tipoemprcodi={4} or 0={4}) and
      (b.emprcodi={5} or 0={5}) and
      (h.srmcrtcodi={7} or 0={7}) and
      (f.srmrecactivo='S')
      order by a.evencodi,f.srmcrtcodi,(f.SRMRECFECHAVENCIM - to_date(to_char(sysdate,'dd/mm/yyyy'),'dd/mm/yyyy')),b.emprnomb, e.tareaabrev||' '||c.areanomb,d.equiabrev
      )
      where (r >= ((({8}-1) * {9}) + 1) and r &lt; (({8} * {9}) + 1 )) or ({8} = -1 and {9} = -1)
    </query>
  </Sql>

  <Sql>
    <key>TotalRegistrosGestion</key>
    <query>
      select count(*)
      from eve_evento a, si_empresa b, eq_area c, eq_equipo d, eq_tipoarea e, srm_recomendacion f, srm_estado g, srm_criticidad h, eq_familia i, si_tipoempresa j
      where a.deleted='N' and 
      a.emprcodi=b.emprcodi and a.equicodi=d.equicodi and c.areacodi=d.areacodi and c.tareacodi=e.tareacodi and
      (a.evenasegoperacion='S' or a.evenpreliminar='A') and a.evencodi = f.evencodi and f.SRMSTDCODI= g.SRMSTDCODI and f.SRMCRTCODI = h.SRMCRTCODI and i.famcodi=d.famcodi
      and j.tipoemprcodi=b.tipoemprcodi
      and
      (
      ((f.SRMRECFECHAVENCIM - to_date(to_char(sysdate,'dd/mm/yyyy'),'dd/mm/yyyy'))&lt;0 and -2={6} ) or
      ((f.SRMRECFECHAVENCIM - to_date(to_char(sysdate,'dd/mm/yyyy'),'dd/mm/yyyy'))>=0 and f.srmstdcodi={6} ) or
      0={6}
      ) and
      (f.srmrecfecharecomend >= to_date('{0} 00:00:00','YYYY-MM-DD HH24:MI:SS') and f.srmrecfechavencim &lt; to_date('{1} 00:00:00','YYYY-MM-DD HH24:MI:SS')+1) and
      (d.famcodi={2} or 0={2}) and
      (upper(d.equiabrev) like upper('%{3}%') or 'x1x2x3'='{3}') and
      (b.tipoemprcodi={4} or 0={4}) and
      (b.emprcodi={5} or 0={5}) and
      (h.srmcrtcodi={7} or 0={7}) and
      (f.srmrecactivo='S')
    </query>
  </Sql>
  
  <Sql>
    <key>ObtenerListadoGestionFaltante</key>
    <query>
      select
      *
      from (
      select a.evencodi,
      case evenpreliminar when 'A' then 'EVENTO AO' ELSE 'EVENTO' END TIPO,
      b.emprnomb,
      e.tareaabrev||' '||c.areanomb areanomb,
      d.equiabrev,
      a.evenini,a.evenfin,
      a.evenasunto,
      (row_number() over (order by a.evenini desc)) as r
      from eve_evento a, si_empresa b, eq_area c, eq_equipo d, eq_tipoarea e, eq_familia i, si_tipoempresa j
      where a.deleted='N' and 
      a.emprcodi=b.emprcodi and a.equicodi=d.equicodi and c.areacodi=d.areacodi and c.tareacodi=e.tareacodi and
      (a.evenasegoperacion='S' or a.evenpreliminar='A') and i.famcodi=d.famcodi
      and j.tipoemprcodi=b.tipoemprcodi
      and
      (a.evenini >= to_date('{0} 00:00:00','YYYY-MM-DD HH24:MI:SS') and (a.evenfin &lt; to_date('{1} 00:00:00','YYYY-MM-DD HH24:MI:SS')+1) or a.evenfin is null) and
      (d.famcodi={2} or 0={2}) and
      (upper(d.equiabrev) like upper('%{3}%') or 'x1x2x3'='{3}') and
      (b.tipoemprcodi={4} or 0={4}) and
      (b.emprcodi={5} or 0={5}) and
      (a.evencodi not in (select evencodi from srm_recomendacion))
      order by a.evencodi,b.emprnomb, e.tareaabrev||' '||c.areanomb,d.equiabrev
      )
      where (r >= ((({6}-1) * {7}) + 1) and r &lt; (({6} * {7}) + 1 )) or ({6} = -1 and {7} = -1)
    </query>

  </Sql>

  <Sql>
    <key>TotalRegistrosGestionFaltante</key>
    <query>
      select count(*)
      from eve_evento a, si_empresa b, eq_area c, eq_equipo d, eq_tipoarea e, eq_familia i, si_tipoempresa j
      where a.deleted='N' and 
      a.emprcodi=b.emprcodi and a.equicodi=d.equicodi and c.areacodi=d.areacodi and c.tareacodi=e.tareacodi and
      (a.evenasegoperacion='S' or a.evenpreliminar='A') and i.famcodi=d.famcodi
      and j.tipoemprcodi=b.tipoemprcodi
      and
      (a.evenini >= to_date('{0} 00:00:00','YYYY-MM-DD HH24:MI:SS') and (a.evenfin &lt; to_date('{1} 00:00:00','YYYY-MM-DD HH24:MI:SS')+1) or a.evenfin is null) and
      (d.famcodi={2} or 0={2}) and
      (upper(d.equiabrev) like upper('%{3}%') or 'x1x2x3'='{3}') and
      (b.tipoemprcodi={4} or 0={4}) and
      (b.emprcodi={5} or 0={5}) and
      (a.evencodi not in (select evencodi from srm_recomendacion))
    </query>
  </Sql>

  <Sql>
    <key>ObtenerListadoRecomendacion</key>
    <query>
      select
      *
      from (
      select h.srmreccodi,b.emprnomb,e.tareaabrev||' '||c.areanomb areanomb,a.equiabrev,h.srmrectitulo,h.srmrecfecharecomend,h.srmrecfechavencim,
      (select username from fw_user aa where aa.usercode=h.usercode ) srmrecrecomendacion,
      (case when (h.SRMRECFECHAVENCIM - to_date(to_char(sysdate,'dd/mm/yyyy'),'dd/mm/yyyy'))&lt;0 and h.srmstdcodi!=3 then (select srmstddescrip from srm_estado where srmstdcodi = -2 ) else g.srmstddescrip  end) srmstddescrip,
      (case when (h.SRMRECFECHAVENCIM - to_date(to_char(sysdate,'dd/mm/yyyy'),'dd/mm/yyyy'))&lt;0 and h.srmstdcodi!=3 then (select srmstdcolor from srm_estado where srmstdcodi = -2 ) else g.srmstdcolor  end) srmstdcolor,
      f.srmcrtcodi, f.srmcrtdescrip,f.srmcrtcolor,
      (case when (select count(*) from srm_comentario aa where aa.srmcomactivo='S' and aa.srmreccodi=h.srmreccodi)>0 then 'SI' else 'NO'  end) comentario,
      h.srmrecusucreacion, h.srmrecfeccreacion,
      h.srmrecusumodificacion, h.srmrecfecmodificacion,
      h.srmrecactivo,
      h.evenrcmctaf,
      (row_number() over (order by g.srmstdcodi,h.srmrecfecharecomend desc)) as r
      from eq_equipo a, si_empresa b, eq_area c, eq_tipoarea e, srm_criticidad f, srm_estado g, srm_recomendacion h, eve_evento i
      where a.emprcodi=b.emprcodi and a.areacodi=c.areacodi and c.tareacodi=e.tareacodi and i.evencodi=h.evencodi and i.deleted='N' and (i.evenasegoperacion='S' or i.evenpreliminar='A' or i.evenrcmctaf = 'S') and
      h.srmstdcodi=g.srmstdcodi and h.srmcrtcodi = f.srmcrtcodi and h.equicodi =a.equicodi
      and h.srmrecactivo='{1}'
      and h.evencodi={0}
      order by g.srmstdcodi,h.srmrecfecharecomend
      )
      where (r >= ((({2}-1) * {3}) + 1) and r &lt; (({2} * {3}) + 1 )) or ({2} = -1 and {3} = -1)
    </query>
  </Sql>

  <Sql>
    <key>TotalRegistrosRec</key>
    <query>
      select count(*)
      from eq_equipo a, si_empresa b, eq_area c, eq_tipoarea e, srm_criticidad f, srm_estado g, srm_recomendacion h, eve_evento i
      where a.emprcodi=b.emprcodi and a.areacodi=c.areacodi and c.tareacodi=e.tareacodi and i.evencodi=h.evencodi and i.deleted='N' and (i.evenasegoperacion='S' or i.evenpreliminar='A') and
      h.srmstdcodi=g.srmstdcodi and h.srmcrtcodi = f.srmcrtcodi and h.equicodi =a.equicodi
      and h.srmrecactivo='{1}'
      and h.evencodi={0}
    </query>
  </Sql>
  

  <Sql>
    <key>ObtenerListadoReporte</key>
    <query>
      select
      *
      from (
      select
      b.emprnomb,
      e.tareaabrev||' '||c.areanomb areanomb,
      d.equiabrev,
      f.srmrectitulo,
      k.username,
      f.srmrecfecharecomend,
      f.srmrecfechavencim,
      (f.SRMRECFECHAVENCIM - to_date(to_char(sysdate,'dd/mm/yyyy'),'dd/mm/yyyy')) Srmrecdianotifplazo,
      (case when (f.SRMRECFECHAVENCIM - to_date(to_char(sysdate,'dd/mm/yyyy'),'dd/mm/yyyy'))&lt;0 and f.srmstdcodi!=3 then -2 else g.srmstdcodi  end) srmstdcodi,
      (case when (f.SRMRECFECHAVENCIM - to_date(to_char(sysdate,'dd/mm/yyyy'),'dd/mm/yyyy'))&lt;0 and f.srmstdcodi!=3 then (select srmstddescrip from srm_estado where srmstdcodi = -2 ) else g.srmstddescrip  end) srmstddescrip,
      (case when (f.SRMRECFECHAVENCIM - to_date(to_char(sysdate,'dd/mm/yyyy'),'dd/mm/yyyy'))&lt;0 and f.srmstdcodi!=3 then (select srmstdcolor from srm_estado where srmstdcodi = -2 ) else g.srmstdcolor  end) srmstdcolor,
      h.srmcrtcodi, h.srmcrtdescrip,h.srmcrtcolor,
      b.emprcodi,
      i.famcodi,
      i.famnomb,
      (row_number() over (order by f.SRMRECFECHAVENCIM desc)) as r
      from si_empresa b, eq_area c, eq_equipo d, eq_tipoarea e, srm_recomendacion f, srm_estado g, srm_criticidad h, eq_familia i, si_tipoempresa j, fw_user k, eve_evento l
      where
      f.equicodi=d.equicodi and c.areacodi=d.areacodi and c.tareacodi=e.tareacodi and l.evencodi=f.evencodi and l.deleted='N' and (l.evenasegoperacion='S' or l.evenpreliminar='A') and
      f.SRMSTDCODI= g.SRMSTDCODI and f.SRMCRTCODI = h.SRMCRTCODI and i.famcodi=d.famcodi
      and j.tipoemprcodi=b.tipoemprcodi and k.usercode=f.usercode
      and b.emprcodi=d.emprcodi and
      (
      ((f.SRMRECFECHAVENCIM - to_date(to_char(sysdate,'dd/mm/yyyy'),'dd/mm/yyyy'))&lt;0 and f.srmstdcodi!=3  and -2={7} ) or
      (((f.SRMRECFECHAVENCIM - to_date(to_char(sysdate,'dd/mm/yyyy'),'dd/mm/yyyy'))>=0 or  f.srmstdcodi=3 ) and f.srmstdcodi={7} ) or
      0={7}
      ) and
      (f.srmrecfechavencim >= to_date('{0} 00:00:00','YYYY-MM-DD HH24:MI:SS') and f.srmrecfechavencim &lt; to_date('{1} 00:00:00','YYYY-MM-DD HH24:MI:SS')+1) and
      (d.famcodi={2} or 0={2}) and
      (upper(d.equiabrev) like upper('%{3}%') or 'x1x2x3'='{3}') and
      (upper(f.srmrectitulo) like upper('%{8}%') or upper(f.srmrecrecomendacion) like upper('%{8}%') or 'x1x2x3'='{8}') and
      (b.tipoemprcodi={4} or 0={4}) and
      (b.emprcodi={5} or 0={5}) and
      (h.srmcrtcodi={6} or 0={6}) and
      (f.srmrecactivo='S') and
      (k.usercode={9} or 0={9})
      order by f.srmcrtcodi,(f.SRMRECFECHAVENCIM - to_date(to_char(sysdate,'dd/mm/yyyy'),'dd/mm/yyyy')),b.emprnomb, e.tareaabrev||' '||c.areanomb,d.equiabrev
      )
      where (r >= ((({10}-1) * {11}) + 1) and r &lt; (({10} * {11}) + 1 )) or ({10} = -1 and {11} = -1)
    </query>
  </Sql>
  <Sql>
    <key>TotalRegistrosListadoReporte</key>
    <query>
      select
      count(*)
      from si_empresa b, eq_area c, eq_equipo d, eq_tipoarea e, srm_recomendacion f, srm_estado g, srm_criticidad h, eq_familia i, si_tipoempresa j, fw_user k, eve_evento l
      where
      f.equicodi=d.equicodi and c.areacodi=d.areacodi and c.tareacodi=e.tareacodi and l.evencodi=f.evencodi and l.deleted='N' and (l.evenasegoperacion='S' or l.evenpreliminar='A') and
      f.SRMSTDCODI= g.SRMSTDCODI and f.SRMCRTCODI = h.SRMCRTCODI and i.famcodi=d.famcodi
      and j.tipoemprcodi=b.tipoemprcodi and k.usercode=f.usercode
      and b.emprcodi=d.emprcodi and
      (
      ((f.SRMRECFECHAVENCIM - to_date(to_char(sysdate,'dd/mm/yyyy'),'dd/mm/yyyy'))&lt;0 and f.srmstdcodi!=3  and -2={7} ) or
      (((f.SRMRECFECHAVENCIM - to_date(to_char(sysdate,'dd/mm/yyyy'),'dd/mm/yyyy'))>=0 or  f.srmstdcodi=3 ) and f.srmstdcodi={7} ) or
      0={7}
      ) and
      (f.srmrecfechavencim >= to_date('{0} 00:00:00','YYYY-MM-DD HH24:MI:SS') and f.srmrecfechavencim &lt; to_date('{1} 00:00:00','YYYY-MM-DD HH24:MI:SS')+1) and
      (d.famcodi={2} or 0={2}) and
      (upper(d.equiabrev) like upper('%{3}%') or 'x1x2x3'='{3}') and
      (upper(f.srmrectitulo) like upper('%{8}%') or upper(f.srmrecrecomendacion) like upper('%{8}%') or 'x1x2x3'='{8}') and
      (b.tipoemprcodi={4} or 0={4}) and
      (b.emprcodi={5} or 0={5}) and
      (h.srmcrtcodi={6} or 0={6}) and
      (f.srmrecactivo='S') and
      (k.usercode={9} or 0={9})      
    </query>
  </Sql>

  <Sql>
    <key>ObtenerListadoEmpresaCriticidad</key>
    <query>
      select
      b.emprcodi,
      b.emprnomb,
      h.srmcrtcodi, h.srmcrtdescrip,h.srmcrtcolor,
      count(*) registros,
      (
      select count(*)
      from si_empresa bz, eq_area c, eq_equipo d, eq_tipoarea e, srm_recomendacion f, srm_estado g, srm_criticidad h, eq_familia i, si_tipoempresa j, fw_user k
      where
      f.equicodi=d.equicodi and c.areacodi=d.areacodi and c.tareacodi=e.tareacodi and
      f.SRMSTDCODI= g.SRMSTDCODI and f.SRMCRTCODI = h.SRMCRTCODI and i.famcodi=d.famcodi
      and j.tipoemprcodi=bz.tipoemprcodi and k.usercode=f.usercode
      and bz.emprcodi=d.emprcodi and
      (
      ((f.SRMRECFECHAVENCIM - to_date(to_char(sysdate,'dd/mm/yyyy'),'dd/mm/yyyy'))&lt;0 and f.srmstdcodi!=3  and -2={7} ) or
      (((f.SRMRECFECHAVENCIM - to_date(to_char(sysdate,'dd/mm/yyyy'),'dd/mm/yyyy'))>=0 or  f.srmstdcodi=3 ) and f.srmstdcodi={7} ) or
      0={7}
      ) and
      (f.srmrecfechavencim >= to_date('{0} 00:00:00','YYYY-MM-DD HH24:MI:SS') and f.srmrecfechavencim &lt; to_date('{1} 00:00:00','YYYY-MM-DD HH24:MI:SS')+1) and
      (d.famcodi={2} or 0={2}) and
      (upper(d.equiabrev) like upper('%{3}%') or 'x1x2x3'='{3}') and
      (upper(f.srmrectitulo) like upper('%{8}%') or upper(f.srmrecrecomendacion) like upper('%{8}%') or 'x1x2x3'='{8}') and
      (b.tipoemprcodi={4} or 0={4}) and
      (b.emprcodi={5} or 0={5}) and
      (h.srmcrtcodi={6} or 0={6}) and
      (f.srmrecactivo='S') and
      (k.usercode={9} or 0={9}) and bz.emprcodi=b.emprcodi
      ) total
      from si_empresa b, eq_area c, eq_equipo d, eq_tipoarea e, srm_recomendacion f, srm_estado g, srm_criticidad h, eq_familia i, si_tipoempresa j, fw_user k, eve_evento l
      where
      f.equicodi=d.equicodi and c.areacodi=d.areacodi and c.tareacodi=e.tareacodi and l.evencodi=f.evencodi and l.deleted='N' and (l.evenasegoperacion='S' or l.evenpreliminar='A') and
      f.SRMSTDCODI= g.SRMSTDCODI and f.SRMCRTCODI = h.SRMCRTCODI and i.famcodi=d.famcodi
      and j.tipoemprcodi=b.tipoemprcodi and k.usercode=f.usercode
      and b.emprcodi=d.emprcodi and
      (
      ((f.SRMRECFECHAVENCIM - to_date(to_char(sysdate,'dd/mm/yyyy'),'dd/mm/yyyy'))&lt;0 and f.srmstdcodi!=3  and -2={7} ) or
      (((f.SRMRECFECHAVENCIM - to_date(to_char(sysdate,'dd/mm/yyyy'),'dd/mm/yyyy'))>=0 or  f.srmstdcodi=3 ) and f.srmstdcodi={7} ) or
      0={7}
      ) and
      (f.srmrecfechavencim >= to_date('{0} 00:00:00','YYYY-MM-DD HH24:MI:SS') and f.srmrecfechavencim &lt; to_date('{1} 00:00:00','YYYY-MM-DD HH24:MI:SS')+1) and
      (d.famcodi={2} or 0={2}) and
      (upper(d.equiabrev) like upper('%{3}%') or 'x1x2x3'='{3}') and
      (upper(f.srmrectitulo) like upper('%{8}%') or upper(f.srmrecrecomendacion) like upper('%{8}%') or 'x1x2x3'='{8}') and
      (b.tipoemprcodi={4} or 0={4}) and
      (b.emprcodi={5} or 0={5}) and
      (h.srmcrtcodi={6} or 0={6}) and
      (f.srmrecactivo='S') and
      (k.usercode={9} or 0={9})
      group by b.emprcodi,b.emprnomb,h.srmcrtcodi, h.srmcrtdescrip,h.srmcrtcolor
      order by total desc,b.emprnomb,h.srmcrtcodi
    </query>
  </Sql>
  <Sql>
    <key>ObtenerListadoEmpresaEstado</key>
    <query>
      select
      emprnomb1 emprnomb,srmstdcodi,srmstdcolor,srmstddescrip,count(*) registros,
      (
        select
        count(*)
        from si_empresa bz, eq_area c, eq_equipo d, eq_tipoarea e, srm_recomendacion f, srm_estado g, srm_criticidad h, eq_familia i, si_tipoempresa j, fw_user k
        where
        f.equicodi=d.equicodi and c.areacodi=d.areacodi and c.tareacodi=e.tareacodi and
        f.SRMSTDCODI= g.SRMSTDCODI and f.SRMCRTCODI = h.SRMCRTCODI and i.famcodi=d.famcodi
        and j.tipoemprcodi=bz.tipoemprcodi and k.usercode=f.usercode
        and bz.emprcodi=d.emprcodi and
        (
        ((f.SRMRECFECHAVENCIM - to_date(to_char(sysdate,'dd/mm/yyyy'),'dd/mm/yyyy'))&lt;0 and f.srmstdcodi!=3  and -2={7} ) or
        (((f.SRMRECFECHAVENCIM - to_date(to_char(sysdate,'dd/mm/yyyy'),'dd/mm/yyyy'))>=0 or  f.srmstdcodi=3 ) and f.srmstdcodi={7} ) or
        0={7}
        ) and
        (f.srmrecfechavencim >= to_date('{0} 00:00:00','YYYY-MM-DD HH24:MI:SS') and f.srmrecfechavencim &lt; to_date('{1} 00:00:00','YYYY-MM-DD HH24:MI:SS')+1) and
        (d.famcodi={2} or 0={2}) and
        (upper(d.equiabrev) like upper('%{3}%') or 'x1x2x3'='{3}') and
        (upper(f.srmrectitulo) like upper('%{8}%') or upper(f.srmrecrecomendacion) like upper('%{8}%') or 'x1x2x3'='{8}') and
        (bz.tipoemprcodi={4} or 0={4}) and
        (bz.emprcodi={5} or 0={5}) and
        (h.srmcrtcodi={6} or 0={6}) and
        (f.srmrecactivo='S') and
        (k.usercode={9} or 0={9}) and bz.emprnomb=emprnomb1
      ) total
      from (
      select
      b.emprnomb emprnomb1,
      (case when (f.SRMRECFECHAVENCIM - to_date(to_char(sysdate,'dd/mm/yyyy'),'dd/mm/yyyy'))&lt;0 and f.srmstdcodi!=3 then -2 else g.srmstdcodi  end) srmstdcodi,
      (case when (f.SRMRECFECHAVENCIM - to_date(to_char(sysdate,'dd/mm/yyyy'),'dd/mm/yyyy'))&lt;0 and f.srmstdcodi!=3 then (select srmstddescrip from srm_estado where srmstdcodi = -2 ) else g.srmstddescrip  end) srmstddescrip,
      (case when (f.SRMRECFECHAVENCIM - to_date(to_char(sysdate,'dd/mm/yyyy'),'dd/mm/yyyy'))&lt;0 and f.srmstdcodi!=3 then (select srmstdcolor from srm_estado where srmstdcodi = -2 ) else g.srmstdcolor  end) srmstdcolor
      from si_empresa b, eq_area c, eq_equipo d, eq_tipoarea e, srm_recomendacion f, srm_estado g, srm_criticidad h, eq_familia i, si_tipoempresa j, fw_user k, eve_evento l
      where
      f.equicodi=d.equicodi and c.areacodi=d.areacodi and c.tareacodi=e.tareacodi and l.evencodi=f.evencodi and l.deleted='N' and (l.evenasegoperacion='S' or l.evenpreliminar='A') and
      f.SRMSTDCODI= g.SRMSTDCODI and f.SRMCRTCODI = h.SRMCRTCODI and i.famcodi=d.famcodi
      and j.tipoemprcodi=b.tipoemprcodi and k.usercode=f.usercode
      and b.emprcodi=d.emprcodi and
      (
      ((f.SRMRECFECHAVENCIM - to_date(to_char(sysdate,'dd/mm/yyyy'),'dd/mm/yyyy'))&lt;0 and f.srmstdcodi!=3  and -2={7} ) or
      (((f.SRMRECFECHAVENCIM - to_date(to_char(sysdate,'dd/mm/yyyy'),'dd/mm/yyyy'))>=0 or  f.srmstdcodi=3 ) and f.srmstdcodi={7} ) or
      0={7}
      ) and
      (f.srmrecfechavencim >= to_date('{0} 00:00:00','YYYY-MM-DD HH24:MI:SS') and f.srmrecfechavencim &lt; to_date('{1} 00:00:00','YYYY-MM-DD HH24:MI:SS')+1) and
      (d.famcodi={2} or 0={2}) and
      (upper(d.equiabrev) like upper('%{3}%') or 'x1x2x3'='{3}') and
      (upper(f.srmrectitulo) like upper('%{8}%') or upper(f.srmrecrecomendacion) like upper('%{8}%') or 'x1x2x3'='{8}') and
      (b.tipoemprcodi={4} or 0={4}) and
      (b.emprcodi={5} or 0={5}) and
      (h.srmcrtcodi={6} or 0={6}) and
      (f.srmrecactivo='S') and
      (k.usercode={9} or 0={9})
      order by f.srmcrtcodi,(f.SRMRECFECHAVENCIM - to_date(to_char(sysdate,'dd/mm/yyyy'),'dd/mm/yyyy')),b.emprnomb, e.tareaabrev||' '||c.areanomb,d.equiabrev
      )
      group by emprnomb1,srmstdcodi,srmstdcolor,srmstddescrip
      order by total desc,emprnomb1
    </query>
  </Sql>
  <Sql>
    <key>ObtenerListadoTipoEquipoCriticidad</key>
    <query>
      select
      i.famcodi,
      i.famnomb,
      h.srmcrtcodi, h.srmcrtdescrip,h.srmcrtcolor,
      count(*) registros,
      (
        select        
        count(*)
        from si_empresa b, eq_area c, eq_equipo d, eq_tipoarea e, srm_recomendacion f, srm_estado g, srm_criticidad h, eq_familia iz, si_tipoempresa j, fw_user k
        where
        f.equicodi=d.equicodi and c.areacodi=d.areacodi and c.tareacodi=e.tareacodi and
        f.SRMSTDCODI= g.SRMSTDCODI and f.SRMCRTCODI = h.SRMCRTCODI and i.famcodi=d.famcodi
        and j.tipoemprcodi=b.tipoemprcodi and k.usercode=f.usercode
        and b.emprcodi=d.emprcodi and
        (
        ((f.SRMRECFECHAVENCIM - to_date(to_char(sysdate,'dd/mm/yyyy'),'dd/mm/yyyy'))&lt;0 and f.srmstdcodi!=3  and -2={7} ) or
        (((f.SRMRECFECHAVENCIM - to_date(to_char(sysdate,'dd/mm/yyyy'),'dd/mm/yyyy'))>=0 or  f.srmstdcodi=3 ) and f.srmstdcodi={7} ) or
        0={7}
        ) and
        (f.srmrecfechavencim >= to_date('{0} 00:00:00','YYYY-MM-DD HH24:MI:SS') and f.srmrecfechavencim &lt; to_date('{1} 00:00:00','YYYY-MM-DD HH24:MI:SS')+1) and
      (d.famcodi={2} or 0={2}) and
      (upper(d.equiabrev) like upper('%{3}%') or 'x1x2x3'='{3}') and
      (upper(f.srmrectitulo) like upper('%{8}%') or upper(f.srmrecrecomendacion) like upper('%{8}%') or 'x1x2x3'='{8}') and
      (b.tipoemprcodi={4} or 0={4}) and
      (b.emprcodi={5} or 0={5}) and
      (h.srmcrtcodi={6} or 0={6}) and
      (f.srmrecactivo='S') and
      (k.usercode={9} or 0={9}) and iz.famcodi=i.famcodi
      ) total
      from si_empresa b, eq_area c, eq_equipo d, eq_tipoarea e, srm_recomendacion f, srm_estado g, srm_criticidad h, eq_familia i, si_tipoempresa j, fw_user k, eve_evento l
      where
      f.equicodi=d.equicodi and c.areacodi=d.areacodi and c.tareacodi=e.tareacodi and l.evencodi=f.evencodi and l.deleted='N' and (l.evenasegoperacion='S' or l.evenpreliminar='A') and
      f.SRMSTDCODI= g.SRMSTDCODI and f.SRMCRTCODI = h.SRMCRTCODI and i.famcodi=d.famcodi
      and j.tipoemprcodi=b.tipoemprcodi and k.usercode=f.usercode
      and b.emprcodi=d.emprcodi and
      (
      ((f.SRMRECFECHAVENCIM - to_date(to_char(sysdate,'dd/mm/yyyy'),'dd/mm/yyyy'))&lt;0 and f.srmstdcodi!=3  and -2={7} ) or
      (((f.SRMRECFECHAVENCIM - to_date(to_char(sysdate,'dd/mm/yyyy'),'dd/mm/yyyy'))>=0 or  f.srmstdcodi=3 ) and f.srmstdcodi={7} ) or
      0={7}
      ) and
      (f.srmrecfechavencim >= to_date('{0} 00:00:00','YYYY-MM-DD HH24:MI:SS') and f.srmrecfechavencim &lt; to_date('{1} 00:00:00','YYYY-MM-DD HH24:MI:SS')+1) and
      (d.famcodi={2} or 0={2}) and
      (upper(d.equiabrev) like upper('%{3}%') or 'x1x2x3'='{3}') and
      (upper(f.srmrectitulo) like upper('%{8}%') or upper(f.srmrecrecomendacion) like upper('%{8}%') or 'x1x2x3'='{8}') and
      (b.tipoemprcodi={4} or 0={4}) and
      (b.emprcodi={5} or 0={5}) and
      (h.srmcrtcodi={6} or 0={6}) and
      (f.srmrecactivo='S') and
      (k.usercode={9} or 0={9})
      group by i.famcodi,i.famnomb,h.srmcrtcodi, h.srmcrtdescrip,h.srmcrtcolor
      order by total desc,i.famnomb
    </query>
  </Sql>
  <Sql>
    <key>ObtenerListadoTipoEquipoEstado</key>
    <query>
      select
      famnomb1 famnomb,srmstdcodi,srmstdcolor,srmstddescrip,count(*) registros,
      (

      select
      count(*)
      from si_empresa b, eq_area c, eq_equipo d, eq_tipoarea e, srm_recomendacion f, srm_estado g, srm_criticidad h, eq_familia iz, si_tipoempresa j, fw_user k
      where
      f.equicodi=d.equicodi and c.areacodi=d.areacodi and c.tareacodi=e.tareacodi and
      f.SRMSTDCODI= g.SRMSTDCODI and f.SRMCRTCODI = h.SRMCRTCODI and iz.famcodi=d.famcodi
      and j.tipoemprcodi=b.tipoemprcodi and k.usercode=f.usercode
      and b.emprcodi=d.emprcodi and
      (
      ((f.SRMRECFECHAVENCIM - to_date(to_char(sysdate,'dd/mm/yyyy'),'dd/mm/yyyy'))&lt;0 and f.srmstdcodi!=3  and -2={7} ) or
      (((f.SRMRECFECHAVENCIM - to_date(to_char(sysdate,'dd/mm/yyyy'),'dd/mm/yyyy'))>=0 or  f.srmstdcodi=3 ) and f.srmstdcodi={7} ) or
      0={7}
      ) and
      (f.srmrecfechavencim >= to_date('{0} 00:00:00','YYYY-MM-DD HH24:MI:SS') and f.srmrecfechavencim &lt; to_date('{1} 00:00:00','YYYY-MM-DD HH24:MI:SS')+1) and
      (d.famcodi={2} or 0={2}) and
      (upper(d.equiabrev) like upper('%{3}%') or 'x1x2x3'='{3}') and
      (upper(f.srmrectitulo) like upper('%{8}%') or upper(f.srmrecrecomendacion) like upper('%{8}%') or 'x1x2x3'='{8}') and
      (b.tipoemprcodi={4} or 0={4}) and
      (b.emprcodi={5} or 0={5}) and
      (h.srmcrtcodi={6} or 0={6}) and
      (f.srmrecactivo='S') and
      (k.usercode={9} or 0={9}) and iz.famnomb=famnomb1

      ) total
      from (
      select
      i.famnomb famnomb1,
      (case when (f.SRMRECFECHAVENCIM - to_date(to_char(sysdate,'dd/mm/yyyy'),'dd/mm/yyyy'))&lt;0 and f.srmstdcodi!=3 then -2 else g.srmstdcodi  end) srmstdcodi,
      (case when (f.SRMRECFECHAVENCIM - to_date(to_char(sysdate,'dd/mm/yyyy'),'dd/mm/yyyy'))&lt;0 and f.srmstdcodi!=3 then (select srmstddescrip from srm_estado where srmstdcodi = -2 ) else g.srmstddescrip  end) srmstddescrip,
      (case when (f.SRMRECFECHAVENCIM - to_date(to_char(sysdate,'dd/mm/yyyy'),'dd/mm/yyyy'))&lt;0 and f.srmstdcodi!=3 then (select srmstdcolor from srm_estado where srmstdcodi = -2 ) else g.srmstdcolor  end) srmstdcolor
      from si_empresa b, eq_area c, eq_equipo d, eq_tipoarea e, srm_recomendacion f, srm_estado g, srm_criticidad h, eq_familia i, si_tipoempresa j, fw_user k, eve_evento l
      where
      f.equicodi=d.equicodi and c.areacodi=d.areacodi and c.tareacodi=e.tareacodi and l.evencodi=f.evencodi and l.deleted='N' and  (l.evenasegoperacion='S' or l.evenpreliminar='A') and
      f.SRMSTDCODI= g.SRMSTDCODI and f.SRMCRTCODI = h.SRMCRTCODI and i.famcodi=d.famcodi
      and j.tipoemprcodi=b.tipoemprcodi and k.usercode=f.usercode
      and b.emprcodi=d.emprcodi and
      (
      ((f.SRMRECFECHAVENCIM - to_date(to_char(sysdate,'dd/mm/yyyy'),'dd/mm/yyyy'))&lt;0 and f.srmstdcodi!=3  and -2={7} ) or
      (((f.SRMRECFECHAVENCIM - to_date(to_char(sysdate,'dd/mm/yyyy'),'dd/mm/yyyy'))>=0 or  f.srmstdcodi=3 ) and f.srmstdcodi={7} ) or
      0={7}
      ) and
      (f.srmrecfechavencim >= to_date('{0} 00:00:00','YYYY-MM-DD HH24:MI:SS') and f.srmrecfechavencim &lt; to_date('{1} 00:00:00','YYYY-MM-DD HH24:MI:SS')+1) and
      (d.famcodi={2} or 0={2}) and
      (upper(d.equiabrev) like upper('%{3}%') or 'x1x2x3'='{3}') and
      (upper(f.srmrectitulo) like upper('%{8}%') or upper(f.srmrecrecomendacion) like upper('%{8}%') or 'x1x2x3'='{8}') and
      (b.tipoemprcodi={4} or 0={4}) and
      (b.emprcodi={5} or 0={5}) and
      (h.srmcrtcodi={6} or 0={6}) and
      (f.srmrecactivo='S') and
      (k.usercode={9} or 0={9})
      order by f.srmcrtcodi,(f.SRMRECFECHAVENCIM - to_date(to_char(sysdate,'dd/mm/yyyy'),'dd/mm/yyyy')),b.emprnomb, e.tareaabrev||' '||c.areanomb,d.equiabrev
      )
      group by famnomb1,srmstdcodi,srmstdcolor,srmstddescrip
      order by total desc,famnomb1,srmstdcodi
    </query>
  </Sql>
  <Sql>
    <key>ObtenerListadoEstado</key>
    <query>
      select
      srmstdcodi,srmstdcolor,srmstddescrip,count(*) registros
      from (
      select
      (case when (f.SRMRECFECHAVENCIM - to_date(to_char(sysdate,'dd/mm/yyyy'),'dd/mm/yyyy'))&lt;0 and f.srmstdcodi!=3 then -2 else g.srmstdcodi  end) srmstdcodi,
      (case when (f.SRMRECFECHAVENCIM - to_date(to_char(sysdate,'dd/mm/yyyy'),'dd/mm/yyyy'))&lt;0 and f.srmstdcodi!=3 then (select srmstddescrip from srm_estado where srmstdcodi = -2 ) else g.srmstddescrip  end) srmstddescrip,
      (case when (f.SRMRECFECHAVENCIM - to_date(to_char(sysdate,'dd/mm/yyyy'),'dd/mm/yyyy'))&lt;0 and f.srmstdcodi!=3 then (select srmstdcolor from srm_estado where srmstdcodi = -2 ) else g.srmstdcolor  end) srmstdcolor
      from si_empresa b, eq_area c, eq_equipo d, eq_tipoarea e, srm_recomendacion f, srm_estado g, srm_criticidad h, eq_familia i, si_tipoempresa j, fw_user k, eve_evento l
      where
      f.equicodi=d.equicodi and c.areacodi=d.areacodi and c.tareacodi=e.tareacodi and l.evencodi=f.evencodi and l.deleted='N' and  (l.evenasegoperacion='S' or l.evenpreliminar='A') and
      f.SRMSTDCODI= g.SRMSTDCODI and f.SRMCRTCODI = h.SRMCRTCODI and i.famcodi=d.famcodi
      and j.tipoemprcodi=b.tipoemprcodi and k.usercode=f.usercode
      and b.emprcodi=d.emprcodi and
      (
      ((f.SRMRECFECHAVENCIM - to_date(to_char(sysdate,'dd/mm/yyyy'),'dd/mm/yyyy'))&lt;0 and f.srmstdcodi!=3  and -2={7} ) or
      (((f.SRMRECFECHAVENCIM - to_date(to_char(sysdate,'dd/mm/yyyy'),'dd/mm/yyyy'))>=0 or  f.srmstdcodi=3 ) and f.srmstdcodi={7} ) or
      0={7}
      ) and
      (f.srmrecfechavencim >= to_date('{0} 00:00:00','YYYY-MM-DD HH24:MI:SS') and f.srmrecfechavencim &lt; to_date('{1} 00:00:00','YYYY-MM-DD HH24:MI:SS')+1) and
      (d.famcodi={2} or 0={2}) and
      (upper(d.equiabrev) like upper('%{3}%') or 'x1x2x3'='{3}') and
      (upper(f.srmrectitulo) like upper('%{8}%') or upper(f.srmrecrecomendacion) like upper('%{8}%') or 'x1x2x3'='{8}') and
      (b.tipoemprcodi={4} or 0={4}) and
      (b.emprcodi={5} or 0={5}) and
      (h.srmcrtcodi={6} or 0={6}) and
      (f.srmrecactivo='S') and
      (k.usercode={9} or 0={9})
      )
      group by srmstdcodi,srmstdcolor,srmstddescrip
      order by srmstdcodi
    </query>
  </Sql>
  <Sql>
    <key>ObtenerListadoEstadoCriticidad</key>
    <query>
      select
      srmcrtcodi,srmcrtdescrip,srmcrtcolor,
      srmstdcodi,srmstdcolor,srmstddescrip,count(*) registros
      from (
      select
      h.srmcrtcodi,h.srmcrtdescrip,h.srmcrtcolor,
      (case when (f.SRMRECFECHAVENCIM - to_date(to_char(sysdate,'dd/mm/yyyy'),'dd/mm/yyyy'))&lt;0 and f.srmstdcodi!=3 then -2 else g.srmstdcodi  end) srmstdcodi,
      (case when (f.SRMRECFECHAVENCIM - to_date(to_char(sysdate,'dd/mm/yyyy'),'dd/mm/yyyy'))&lt;0 and f.srmstdcodi!=3 then (select srmstddescrip from srm_estado where srmstdcodi = -2 ) else g.srmstddescrip  end) srmstddescrip,
      (case when (f.SRMRECFECHAVENCIM - to_date(to_char(sysdate,'dd/mm/yyyy'),'dd/mm/yyyy'))&lt;0 and f.srmstdcodi!=3 then (select srmstdcolor from srm_estado where srmstdcodi = -2 ) else g.srmstdcolor  end) srmstdcolor
      from si_empresa b, eq_area c, eq_equipo d, eq_tipoarea e, srm_recomendacion f, srm_estado g, srm_criticidad h, eq_familia i, si_tipoempresa j, fw_user k, eve_evento l
      where
      f.equicodi=d.equicodi and c.areacodi=d.areacodi and c.tareacodi=e.tareacodi and l.evencodi=f.evencodi and l.deleted='N' and and (l.evenasegoperacion='S' or l.evenpreliminar='A') and
      f.SRMSTDCODI= g.SRMSTDCODI and f.SRMCRTCODI = h.SRMCRTCODI and i.famcodi=d.famcodi
      and j.tipoemprcodi=b.tipoemprcodi and k.usercode=f.usercode
      and b.emprcodi=d.emprcodi and
      (
      ((f.SRMRECFECHAVENCIM - to_date(to_char(sysdate,'dd/mm/yyyy'),'dd/mm/yyyy'))&lt;0 and f.srmstdcodi!=3  and -2={7} ) or
      (((f.SRMRECFECHAVENCIM - to_date(to_char(sysdate,'dd/mm/yyyy'),'dd/mm/yyyy'))>=0 or  f.srmstdcodi=3 ) and f.srmstdcodi={7} ) or
      0={7}
      ) and
      (f.srmrecfechavencim >= to_date('{0} 00:00:00','YYYY-MM-DD HH24:MI:SS') and f.srmrecfechavencim &lt; to_date('{1} 00:00:00','YYYY-MM-DD HH24:MI:SS')+1) and
      (d.famcodi={2} or 0={2}) and
      (upper(d.equiabrev) like upper('%{3}%') or 'x1x2x3'='{3}') and
      (upper(f.srmrectitulo) like upper('%{8}%') or upper(f.srmrecrecomendacion) like upper('%{8}%') or 'x1x2x3'='{8}') and
      (b.tipoemprcodi={4} or 0={4}) and
      (b.emprcodi={5} or 0={5}) and
      (h.srmcrtcodi={6} or 0={6}) and
      (f.srmrecactivo='S') and
      (k.usercode={9} or 0={9})
      )
      group by srmcrtcodi,srmcrtdescrip,srmcrtcolor,srmstdcodi,srmstdcolor,srmstddescrip
      order by srmstdcodi,srmcrtcodi
    </query>
  </Sql>
  <Sql>
    <key>ObtenerListadoCriticidad</key>
    <query>
      select
      h.srmcrtcodi,h.srmcrtdescrip,h.srmcrtcolor,count(*) registros
      from si_empresa b, eq_area c, eq_equipo d, eq_tipoarea e, srm_recomendacion f, srm_estado g, srm_criticidad h, eq_familia i, si_tipoempresa j, fw_user k, eve_evento l
      where
      f.equicodi=d.equicodi and c.areacodi=d.areacodi and c.tareacodi=e.tareacodi and l.evencodi=f.evencodi and l.deleted='N' and (l.evenasegoperacion='S' or l.evenpreliminar='A') and
      f.SRMSTDCODI= g.SRMSTDCODI and f.SRMCRTCODI = h.SRMCRTCODI and i.famcodi=d.famcodi
      and j.tipoemprcodi=b.tipoemprcodi and k.usercode=f.usercode
      and b.emprcodi=d.emprcodi and
      (
      ((f.SRMRECFECHAVENCIM - to_date(to_char(sysdate,'dd/mm/yyyy'),'dd/mm/yyyy'))&lt;0 and f.srmstdcodi!=3  and -2={7} ) or
      (((f.SRMRECFECHAVENCIM - to_date(to_char(sysdate,'dd/mm/yyyy'),'dd/mm/yyyy'))>=0 or  f.srmstdcodi=3 ) and f.srmstdcodi={7} ) or
      0={7}
      ) and
      (f.srmrecfechavencim >= to_date('{0} 00:00:00','YYYY-MM-DD HH24:MI:SS') and f.srmrecfechavencim &lt; to_date('{1} 00:00:00','YYYY-MM-DD HH24:MI:SS')+1) and
      (d.famcodi={2} or 0={2}) and
      (upper(d.equiabrev) like upper('%{3}%') or 'x1x2x3'='{3}') and
      (upper(f.srmrectitulo) like upper('%{8}%') or upper(f.srmrecrecomendacion) like upper('%{8}%') or 'x1x2x3'='{8}') and
      (b.tipoemprcodi={4} or 0={4}) and
      (b.emprcodi={5} or 0={5}) and
      (h.srmcrtcodi={6} or 0={6}) and
      (f.srmrecactivo='S') and
      (k.usercode={9} or 0={9})
      group by h.srmcrtcodi,h.srmcrtcolor,h.srmcrtdescrip
      order by h.srmcrtcodi
    </query>
  </Sql>
  <Sql>
    <key>ObtenerListadoAlarma</key>
    <query>
      select
      case when to_char(h.srmrecfechavencim-h.srmrecdianotifplazo,'yyyy-mm-dd')='{0}' then 1 else 0 end avencer,
      case when to_char(h.srmrecfechavencim+{1},'yyyy-mm-dd')='{0}' then 1 else 0 end vencido,
      case when ((to_date('{0}','yyyy-mm-dd') - h.srmrecfechavencim)>0) then (
      case when mod(((to_date('{0}','yyyy-mm-dd') - h.srmrecfechavencim)),{2})=0 then 1 else 0 end
      ) else 0 end
      ciclico,
      h.srmreccodi,b.emprnomb,e.tareaabrev||' '||c.areanomb areanomb,a.equiabrev,h.srmrectitulo,h.srmrecrecomendacion,h.srmrecfecharecomend,h.srmrecfechavencim,
      h.srmrecrecomendacion,
      (case when (h.SRMRECFECHAVENCIM - to_date('{0}','yyyy-mm-dd'))&lt;0 and h.srmstdcodi!=3 then (select srmstddescrip from srm_estado where srmstdcodi = -2 ) else g.srmstddescrip  end) srmstddescrip,
      (case when (h.SRMRECFECHAVENCIM - to_date('{0}','yyyy-mm-dd'))&lt;0 and h.srmstdcodi!=3 then (select srmstdcolor from srm_estado where srmstdcodi = -2 ) else g.srmstdcolor  end) srmstdcolor,
      f.srmcrtcodi, f.srmcrtdescrip,f.srmcrtcolor,
      (case when (select count(*) from srm_comentario aa where aa.srmcomactivo='S' and aa.srmreccodi=h.srmreccodi)>0 then 'SI' else 'NO'  end) comentario,
      h.srmrecusucreacion, h.srmrecfeccreacion,
      h.srmrecusumodificacion, h.srmrecfecmodificacion,
      h.srmrecactivo
      from eq_equipo a, si_empresa b, eq_area c, eq_tipoarea e, srm_criticidad f, srm_estado g, srm_recomendacion h, eve_evento i
      where a.emprcodi=b.emprcodi and a.areacodi=c.areacodi and c.tareacodi=e.tareacodi and i.evencodi=h.evencodi and i.deleted='N' and  (i.evenasegoperacion='S' or i.evenpreliminar='A') and
      h.srmstdcodi=g.srmstdcodi and h.srmcrtcodi = f.srmcrtcodi and h.equicodi =a.equicodi
      and h.srmrecactivo='S' and h.srmstdcodi!=3
      order by h.srmreccodi
    </query>
  </Sql>
  <Sql>
    <key>TotalRegistrosCtaf</key>
    <query>
      select count(*) from srm_recomendacion where afrrec = {0}
    </query>
  </Sql>
  <Sql>
    <key>ObtenerListadoGestionCtaf</key>
    <query>
      select
      *
      from (
      select a.evencodi,
      'EVENTO CTAF' TIPO,
      b.emprnomb,
      e.tareaabrev||' '||c.areanomb areanomb,
      d.equiabrev,
      a.evenini,a.evenfin,
      a.evenasunto,
      f.srmrecfecharecomend,
      f.srmrecfechavencim,
      (select e.tareaabrev||' '||c.areanomb||' / '||dd.equiabrev
      from
      eq_area cc, eq_equipo dd, eq_tipoarea ee
      where cc.areacodi=dd.areacodi and cc.tareacodi=ee.tareacodi and dd.equicodi=f.equicodi
      ) equinomb,
      (case when (f.SRMRECFECHAVENCIM - to_date(to_char(sysdate,'dd/mm/yyyy'),'dd/mm/yyyy')) &lt; 0 and f.srmstdcodi!= 3 then -2 else g.srmstdcodi end) srmstdcodi,
      (case when (f.SRMRECFECHAVENCIM - to_date(to_char(sysdate,'dd/mm/yyyy'),'dd/mm/yyyy')) &lt; 0 and f.srmstdcodi!= 3 then (select srmstddescrip from srm_estado where srmstdcodi = -2 ) else g.srmstddescrip end) srmstddescrip,
      (case when (f.SRMRECFECHAVENCIM - to_date(to_char(sysdate,'dd/mm/yyyy'),'dd/mm/yyyy')) &lt; 0 and f.srmstdcodi!= 3 then (select srmstdcolor from srm_estado where srmstdcodi = -2) else g.srmstdcolor end) srmstdcolor,
      h.srmcrtcodi, h.srmcrtdescrip,h.srmcrtcolor,
      (f.SRMRECFECHAVENCIM - to_date(to_char(sysdate,'dd/mm/yyyy'),'dd/mm/yyyy')) Srmrecdianotifplazo,
      (select case count(*) when 0 then 'NO' ELSE 'SI' END from srm_comentario z where z.srmreccodi = f.srmreccodi) CONCOMENTARIO,
      (row_number() over (order by a.evenini desc)) as r,
      a.evenrcmctaf
      from eve_evento a, si_empresa b, eq_area c, eq_equipo d, eq_tipoarea e, srm_recomendacion f,srm_estado g, srm_criticidad h, eq_familia i, si_tipoempresa j
      where a.deleted='N' and f.srmrecactivo = 'S' and
      a.emprcodi=b.emprcodi and a.equicodi=d.equicodi and c.areacodi=d.areacodi and c.tareacodi=e.tareacodi and
      (a.evenasegoperacion!='S' and a.evenpreliminar!='A' and a.evenrcmctaf = 'S') and a.evencodi = f.evencodi and f.SRMSTDCODI= g.SRMSTDCODI and f.SRMCRTCODI = h.SRMCRTCODI and i.famcodi=d.famcodi
      and j.tipoemprcodi=b.tipoemprcodi
      and (a.evenini >= to_date('{0} 00:00:00','YYYY-MM-DD HH24:MI:SS') and (a.evenfin &lt; to_date('{1} 00:00:00','YYYY-MM-DD HH24:MI:SS')+1) or a.evenfin is null) and
      (d.famcodi={2} or 0={2}) and
      (upper(d.equiabrev) like upper('%{3}%') or 'x1x2x3'='{3}') and
      (b.tipoemprcodi={4} or 0={4}) and
      (b.emprcodi={5} or 0={5})
      order by a.evencodi,f.srmcrtcodi,(f.SRMRECFECHAVENCIM - to_date(to_char(sysdate,'dd/mm/yyyy'),'dd/mm/yyyy')),b.emprnomb, e.tareaabrev||' '||c.areanomb,d.equiabrev
      )
      where (r >= ((({6}-1) * {7}) + 1) and r &lt; (({6} * {7}) + 1 )) or ({6} = -1 and {7} = -1)
    </query>

  </Sql>
  <Sql>
    <key>ListadoRecomendacionesEventosCtaf</key>
    <query>
      select
      srmreccodi,
      evencodi,
      evenrcmctaf,
      afrrec,
      srmrecactivo
      from srm_recomendacion
      where evencodi = {0}
    </query>

  </Sql>
  <Sql>
    <key>GetByIdxAfrrec</key>
    <query>
      select
      srmreccodi,
      evencodi,
      equicodi,
      srmcrtcodi,
      srmstdcodi,
      usercode,
      srmrecfecharecomend,
      srmrecfechavencim,
      srmrecdianotifplazo,
      srmrectitulo,
      srmrecrecomendacion,
      srmrecactivo,
      srmrecusucreacion,
      srmrecfeccreacion,
      srmrecusumodificacion,
      srmrecfecmodificacion,
      evenrcmctaf
      from
      srm_recomendacion
      where
      afrrec = :afrrec
    </query>
  </Sql>
  <Sql>
    <key>ValidaRecomendacionxEventoEstado</key>
    <query>
      select count(*) from eve_evento evento
      inner join srm_recomendacion recomendacion
      on evento.evencodi = recomendacion.evencodi
      where evento.evencodi = {0} and recomendacion.srmstdcodi = {1}
    </query>
  </Sql>
  <Sql>
    <key>ObtenerRecomendacionEvento</key>
    <query>
      select count(*) from srm_recomendacion where evencodi = {0} and equicodi = {1} and srmcrtcodi = {2} and srmstdcodi = {3} and srmrecactivo = 'S'
    </query>
  </Sql>
</Sqls>
