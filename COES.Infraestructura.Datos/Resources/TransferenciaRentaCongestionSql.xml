<?xml version="1.0" encoding="utf-8" ?>
<Sqls>

  <Sql>
    <key>ListPeriodosRentaCongestion</key>
    <query>
      SELECT ext.* FROM (
      SELECT ROWNUM as item, QD.*
      FROM (
      SELECT PE.PERICODI ,RE.RECACODI,PE.PERINOMBRE,RE.RECANOMBRE,PE.PERIUSERNAME,PE.PERIFECINS,RE.RECAUSERNAME
      ,NVL(RE.RECAFECACT,RE.RECAFECINS) AS RECAFECACT,RE.RECAESTADO
      FROM TRN_PERIODO PE JOIN TRN_RECALCULO RE ON PE.PERICODI = RE.PERICODI
      {0}
      ORDER BY PE.PERIANIOMES DESC
      )QD
      WHERE ROWNUM &#60;= {1}
      ) ext
      WHERE ext.item >= {2}
    </query>
  </Sql>

  <Sql>
    <key>PeriodosRentaCongestionCount</key>
    <query>

      SELECT NVL(COUNT(*),0) AS Q_REGISTROS
      FROM TRN_PERIODO PE JOIN TRN_RECALCULO RE ON PE.PERICODI = RE.PERICODI

    </query>
  </Sql>

  <Sql>
    <key>DeleteDatosRentaPeriodo</key>
    <query>

      DELETE FROM RCG_RENTA_PERIODO WHERE PERICODI = {0} AND RECACODI = {1}

    </query>
  </Sql>

  <Sql>
    <key>DeleteDatosRentaCongestion</key>
    <query>

      DELETE FROM RCG_RENTA_CONGESTION
      WHERE TRETCODI IN (SELECT TRETCODI FROM TRN_TRANS_RETIRO
      WHERE tretestado = 'ACT' and  PERICODI={0} AND TRETVERSION = {1})

    </query>
  </Sql>
  <Sql>
    <key>DeleteDatosRentaEntrega</key>
    <query>

      DELETE FROM RCG_TRANS_ENTREGA_RENDET
      WHERE TENTCODI IN (SELECT TENTCODI FROM TRN_TRANS_ENTREGA
      WHERE tentestado = 'ACT' and  PERICODI={0} AND TENTVERSION = {1})

    </query>
  </Sql>
  <Sql>
    <key>DeleteDatosRentaRetiro</key>
    <query>

      DELETE FROM RCG_TRANS_RETIRO_RENDET
      WHERE TRETCODI IN (SELECT TRETCODI FROM TRN_TRANS_RETIRO
      WHERE tretestado = 'ACT' and   PERICODI={0} AND TRETVERSION = {1})

    </query>
  </Sql>
  <Sql>
    <key>DeleteDatosRentaReparto</key>
    <query>

      DELETE FROM RCG_REPARTO_RND
      WHERE PERICODI = {0} AND RECACODI = {1}

    </query>
  </Sql>

  <Sql>
    <key>DeleteDatosIngresoCompensacion</key>
    <query>

      DELETE FROM TRN_ING_COMPENSACION
      WHERE PERICODI = {0} AND INGCOMVERSION = {1} AND CABCOMCODI = {2}

    </query>
  </Sql>

  <Sql>
    <key>GetPeriodoMes</key>
    <query>
      SELECT PERIANIOMES AS PERIANIOMES  FROM TRN_PERIODO WHERE PERICODI = {0}

    </query>
  </Sql>

  <Sql>
    <key>GetMaximoEntregaId</key>
    <query>
      SELECT NVL(MAX(RCENTDCODI),0) AS RCENTDCODI  FROM RCG_TRANS_ENTREGA_RENDET

    </query>
  </Sql>

  <Sql>
    <key>GetMaximoRetiroId</key>
    <query>
      SELECT NVL(MAX(RCRETDCODI),0) AS RCRETDCODI  FROM RCG_TRANS_RETIRO_RENDET

    </query>
  </Sql>

  <Sql>
    <key>GetMaximoPeriodoId</key>
    <query>
      SELECT NVL(MAX(RCRPERCODI),0) AS RCRPERCODI FROM RCG_RENTA_PERIODO

    </query>
  </Sql>

  <Sql>
    <key>GetMaximoRepartoId</key>
    <query>
      SELECT NVL(MAX(RCRRNDCODI),0) AS RCRRNDCODI FROM RCG_REPARTO_RND
    </query>
  </Sql>

  <Sql>
    <key>GetMaximoIngresoCompensacionId</key>
    <query>
      SELECT NVL(MAX(INGCOMCODI),0) AS INGCOMCODI FROM TRN_ING_COMPENSACION
    </query>
  </Sql>

  <Sql>
    <key>GetMaximoCabeceraCompensacionId</key>
    <query>
      SELECT NVL(MAX(CABCOMCODI),0) AS CABCOMCODI
      FROM TRN_CABE_COMPENSACION WHERE UPPER(CABCOMRENTCONGE)='SI' AND PERICODI = :PERICODI
    </query>
  </Sql>

  <Sql>
    <key>GetPeriodoVersionReparto</key>
    <query>
      SELECT PERICODI,INGRSCVERSION --INTO V_PORC_PERICODI,V_PORC_VERSION
      FROM (
      SELECT DISTINCT PERICODI,INGRSCVERSION
      FROM TRN_ING_RETIROSC
      WHERE PERICODI &#60;= {0} AND INGRSCVERSION &#60;= {1}
      ORDER BY 1 DESC,2 DESC ) RES WHERE ROWNUM = 1
    </query>
  </Sql>

  <Sql>
    <key>GetTotalReparto</key>
    <query>
      SELECT SUM(RCRENCRENTA) AS RENTATOTAL --INTO V_RENTATOTAL_RND
      FROM RCG_RENTA_CONGESTION RC JOIN TRN_TRANS_RETIRO TR ON RC.TRETCODI = TR.TRETCODI
      WHERE TR.PERICODI = :PERICODI AND TR.TRETVERSION = :RECACODI
      AND tr.tretestado = 'ACT' and TR.TRETCODIGO LIKE '%RN_'
    </query>
  </Sql>

  <Sql>
    <key>SaveDetalleReparto</key>
    <query>
      INSERT INTO RCG_REPARTO_RND(RCRRNDCODI,PERICODI,RECACODI,EMPRCODI,RCRRNDRENTA,RCRRNDUSUCREACION,RCRRNDFECCREACION)
      SELECT {0}+ROWNUM,{1},{2},EMPRCODI,INGRSCIMPORTE*{3},'{4}',SYSDATE
      FROM TRN_ING_RETIROSC
      WHERE PERICODI = :PORC_PERICODI AND INGRSCVERSION = :PORC_VERSION
      AND INGRSCIMPORTE &#60;> 0
    </query>
  </Sql>

  <Sql>
    <key>SaveDetalleEntrega</key>
    <query>

      INSERT INTO RCG_TRANS_ENTREGA_RENDET(RCENTDCODI,TENTCODI,RCENTDHORA,RCENTDCMGC,RCENTDENERGIA,RCENTDRENTA)
      SELECT {0} + ROWNUM, TENTCODI,CMGRFECHA,CMGRCONGESTION,TENTDEENERGIA,-1*TENTDEENERGIA*CMGRCONGESTION*1000
      FROM  (SELECT TENTCODI,TO_DATE({1}||TENTDEDIA,'YYYYMMDD')+TENTDEMINUTO*1/24/60 AS TENTDEFECHA,BARRCODI,TENTDEENERGIA
      FROM   (SELECT CA.BARRCODI, DE.*
      FROM TRN_TRANS_ENTREGA CA JOIN TRN_TRANS_ENTREGA_DETALLE DE ON CA.TENTCODI = DE.TENTCODI AND CA.TENTVERSION = DE.TENTDEVERSION
      WHERE ca.tentestado = 'ACT' and CA.PERICODI = :PERICODI AND CA.TENTVERSION = :RECACODI
      AND TENTDEDIA BETWEEN 1 AND {2}
      )
      UNPIVOT (TENTDEENERGIA FOR TENTDEMINUTO IN (TENTDE1	 AS 1*15,
      TENTDE2	 AS 2*15,
      TENTDE3	 AS 3*15,
      TENTDE4	 AS 4*15,
      TENTDE5	 AS 5*15,
      TENTDE6	 AS 6*15,
      TENTDE7	 AS 7*15,
      TENTDE8	 AS 8*15,
      TENTDE9	 AS 9*15,
      TENTDE10	 AS 10*15,
      TENTDE11	 AS 11*15,
      TENTDE12	 AS 12*15,
      TENTDE13	 AS 13*15,
      TENTDE14	 AS 14*15,
      TENTDE15	 AS 15*15,
      TENTDE16	 AS 16*15,
      TENTDE17	 AS 17*15,
      TENTDE18	 AS 18*15,
      TENTDE19	 AS 19*15,
      TENTDE20	 AS 20*15,
      TENTDE21	 AS 21*15,
      TENTDE22	 AS 22*15,
      TENTDE23	 AS 23*15,
      TENTDE24	 AS 24*15,
      TENTDE25	 AS 25*15,
      TENTDE26	 AS 26*15,
      TENTDE27	 AS 27*15,
      TENTDE28	 AS 28*15,
      TENTDE29	 AS 29*15,
      TENTDE30	 AS 30*15,
      TENTDE31	 AS 31*15,
      TENTDE32	 AS 32*15,
      TENTDE33	 AS 33*15,
      TENTDE34	 AS 34*15,
      TENTDE35	 AS 35*15,
      TENTDE36	 AS 36*15,
      TENTDE37	 AS 37*15,
      TENTDE38	 AS 38*15,
      TENTDE39	 AS 39*15,
      TENTDE40	 AS 40*15,
      TENTDE41	 AS 41*15,
      TENTDE42	 AS 42*15,
      TENTDE43	 AS 43*15,
      TENTDE44	 AS 44*15,
      TENTDE45	 AS 45*15,
      TENTDE46	 AS 46*15,
      TENTDE47	 AS 47*15,
      TENTDE48	 AS 48*15,
      TENTDE49	 AS 49*15,
      TENTDE50	 AS 50*15,
      TENTDE51	 AS 51*15,
      TENTDE52	 AS 52*15,
      TENTDE53	 AS 53*15,
      TENTDE54	 AS 54*15,
      TENTDE55	 AS 55*15,
      TENTDE56	 AS 56*15,
      TENTDE57	 AS 57*15,
      TENTDE58	 AS 58*15,
      TENTDE59	 AS 59*15,
      TENTDE60	 AS 60*15,
      TENTDE61	 AS 61*15,
      TENTDE62	 AS 62*15,
      TENTDE63	 AS 63*15,
      TENTDE64	 AS 64*15,
      TENTDE65	 AS 65*15,
      TENTDE66	 AS 66*15,
      TENTDE67	 AS 67*15,
      TENTDE68	 AS 68*15,
      TENTDE69	 AS 69*15,
      TENTDE70	 AS 70*15,
      TENTDE71	 AS 71*15,
      TENTDE72	 AS 72*15,
      TENTDE73	 AS 73*15,
      TENTDE74	 AS 74*15,
      TENTDE75	 AS 75*15,
      TENTDE76	 AS 76*15,
      TENTDE77	 AS 77*15,
      TENTDE78	 AS 78*15,
      TENTDE79	 AS 79*15,
      TENTDE80	 AS 80*15,
      TENTDE81	 AS 81*15,
      TENTDE82	 AS 82*15,
      TENTDE83	 AS 83*15,
      TENTDE84	 AS 84*15,
      TENTDE85	 AS 85*15,
      TENTDE86	 AS 86*15,
      TENTDE87	 AS 87*15,
      TENTDE88	 AS 88*15,
      TENTDE89	 AS 89*15,
      TENTDE90	 AS 90*15,
      TENTDE91	 AS 91*15,
      TENTDE92	 AS 92*15,
      TENTDE93	 AS 93*15,
      TENTDE94	 AS 94*15,
      TENTDE95	 AS 95*15,
      TENTDE96	 AS 96*15)) ENT
      ORDER BY 1) EDET
      JOIN (
      SELECT DISTINCT CASE WHEN TO_CHAR(CMGRFECHA,'HH24:MI')='23:59' THEN CMGRFECHA+1/24/60 ELSE CMGRFECHA END AS CMGRFECHA,BARRCODI,(CMGRCONGESTION/1000) AS CMGRCONGESTION
      FROM (
      SELECT TO_DATE({1}||RCCMGDDIA,'YYYYMMDD')+MINUTO*1/24/60 AS CMGRFECHA,BARRCODI,CMGRCONGESTION
      FROM   (SELECT DE.*
      FROM RCG_COSTOMARGINAL_CAB CA JOIN RCG_COSTOMARGINAL_DET DE ON CA.RCCMGCCODI = DE.RCCMGCCODI
      WHERE CA.PERICODI = :PERICODI AND CA.RECACODI = :RECACODI
      AND DE.RCCMGDDIA BETWEEN 1 AND {2}
      )
      UNPIVOT (CMGRCONGESTION FOR MINUTO IN (RCCMGD1	 AS 1*30,
      RCCMGD2	 AS 2*30,
      RCCMGD3	 AS 3*30,
      RCCMGD4	 AS 4*30,
      RCCMGD5	 AS 5*30,
      RCCMGD6	 AS 6*30,
      RCCMGD7	 AS 7*30,
      RCCMGD8	 AS 8*30,
      RCCMGD9	 AS 9*30,
      RCCMGD10	 AS 10*30,
      RCCMGD11	 AS 11*30,
      RCCMGD12	 AS 12*30,
      RCCMGD13	 AS 13*30,
      RCCMGD14	 AS 14*30,
      RCCMGD15	 AS 15*30,
      RCCMGD16	 AS 16*30,
      RCCMGD17	 AS 17*30,
      RCCMGD18	 AS 18*30,
      RCCMGD19	 AS 19*30,
      RCCMGD20	 AS 20*30,
      RCCMGD21	 AS 21*30,
      RCCMGD22	 AS 22*30,
      RCCMGD23	 AS 23*30,
      RCCMGD24	 AS 24*30,
      RCCMGD25	 AS 25*30,
      RCCMGD26	 AS 26*30,
      RCCMGD27	 AS 27*30,
      RCCMGD28	 AS 28*30,
      RCCMGD29	 AS 29*30,
      RCCMGD30	 AS 30*30,
      RCCMGD31	 AS 31*30,
      RCCMGD32	 AS 32*30,
      RCCMGD33	 AS 33*30,
      RCCMGD34	 AS 34*30,
      RCCMGD35	 AS 35*30,
      RCCMGD36	 AS 36*30,
      RCCMGD37	 AS 37*30,
      RCCMGD38	 AS 38*30,
      RCCMGD39	 AS 39*30,
      RCCMGD40	 AS 40*30,
      RCCMGD41	 AS 41*30,
      RCCMGD42	 AS 42*30,
      RCCMGD43	 AS 43*30,
      RCCMGD44	 AS 44*30,
      RCCMGD45	 AS 45*30,
      RCCMGD46	 AS 46*30,
      RCCMGD47	 AS 47*30,
      RCCMGD48	 AS 48*30
      )) ENT
      )
      UNION
      SELECT DISTINCT CASE WHEN TO_CHAR(CMGRFECHA,'HH24:MI')='23:59' THEN CMGRFECHA+1/24/60 ELSE CMGRFECHA END-15*(1/24/60),BARRCODI,(CMGRCONGESTION/1000) AS CMGRCONGESTION
      FROM (
      SELECT TO_DATE({1}||RCCMGDDIA,'YYYYMMDD')+MINUTO*1/24/60 AS CMGRFECHA,BARRCODI,CMGRCONGESTION
      FROM   (SELECT DE.*
      FROM RCG_COSTOMARGINAL_CAB CA JOIN RCG_COSTOMARGINAL_DET DE ON CA.RCCMGCCODI = DE.RCCMGCCODI
      WHERE CA.PERICODI = :PERICODI AND CA.RECACODI = :RECACODI
      AND DE.RCCMGDDIA BETWEEN 1 AND {2}
      )
      UNPIVOT (CMGRCONGESTION FOR MINUTO IN (RCCMGD1	 AS 1*30,
      RCCMGD2	 AS 2*30,
      RCCMGD3	 AS 3*30,
      RCCMGD4	 AS 4*30,
      RCCMGD5	 AS 5*30,
      RCCMGD6	 AS 6*30,
      RCCMGD7	 AS 7*30,
      RCCMGD8	 AS 8*30,
      RCCMGD9	 AS 9*30,
      RCCMGD10	 AS 10*30,
      RCCMGD11	 AS 11*30,
      RCCMGD12	 AS 12*30,
      RCCMGD13	 AS 13*30,
      RCCMGD14	 AS 14*30,
      RCCMGD15	 AS 15*30,
      RCCMGD16	 AS 16*30,
      RCCMGD17	 AS 17*30,
      RCCMGD18	 AS 18*30,
      RCCMGD19	 AS 19*30,
      RCCMGD20	 AS 20*30,
      RCCMGD21	 AS 21*30,
      RCCMGD22	 AS 22*30,
      RCCMGD23	 AS 23*30,
      RCCMGD24	 AS 24*30,
      RCCMGD25	 AS 25*30,
      RCCMGD26	 AS 26*30,
      RCCMGD27	 AS 27*30,
      RCCMGD28	 AS 28*30,
      RCCMGD29	 AS 29*30,
      RCCMGD30	 AS 30*30,
      RCCMGD31	 AS 31*30,
      RCCMGD32	 AS 32*30,
      RCCMGD33	 AS 33*30,
      RCCMGD34	 AS 34*30,
      RCCMGD35	 AS 35*30,
      RCCMGD36	 AS 36*30,
      RCCMGD37	 AS 37*30,
      RCCMGD38	 AS 38*30,
      RCCMGD39	 AS 39*30,
      RCCMGD40	 AS 40*30,
      RCCMGD41	 AS 41*30,
      RCCMGD42	 AS 42*30,
      RCCMGD43	 AS 43*30,
      RCCMGD44	 AS 44*30,
      RCCMGD45	 AS 45*30,
      RCCMGD46	 AS 46*30,
      RCCMGD47	 AS 47*30,
      RCCMGD48	 AS 48*30
      )) ENT
      )

      ) CMGC ON CMGC.CMGRFECHA = EDET.TENTDEFECHA AND EDET.BARRCODI = CMGC.BARRCODI


    </query>
  </Sql>

  <Sql>
    <key>SaveDetalleRetiro</key>
    <query>

      INSERT INTO RCG_TRANS_RETIRO_RENDET(RCRETDCODI,TRETCODI,RCRETDHORA,RCRETDCMGC,RCRETDENERGIA,RCRETDRENTA)
      SELECT {0} + ROWNUM, TRETCODI,CMGRFECHA,CMGRCONGESTION,TRETDEENERGIA,1*TRETDEENERGIA*CMGRCONGESTION*1000
      FROM  (SELECT TRETCODI,TO_DATE({1}||TRETDEDIA,'YYYYMMDD')+TRETDEMINUTO*1/24/60 AS TRETDEFECHA,BARRCODI,TRETDEENERGIA
      FROM   (SELECT CA.BARRCODI, DE.*
      FROM TRN_TRANS_RETIRO CA JOIN TRN_TRANS_RETIRO_DETALLE DE ON CA.TRETCODI = DE.TRETCODI AND CA.TRETVERSION = DE.TRETDEVERSION
      WHERE ca.tretestado = 'ACT' and CA.PERICODI = :PERICODI AND CA.TRETVERSION = :RECACODI
      AND TRETDEDIA BETWEEN 1 AND {2}
      )
      UNPIVOT (TRETDEENERGIA FOR TRETDEMINUTO IN (TRETDE1	 AS 1*15,
      TRETDE2	 AS 2*15,
      TRETDE3	 AS 3*15,
      TRETDE4	 AS 4*15,
      TRETDE5	 AS 5*15,
      TRETDE6	 AS 6*15,
      TRETDE7	 AS 7*15,
      TRETDE8	 AS 8*15,
      TRETDE9	 AS 9*15,
      TRETDE10	 AS 10*15,
      TRETDE11	 AS 11*15,
      TRETDE12	 AS 12*15,
      TRETDE13	 AS 13*15,
      TRETDE14	 AS 14*15,
      TRETDE15	 AS 15*15,
      TRETDE16	 AS 16*15,
      TRETDE17	 AS 17*15,
      TRETDE18	 AS 18*15,
      TRETDE19	 AS 19*15,
      TRETDE20	 AS 20*15,
      TRETDE21	 AS 21*15,
      TRETDE22	 AS 22*15,
      TRETDE23	 AS 23*15,
      TRETDE24	 AS 24*15,
      TRETDE25	 AS 25*15,
      TRETDE26	 AS 26*15,
      TRETDE27	 AS 27*15,
      TRETDE28	 AS 28*15,
      TRETDE29	 AS 29*15,
      TRETDE30	 AS 30*15,
      TRETDE31	 AS 31*15,
      TRETDE32	 AS 32*15,
      TRETDE33	 AS 33*15,
      TRETDE34	 AS 34*15,
      TRETDE35	 AS 35*15,
      TRETDE36	 AS 36*15,
      TRETDE37	 AS 37*15,
      TRETDE38	 AS 38*15,
      TRETDE39	 AS 39*15,
      TRETDE40	 AS 40*15,
      TRETDE41	 AS 41*15,
      TRETDE42	 AS 42*15,
      TRETDE43	 AS 43*15,
      TRETDE44	 AS 44*15,
      TRETDE45	 AS 45*15,
      TRETDE46	 AS 46*15,
      TRETDE47	 AS 47*15,
      TRETDE48	 AS 48*15,
      TRETDE49	 AS 49*15,
      TRETDE50	 AS 50*15,
      TRETDE51	 AS 51*15,
      TRETDE52	 AS 52*15,
      TRETDE53	 AS 53*15,
      TRETDE54	 AS 54*15,
      TRETDE55	 AS 55*15,
      TRETDE56	 AS 56*15,
      TRETDE57	 AS 57*15,
      TRETDE58	 AS 58*15,
      TRETDE59	 AS 59*15,
      TRETDE60	 AS 60*15,
      TRETDE61	 AS 61*15,
      TRETDE62	 AS 62*15,
      TRETDE63	 AS 63*15,
      TRETDE64	 AS 64*15,
      TRETDE65	 AS 65*15,
      TRETDE66	 AS 66*15,
      TRETDE67	 AS 67*15,
      TRETDE68	 AS 68*15,
      TRETDE69	 AS 69*15,
      TRETDE70	 AS 70*15,
      TRETDE71	 AS 71*15,
      TRETDE72	 AS 72*15,
      TRETDE73	 AS 73*15,
      TRETDE74	 AS 74*15,
      TRETDE75	 AS 75*15,
      TRETDE76	 AS 76*15,
      TRETDE77	 AS 77*15,
      TRETDE78	 AS 78*15,
      TRETDE79	 AS 79*15,
      TRETDE80	 AS 80*15,
      TRETDE81	 AS 81*15,
      TRETDE82	 AS 82*15,
      TRETDE83	 AS 83*15,
      TRETDE84	 AS 84*15,
      TRETDE85	 AS 85*15,
      TRETDE86	 AS 86*15,
      TRETDE87	 AS 87*15,
      TRETDE88	 AS 88*15,
      TRETDE89	 AS 89*15,
      TRETDE90	 AS 90*15,
      TRETDE91	 AS 91*15,
      TRETDE92	 AS 92*15,
      TRETDE93	 AS 93*15,
      TRETDE94	 AS 94*15,
      TRETDE95	 AS 95*15,
      TRETDE96	 AS 96*15)) ENT
      ORDER BY 1) EDET
      JOIN (
      SELECT DISTINCT CASE WHEN TO_CHAR(CMGRFECHA,'HH24:MI')='23:59' THEN CMGRFECHA+1/24/60 ELSE CMGRFECHA END AS CMGRFECHA,BARRCODI,(CMGRCONGESTION/1000) AS CMGRCONGESTION
      FROM (
      SELECT TO_DATE({1}||RCCMGDDIA,'YYYYMMDD')+MINUTO*1/24/60 AS CMGRFECHA,BARRCODI,CMGRCONGESTION
      FROM   (SELECT DE.*
      FROM RCG_COSTOMARGINAL_CAB CA JOIN RCG_COSTOMARGINAL_DET DE ON CA.RCCMGCCODI = DE.RCCMGCCODI
      WHERE CA.PERICODI = :PERICODI AND CA.RECACODI = :RECACODI
      AND DE.RCCMGDDIA BETWEEN 1 AND {2}
      )
      UNPIVOT (CMGRCONGESTION FOR MINUTO IN (RCCMGD1	 AS 1*30,
      RCCMGD2	 AS 2*30,
      RCCMGD3	 AS 3*30,
      RCCMGD4	 AS 4*30,
      RCCMGD5	 AS 5*30,
      RCCMGD6	 AS 6*30,
      RCCMGD7	 AS 7*30,
      RCCMGD8	 AS 8*30,
      RCCMGD9	 AS 9*30,
      RCCMGD10	 AS 10*30,
      RCCMGD11	 AS 11*30,
      RCCMGD12	 AS 12*30,
      RCCMGD13	 AS 13*30,
      RCCMGD14	 AS 14*30,
      RCCMGD15	 AS 15*30,
      RCCMGD16	 AS 16*30,
      RCCMGD17	 AS 17*30,
      RCCMGD18	 AS 18*30,
      RCCMGD19	 AS 19*30,
      RCCMGD20	 AS 20*30,
      RCCMGD21	 AS 21*30,
      RCCMGD22	 AS 22*30,
      RCCMGD23	 AS 23*30,
      RCCMGD24	 AS 24*30,
      RCCMGD25	 AS 25*30,
      RCCMGD26	 AS 26*30,
      RCCMGD27	 AS 27*30,
      RCCMGD28	 AS 28*30,
      RCCMGD29	 AS 29*30,
      RCCMGD30	 AS 30*30,
      RCCMGD31	 AS 31*30,
      RCCMGD32	 AS 32*30,
      RCCMGD33	 AS 33*30,
      RCCMGD34	 AS 34*30,
      RCCMGD35	 AS 35*30,
      RCCMGD36	 AS 36*30,
      RCCMGD37	 AS 37*30,
      RCCMGD38	 AS 38*30,
      RCCMGD39	 AS 39*30,
      RCCMGD40	 AS 40*30,
      RCCMGD41	 AS 41*30,
      RCCMGD42	 AS 42*30,
      RCCMGD43	 AS 43*30,
      RCCMGD44	 AS 44*30,
      RCCMGD45	 AS 45*30,
      RCCMGD46	 AS 46*30,
      RCCMGD47	 AS 47*30,
      RCCMGD48	 AS 48*30
      )) ENT
      )
      UNION
      SELECT DISTINCT CASE WHEN TO_CHAR(CMGRFECHA,'HH24:MI')='23:59' THEN CMGRFECHA+1/24/60 ELSE CMGRFECHA END-15*(1/24/60),BARRCODI,(CMGRCONGESTION/1000) AS CMGRCONGESTION
      FROM (
      SELECT TO_DATE({1}||RCCMGDDIA,'YYYYMMDD')+MINUTO*1/24/60 AS CMGRFECHA,BARRCODI,CMGRCONGESTION
      FROM   (SELECT DE.*
      FROM RCG_COSTOMARGINAL_CAB CA JOIN RCG_COSTOMARGINAL_DET DE ON CA.RCCMGCCODI = DE.RCCMGCCODI
      WHERE CA.PERICODI = :PERICODI AND CA.RECACODI = :RECACODI
      AND DE.RCCMGDDIA BETWEEN 1 AND {2}
      )
      UNPIVOT (CMGRCONGESTION FOR MINUTO IN (RCCMGD1	 AS 1*30,
      RCCMGD2	 AS 2*30,
      RCCMGD3	 AS 3*30,
      RCCMGD4	 AS 4*30,
      RCCMGD5	 AS 5*30,
      RCCMGD6	 AS 6*30,
      RCCMGD7	 AS 7*30,
      RCCMGD8	 AS 8*30,
      RCCMGD9	 AS 9*30,
      RCCMGD10	 AS 10*30,
      RCCMGD11	 AS 11*30,
      RCCMGD12	 AS 12*30,
      RCCMGD13	 AS 13*30,
      RCCMGD14	 AS 14*30,
      RCCMGD15	 AS 15*30,
      RCCMGD16	 AS 16*30,
      RCCMGD17	 AS 17*30,
      RCCMGD18	 AS 18*30,
      RCCMGD19	 AS 19*30,
      RCCMGD20	 AS 20*30,
      RCCMGD21	 AS 21*30,
      RCCMGD22	 AS 22*30,
      RCCMGD23	 AS 23*30,
      RCCMGD24	 AS 24*30,
      RCCMGD25	 AS 25*30,
      RCCMGD26	 AS 26*30,
      RCCMGD27	 AS 27*30,
      RCCMGD28	 AS 28*30,
      RCCMGD29	 AS 29*30,
      RCCMGD30	 AS 30*30,
      RCCMGD31	 AS 31*30,
      RCCMGD32	 AS 32*30,
      RCCMGD33	 AS 33*30,
      RCCMGD34	 AS 34*30,
      RCCMGD35	 AS 35*30,
      RCCMGD36	 AS 36*30,
      RCCMGD37	 AS 37*30,
      RCCMGD38	 AS 38*30,
      RCCMGD39	 AS 39*30,
      RCCMGD40	 AS 40*30,
      RCCMGD41	 AS 41*30,
      RCCMGD42	 AS 42*30,
      RCCMGD43	 AS 43*30,
      RCCMGD44	 AS 44*30,
      RCCMGD45	 AS 45*30,
      RCCMGD46	 AS 46*30,
      RCCMGD47	 AS 47*30,
      RCCMGD48	 AS 48*30
      )) ENT
      )


      ) CMGC ON CMGC.CMGRFECHA = EDET.TRETDEFECHA AND EDET.BARRCODI = CMGC.BARRCODI

    </query>
  </Sql>

  <Sql>
    <key>SaveRentaPeriodo</key>
    <query>

      INSERT INTO RCG_RENTA_PERIODO(RCRPERCODI,PERICODI,RECACODI,RCRPERHORA,RCRPERRENTA,RCRPERFLAGASIGNADA,RCRPERRETIROSCONGESTION,RCRPERUSUCREACION,RCRPERFECCREACION)
      SELECT {0} + ROWNUM,:PERICODI,:RECACODI,FECHORA,RENTA,CASE WHEN RENTA>0 AND NVL(RETCONG,0)&#60;>0 THEN 1 WHEN RENTA>0 AND NVL(RETCONG,0) = 0 THEN 0 ELSE null END AS FLAGASIGNADA,RETCONG,:USUARIO,SYSDATE
      FROM (
      SELECT FECHORA
      ,SUM(CASE WHEN TIPO IN ('ET','RT') THEN RENTA END) AS RENTA
      ,SUM(CASE WHEN TIPO IN ('RC') THEN RENTA END) AS RETCONG
      FROM (
      SELECT RCENTDHORA AS FECHORA,'ET' AS TIPO, SUM(RCENTDRENTA) AS RENTA FROM RCG_TRANS_ENTREGA_RENDET DE
      WHERE TENTCODI IN (SELECT TENTCODI FROM TRN_TRANS_ENTREGA
      WHERE  tentestado = 'ACT' and PERICODI=:PERICODI AND TENTVERSION = :RECACODI)
      GROUP BY RCENTDHORA
      UNION
      SELECT RCRETDHORA, 'RT' AS TIPO, SUM(RCRETDRENTA) FROM RCG_TRANS_RETIRO_RENDET
      WHERE TRETCODI IN (SELECT TRETCODI FROM TRN_TRANS_RETIRO
      WHERE  tretestado = 'ACT' and PERICODI=:PERICODI AND TRETVERSION = :RECACODI)
      GROUP BY RCRETDHORA
      UNION
      SELECT RCRETDHORA, 'RC' AS TIPO, SUM(RCRETDRENTA) FROM RCG_TRANS_RETIRO_RENDET
      WHERE TRETCODI IN (SELECT TRETCODI FROM TRN_TRANS_RETIRO
      WHERE tretestado = 'ACT' and  PERICODI=:PERICODI AND TRETVERSION = :RECACODI)
      AND RCRETDCMGC > 0
      GROUP BY RCRETDHORA) RES
      GROUP BY FECHORA
      ORDER BY FECHORA) GRP
    </query>
  </Sql>

  <Sql>
    <key>SaveRentaCongestionRetiro</key>
    <query>

      INSERT INTO RCG_RENTA_CONGESTION(TRETCODI,RCRENCRENTA,RCRENCUSUCREACION,RCRENCFECCREACION)
      SELECT TRETCODI, SUM(RCRETDRENTA*PER.RCRPERRENTA/PER.RCRPERRETIROSCONGESTION ) RENTACONGESTION,'{0}',SYSDATE
      FROM RCG_TRANS_RETIRO_RENDET RET JOIN RCG_RENTA_PERIODO PER ON RET.RCRETDHORA = PER.RCRPERHORA
      WHERE PER.PERICODI = {1} AND PER.RECACODI = {2}
      AND RET.TRETCODI IN (SELECT TRETCODI FROM TRN_TRANS_RETIRO
      WHERE  tretestado = 'ACT' and PERICODI= {1} AND TRETVERSION = {2})
      AND RET.RCRETDCMGC > 0 AND RCRPERFLAGASIGNADA=1
      GROUP BY TRETCODI

    </query>
  </Sql>

  <Sql>
    <key>SaveRentaCongestionIngresoCompensacion</key>
    <query>

      INSERT INTO TRN_ING_COMPENSACION(INGCOMCODI,CABCOMCODI,PERICODI,INGCOMVERSION,EMPRCODI,INGCOMIMPORTE,INGCOMUSERNAME,INGCOMFECINS,INGCOMFECACT)
      SELECT {0}+ROWNUM,{1},{2},{3},RES.GENEMPRCODI,RES.RENTA_TOT,'{4}',SYSDATE,SYSDATE
      FROM (
      SELECT RET.GENEMPRCODI,SUM(RET.RENTA) AS RENTA_TOT
      FROM (
      SELECT RET.GENEMPRCODI,'REN' AS TIPO, SUM(RC.RCRENCRENTA) AS RENTA
      FROM TRN_TRANS_RETIRO RET JOIN RCG_RENTA_CONGESTION RC ON RET.TRETCODI = RC.TRETCODI
      WHERE ret.tretestado = 'ACT' and RET.PERICODI = {2} AND RET.TRETVERSION = {3}
      GROUP BY RET.GENEMPRCODI
      UNION
      SELECT EMPRCODI,'RND' AS TIPO, RCRRNDRENTA AS RENTA
      FROM RCG_REPARTO_RND
      WHERE PERICODI = {2} AND RECACODI = {3}
      UNION
      SELECT TR.GENEMPRCODI, 'RND' AS TIPO, -1*SUM(RCRENCRENTA) AS RENTA
      FROM RCG_RENTA_CONGESTION RC JOIN TRN_TRANS_RETIRO TR ON RC.TRETCODI = TR.TRETCODI
      WHERE tr.tretestado = 'ACT' and TR.PERICODI = {2} AND TR.TRETVERSION = {3}
      AND TR.TRETCODIGO LIKE '%RN_'
      GROUP BY TR.GENEMPRCODI
      ) RET
      GROUP BY RET.GENEMPRCODI) RES

    </query>
  </Sql>

  <Sql>
    <key>GetTotalRentaCongestion</key>
    <query>
      <!--SELECT NVL(ROUND(SUM(RC.RCRENCRENTA),2),0) AS RENTA
      FROM TRN_TRANS_RETIRO RET JOIN RCG_RENTA_CONGESTION RC ON RET.TRETCODI = RC.TRETCODI
      WHERE RET.PERICODI = :PERICODI AND RET.TRETVERSION = :RECACODI-->
      <!--MODIFICADO POR ASSETEC 20200331-->
      SELECT NVL(SUM(RC.RCRENCRENTA),0) AS RENTA
      FROM TRN_TRANS_RETIRO RET JOIN RCG_RENTA_CONGESTION RC ON RET.TRETCODI = RC.TRETCODI
      WHERE ret.tretestado = 'ACT' and RET.PERICODI = :PERICODI AND RET.TRETVERSION = :RECACODI
    </query>
  </Sql>

  <Sql>
    <key>GetTotalRentaNoAsignada</key>
    <query>

      SELECT NVL(ROUND(SUM(RCRPERRENTA),2),0) AS RENTA_NO_ASIGNADA FROM RCG_RENTA_PERIODO
      WHERE PERICODI = :PERICODI AND RECACODI = :RECACODI AND RCRPERFLAGASIGNADA = 0

    </query>
  </Sql>

  <Sql>
    <key>ListRentaCongestion</key>
    <query>

      SELECT * FROM (
      SELECT EM.EMPRNOMB
      ,SUM(CASE WHEN TIPO='REN' THEN RET.RENTA END) AS RCRENCRENTA
      ,SUM(CASE WHEN TIPO='RND' THEN RET.RENTA END) AS REPARTO
      ,SUM(RET.RENTA) AS RENTATOTAL
      FROM (
      SELECT RET.GENEMPRCODI,'REN' AS TIPO, SUM(RC.RCRENCRENTA) AS RENTA
      FROM TRN_TRANS_RETIRO RET JOIN RCG_RENTA_CONGESTION RC ON RET.TRETCODI = RC.TRETCODI
      WHERE ret.tretestado = 'ACT' and RET.PERICODI = {0} AND RET.TRETVERSION = {1}
      GROUP BY RET.GENEMPRCODI
      UNION
      SELECT EMPRCODI,'RND' AS TIPO, RCRRNDRENTA AS RENTA
      FROM RCG_REPARTO_RND
      WHERE PERICODI = {0} AND RECACODI = {1}
      UNION
      SELECT TR.GENEMPRCODI, 'RND' AS TIPO, -1*SUM(RCRENCRENTA) AS RENTA
      FROM RCG_RENTA_CONGESTION RC JOIN TRN_TRANS_RETIRO TR ON RC.TRETCODI = TR.TRETCODI
      WHERE tr.tretestado = 'ACT' and TR.PERICODI = {0} AND TR.TRETVERSION = {1}
      AND TR.TRETCODIGO LIKE '%RN_'
      GROUP BY TR.GENEMPRCODI
      ) RET LEFT JOIN SI_EMPRESA EM ON RET.GENEMPRCODI = EM.EMPRCODI
      GROUP BY EM.EMPRNOMB) RES
      ORDER BY CASE WHEN REPARTO &#60;0 THEN 1 ELSE 0 END,EMPRNOMB

    </query>
  </Sql>

  <Sql>
    <key>ListRentaCongestionDetalle</key>
    <query>

      SELECT GEN.EMPRNOMB,CLI.EMPRNOMB AS EMPRNOMBRECLIENTE,BAR.BARRBARRATRANSFERENCIA,TR.TRETCODIGO
      ,CASE WHEN SUBSTR(TR.TRETCODIGO,1,2) = 'CL' THEN RC.RCRENCRENTA END AS LICITACION
      ,CASE WHEN SUBSTR(TR.TRETCODIGO,1,2) &#60;> 'CL' THEN RC.RCRENCRENTA END AS BILATERAL
      FROM TRN_TRANS_RETIRO TR JOIN RCG_RENTA_CONGESTION RC ON TR.TRETCODI = RC.TRETCODI
      LEFT JOIN SI_EMPRESA GEN ON TR.GENEMPRCODI = GEN.EMPRCODI
      LEFT JOIN SI_EMPRESA CLI ON TR.CLIEMPRCODI = CLI.EMPRCODI
      LEFT JOIN TRN_BARRA BAR ON TR.BARRCODI = BAR.BARRCODI
      WHERE tr.tretestado = 'ACT' and TR.PERICODI = :PERICODI AND TR.TRETVERSION = :RECACODI
      ORDER BY 1,2,3,4


    </query>
  </Sql>


  <Sql>
    <key>ListTotalPorcentajes</key>
    <query>
      SELECT COUNT(*) AS CANTIDAD FROM TRN_ING_RETIROSC WHERE PERICODI = :PERICODI AND INGRSCVERSION = :RECACODI
    </query>
  </Sql>

  <Sql>
    <key>ListErroresBarras</key>
    <query>

      SELECT  ORDEN,BARRCODI,BARRBARRATRANSFERENCIA,OBS,TO_CHAR(FECHA,'DD/MM/YYYY HH24:MI') AS FECHA,rownum FROM (
      SELECT 1 AS ORDEN,BAR.BARRCODI,MB.BARRBARRATRANSFERENCIA,'No existe en todo el mes' AS OBS,NULL AS FECHA
      FROM (
      SELECT BARRCODI FROM TRN_TRANS_ENTREGA WHERE tentestado = 'ACT' and PERICODI={0} AND TENTVERSION={1}
      UNION
      SELECT BARRCODI FROM TRN_TRANS_RETIRO WHERE tretestado = 'ACT' and PERICODI={0} AND TRETVERSION={1}
      ) BAR LEFT JOIN TRN_BARRA MB ON BAR.BARRCODI = MB.BARRCODI
      WHERE NOT EXISTS (SELECT 1 FROM SI_COSTOMARGINAL CM WHERE CMGRFECHA >= TO_DATE('{2}','YYYYMM') AND CMGRFECHA &#60; ADD_MONTHS(TO_DATE('{2}','YYYYMM'),1) AND CM.BARRCODI= BAR.BARRCODI)
      UNION
      SELECT 2 AS ORDEN,BAR.BARRCODI,MB.BARRBARRATRANSFERENCIA,'No tiene registro en la fecha' AS OBS,FEC.FECHA
      FROM (SELECT BARRCODI FROM TRN_TRANS_ENTREGA WHERE  tentestado = 'ACT' and PERICODI={0} AND TENTVERSION={1}
      UNION
      SELECT BARRCODI FROM TRN_TRANS_RETIRO WHERE tretestado = 'ACT' and PERICODI={0} AND TRETVERSION={1}
      ) BAR , (SELECT CASE WHEN TO_CHAR(TO_DATE('{2}','YYYYMM') + ROWNUM*(1/24/2),'HH24:MI')='00:00' THEN (TO_DATE('{2}','YYYYMM') + ROWNUM*(1/24/2))-1/24/60 ELSE TO_DATE('{2}','YYYYMM') + ROWNUM*(1/24/2) END AS FECHA FROM DUAL
      CONNECT BY LEVEL &#60;= (ADD_MONTHS(TO_DATE('{2}','YYYYMM'),1) - TO_DATE('{2}','YYYYMM'))*24*2) FEC
      ,TRN_BARRA MB
      WHERE BAR.BARRCODI = MB.BARRCODI
      AND NOT EXISTS (SELECT 1 FROM SI_COSTOMARGINAL CM WHERE CMGRFECHA = FEC.FECHA AND CM.BARRCODI= BAR.BARRCODI)
      AND EXISTS (SELECT 1 FROM SI_COSTOMARGINAL CM WHERE CMGRFECHA >= TO_DATE('{2}','YYYYMM') AND CMGRFECHA &#60; ADD_MONTHS(TO_DATE('{2}','YYYYMM'),1) AND CM.BARRCODI= BAR.BARRCODI)
      ORDER BY 1,3,5
      ) RES where rownum &#60;10000

    </query>
  </Sql>

  <Sql>
    <key>ListCostosMarginales</key>
    <query>

      SELECT BA.INTERVALO,BA.EMPRNOMB,BA.EQUINOMB,BA.BARRNOMBRE,BA.TENTCODIGO,BA.TIPO, CMG.CMGRCONGESTION
      FROM
      (SELECT *
      FROM (SELECT TO_DATE({0},'YYYYMM') + (1/24/4)*ROWNUM AS INTERVALO
      FROM DUAL CONNECT BY LEVEL &#60;= (SELECT TO_CHAR(LAST_DAY(TO_DATE({0},'YYYYMM')),'DD')*96 FROM DUAL))
      ,(SELECT EM.EMPRNOMB,EQ.EQUINOMB,BA.BARRNOMBRE,CA.TENTCODIGO,'Entrega' as Tipo, CA.BARRCODI
      FROM TRN_TRANS_ENTREGA CA JOIN SI_EMPRESA EM ON CA.EMPRCODI = EM.EMPRCODI
      JOIN EQ_EQUIPO EQ ON CA.EQUICODI = EQ.EQUICODI
      JOIN TRN_BARRA BA ON CA.BARRCODI = BA.BARRCODI
      WHERE ca.tentestado = 'ACT' and CA.PERICODI = {1} AND CA.TENTVERSION = {2}
      UNION ALL
      SELECT EM.EMPRNOMB,CL.EMPRNOMB,BA.BARRNOMBRE,CA.TRETCODIGO,'Retiro' as Tipo, CA.BARRCODI
      FROM TRN_TRANS_RETIRO CA JOIN SI_EMPRESA EM ON CA.GENEMPRCODI = EM.EMPRCODI
      JOIN SI_EMPRESA CL ON CA.CLIEMPRCODI = CL.EMPRCODI
      JOIN TRN_BARRA BA ON CA.BARRCODI = BA.BARRCODI
      WHERE ca.tretestado = 'ACT' and CA.PERICODI = {1} AND CA.TRETVERSION = {2}
      )
      ) BA
      LEFT JOIN (
      SELECT DISTINCT CASE WHEN TO_CHAR(CMGRFECHA,'HH24:MI')='23:59' THEN CMGRFECHA+1/24/60 ELSE CMGRFECHA END AS CMGRFECHA,BARRCODI,(CMGRCONGESTION/1000) AS CMGRCONGESTION
      FROM (
      SELECT TO_DATE({0}||RCCMGDDIA,'YYYYMMDD')+MINUTO*1/24/60 AS CMGRFECHA,BARRCODI,CMGRCONGESTION
      FROM   (SELECT DE.*
      FROM RCG_COSTOMARGINAL_CAB CA JOIN RCG_COSTOMARGINAL_DET DE ON CA.RCCMGCCODI = DE.RCCMGCCODI
      WHERE CA.PERICODI = {1} AND CA.RECACODI = {2}
      )
      UNPIVOT (CMGRCONGESTION FOR MINUTO IN (RCCMGD1         AS 1*30,
      RCCMGD2         AS 2*30,
      RCCMGD3         AS 3*30,
      RCCMGD4         AS 4*30,
      RCCMGD5         AS 5*30,
      RCCMGD6         AS 6*30,
      RCCMGD7         AS 7*30,
      RCCMGD8         AS 8*30,
      RCCMGD9         AS 9*30,
      RCCMGD10         AS 10*30,
      RCCMGD11         AS 11*30,
      RCCMGD12         AS 12*30,
      RCCMGD13         AS 13*30,
      RCCMGD14         AS 14*30,
      RCCMGD15         AS 15*30,
      RCCMGD16         AS 16*30,
      RCCMGD17         AS 17*30,
      RCCMGD18         AS 18*30,
      RCCMGD19         AS 19*30,
      RCCMGD20         AS 20*30,
      RCCMGD21         AS 21*30,
      RCCMGD22         AS 22*30,
      RCCMGD23         AS 23*30,
      RCCMGD24         AS 24*30,
      RCCMGD25         AS 25*30,
      RCCMGD26         AS 26*30,
      RCCMGD27         AS 27*30,
      RCCMGD28         AS 28*30,
      RCCMGD29         AS 29*30,
      RCCMGD30         AS 30*30,
      RCCMGD31         AS 31*30,
      RCCMGD32         AS 32*30,
      RCCMGD33         AS 33*30,
      RCCMGD34         AS 34*30,
      RCCMGD35         AS 35*30,
      RCCMGD36         AS 36*30,
      RCCMGD37         AS 37*30,
      RCCMGD38         AS 38*30,
      RCCMGD39         AS 39*30,
      RCCMGD40         AS 40*30,
      RCCMGD41         AS 41*30,
      RCCMGD42         AS 42*30,
      RCCMGD43         AS 43*30,
      RCCMGD44         AS 44*30,
      RCCMGD45         AS 45*30,
      RCCMGD46         AS 46*30,
      RCCMGD47         AS 47*30,
      RCCMGD48         AS 48*30
      )) ENT
      )
      UNION
      SELECT DISTINCT CASE WHEN TO_CHAR(CMGRFECHA,'HH24:MI')='23:59' THEN CMGRFECHA+1/24/60 ELSE CMGRFECHA END-15*(1/24/60),BARRCODI,(CMGRCONGESTION/1000) AS CMGRCONGESTION
      FROM (
      SELECT TO_DATE({0}||RCCMGDDIA,'YYYYMMDD')+MINUTO*1/24/60 AS CMGRFECHA,BARRCODI,CMGRCONGESTION
      FROM   (SELECT DE.*
      FROM RCG_COSTOMARGINAL_CAB CA JOIN RCG_COSTOMARGINAL_DET DE ON CA.RCCMGCCODI = DE.RCCMGCCODI
      WHERE CA.PERICODI = {1} AND CA.RECACODI = {2}
      )
      UNPIVOT (CMGRCONGESTION FOR MINUTO IN (RCCMGD1         AS 1*30,
      RCCMGD2         AS 2*30,
      RCCMGD3         AS 3*30,
      RCCMGD4         AS 4*30,
      RCCMGD5         AS 5*30,
      RCCMGD6         AS 6*30,
      RCCMGD7         AS 7*30,
      RCCMGD8         AS 8*30,
      RCCMGD9         AS 9*30,
      RCCMGD10         AS 10*30,
      RCCMGD11         AS 11*30,
      RCCMGD12         AS 12*30,
      RCCMGD13         AS 13*30,
      RCCMGD14         AS 14*30,
      RCCMGD15         AS 15*30,
      RCCMGD16         AS 16*30,
      RCCMGD17         AS 17*30,
      RCCMGD18         AS 18*30,
      RCCMGD19         AS 19*30,
      RCCMGD20         AS 20*30,
      RCCMGD21         AS 21*30,
      RCCMGD22         AS 22*30,
      RCCMGD23         AS 23*30,
      RCCMGD24         AS 24*30,
      RCCMGD25         AS 25*30,
      RCCMGD26         AS 26*30,
      RCCMGD27         AS 27*30,
      RCCMGD28         AS 28*30,
      RCCMGD29         AS 29*30,
      RCCMGD30         AS 30*30,
      RCCMGD31         AS 31*30,
      RCCMGD32         AS 32*30,
      RCCMGD33         AS 33*30,
      RCCMGD34         AS 34*30,
      RCCMGD35         AS 35*30,
      RCCMGD36         AS 36*30,
      RCCMGD37         AS 37*30,
      RCCMGD38         AS 38*30,
      RCCMGD39         AS 39*30,
      RCCMGD40         AS 40*30,
      RCCMGD41         AS 41*30,
      RCCMGD42         AS 42*30,
      RCCMGD43         AS 43*30,
      RCCMGD44         AS 44*30,
      RCCMGD45         AS 45*30,
      RCCMGD46         AS 46*30,
      RCCMGD47         AS 47*30,
      RCCMGD48         AS 48*30
      )) ENT
      )
      ORDER BY 1
      ) CMG ON BA.INTERVALO = CMG.CMGRFECHA AND BA.BARRCODI = CMG.BARRCODI
      ORDER BY INTERVALO,TIPO,TENTCODIGO

    </query>
  </Sql>

  <Sql>
    <key>ListEntregasRetiros</key>
    <query>

      SELECT BA.INTERVALO,BA.EMPRNOMB,BA.EQUINOMB,BA.BARRNOMBRE,BA.TENTCODIGO,BA.TIPO, ER.TENTDEENERGIA
      FROM
      (SELECT *
      FROM (SELECT TO_DATE({0},'YYYYMM') + (1/24/4)*ROWNUM AS INTERVALO
      FROM DUAL CONNECT BY LEVEL &#60;= (SELECT TO_CHAR(LAST_DAY(TO_DATE({0},'YYYYMM')),'DD')*96 FROM DUAL))
      ,(SELECT EM.EMPRNOMB,EQ.EQUINOMB,BA.BARRNOMBRE,CA.TENTCODIGO,'Entrega' as Tipo, CA.TENTCODI
      FROM TRN_TRANS_ENTREGA CA JOIN SI_EMPRESA EM ON CA.EMPRCODI = EM.EMPRCODI
      JOIN EQ_EQUIPO EQ ON CA.EQUICODI = EQ.EQUICODI
      JOIN TRN_BARRA BA ON CA.BARRCODI = BA.BARRCODI
      WHERE ca.tentestado = 'ACT' and CA.PERICODI = :Pericodi AND CA.TENTVERSION = :Recacodi
      UNION ALL
      SELECT EM.EMPRNOMB,CL.EMPRNOMB,BA.BARRNOMBRE,CA.TRETCODIGO,'Retiro' as Tipo, CA.TRETCODI
      FROM TRN_TRANS_RETIRO CA JOIN SI_EMPRESA EM ON CA.GENEMPRCODI = EM.EMPRCODI
      JOIN SI_EMPRESA CL ON CA.CLIEMPRCODI = CL.EMPRCODI
      JOIN TRN_BARRA BA ON CA.BARRCODI = BA.BARRCODI
      WHERE ca.tretestado = 'ACT' and CA.PERICODI = :Pericodi AND CA.TRETVERSION = :Recacodi
      )
      ) BA
      LEFT JOIN (
      SELECT TENTCODI,TENTDEFECHA,'Entrega' AS TIPO, TENTDEENERGIA
      FROM  (SELECT TENTCODI,TO_DATE({0}||TENTDEDIA,'YYYYMMDD')+TENTDEMINUTO*1/24/60 AS TENTDEFECHA,BARRCODI,TENTDEENERGIA
      FROM   (SELECT CA.BARRCODI, DE.*
      FROM TRN_TRANS_ENTREGA CA JOIN TRN_TRANS_ENTREGA_DETALLE DE ON CA.TENTCODI = DE.TENTCODI AND CA.TENTVERSION = DE.TENTDEVERSION
      WHERE ca.tentestado = 'ACT' and CA.PERICODI = :Pericodi AND CA.TENTVERSION = :Recacodi
      AND TENTDEDIA BETWEEN 1 AND {1}
      )
      UNPIVOT (TENTDEENERGIA FOR TENTDEMINUTO IN (TENTDE1         AS 1*15,
      TENTDE2         AS 2*15,
      TENTDE3         AS 3*15,
      TENTDE4         AS 4*15,
      TENTDE5         AS 5*15,
      TENTDE6         AS 6*15,
      TENTDE7         AS 7*15,
      TENTDE8         AS 8*15,
      TENTDE9         AS 9*15,
      TENTDE10         AS 10*15,
      TENTDE11         AS 11*15,
      TENTDE12         AS 12*15,
      TENTDE13         AS 13*15,
      TENTDE14         AS 14*15,
      TENTDE15         AS 15*15,
      TENTDE16         AS 16*15,
      TENTDE17         AS 17*15,
      TENTDE18         AS 18*15,
      TENTDE19         AS 19*15,
      TENTDE20         AS 20*15,
      TENTDE21         AS 21*15,
      TENTDE22         AS 22*15,
      TENTDE23         AS 23*15,
      TENTDE24         AS 24*15,
      TENTDE25         AS 25*15,
      TENTDE26         AS 26*15,
      TENTDE27         AS 27*15,
      TENTDE28         AS 28*15,
      TENTDE29         AS 29*15,
      TENTDE30         AS 30*15,
      TENTDE31         AS 31*15,
      TENTDE32         AS 32*15,
      TENTDE33         AS 33*15,
      TENTDE34         AS 34*15,
      TENTDE35         AS 35*15,
      TENTDE36         AS 36*15,
      TENTDE37         AS 37*15,
      TENTDE38         AS 38*15,
      TENTDE39         AS 39*15,
      TENTDE40         AS 40*15,
      TENTDE41         AS 41*15,
      TENTDE42         AS 42*15,
      TENTDE43         AS 43*15,
      TENTDE44         AS 44*15,
      TENTDE45         AS 45*15,
      TENTDE46         AS 46*15,
      TENTDE47         AS 47*15,
      TENTDE48         AS 48*15,
      TENTDE49         AS 49*15,
      TENTDE50         AS 50*15,
      TENTDE51         AS 51*15,
      TENTDE52         AS 52*15,
      TENTDE53         AS 53*15,
      TENTDE54         AS 54*15,
      TENTDE55         AS 55*15,
      TENTDE56         AS 56*15,
      TENTDE57         AS 57*15,
      TENTDE58         AS 58*15,
      TENTDE59         AS 59*15,
      TENTDE60         AS 60*15,
      TENTDE61         AS 61*15,
      TENTDE62         AS 62*15,
      TENTDE63         AS 63*15,
      TENTDE64         AS 64*15,
      TENTDE65         AS 65*15,
      TENTDE66         AS 66*15,
      TENTDE67         AS 67*15,
      TENTDE68         AS 68*15,
      TENTDE69         AS 69*15,
      TENTDE70         AS 70*15,
      TENTDE71         AS 71*15,
      TENTDE72         AS 72*15,
      TENTDE73         AS 73*15,
      TENTDE74         AS 74*15,
      TENTDE75         AS 75*15,
      TENTDE76         AS 76*15,
      TENTDE77         AS 77*15,
      TENTDE78         AS 78*15,
      TENTDE79         AS 79*15,
      TENTDE80         AS 80*15,
      TENTDE81         AS 81*15,
      TENTDE82         AS 82*15,
      TENTDE83         AS 83*15,
      TENTDE84         AS 84*15,
      TENTDE85         AS 85*15,
      TENTDE86         AS 86*15,
      TENTDE87         AS 87*15,
      TENTDE88         AS 88*15,
      TENTDE89         AS 89*15,
      TENTDE90         AS 90*15,
      TENTDE91         AS 91*15,
      TENTDE92         AS 92*15,
      TENTDE93         AS 93*15,
      TENTDE94         AS 94*15,
      TENTDE95         AS 95*15,
      TENTDE96         AS 96*15)) ENT
      ORDER BY 1) EDET
      UNION ALL
      SELECT TRETCODI,TRETDEFECHA,'Retiro' AS TIPO,TRETDEENERGIA
      FROM  (SELECT TRETCODI,TO_DATE({0}||TRETDEDIA,'YYYYMMDD')+TRETDEMINUTO*1/24/60 AS TRETDEFECHA,BARRCODI,TRETDEENERGIA
      FROM   (SELECT CA.BARRCODI, DE.*
      FROM TRN_TRANS_RETIRO CA JOIN TRN_TRANS_RETIRO_DETALLE DE ON CA.TRETCODI = DE.TRETCODI AND CA.TRETVERSION = DE.TRETDEVERSION
      WHERE ca.tretestado = 'ACT' and CA.PERICODI = :Pericodi AND CA.TRETVERSION = :Recacodi
      AND TRETDEDIA BETWEEN 1 AND {1}
      )
      UNPIVOT (TRETDEENERGIA FOR TRETDEMINUTO IN (TRETDE1         AS 1*15,
      TRETDE2         AS 2*15,
      TRETDE3         AS 3*15,
      TRETDE4         AS 4*15,
      TRETDE5         AS 5*15,
      TRETDE6         AS 6*15,
      TRETDE7         AS 7*15,
      TRETDE8         AS 8*15,
      TRETDE9         AS 9*15,
      TRETDE10         AS 10*15,
      TRETDE11         AS 11*15,
      TRETDE12         AS 12*15,
      TRETDE13         AS 13*15,
      TRETDE14         AS 14*15,
      TRETDE15         AS 15*15,
      TRETDE16         AS 16*15,
      TRETDE17         AS 17*15,
      TRETDE18         AS 18*15,
      TRETDE19         AS 19*15,
      TRETDE20         AS 20*15,
      TRETDE21         AS 21*15,
      TRETDE22         AS 22*15,
      TRETDE23         AS 23*15,
      TRETDE24         AS 24*15,
      TRETDE25         AS 25*15,
      TRETDE26         AS 26*15,
      TRETDE27         AS 27*15,
      TRETDE28         AS 28*15,
      TRETDE29         AS 29*15,
      TRETDE30         AS 30*15,
      TRETDE31         AS 31*15,
      TRETDE32         AS 32*15,
      TRETDE33         AS 33*15,
      TRETDE34         AS 34*15,
      TRETDE35         AS 35*15,
      TRETDE36         AS 36*15,
      TRETDE37         AS 37*15,
      TRETDE38         AS 38*15,
      TRETDE39         AS 39*15,
      TRETDE40         AS 40*15,
      TRETDE41         AS 41*15,
      TRETDE42         AS 42*15,
      TRETDE43         AS 43*15,
      TRETDE44         AS 44*15,
      TRETDE45         AS 45*15,
      TRETDE46         AS 46*15,
      TRETDE47         AS 47*15,
      TRETDE48         AS 48*15,
      TRETDE49         AS 49*15,
      TRETDE50         AS 50*15,
      TRETDE51         AS 51*15,
      TRETDE52         AS 52*15,
      TRETDE53         AS 53*15,
      TRETDE54         AS 54*15,
      TRETDE55         AS 55*15,
      TRETDE56         AS 56*15,
      TRETDE57         AS 57*15,
      TRETDE58         AS 58*15,
      TRETDE59         AS 59*15,
      TRETDE60         AS 60*15,
      TRETDE61         AS 61*15,
      TRETDE62         AS 62*15,
      TRETDE63         AS 63*15,
      TRETDE64         AS 64*15,
      TRETDE65         AS 65*15,
      TRETDE66         AS 66*15,
      TRETDE67         AS 67*15,
      TRETDE68         AS 68*15,
      TRETDE69         AS 69*15,
      TRETDE70         AS 70*15,
      TRETDE71         AS 71*15,
      TRETDE72         AS 72*15,
      TRETDE73         AS 73*15,
      TRETDE74         AS 74*15,
      TRETDE75         AS 75*15,
      TRETDE76         AS 76*15,
      TRETDE77         AS 77*15,
      TRETDE78         AS 78*15,
      TRETDE79         AS 79*15,
      TRETDE80         AS 80*15,
      TRETDE81         AS 81*15,
      TRETDE82         AS 82*15,
      TRETDE83         AS 83*15,
      TRETDE84         AS 84*15,
      TRETDE85         AS 85*15,
      TRETDE86         AS 86*15,
      TRETDE87         AS 87*15,
      TRETDE88         AS 88*15,
      TRETDE89         AS 89*15,
      TRETDE90         AS 90*15,
      TRETDE91         AS 91*15,
      TRETDE92         AS 92*15,
      TRETDE93         AS 93*15,
      TRETDE94         AS 94*15,
      TRETDE95         AS 95*15,
      TRETDE96         AS 96*15)) ENT
      ORDER BY 1) EDET
      ) ER ON BA.INTERVALO = ER.TENTDEFECHA AND BA.TENTCODI = ER.TENTCODI AND BA.TIPO = ER.TIPO
      ORDER BY INTERVALO,TIPO,TENTCODIGO

    </query>
  </Sql>

  <Sql>
    <key>ListCostosMarginalesPorBarra</key>
    <query>


      SELECT BA.INTERVALO,BA.BARRNOMBRE,CMG.CMGRCONGESTION
      FROM
      (SELECT *
      FROM (SELECT TO_DATE({0},'YYYYMM') + (1/24/2)*ROWNUM AS INTERVALO
      FROM DUAL CONNECT BY LEVEL &#60;= (SELECT TO_CHAR(LAST_DAY(TO_DATE({0},'YYYYMM')),'DD')*48 FROM DUAL))
      ,(
      SELECT DISTINCT DE.BARRCODI, BR.BARRNOMBRE
      FROM RCG_COSTOMARGINAL_CAB CA JOIN RCG_COSTOMARGINAL_DET DE ON CA.RCCMGCCODI = DE.RCCMGCCODI
      JOIN TRN_BARRA BR ON DE.BARRCODI = BR.BARRCODI
      WHERE CA.PERICODI = {1} AND CA.RECACODI = {2}
      )
      ) BA
      LEFT JOIN (
      SELECT DISTINCT CASE WHEN TO_CHAR(CMGRFECHA,'HH24:MI')='23:59' THEN CMGRFECHA+1/24/60 ELSE CMGRFECHA END AS CMGRFECHA,BARRCODI,(CMGRCONGESTION/1000) AS CMGRCONGESTION
      FROM (
      SELECT TO_DATE({0}||RCCMGDDIA,'YYYYMMDD')+MINUTO*1/24/60 AS CMGRFECHA,BARRCODI,CMGRCONGESTION
      FROM   (SELECT DE.*
      FROM RCG_COSTOMARGINAL_CAB CA JOIN RCG_COSTOMARGINAL_DET DE ON CA.RCCMGCCODI = DE.RCCMGCCODI
      WHERE CA.PERICODI = {1} AND CA.RECACODI = {2}
      )
      UNPIVOT (CMGRCONGESTION FOR MINUTO IN (RCCMGD1         AS 1*30,
      RCCMGD2         AS 2*30,
      RCCMGD3         AS 3*30,
      RCCMGD4         AS 4*30,
      RCCMGD5         AS 5*30,
      RCCMGD6         AS 6*30,
      RCCMGD7         AS 7*30,
      RCCMGD8         AS 8*30,
      RCCMGD9         AS 9*30,
      RCCMGD10         AS 10*30,
      RCCMGD11         AS 11*30,
      RCCMGD12         AS 12*30,
      RCCMGD13         AS 13*30,
      RCCMGD14         AS 14*30,
      RCCMGD15         AS 15*30,
      RCCMGD16         AS 16*30,
      RCCMGD17         AS 17*30,
      RCCMGD18         AS 18*30,
      RCCMGD19         AS 19*30,
      RCCMGD20         AS 20*30,
      RCCMGD21         AS 21*30,
      RCCMGD22         AS 22*30,
      RCCMGD23         AS 23*30,
      RCCMGD24         AS 24*30,
      RCCMGD25         AS 25*30,
      RCCMGD26         AS 26*30,
      RCCMGD27         AS 27*30,
      RCCMGD28         AS 28*30,
      RCCMGD29         AS 29*30,
      RCCMGD30         AS 30*30,
      RCCMGD31         AS 31*30,
      RCCMGD32         AS 32*30,
      RCCMGD33         AS 33*30,
      RCCMGD34         AS 34*30,
      RCCMGD35         AS 35*30,
      RCCMGD36         AS 36*30,
      RCCMGD37         AS 37*30,
      RCCMGD38         AS 38*30,
      RCCMGD39         AS 39*30,
      RCCMGD40         AS 40*30,
      RCCMGD41         AS 41*30,
      RCCMGD42         AS 42*30,
      RCCMGD43         AS 43*30,
      RCCMGD44         AS 44*30,
      RCCMGD45         AS 45*30,
      RCCMGD46         AS 46*30,
      RCCMGD47         AS 47*30,
      RCCMGD48         AS 48*30
      )) ENT
      )
      ) CMG ON BA.INTERVALO = CMG.CMGRFECHA AND BA.BARRCODI = CMG.BARRCODI
      ORDER BY INTERVALO,BARRNOMBRE

    </query>
  </Sql>

  <Sql>
    <key>ListTotalRegistrosCostosMarginales</key>
    <query>

      SELECT COUNT(*) AS NROREGS,MAX(NVL(C.RCCMGCFECMODIFICACION,C.RCCMGCFECCREACION)) AS FECULTACTUALIZACION
      FROM RCG_COSTOMARGINAL_CAB C JOIN RCG_COSTOMARGINAL_DET D ON C.RCCMGCCODI = D.RCCMGCCODI
      WHERE PERICODI = :PERICODI
      AND RECACODI = :RECACODI
    </query>
  </Sql>

	<Sql>
		<key>DeleteCostoMarginalCab</key>
		<query>

			DELETE FROM RCG_COSTOMARGINAL_CAB WHERE PERICODI = :PERICODI AND RECACODI = :RECACODI

		</query>
	</Sql>
	
  <Sql>
    <key>DeleteDatosRcgCostoMarginalDet</key>
    <query>

      DELETE FROM RCG_COSTOMARGINAL_DET WHERE RCCMGCCODI = :RCCMGCCODI

    </query>
  </Sql>

  <Sql>
    <key>GetMaximoCostoMarginalDetalleId</key>
    <query>
      SELECT NVL(MAX(RCCMGDCODI),0) AS RCCMGDCODI  FROM RCG_COSTOMARGINAL_DET

    </query>
  </Sql>

  <Sql>
    <key>SaveCostoMarginalDetSEV_OLD</key>
    <query>

      INSERT INTO RCG_COSTOMARGINAL_DET (RCCMGDCODI,    RCCMGCCODI,    BARRCODI,    RCCMGDDIA,
      RCCMGD1,     RCCMGD2,     RCCMGD3,     RCCMGD4,     RCCMGD5,     RCCMGD6,     RCCMGD7,     RCCMGD8,     RCCMGD9,     RCCMGD10,    RCCMGD11,    RCCMGD12,
      RCCMGD13,    RCCMGD14,    RCCMGD15,    RCCMGD16,    RCCMGD17,    RCCMGD18,    RCCMGD19,    RCCMGD20,    RCCMGD21,    RCCMGD22,    RCCMGD23,    RCCMGD24,
      RCCMGD25,    RCCMGD26,    RCCMGD27,    RCCMGD28,    RCCMGD29,    RCCMGD30,    RCCMGD31,    RCCMGD32,    RCCMGD33,    RCCMGD34,    RCCMGD35,    RCCMGD36,
      RCCMGD37,    RCCMGD38,    RCCMGD39,    RCCMGD40,    RCCMGD41,    RCCMGD42,    RCCMGD43,    RCCMGD44,    RCCMGD45,    RCCMGD46,    RCCMGD47,    RCCMGD48  )
      SELECT ROWNUM + {0},{1},D.* FROM
      (SELECT  BARRCODI,EXTRACT(DAY FROM (CMGRFECHA - 1/24/2)) AS DIA
      ,SUM(CASE WHEN TO_CHAR(CMGRFECHA - 1/24/2,'HH24:MI')='00:00' THEN NVL(CMGRCONGESTION, 0) ELSE 0 END) AS RCCMGD1
      ,SUM(CASE WHEN TO_CHAR(CMGRFECHA - 1/24/2,'HH24:MI')='00:30' THEN NVL(CMGRCONGESTION, 0) ELSE 0 END) AS RCCMGD2
      ,SUM(CASE WHEN TO_CHAR(CMGRFECHA - 1/24/2,'HH24:MI')='01:00' THEN NVL(CMGRCONGESTION, 0) ELSE 0 END) AS RCCMGD3
      ,SUM(CASE WHEN TO_CHAR(CMGRFECHA - 1/24/2,'HH24:MI')='01:30' THEN NVL(CMGRCONGESTION, 0) ELSE 0 END) AS RCCMGD4
      ,SUM(CASE WHEN TO_CHAR(CMGRFECHA - 1/24/2,'HH24:MI')='02:00' THEN NVL(CMGRCONGESTION, 0) ELSE 0 END) AS RCCMGD5
      ,SUM(CASE WHEN TO_CHAR(CMGRFECHA - 1/24/2,'HH24:MI')='02:30' THEN NVL(CMGRCONGESTION, 0) ELSE 0 END) AS RCCMGD6
      ,SUM(CASE WHEN TO_CHAR(CMGRFECHA - 1/24/2,'HH24:MI')='03:00' THEN NVL(CMGRCONGESTION, 0) ELSE 0 END) AS RCCMGD7
      ,SUM(CASE WHEN TO_CHAR(CMGRFECHA - 1/24/2,'HH24:MI')='03:30' THEN NVL(CMGRCONGESTION, 0) ELSE 0 END) AS RCCMGD8
      ,SUM(CASE WHEN TO_CHAR(CMGRFECHA - 1/24/2,'HH24:MI')='04:00' THEN NVL(CMGRCONGESTION, 0) ELSE 0 END) AS RCCMGD9
      ,SUM(CASE WHEN TO_CHAR(CMGRFECHA - 1/24/2,'HH24:MI')='04:30' THEN NVL(CMGRCONGESTION, 0) ELSE 0 END) AS RCCMGD10
      ,SUM(CASE WHEN TO_CHAR(CMGRFECHA - 1/24/2,'HH24:MI')='05:00' THEN NVL(CMGRCONGESTION, 0) ELSE 0 END) AS RCCMGD11
      ,SUM(CASE WHEN TO_CHAR(CMGRFECHA - 1/24/2,'HH24:MI')='05:30' THEN NVL(CMGRCONGESTION, 0) ELSE 0 END) AS RCCMGD12
      ,SUM(CASE WHEN TO_CHAR(CMGRFECHA - 1/24/2,'HH24:MI')='06:00' THEN NVL(CMGRCONGESTION, 0) ELSE 0 END) AS RCCMGD13
      ,SUM(CASE WHEN TO_CHAR(CMGRFECHA - 1/24/2,'HH24:MI')='06:30' THEN NVL(CMGRCONGESTION, 0) ELSE 0 END) AS RCCMGD14
      ,SUM(CASE WHEN TO_CHAR(CMGRFECHA - 1/24/2,'HH24:MI')='07:00' THEN NVL(CMGRCONGESTION, 0) ELSE 0 END) AS RCCMGD15
      ,SUM(CASE WHEN TO_CHAR(CMGRFECHA - 1/24/2,'HH24:MI')='07:30' THEN NVL(CMGRCONGESTION, 0) ELSE 0 END) AS RCCMGD16
      ,SUM(CASE WHEN TO_CHAR(CMGRFECHA - 1/24/2,'HH24:MI')='08:00' THEN NVL(CMGRCONGESTION, 0) ELSE 0 END) AS RCCMGD17
      ,SUM(CASE WHEN TO_CHAR(CMGRFECHA - 1/24/2,'HH24:MI')='08:30' THEN NVL(CMGRCONGESTION, 0) ELSE 0 END) AS RCCMGD18
      ,SUM(CASE WHEN TO_CHAR(CMGRFECHA - 1/24/2,'HH24:MI')='09:00' THEN NVL(CMGRCONGESTION, 0) ELSE 0 END) AS RCCMGD19
      ,SUM(CASE WHEN TO_CHAR(CMGRFECHA - 1/24/2,'HH24:MI')='09:30' THEN NVL(CMGRCONGESTION, 0) ELSE 0 END) AS RCCMGD20
      ,SUM(CASE WHEN TO_CHAR(CMGRFECHA - 1/24/2,'HH24:MI')='10:00' THEN NVL(CMGRCONGESTION, 0) ELSE 0 END) AS RCCMGD21
      ,SUM(CASE WHEN TO_CHAR(CMGRFECHA - 1/24/2,'HH24:MI')='10:30' THEN NVL(CMGRCONGESTION, 0) ELSE 0 END) AS RCCMGD22
      ,SUM(CASE WHEN TO_CHAR(CMGRFECHA - 1/24/2,'HH24:MI')='11:00' THEN NVL(CMGRCONGESTION, 0) ELSE 0 END) AS RCCMGD23
      ,SUM(CASE WHEN TO_CHAR(CMGRFECHA - 1/24/2,'HH24:MI')='11:30' THEN NVL(CMGRCONGESTION, 0) ELSE 0 END) AS RCCMGD24
      ,SUM(CASE WHEN TO_CHAR(CMGRFECHA - 1/24/2,'HH24:MI')='12:00' THEN NVL(CMGRCONGESTION, 0) ELSE 0 END) AS RCCMGD25
      ,SUM(CASE WHEN TO_CHAR(CMGRFECHA - 1/24/2,'HH24:MI')='12:30' THEN NVL(CMGRCONGESTION, 0) ELSE 0 END) AS RCCMGD26
      ,SUM(CASE WHEN TO_CHAR(CMGRFECHA - 1/24/2,'HH24:MI')='13:00' THEN NVL(CMGRCONGESTION, 0) ELSE 0 END) AS RCCMGD27
      ,SUM(CASE WHEN TO_CHAR(CMGRFECHA - 1/24/2,'HH24:MI')='13:30' THEN NVL(CMGRCONGESTION, 0) ELSE 0 END) AS RCCMGD28
      ,SUM(CASE WHEN TO_CHAR(CMGRFECHA - 1/24/2,'HH24:MI')='14:00' THEN NVL(CMGRCONGESTION, 0) ELSE 0 END) AS RCCMGD29
      ,SUM(CASE WHEN TO_CHAR(CMGRFECHA - 1/24/2,'HH24:MI')='14:30' THEN NVL(CMGRCONGESTION, 0) ELSE 0 END) AS RCCMGD30
      ,SUM(CASE WHEN TO_CHAR(CMGRFECHA - 1/24/2,'HH24:MI')='15:00' THEN NVL(CMGRCONGESTION, 0) ELSE 0 END) AS RCCMGD31
      ,SUM(CASE WHEN TO_CHAR(CMGRFECHA - 1/24/2,'HH24:MI')='15:30' THEN NVL(CMGRCONGESTION, 0) ELSE 0 END) AS RCCMGD32
      ,SUM(CASE WHEN TO_CHAR(CMGRFECHA - 1/24/2,'HH24:MI')='16:00' THEN NVL(CMGRCONGESTION, 0) ELSE 0 END) AS RCCMGD33
      ,SUM(CASE WHEN TO_CHAR(CMGRFECHA - 1/24/2,'HH24:MI')='16:30' THEN NVL(CMGRCONGESTION, 0) ELSE 0 END) AS RCCMGD34
      ,SUM(CASE WHEN TO_CHAR(CMGRFECHA - 1/24/2,'HH24:MI')='17:00' THEN NVL(CMGRCONGESTION, 0) ELSE 0 END) AS RCCMGD35
      ,SUM(CASE WHEN TO_CHAR(CMGRFECHA - 1/24/2,'HH24:MI')='17:30' THEN NVL(CMGRCONGESTION, 0) ELSE 0 END) AS RCCMGD36
      ,SUM(CASE WHEN TO_CHAR(CMGRFECHA - 1/24/2,'HH24:MI')='18:00' THEN NVL(CMGRCONGESTION, 0) ELSE 0 END) AS RCCMGD37
      ,SUM(CASE WHEN TO_CHAR(CMGRFECHA - 1/24/2,'HH24:MI')='18:30' THEN NVL(CMGRCONGESTION, 0) ELSE 0 END) AS RCCMGD38
      ,SUM(CASE WHEN TO_CHAR(CMGRFECHA - 1/24/2,'HH24:MI')='19:00' THEN NVL(CMGRCONGESTION, 0) ELSE 0 END) AS RCCMGD39
      ,SUM(CASE WHEN TO_CHAR(CMGRFECHA - 1/24/2,'HH24:MI')='19:30' THEN NVL(CMGRCONGESTION, 0) ELSE 0 END) AS RCCMGD40
      ,SUM(CASE WHEN TO_CHAR(CMGRFECHA - 1/24/2,'HH24:MI')='20:00' THEN NVL(CMGRCONGESTION, 0) ELSE 0 END) AS RCCMGD41
      ,SUM(CASE WHEN TO_CHAR(CMGRFECHA - 1/24/2,'HH24:MI')='20:30' THEN NVL(CMGRCONGESTION, 0) ELSE 0 END) AS RCCMGD42
      ,SUM(CASE WHEN TO_CHAR(CMGRFECHA - 1/24/2,'HH24:MI')='21:00' THEN NVL(CMGRCONGESTION, 0) ELSE 0 END) AS RCCMGD43
      ,SUM(CASE WHEN TO_CHAR(CMGRFECHA - 1/24/2,'HH24:MI')='21:30' THEN NVL(CMGRCONGESTION, 0) ELSE 0 END) AS RCCMGD44
      ,SUM(CASE WHEN TO_CHAR(CMGRFECHA - 1/24/2,'HH24:MI')='22:00' THEN NVL(CMGRCONGESTION, 0) ELSE 0 END) AS RCCMGD45
      ,SUM(CASE WHEN TO_CHAR(CMGRFECHA - 1/24/2,'HH24:MI')='22:30' THEN NVL(CMGRCONGESTION, 0) ELSE 0 END) AS RCCMGD46
      ,SUM(CASE WHEN TO_CHAR(CMGRFECHA - 1/24/2,'HH24:MI')='23:00' THEN NVL(CMGRCONGESTION, 0) ELSE 0 END) AS RCCMGD47
      ,SUM(CASE WHEN TO_CHAR(CMGRFECHA - 1/24/2,'HH24:MI')='23:30' THEN NVL(CMGRCONGESTION, 0) ELSE 0 END) AS RCCMGD48

      FROM (SELECT BARRCODI,CASE WHEN  to_char(CMGRFECHA,'HH24:MI') = '23:59' THEN CMGRFECHA + 1/24/60 ELSE  CMGRFECHA END AS CMGRFECHA,CMGRCONGESTION
      FROM SI_COSTOMARGINAL
      WHERE CMGRFECHA > TO_DATE({2},'YYYYMM') AND CMGRFECHA &#60;= ADD_MONTHS(TO_DATE({2},'YYYYMM'),1)
      AND NVL(CMGRCONGESTION,0) &#60;>0
      AND NVL(CMGRCONGESTION,0) &#60;> -1000
      AND BARRCODI IN (SELECT BARRCODI FROM TRN_BARRA)) CMG
      GROUP BY BARRCODI,EXTRACT(DAY FROM (CMGRFECHA - 1/24/2))
      ORDER BY 1,2) D
    </query>
  </Sql>

  <Sql>
    <key>SaveCostoMarginalDetCalculoAnterior</key>
    <query>

      INSERT INTO RCG_COSTOMARGINAL_DET (RCCMGDCODI,    RCCMGCCODI,    BARRCODI,    RCCMGDDIA,
      RCCMGD1,     RCCMGD2,     RCCMGD3,     RCCMGD4,     RCCMGD5,     RCCMGD6,     RCCMGD7,     RCCMGD8,     RCCMGD9,     RCCMGD10,    RCCMGD11,    RCCMGD12,
      RCCMGD13,    RCCMGD14,    RCCMGD15,    RCCMGD16,    RCCMGD17,    RCCMGD18,    RCCMGD19,    RCCMGD20,    RCCMGD21,    RCCMGD22,    RCCMGD23,    RCCMGD24,
      RCCMGD25,    RCCMGD26,    RCCMGD27,    RCCMGD28,    RCCMGD29,    RCCMGD30,    RCCMGD31,    RCCMGD32,    RCCMGD33,    RCCMGD34,    RCCMGD35,    RCCMGD36,
      RCCMGD37,    RCCMGD38,    RCCMGD39,    RCCMGD40,    RCCMGD41,    RCCMGD42,    RCCMGD43,    RCCMGD44,    RCCMGD45,    RCCMGD46,    RCCMGD47,    RCCMGD48  )

      SELECT ROWNUM+{0},  {1},    BARRCODI,    RCCMGDDIA,
      RCCMGD1,     RCCMGD2,     RCCMGD3,     RCCMGD4,     RCCMGD5,     RCCMGD6,     RCCMGD7,     RCCMGD8,     RCCMGD9,     RCCMGD10,    RCCMGD11,    RCCMGD12,
      RCCMGD13,    RCCMGD14,    RCCMGD15,    RCCMGD16,    RCCMGD17,    RCCMGD18,    RCCMGD19,    RCCMGD20,    RCCMGD21,    RCCMGD22,    RCCMGD23,    RCCMGD24,
      RCCMGD25,    RCCMGD26,    RCCMGD27,    RCCMGD28,    RCCMGD29,    RCCMGD30,    RCCMGD31,    RCCMGD32,    RCCMGD33,    RCCMGD34,    RCCMGD35,    RCCMGD36,
      RCCMGD37,    RCCMGD38,    RCCMGD39,    RCCMGD40,    RCCMGD41,    RCCMGD42,    RCCMGD43,    RCCMGD44,    RCCMGD45,    RCCMGD46,    RCCMGD47,    RCCMGD48
      FROM  RCG_COSTOMARGINAL_CAB C JOIN RCG_COSTOMARGINAL_DET D ON C.RCCMGCCODI = D.RCCMGCCODI
      WHERE C.PERICODI = {2}
      AND C.RECACODI = {3}
    </query>
  </Sql>

  <Sql>
    <key>ValidarCostoMarginal</key>
    <query>

      SELECT COUNT(*) FROM RCG_COSTOMARGINAL_CAB C JOIN RCG_COSTOMARGINAL_DET D ON C.RCCMGCCODI = D.RCCMGCCODI
      WHERE C.PERICODI = :PERICODI AND C.RECACODI = :RECACODI


    </query>
  </Sql>

  <!--ASSETEC 202002-->
  <Sql>
    <key>SaveCostoMarginalDetSEV_DDD</key>
    <query>
      INSERT INTO RCG_COSTOMARGINAL_DET (RCCMGDCODI,    RCCMGCCODI,    BARRCODI,    RCCMGDDIA,
      RCCMGD1,     RCCMGD2,     RCCMGD3,     RCCMGD4,     RCCMGD5,     RCCMGD6,     RCCMGD7,     RCCMGD8,     RCCMGD9,     RCCMGD10,    RCCMGD11,    RCCMGD12,
      RCCMGD13,    RCCMGD14,    RCCMGD15,    RCCMGD16,    RCCMGD17,    RCCMGD18,    RCCMGD19,    RCCMGD20,    RCCMGD21,    RCCMGD22,    RCCMGD23,    RCCMGD24,
      RCCMGD25,    RCCMGD26,    RCCMGD27,    RCCMGD28,    RCCMGD29,    RCCMGD30,    RCCMGD31,    RCCMGD32,    RCCMGD33,    RCCMGD34,    RCCMGD35,    RCCMGD36,
      RCCMGD37,    RCCMGD38,    RCCMGD39,    RCCMGD40,    RCCMGD41,    RCCMGD42,    RCCMGD43,    RCCMGD44,    RCCMGD45,    RCCMGD46,    RCCMGD47,    RCCMGD48  )
      select ({0} + rownum) as rccmgdcodi, {1} as rccmgccodi, barrcodi, to_number(substr(fecha, 9,2)) as rccmgddia,
      rccmgd1,rccmgd2,rccmgd3,rccmgd4,rccmgd5,rccmgd6,rccmgd7,rccmgd8,rccmgd9,rccmgd10,
      rccmgd11,rccmgd12,rccmgd13,rccmgd14,rccmgd15,rccmgd16,rccmgd17,rccmgd18,rccmgd19,rccmgd20,
      rccmgd21,rccmgd22,rccmgd23,rccmgd24,rccmgd25,rccmgd26,rccmgd27,rccmgd28,rccmgd29,rccmgd30,
      rccmgd31,rccmgd32,rccmgd33,rccmgd34,rccmgd35,rccmgd36,rccmgd37,rccmgd38,rccmgd39,rccmgd40,
      rccmgd41,rccmgd42,rccmgd43,rccmgd44,rccmgd45,rccmgd46,rccmgd47,rccmgd48
      from (
      select barrcodi, to_char(fecha, 'YYYY-MM-DD') as fecha,
      sum(h1) as rccmgd1, sum(h2) as rccmgd2, sum(h3) as rccmgd3, sum(h4) as rccmgd4, sum(h5) as rccmgd5,
      sum(h6) as rccmgd6, sum(h7) as rccmgd7, sum(h8) as rccmgd8, sum(h9) as rccmgd9, sum(h10) as rccmgd10,
      sum(h11) as rccmgd11, sum(h12) as rccmgd12, sum(h13) as rccmgd13, sum(h14) as rccmgd14, sum(h15) as rccmgd15,
      sum(h16) as rccmgd16, sum(h17) as rccmgd17, sum(h18) as rccmgd18, sum(h19) as rccmgd19, sum(h20) as rccmgd20,
      sum(h21) as rccmgd21, sum(h22) as rccmgd22, sum(h23) as rccmgd23, sum(h24) as rccmgd24, sum(h25) as rccmgd25,
      sum(h26) as rccmgd26, sum(h27) as rccmgd27, sum(h28) as rccmgd28, sum(h29) as rccmgd29, sum(h30) as rccmgd30,
      sum(h31) as rccmgd31, sum(h32) as rccmgd32, sum(h33) as rccmgd33, sum(h34) as rccmgd34, sum(h35) as rccmgd35,
      sum(h36) as rccmgd36, sum(h37) as rccmgd37, sum(h38) as rccmgd38, sum(h39) as rccmgd39, sum(h40) as rccmgd40,
      sum(h41) as rccmgd41, sum(h42) as rccmgd42, sum(h43) as rccmgd43, sum(h44) as rccmgd44, sum(h45) as rccmgd45,
      sum(h46) as rccmgd46, sum(h47) as rccmgd47, sum(h48) as rccmgd48
      from (
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, nvl((cm.cmgrcongestion / 1000),0) as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 1 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 1 and to_char(cm.cmgrfecha, 'YYYYMM') = {2}
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='00:30'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, nvl((cm.cmgrcongestion / 1000),0) as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 2 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 2 and to_char(cm.cmgrfecha, 'YYYYMM') = {2}
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='01:00'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, nvl((cm.cmgrcongestion / 1000),0) as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 3 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 3 and to_char(cm.cmgrfecha, 'YYYYMM') = {2}
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='01:30'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, nvl((cm.cmgrcongestion / 1000),0) as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 4 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 4 and to_char(cm.cmgrfecha, 'YYYYMM') = {2}
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='02:00'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, nvl((cm.cmgrcongestion / 1000),0) as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 5 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 5 and to_char(cm.cmgrfecha, 'YYYYMM') = {2}
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='02:30'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, nvl((cm.cmgrcongestion / 1000),0) as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 6 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 6 and to_char(cm.cmgrfecha, 'YYYYMM') = {2}
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='03:00'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, nvl((cm.cmgrcongestion / 1000),0) as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 7 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 7 and to_char(cm.cmgrfecha, 'YYYYMM') = {2}
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='03:30'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, nvl((cm.cmgrcongestion / 1000),0) as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 8 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 8 and to_char(cm.cmgrfecha, 'YYYYMM') = {2}
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='04:00'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, nvl((cm.cmgrcongestion / 1000),0) as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 9 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 9 and to_char(cm.cmgrfecha, 'YYYYMM') = {2}
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='04:30'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, nvl((cm.cmgrcongestion / 1000),0) as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 10 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 10 and to_char(cm.cmgrfecha, 'YYYYMM') = {2}
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='05:00'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      nvl((cm.cmgrcongestion / 1000),0) as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 11 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 11 and to_char(cm.cmgrfecha, 'YYYYMM') = {2}
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='05:30'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, nvl((cm.cmgrcongestion / 1000),0) as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 12 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 12 and to_char(cm.cmgrfecha, 'YYYYMM') = {2}
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='06:00'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, nvl((cm.cmgrcongestion / 1000),0) as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 13 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 13 and to_char(cm.cmgrfecha, 'YYYYMM') = {2}
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='06:30'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, nvl((cm.cmgrcongestion / 1000),0) as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 14 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 14 and to_char(cm.cmgrfecha, 'YYYYMM') = {2}
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='07:00'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, nvl((cm.cmgrcongestion / 1000),0) as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 15 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 15 and to_char(cm.cmgrfecha, 'YYYYMM') = {2}
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='07:30'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, nvl((cm.cmgrcongestion / 1000),0) as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 16 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 16 and to_char(cm.cmgrfecha, 'YYYYMM') = {2}
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='08:00'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, nvl((cm.cmgrcongestion / 1000),0) as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 17 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 17 and to_char(cm.cmgrfecha, 'YYYYMM') = {2}
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='08:30'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, nvl((cm.cmgrcongestion / 1000),0) as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 18 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 18 and to_char(cm.cmgrfecha, 'YYYYMM') = {2}
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='09:00'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, nvl((cm.cmgrcongestion / 1000),0) as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 19 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 19 and to_char(cm.cmgrfecha, 'YYYYMM') = {2}
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='09:30'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, nvl((cm.cmgrcongestion / 1000),0) as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 20 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 20 and to_char(cm.cmgrfecha, 'YYYYMM') = {2}
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='10:00'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      nvl((cm.cmgrcongestion / 1000),0) as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 21 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 21 and to_char(cm.cmgrfecha, 'YYYYMM') = {2}
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='10:30'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, nvl((cm.cmgrcongestion / 1000),0) as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 22 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 22 and to_char(cm.cmgrfecha, 'YYYYMM') = {2}
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='11:00'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, nvl((cm.cmgrcongestion / 1000),0) as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 23 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 23 and to_char(cm.cmgrfecha, 'YYYYMM') = {2}
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='11:30'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, nvl((cm.cmgrcongestion / 1000),0) as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 24 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 24 and to_char(cm.cmgrfecha, 'YYYYMM') = {2}
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='12:00'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, nvl((cm.cmgrcongestion / 1000),0) as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 25 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 25 and to_char(cm.cmgrfecha, 'YYYYMM') = {2}
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='12:30'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, nvl((cm.cmgrcongestion / 1000),0) as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 26 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 26 and to_char(cm.cmgrfecha, 'YYYYMM') = {2}
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='13:00'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, nvl((cm.cmgrcongestion / 1000),0) as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 27 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 27 and to_char(cm.cmgrfecha, 'YYYYMM') = {2}
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='13:30'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, nvl((cm.cmgrcongestion / 1000),0) as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 28 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 28 and to_char(cm.cmgrfecha, 'YYYYMM') = {2}
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='14:00'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, nvl((cm.cmgrcongestion / 1000),0) as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 29 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 29 and to_char(cm.cmgrfecha, 'YYYYMM') = {2}
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='14:30'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, nvl((cm.cmgrcongestion / 1000),0) as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 30 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 30 and to_char(cm.cmgrfecha, 'YYYYMM') = {2}
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='15:00'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      nvl((cm.cmgrcongestion / 1000),0) as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 31 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 31 and to_char(cm.cmgrfecha, 'YYYYMM') = {2}
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='15:30'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, nvl((cm.cmgrcongestion / 1000),0) as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 32 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 32 and to_char(cm.cmgrfecha, 'YYYYMM') = {2}
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='16:00'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, nvl((cm.cmgrcongestion / 1000),0) as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 33 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 33 and to_char(cm.cmgrfecha, 'YYYYMM') = {2}
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='16:30'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, nvl((cm.cmgrcongestion / 1000),0) as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 34 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 34 and to_char(cm.cmgrfecha, 'YYYYMM') = {2}
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='17:00'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, nvl((cm.cmgrcongestion / 1000),0) as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 35 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 35 and to_char(cm.cmgrfecha, 'YYYYMM') = {2}
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='17:30'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, nvl((cm.cmgrcongestion / 1000),0) as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 36 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 36 and to_char(cm.cmgrfecha, 'YYYYMM') = {2}
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='18:00'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, nvl((cm.cmgrcongestion / 1000),0) as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 37 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 37 and to_char(cm.cmgrfecha, 'YYYYMM') = {2}
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='18:30'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, nvl((cm.cmgrcongestion / 1000),0) as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 38 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 38 and to_char(cm.cmgrfecha, 'YYYYMM') = {2}
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='19:00'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, nvl((cm.cmgrcongestion / 1000),0) as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 39 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 39 and to_char(cm.cmgrfecha, 'YYYYMM') = {2}
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='19:30'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, nvl((cm.cmgrcongestion / 1000),0) as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 40 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 40 and to_char(cm.cmgrfecha, 'YYYYMM') = {2}
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='20:00'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      nvl((cm.cmgrcongestion / 1000),0) as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 41 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 41 and to_char(cm.cmgrfecha, 'YYYYMM') = {2}
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='20:30'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, nvl((cm.cmgrcongestion / 1000),0) as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 42 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 42 and to_char(cm.cmgrfecha, 'YYYYMM') = {2}
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='21:00'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, nvl((cm.cmgrcongestion / 1000),0) as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 43 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 43 and to_char(cm.cmgrfecha, 'YYYYMM') = {2}
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='21:30'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, nvl((cm.cmgrcongestion / 1000),0) as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 44 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 44 and to_char(cm.cmgrfecha, 'YYYYMM') = {2}
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='22:00'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, nvl((cm.cmgrcongestion / 1000),0) as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 45 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 45 and to_char(cm.cmgrfecha, 'YYYYMM') = {2}
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='22:30'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, nvl((cm.cmgrcongestion / 1000),0) as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 46 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 46 and to_char(cm.cmgrfecha, 'YYYYMM') = {2}
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='23:00'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, nvl((cm.cmgrcongestion / 1000),0) as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 47 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 47 and to_char(cm.cmgrfecha, 'YYYYMM') = {2}
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='23:30'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, nvl((cm.cmgrcongestion / 1000),0) as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 48 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 48 and to_char(cm.cmgrfecha, 'YYYYMM') = {2}
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='23:59'
      ) t2
      group by barrcodi, to_char(fecha, 'YYYY-MM-DD')
      order by 1, 2
      ) t1
    </query>
  </Sql>

  <Sql>
    <key>SaveCostoMarginalDetSEV</key>
    <query>
      INSERT INTO RCG_COSTOMARGINAL_DET (RCCMGDCODI,    RCCMGCCODI,    BARRCODI,    RCCMGDDIA,
      RCCMGD1,     RCCMGD2,     RCCMGD3,     RCCMGD4,     RCCMGD5,     RCCMGD6,     RCCMGD7,     RCCMGD8,     RCCMGD9,     RCCMGD10,    RCCMGD11,    RCCMGD12,
      RCCMGD13,    RCCMGD14,    RCCMGD15,    RCCMGD16,    RCCMGD17,    RCCMGD18,    RCCMGD19,    RCCMGD20,    RCCMGD21,    RCCMGD22,    RCCMGD23,    RCCMGD24,
      RCCMGD25,    RCCMGD26,    RCCMGD27,    RCCMGD28,    RCCMGD29,    RCCMGD30,    RCCMGD31,    RCCMGD32,    RCCMGD33,    RCCMGD34,    RCCMGD35,    RCCMGD36,
      RCCMGD37,    RCCMGD38,    RCCMGD39,    RCCMGD40,    RCCMGD41,    RCCMGD42,    RCCMGD43,    RCCMGD44,    RCCMGD45,    RCCMGD46,    RCCMGD47,    RCCMGD48  )
      select ({0} + rownum) as rccmgdcodi, {1} as rccmgccodi, barrcodi, to_number(substr(fecha, 9,2)) as rccmgddia,
      rccmgd1,rccmgd2,rccmgd3,rccmgd4,rccmgd5,rccmgd6,rccmgd7,rccmgd8,rccmgd9,rccmgd10,
      rccmgd11,rccmgd12,rccmgd13,rccmgd14,rccmgd15,rccmgd16,rccmgd17,rccmgd18,rccmgd19,rccmgd20,
      rccmgd21,rccmgd22,rccmgd23,rccmgd24,rccmgd25,rccmgd26,rccmgd27,rccmgd28,rccmgd29,rccmgd30,
      rccmgd31,rccmgd32,rccmgd33,rccmgd34,rccmgd35,rccmgd36,rccmgd37,rccmgd38,rccmgd39,rccmgd40,
      rccmgd41,rccmgd42,rccmgd43,rccmgd44,rccmgd45,rccmgd46,rccmgd47,rccmgd48
      from (
      select barrcodi, to_char(fecha, 'YYYY-MM-DD') as fecha,
      sum(h1) as rccmgd1, sum(h2) as rccmgd2, sum(h3) as rccmgd3, sum(h4) as rccmgd4, sum(h5) as rccmgd5,
      sum(h6) as rccmgd6, sum(h7) as rccmgd7, sum(h8) as rccmgd8, sum(h9) as rccmgd9, sum(h10) as rccmgd10,
      sum(h11) as rccmgd11, sum(h12) as rccmgd12, sum(h13) as rccmgd13, sum(h14) as rccmgd14, sum(h15) as rccmgd15,
      sum(h16) as rccmgd16, sum(h17) as rccmgd17, sum(h18) as rccmgd18, sum(h19) as rccmgd19, sum(h20) as rccmgd20,
      sum(h21) as rccmgd21, sum(h22) as rccmgd22, sum(h23) as rccmgd23, sum(h24) as rccmgd24, sum(h25) as rccmgd25,
      sum(h26) as rccmgd26, sum(h27) as rccmgd27, sum(h28) as rccmgd28, sum(h29) as rccmgd29, sum(h30) as rccmgd30,
      sum(h31) as rccmgd31, sum(h32) as rccmgd32, sum(h33) as rccmgd33, sum(h34) as rccmgd34, sum(h35) as rccmgd35,
      sum(h36) as rccmgd36, sum(h37) as rccmgd37, sum(h38) as rccmgd38, sum(h39) as rccmgd39, sum(h40) as rccmgd40,
      sum(h41) as rccmgd41, sum(h42) as rccmgd42, sum(h43) as rccmgd43, sum(h44) as rccmgd44, sum(h45) as rccmgd45,
      sum(h46) as rccmgd46, sum(h47) as rccmgd47, sum(h48) as rccmgd48
      from (
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, nvl((cm.cmgrcongestion / 1),0) as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 1 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 1 and to_char(cm.cmgrfecha, 'YYYYMM') = {2}
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='00:30'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, nvl((cm.cmgrcongestion / 1),0) as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 2 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 2 and to_char(cm.cmgrfecha, 'YYYYMM') = {2}
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='01:00'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, nvl((cm.cmgrcongestion / 1),0) as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 3 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 3 and to_char(cm.cmgrfecha, 'YYYYMM') = {2}
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='01:30'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, nvl((cm.cmgrcongestion / 1),0) as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 4 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 4 and to_char(cm.cmgrfecha, 'YYYYMM') = {2}
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='02:00'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, nvl((cm.cmgrcongestion / 1),0) as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 5 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 5 and to_char(cm.cmgrfecha, 'YYYYMM') = {2}
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='02:30'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, nvl((cm.cmgrcongestion / 1),0) as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 6 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 6 and to_char(cm.cmgrfecha, 'YYYYMM') = {2}
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='03:00'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, nvl((cm.cmgrcongestion / 1),0) as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 7 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 7 and to_char(cm.cmgrfecha, 'YYYYMM') = {2}
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='03:30'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, nvl((cm.cmgrcongestion / 1),0) as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 8 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 8 and to_char(cm.cmgrfecha, 'YYYYMM') = {2}
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='04:00'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, nvl((cm.cmgrcongestion / 1),0) as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 9 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 9 and to_char(cm.cmgrfecha, 'YYYYMM') = {2}
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='04:30'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, nvl((cm.cmgrcongestion / 1),0) as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 10 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 10 and to_char(cm.cmgrfecha, 'YYYYMM') = {2}
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='05:00'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      nvl((cm.cmgrcongestion / 1),0) as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 11 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 11 and to_char(cm.cmgrfecha, 'YYYYMM') = {2}
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='05:30'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, nvl((cm.cmgrcongestion / 1),0) as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 12 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 12 and to_char(cm.cmgrfecha, 'YYYYMM') = {2}
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='06:00'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, nvl((cm.cmgrcongestion / 1), 0) as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 13 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 13 and to_char(cm.cmgrfecha, 'YYYYMM') = {2}
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='06:30'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, nvl((cm.cmgrcongestion / 1),0) as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 14 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 14 and to_char(cm.cmgrfecha, 'YYYYMM') = {2}
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='07:00'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, nvl((cm.cmgrcongestion / 1),0) as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 15 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 15 and to_char(cm.cmgrfecha, 'YYYYMM') = {2}
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='07:30'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, nvl((cm.cmgrcongestion / 1),0) as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 16 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 16 and to_char(cm.cmgrfecha, 'YYYYMM') = {2}
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='08:00'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, nvl((cm.cmgrcongestion / 1),0) as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 17 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 17 and to_char(cm.cmgrfecha, 'YYYYMM') = {2}
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='08:30'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, nvl((cm.cmgrcongestion / 1),0) as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 18 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 18 and to_char(cm.cmgrfecha, 'YYYYMM') = {2}
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='09:00'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, nvl((cm.cmgrcongestion / 1),0) as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 19 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 19 and to_char(cm.cmgrfecha, 'YYYYMM') = {2}
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='09:30'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, nvl((cm.cmgrcongestion / 1),0) as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 20 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 20 and to_char(cm.cmgrfecha, 'YYYYMM') = {2}
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='10:00'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      nvl((cm.cmgrcongestion / 1),0) as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 21 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 21 and to_char(cm.cmgrfecha, 'YYYYMM') = {2}
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='10:30'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, nvl((cm.cmgrcongestion / 1),0) as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 22 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 22 and to_char(cm.cmgrfecha, 'YYYYMM') = {2}
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='11:00'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, nvl((cm.cmgrcongestion / 1),0) as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 23 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 23 and to_char(cm.cmgrfecha, 'YYYYMM') = {2}
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='11:30'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, nvl((cm.cmgrcongestion / 1),0) as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 24 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 24 and to_char(cm.cmgrfecha, 'YYYYMM') = {2}
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='12:00'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, nvl((cm.cmgrcongestion / 1),0) as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 25 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 25 and to_char(cm.cmgrfecha, 'YYYYMM') = {2}
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='12:30'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, nvl((cm.cmgrcongestion / 1),0) as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 26 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 26 and to_char(cm.cmgrfecha, 'YYYYMM') = {2}
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='13:00'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, nvl((cm.cmgrcongestion / 1),0) as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 27 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 27 and to_char(cm.cmgrfecha, 'YYYYMM') = {2}
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='13:30'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, nvl((cm.cmgrcongestion / 1),0) as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 28 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 28 and to_char(cm.cmgrfecha, 'YYYYMM') = {2}
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='14:00'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, nvl((cm.cmgrcongestion / 1),0) as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 29 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 29 and to_char(cm.cmgrfecha, 'YYYYMM') = {2}
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='14:30'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, nvl((cm.cmgrcongestion / 1),0) as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 30 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 30 and to_char(cm.cmgrfecha, 'YYYYMM') = {2}
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='15:00'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      nvl((cm.cmgrcongestion / 1),0) as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 31 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 31 and to_char(cm.cmgrfecha, 'YYYYMM') = {2}
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='15:30'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, nvl((cm.cmgrcongestion / 1),0) as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 32 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 32 and to_char(cm.cmgrfecha, 'YYYYMM') = {2}
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='16:00'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, nvl((cm.cmgrcongestion / 1),0) as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 33 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 33 and to_char(cm.cmgrfecha, 'YYYYMM') = {2}
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='16:30'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, nvl((cm.cmgrcongestion / 1),0) as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 34 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 34 and to_char(cm.cmgrfecha, 'YYYYMM') = {2}
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='17:00'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, nvl((cm.cmgrcongestion / 1),0) as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 35 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 35 and to_char(cm.cmgrfecha, 'YYYYMM') = {2}
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='17:30'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, nvl((cm.cmgrcongestion / 1),0) as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 36 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 36 and to_char(cm.cmgrfecha, 'YYYYMM') = {2}
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='18:00'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, nvl((cm.cmgrcongestion / 1),0) as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 37 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 37 and to_char(cm.cmgrfecha, 'YYYYMM') = {2}
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='18:30'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, nvl((cm.cmgrcongestion / 1),0) as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 38 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 38 and to_char(cm.cmgrfecha, 'YYYYMM') = {2}
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='19:00'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, nvl((cm.cmgrcongestion / 1),0) as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 39 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 39 and to_char(cm.cmgrfecha, 'YYYYMM') = {2}
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='19:30'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, nvl((cm.cmgrcongestion / 1),0) as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 40 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 40 and to_char(cm.cmgrfecha, 'YYYYMM') = {2}
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='20:00'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      nvl((cm.cmgrcongestion / 1),0) as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 41 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 41 and to_char(cm.cmgrfecha, 'YYYYMM') = {2}
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='20:30'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, nvl((cm.cmgrcongestion / 1),0) as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 42 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 42 and to_char(cm.cmgrfecha, 'YYYYMM') = {2}
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='21:00'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, nvl((cm.cmgrcongestion / 1),0) as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 43 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 43 and to_char(cm.cmgrfecha, 'YYYYMM') = {2}
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='21:30'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, nvl((cm.cmgrcongestion / 1),0) as h44, 0 as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 44 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 44 and to_char(cm.cmgrfecha, 'YYYYMM') = {2}
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='22:00'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, nvl((cm.cmgrcongestion / 1),0) as h45, 0 as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 45 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 45 and to_char(cm.cmgrfecha, 'YYYYMM') = {2}
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='22:30'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, nvl((cm.cmgrcongestion / 1),0) as h46, 0 as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 46 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 46 and to_char(cm.cmgrfecha, 'YYYYMM') = {2}
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='23:00'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, nvl((cm.cmgrcongestion / 1),0) as h47, 0 as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 47 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 47 and to_char(cm.cmgrfecha, 'YYYYMM') = {2}
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='23:30'
      union
      select tmp.barrcodi, tmp.cmgrfecha as fecha, tmp.cmgrcorrelativo, 0 as h1, 0 as h2, 0 as h3, 0 as h4, 0 as h5, 0 as h6, 0 as h7, 0 as h8, 0 as h9, 0 as h10,
      0 as h11, 0 as h12, 0 as h13, 0 as h14, 0 as h15, 0 as h16, 0 as h17, 0 as h18, 0 as h19, 0 as h20,
      0 as h21, 0 as h22, 0 as h23, 0 as h24, 0 as h25, 0 as h26, 0 as h27, 0 as h28, 0 as h29, 0 as h30,
      0 as h31, 0 as h32, 0 as h33, 0 as h34, 0 as h35, 0 as h36, 0 as h37, 0 as h38, 0 as h39, 0 as h40,
      0 as h41, 0 as h42, 0 as h43, 0 as h44, 0 as h45, 0 as h46, 0 as h47, nvl((cm.cmgrcongestion / 1),0) as h48
      from si_costomarginal cm right join trn_costo_marginal_tmp tmp on cm.barrcodi = tmp.barrcodi and tmp.cmgrcorrelativo = 48 and cm.cmgrfecha = tmp.cmgrfecha
      and cm.cmgrcorrelativo = 48 and to_char(cm.cmgrfecha, 'YYYYMM') = {2}
      where TO_CHAR(tmp.cmgrfecha,'HH24:MI')='23:59'
      ) t2
      group by barrcodi, to_char(fecha, 'YYYY-MM-DD')
      order by 1, 2
      ) t1
    </query>
  </Sql>

  <!--ASSETEC 202210 - Ajustar intervalos de 15 y 45 minutos.-->
  <Sql>
    <key>AjustarRGCEntregas</key>
    <query>
      update rcg_trans_entrega_rendet rcg1
      set rcg1.rcentdcmgc = nvl((select rcg2.rcentdcmgc from rcg_trans_entrega_rendet rcg2
      where rcg1.tentcodi = rcg2.tentcodi and
      rcg2.rcentdhora = to_date('{0}','DD/MM/YYYY HH24:MI:SS')
      ),0)
      where rcg1.rcentdcodi >= {2} and rcg1.rcentdhora = to_date('{1}','DD/MM/YYYY HH24:MI:SS')
    </query>
  </Sql>
  <Sql>
    <key>AjustarRGCRetiros</key>
    <query>
      update rcg_trans_retiro_rendet rcg1
      set rcg1.rcretdcmgc = nvl((select rcg2.rcretdcmgc from rcg_trans_retiro_rendet rcg2
      where rcg1.tretcodi = rcg2.tretcodi and
      rcg2.rcretdhora = to_date('{0}','DD/MM/YYYY HH24:MI:SS')
      ),0)
      where rcg1.rcretdcodi >= {2} and rcg1.rcretdhora = to_date('{1}','DD/MM/YYYY HH24:MI:SS')
    </query>
  </Sql>

  <Sql>
    <key>ListRGCEntregas</key>
    <query>
      select tentcodi from rcg_trans_entrega_rendet where rcentdcodi >= {0} group by tentcodi order by tentcodi
    </query>
  </Sql>
  <Sql>
    <key>ListRGCRetiros</key>
    <query>
      select tretcodi from rcg_trans_retiro_rendet where rcretdcodi >= {0} group by tretcodi order by tretcodi
    </query>
  </Sql>

  <Sql>
    <key>AjustarRGCEntregasDiaAterior</key>
    <query>
      update rcg_trans_entrega_rendet rcg1
      set rcg1.rcentdcmgc = nvl((select rcg2.rcentdcmgc from rcg_trans_entrega_rendet rcg2
      where (select b.tentcodi from trn_trans_entrega a, trn_trans_entrega b
      where a.tentcodi = {0} and a.barrcodi = b.barrcodi and a.codentcodi = b.codentcodi and b.tentestado = 'ACT' and
      b.pericodi = {1} and b.tentversion = {2}) = rcg2.tentcodi and
      rcg2.rcentdhora = to_date('{3}','DD/MM/YYYY HH24:MI:SS')
      ),0)
      where rcg1.tentcodi = {0} and rcg1.rcentdhora = to_date('{4}','DD/MM/YYYY HH24:MI:SS')
    </query>
  </Sql>
  <Sql>
    <key>AjustarRGCRetirosDiaAterior</key>
    <query>
      update rcg_trans_retiro_rendet rcg1
      set rcg1.rcretdcmgc = nvl((select rcg2.rcretdcmgc from rcg_trans_retiro_rendet rcg2
      where (select b.tretcodi from trn_trans_retiro a, trn_trans_retiro b
      where a.tretcodi = {0} and a.barrcodi = b.barrcodi and a.tretcoresocoresccodi = b.tretcoresocoresccodi and b.tretestado = 'ACT' and
      b.pericodi = {1} and b.tretversion = {2}) = rcg2.tretcodi and
      rcg2.rcretdhora = to_date('{3}','DD/MM/YYYY HH24:MI:SS')
      ),0)
      where rcg1.tretcodi = {0} and rcg1.rcretdhora = to_date('{4}','DD/MM/YYYY HH24:MI:SS')
    </query>
  </Sql>

  <Sql>
    <key>UpdateRGCEntregas</key>
    <query>
      update rcg_trans_entrega_rendet set rcentdrenta = (-1000 * rcentdcmgc * rcentdenergia)
      where rcentdcodi >= {0}
    </query>
  </Sql>
  <Sql>
    <key>UpdateRGCRetiros</key>
    <query>
      update rcg_trans_retiro_rendet set rcretdrenta = (1000 * rcretdcmgc * rcretdenergia)
      where rcretdcodi >= {0}
    </query>
  </Sql>
</Sqls>